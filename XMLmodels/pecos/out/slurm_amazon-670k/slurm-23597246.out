amazon670k
UUID is 2024-05-14-10-11-55
--- start training of bert1 ---
05/14/2024 10:12:00 - INFO - __main__ - Setting random seed 0
05/14/2024 10:12:03 - INFO - __main__ - Loaded training feature matrix with shape=(490449, 135909)
05/14/2024 10:12:03 - INFO - __main__ - Loaded training label matrix with shape=(490449, 670091)
05/14/2024 10:12:04 - INFO - __main__ - Loaded 490449 training sequences
05/14/2024 10:12:16 - INFO - pecos.xmc.xtransformer.model - Hierarchical label tree: [128, 2048, 32768, 670091]
05/14/2024 10:12:16 - INFO - pecos.xmc.xtransformer.model - Fine-tune Transformers with nr_labels=[128, 2048, 32768]
05/14/2024 10:12:16 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn+man at level 0, nr_labels=128, avr_M_nnz=128
05/14/2024 10:12:20 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-uncased model from s3.
05/14/2024 10:12:20 - INFO - pecos.xmc.xtransformer.matcher - ***** Encoding data len=490449 truncation=128*****
05/14/2024 10:12:55 - INFO - pecos.xmc.xtransformer.matcher - ***** Finished with time cost=35.16510820388794 *****
05/14/2024 10:13:17 - INFO - pecos.xmc.xtransformer.matcher - trn tensors saved to /scratch/slurm_tmpdir/job_23597246/tmp9pak7jj1/X_trn.pt
05/14/2024 10:13:18 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 4
05/14/2024 10:13:37 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
05/14/2024 10:13:37 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
/home/ul/ul_student/ul_ruw26/.local/lib/python3.9/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
05/14/2024 10:13:37 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
05/14/2024 10:13:37 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 490449
05/14/2024 10:13:37 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 128
05/14/2024 10:13:37 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 2
05/14/2024 10:13:37 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
05/14/2024 10:13:37 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 128
05/14/2024 10:13:37 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
05/14/2024 10:13:37 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
05/14/2024 10:14:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][    50/  4000] |   49/3832 batches | ms/batch 391.2233 | train_loss 9.070682e-01 | lr 2.500000e-05
05/14/2024 10:14:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   100/  4000] |   99/3832 batches | ms/batch 210.6816 | train_loss 2.147750e-01 | lr 5.000000e-05
05/14/2024 10:14:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   150/  4000] |  149/3832 batches | ms/batch 210.7339 | train_loss 1.714972e-01 | lr 7.500000e-05
05/14/2024 10:14:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   200/  4000] |  199/3832 batches | ms/batch 211.1032 | train_loss 1.510346e-01 | lr 1.000000e-04
05/14/2024 10:14:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   250/  4000] |  249/3832 batches | ms/batch 211.6068 | train_loss 1.222559e-01 | lr 9.868421e-05
05/14/2024 10:14:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   300/  4000] |  299/3832 batches | ms/batch 215.0082 | train_loss 1.053162e-01 | lr 9.736842e-05
05/14/2024 10:15:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   350/  4000] |  349/3832 batches | ms/batch 214.5169 | train_loss 9.446141e-02 | lr 9.605263e-05
05/14/2024 10:15:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   400/  4000] |  399/3832 batches | ms/batch 214.7711 | train_loss 8.681316e-02 | lr 9.473684e-05
05/14/2024 10:15:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   450/  4000] |  449/3832 batches | ms/batch 214.7151 | train_loss 8.532228e-02 | lr 9.342105e-05
05/14/2024 10:15:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   500/  4000] |  499/3832 batches | ms/batch 213.6089 | train_loss 8.071290e-02 | lr 9.210526e-05
05/14/2024 10:15:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   550/  4000] |  549/3832 batches | ms/batch 214.7244 | train_loss 8.037464e-02 | lr 9.078947e-05
05/14/2024 10:16:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   600/  4000] |  599/3832 batches | ms/batch 216.0258 | train_loss 7.839615e-02 | lr 8.947368e-05
05/14/2024 10:16:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   650/  4000] |  649/3832 batches | ms/batch 214.4034 | train_loss 7.677817e-02 | lr 8.815789e-05
05/14/2024 10:16:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   700/  4000] |  699/3832 batches | ms/batch 213.8525 | train_loss 7.587186e-02 | lr 8.684211e-05
05/14/2024 10:16:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   750/  4000] |  749/3832 batches | ms/batch 214.2989 | train_loss 7.346656e-02 | lr 8.552632e-05
05/14/2024 10:16:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   800/  4000] |  799/3832 batches | ms/batch 215.9757 | train_loss 7.451362e-02 | lr 8.421053e-05
05/14/2024 10:17:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   850/  4000] |  849/3832 batches | ms/batch 213.6434 | train_loss 7.211302e-02 | lr 8.289474e-05
05/14/2024 10:17:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   900/  4000] |  899/3832 batches | ms/batch 216.5448 | train_loss 7.162158e-02 | lr 8.157895e-05
05/14/2024 10:17:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   950/  4000] |  949/3832 batches | ms/batch 214.9903 | train_loss 7.155641e-02 | lr 8.026316e-05
05/14/2024 10:17:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1000/  4000] |  999/3832 batches | ms/batch 215.0087 | train_loss 7.147217e-02 | lr 7.894737e-05
05/14/2024 10:17:42 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmpx6vipcx2 at global_step 1000 ****
05/14/2024 10:17:43 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 10:17:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1050/  4000] | 1049/3832 batches | ms/batch 215.3732 | train_loss 6.958412e-02 | lr 7.763158e-05
05/14/2024 10:18:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1100/  4000] | 1099/3832 batches | ms/batch 215.2090 | train_loss 6.926203e-02 | lr 7.631579e-05
05/14/2024 10:18:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1150/  4000] | 1149/3832 batches | ms/batch 214.9654 | train_loss 6.871928e-02 | lr 7.500000e-05
05/14/2024 10:18:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1200/  4000] | 1199/3832 batches | ms/batch 214.3667 | train_loss 6.887179e-02 | lr 7.368421e-05
05/14/2024 10:18:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1250/  4000] | 1249/3832 batches | ms/batch 216.0298 | train_loss 6.864004e-02 | lr 7.236842e-05
05/14/2024 10:18:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1300/  4000] | 1299/3832 batches | ms/batch 215.5065 | train_loss 6.860401e-02 | lr 7.105263e-05
05/14/2024 10:19:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1350/  4000] | 1349/3832 batches | ms/batch 215.9887 | train_loss 6.856630e-02 | lr 6.973684e-05
05/14/2024 10:19:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1400/  4000] | 1399/3832 batches | ms/batch 215.5419 | train_loss 6.808050e-02 | lr 6.842105e-05
05/14/2024 10:19:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1450/  4000] | 1449/3832 batches | ms/batch 214.6133 | train_loss 6.672620e-02 | lr 6.710526e-05
05/14/2024 10:19:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1500/  4000] | 1499/3832 batches | ms/batch 215.7816 | train_loss 6.722469e-02 | lr 6.578947e-05
05/14/2024 10:19:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1550/  4000] | 1549/3832 batches | ms/batch 215.2366 | train_loss 6.711543e-02 | lr 6.447368e-05
05/14/2024 10:20:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1600/  4000] | 1599/3832 batches | ms/batch 215.1517 | train_loss 6.488486e-02 | lr 6.315789e-05
05/14/2024 10:20:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1650/  4000] | 1649/3832 batches | ms/batch 214.2349 | train_loss 6.714008e-02 | lr 6.184211e-05
05/14/2024 10:20:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1700/  4000] | 1699/3832 batches | ms/batch 215.3690 | train_loss 6.681327e-02 | lr 6.052632e-05
05/14/2024 10:20:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1750/  4000] | 1749/3832 batches | ms/batch 214.7130 | train_loss 6.601267e-02 | lr 5.921053e-05
05/14/2024 10:20:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1800/  4000] | 1799/3832 batches | ms/batch 213.4504 | train_loss 6.342089e-02 | lr 5.789474e-05
05/14/2024 10:21:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1850/  4000] | 1849/3832 batches | ms/batch 216.0436 | train_loss 6.491376e-02 | lr 5.657895e-05
05/14/2024 10:21:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1900/  4000] | 1899/3832 batches | ms/batch 215.3909 | train_loss 6.583503e-02 | lr 5.526316e-05
05/14/2024 10:21:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1950/  4000] | 1949/3832 batches | ms/batch 215.9906 | train_loss 6.504699e-02 | lr 5.394737e-05
05/14/2024 10:21:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2000/  4000] | 1999/3832 batches | ms/batch 216.4827 | train_loss 6.420020e-02 | lr 5.263158e-05
05/14/2024 10:21:36 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmpx6vipcx2 at global_step 2000 ****
05/14/2024 10:21:36 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 10:21:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2050/  4000] | 2049/3832 batches | ms/batch 217.0838 | train_loss 6.525851e-02 | lr 5.131579e-05
05/14/2024 10:21:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2100/  4000] | 2099/3832 batches | ms/batch 215.8503 | train_loss 6.459830e-02 | lr 5.000000e-05
05/14/2024 10:22:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2150/  4000] | 2149/3832 batches | ms/batch 215.7002 | train_loss 6.427428e-02 | lr 4.868421e-05
05/14/2024 10:22:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2200/  4000] | 2199/3832 batches | ms/batch 216.9973 | train_loss 6.393245e-02 | lr 4.736842e-05
05/14/2024 10:22:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2250/  4000] | 2249/3832 batches | ms/batch 215.7798 | train_loss 6.435431e-02 | lr 4.605263e-05
05/14/2024 10:22:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2300/  4000] | 2299/3832 batches | ms/batch 215.6168 | train_loss 6.339299e-02 | lr 4.473684e-05
05/14/2024 10:22:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2350/  4000] | 2349/3832 batches | ms/batch 216.2980 | train_loss 6.371703e-02 | lr 4.342105e-05
05/14/2024 10:23:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2400/  4000] | 2399/3832 batches | ms/batch 215.3369 | train_loss 6.264738e-02 | lr 4.210526e-05
05/14/2024 10:23:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2450/  4000] | 2449/3832 batches | ms/batch 215.3692 | train_loss 6.135277e-02 | lr 4.078947e-05
05/14/2024 10:23:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2500/  4000] | 2499/3832 batches | ms/batch 216.0057 | train_loss 6.284894e-02 | lr 3.947368e-05
05/14/2024 10:23:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2550/  4000] | 2549/3832 batches | ms/batch 215.0548 | train_loss 6.287633e-02 | lr 3.815789e-05
05/14/2024 10:23:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2600/  4000] | 2599/3832 batches | ms/batch 215.7114 | train_loss 6.209992e-02 | lr 3.684211e-05
05/14/2024 10:24:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2650/  4000] | 2649/3832 batches | ms/batch 215.1904 | train_loss 6.256276e-02 | lr 3.552632e-05
05/14/2024 10:24:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2700/  4000] | 2699/3832 batches | ms/batch 215.7845 | train_loss 6.262040e-02 | lr 3.421053e-05
05/14/2024 10:24:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2750/  4000] | 2749/3832 batches | ms/batch 216.7837 | train_loss 6.192270e-02 | lr 3.289474e-05
05/14/2024 10:24:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2800/  4000] | 2799/3832 batches | ms/batch 215.1167 | train_loss 6.130197e-02 | lr 3.157895e-05
05/14/2024 10:24:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2850/  4000] | 2849/3832 batches | ms/batch 216.0966 | train_loss 6.187827e-02 | lr 3.026316e-05
05/14/2024 10:25:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2900/  4000] | 2899/3832 batches | ms/batch 214.8263 | train_loss 6.238210e-02 | lr 2.894737e-05
05/14/2024 10:25:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2950/  4000] | 2949/3832 batches | ms/batch 213.7949 | train_loss 6.054550e-02 | lr 2.763158e-05
05/14/2024 10:25:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3000/  4000] | 2999/3832 batches | ms/batch 214.7486 | train_loss 6.099000e-02 | lr 2.631579e-05
05/14/2024 10:25:29 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmpx6vipcx2 at global_step 3000 ****
05/14/2024 10:25:29 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 10:25:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3050/  4000] | 3049/3832 batches | ms/batch 214.6861 | train_loss 6.132082e-02 | lr 2.500000e-05
05/14/2024 10:25:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3100/  4000] | 3099/3832 batches | ms/batch 214.9094 | train_loss 6.012325e-02 | lr 2.368421e-05
05/14/2024 10:26:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3150/  4000] | 3149/3832 batches | ms/batch 214.9216 | train_loss 6.054404e-02 | lr 2.236842e-05
05/14/2024 10:26:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3200/  4000] | 3199/3832 batches | ms/batch 216.7794 | train_loss 6.137242e-02 | lr 2.105263e-05
05/14/2024 10:26:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3250/  4000] | 3249/3832 batches | ms/batch 216.1371 | train_loss 6.045928e-02 | lr 1.973684e-05
05/14/2024 10:26:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3300/  4000] | 3299/3832 batches | ms/batch 215.7743 | train_loss 5.988389e-02 | lr 1.842105e-05
05/14/2024 10:26:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3350/  4000] | 3349/3832 batches | ms/batch 215.6584 | train_loss 6.130610e-02 | lr 1.710526e-05
05/14/2024 10:27:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3400/  4000] | 3399/3832 batches | ms/batch 214.9456 | train_loss 5.976176e-02 | lr 1.578947e-05
05/14/2024 10:27:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3450/  4000] | 3449/3832 batches | ms/batch 214.4436 | train_loss 6.060173e-02 | lr 1.447368e-05
05/14/2024 10:27:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3500/  4000] | 3499/3832 batches | ms/batch 215.3022 | train_loss 6.075243e-02 | lr 1.315789e-05
05/14/2024 10:27:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3550/  4000] | 3549/3832 batches | ms/batch 215.4181 | train_loss 5.907318e-02 | lr 1.184211e-05
05/14/2024 10:27:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3600/  4000] | 3599/3832 batches | ms/batch 216.2860 | train_loss 5.924726e-02 | lr 1.052632e-05
05/14/2024 10:28:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3650/  4000] | 3649/3832 batches | ms/batch 216.2424 | train_loss 5.973486e-02 | lr 9.210526e-06
05/14/2024 10:28:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3700/  4000] | 3699/3832 batches | ms/batch 214.8187 | train_loss 6.034555e-02 | lr 7.894737e-06
05/14/2024 10:28:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3750/  4000] | 3749/3832 batches | ms/batch 217.3611 | train_loss 5.865084e-02 | lr 6.578947e-06
05/14/2024 10:28:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3800/  4000] | 3799/3832 batches | ms/batch 215.5619 | train_loss 6.008953e-02 | lr 5.263158e-06
05/14/2024 10:28:52 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  3850/  4000] |   17/3832 batches | ms/batch 214.4317 | train_loss 5.790531e-02 | lr 3.947368e-06
05/14/2024 10:29:04 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  3900/  4000] |   67/3832 batches | ms/batch 214.4104 | train_loss 5.363830e-02 | lr 2.631579e-06
05/14/2024 10:29:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  3950/  4000] |  117/3832 batches | ms/batch 214.3860 | train_loss 5.393138e-02 | lr 1.315789e-06
05/14/2024 10:29:27 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  4000/  4000] |  167/3832 batches | ms/batch 216.3093 | train_loss 5.520529e-02 | lr 0.000000e+00
05/14/2024 10:29:27 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmpx6vipcx2 at global_step 4000 ****
05/14/2024 10:29:28 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 10:29:29 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23597246/tmpx6vipcx2
05/14/2024 10:29:29 - INFO - pecos.xmc.xtransformer.matcher - Predict on input text tensors(torch.Size([490449, 128])) in OVA mode
05/14/2024 10:29:29 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
05/14/2024 10:35:51 - INFO - pecos.xmc.xtransformer.matcher - Concatenating instance embeddings with features...
05/14/2024 10:36:01 - INFO - pecos.xmc.xtransformer.matcher - Start training concat_model of transformer matcher...
05/14/2024 10:37:20 - INFO - pecos.xmc.xtransformer.matcher - Using concat-only for transformer/concat ensemble of pred_csr
05/14/2024 10:37:35 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn+man at level 1, nr_labels=2048, avr_M_nnz=5.096409616494274
05/14/2024 10:37:36 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-uncased model from s3.
05/14/2024 10:38:06 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23597246/tmp9pak7jj1/X_trn.pt
05/14/2024 10:38:06 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
05/14/2024 10:40:06 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
05/14/2024 10:40:06 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 4
05/14/2024 10:40:06 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
05/14/2024 10:40:06 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
/home/ul/ul_student/ul_ruw26/.local/lib/python3.9/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
05/14/2024 10:40:24 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
05/14/2024 10:40:24 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 490449
05/14/2024 10:40:24 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 2048
05/14/2024 10:40:24 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 176
05/14/2024 10:40:24 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 2
05/14/2024 10:40:24 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
05/14/2024 10:40:24 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 128
05/14/2024 10:40:24 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
05/14/2024 10:40:24 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
05/14/2024 10:40:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][    50/  4000] |   49/3832 batches | ms/batch 246.1648 | train_loss 8.471358e-01 | lr 2.500000e-05
05/14/2024 10:40:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   100/  4000] |   99/3832 batches | ms/batch 237.7500 | train_loss 7.145475e-01 | lr 5.000000e-05
05/14/2024 10:41:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   150/  4000] |  149/3832 batches | ms/batch 236.7816 | train_loss 6.810559e-01 | lr 7.500000e-05
05/14/2024 10:41:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   200/  4000] |  199/3832 batches | ms/batch 236.3840 | train_loss 6.707931e-01 | lr 1.000000e-04
05/14/2024 10:41:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   250/  4000] |  249/3832 batches | ms/batch 232.4796 | train_loss 6.620421e-01 | lr 9.868421e-05
05/14/2024 10:41:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   300/  4000] |  299/3832 batches | ms/batch 236.6217 | train_loss 6.547327e-01 | lr 9.736842e-05
05/14/2024 10:42:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   350/  4000] |  349/3832 batches | ms/batch 234.4961 | train_loss 6.516477e-01 | lr 9.605263e-05
05/14/2024 10:42:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   400/  4000] |  399/3832 batches | ms/batch 234.4677 | train_loss 6.478406e-01 | lr 9.473684e-05
05/14/2024 10:42:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   450/  4000] |  449/3832 batches | ms/batch 239.6193 | train_loss 6.447291e-01 | lr 9.342105e-05
05/14/2024 10:42:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   500/  4000] |  499/3832 batches | ms/batch 236.9381 | train_loss 6.426649e-01 | lr 9.210526e-05
05/14/2024 10:42:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   550/  4000] |  549/3832 batches | ms/batch 243.7488 | train_loss 6.410994e-01 | lr 9.078947e-05
05/14/2024 10:43:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   600/  4000] |  599/3832 batches | ms/batch 240.6302 | train_loss 6.399914e-01 | lr 8.947368e-05
05/14/2024 10:43:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   650/  4000] |  649/3832 batches | ms/batch 238.7038 | train_loss 6.387967e-01 | lr 8.815789e-05
05/14/2024 10:43:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   700/  4000] |  699/3832 batches | ms/batch 256.1463 | train_loss 6.372466e-01 | lr 8.684211e-05
05/14/2024 10:43:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   750/  4000] |  749/3832 batches | ms/batch 243.8685 | train_loss 6.364686e-01 | lr 8.552632e-05
05/14/2024 10:44:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   800/  4000] |  799/3832 batches | ms/batch 235.2806 | train_loss 6.340109e-01 | lr 8.421053e-05
05/14/2024 10:44:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   850/  4000] |  849/3832 batches | ms/batch 248.1372 | train_loss 6.332697e-01 | lr 8.289474e-05
05/14/2024 10:44:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   900/  4000] |  899/3832 batches | ms/batch 238.2475 | train_loss 6.321039e-01 | lr 8.157895e-05
05/14/2024 10:44:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   950/  4000] |  949/3832 batches | ms/batch 223.9261 | train_loss 6.314191e-01 | lr 8.026316e-05
05/14/2024 10:44:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1000/  4000] |  999/3832 batches | ms/batch 245.6012 | train_loss 6.305428e-01 | lr 7.894737e-05
05/14/2024 10:44:52 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp33xp01ua at global_step 1000 ****
05/14/2024 10:44:52 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 10:45:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1050/  4000] | 1049/3832 batches | ms/batch 244.1364 | train_loss 6.313322e-01 | lr 7.763158e-05
05/14/2024 10:45:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1100/  4000] | 1099/3832 batches | ms/batch 219.9954 | train_loss 6.291015e-01 | lr 7.631579e-05
05/14/2024 10:45:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1150/  4000] | 1149/3832 batches | ms/batch 233.5498 | train_loss 6.286107e-01 | lr 7.500000e-05
05/14/2024 10:45:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1200/  4000] | 1199/3832 batches | ms/batch 238.4224 | train_loss 6.285473e-01 | lr 7.368421e-05
05/14/2024 10:45:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1250/  4000] | 1249/3832 batches | ms/batch 226.9797 | train_loss 6.277455e-01 | lr 7.236842e-05
05/14/2024 10:46:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1300/  4000] | 1299/3832 batches | ms/batch 226.4188 | train_loss 6.278331e-01 | lr 7.105263e-05
05/14/2024 10:46:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1350/  4000] | 1349/3832 batches | ms/batch 243.5518 | train_loss 6.276399e-01 | lr 6.973684e-05
05/14/2024 10:46:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1400/  4000] | 1399/3832 batches | ms/batch 251.4002 | train_loss 6.257804e-01 | lr 6.842105e-05
05/14/2024 10:46:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1450/  4000] | 1449/3832 batches | ms/batch 240.3028 | train_loss 6.250810e-01 | lr 6.710526e-05
05/14/2024 10:47:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1500/  4000] | 1499/3832 batches | ms/batch 232.3442 | train_loss 6.272373e-01 | lr 6.578947e-05
05/14/2024 10:47:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1550/  4000] | 1549/3832 batches | ms/batch 242.2916 | train_loss 6.234685e-01 | lr 6.447368e-05
05/14/2024 10:47:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1600/  4000] | 1599/3832 batches | ms/batch 235.4879 | train_loss 6.235046e-01 | lr 6.315789e-05
05/14/2024 10:47:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1650/  4000] | 1649/3832 batches | ms/batch 244.0356 | train_loss 6.253071e-01 | lr 6.184211e-05
05/14/2024 10:47:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1700/  4000] | 1699/3832 batches | ms/batch 252.1696 | train_loss 6.239361e-01 | lr 6.052632e-05
05/14/2024 10:48:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1750/  4000] | 1749/3832 batches | ms/batch 225.5274 | train_loss 6.228746e-01 | lr 5.921053e-05
05/14/2024 10:48:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1800/  4000] | 1799/3832 batches | ms/batch 227.3500 | train_loss 6.222324e-01 | lr 5.789474e-05
05/14/2024 10:48:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1850/  4000] | 1849/3832 batches | ms/batch 251.2562 | train_loss 6.224023e-01 | lr 5.657895e-05
05/14/2024 10:48:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1900/  4000] | 1899/3832 batches | ms/batch 244.1642 | train_loss 6.220884e-01 | lr 5.526316e-05
05/14/2024 10:48:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1950/  4000] | 1949/3832 batches | ms/batch 235.2500 | train_loss 6.217556e-01 | lr 5.394737e-05
05/14/2024 10:49:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2000/  4000] | 1999/3832 batches | ms/batch 242.3249 | train_loss 6.222536e-01 | lr 5.263158e-05
05/14/2024 10:49:11 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp33xp01ua at global_step 2000 ****
05/14/2024 10:49:12 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 10:49:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2050/  4000] | 2049/3832 batches | ms/batch 246.2681 | train_loss 6.211645e-01 | lr 5.131579e-05
05/14/2024 10:49:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2100/  4000] | 2099/3832 batches | ms/batch 235.8300 | train_loss 6.210836e-01 | lr 5.000000e-05
05/14/2024 10:49:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2150/  4000] | 2149/3832 batches | ms/batch 244.7290 | train_loss 6.208128e-01 | lr 4.868421e-05
05/14/2024 10:50:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2200/  4000] | 2199/3832 batches | ms/batch 251.4621 | train_loss 6.202769e-01 | lr 4.736842e-05
05/14/2024 10:50:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2250/  4000] | 2249/3832 batches | ms/batch 232.8014 | train_loss 6.202874e-01 | lr 4.605263e-05
05/14/2024 10:50:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2300/  4000] | 2299/3832 batches | ms/batch 226.1680 | train_loss 6.194108e-01 | lr 4.473684e-05
05/14/2024 10:50:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2350/  4000] | 2349/3832 batches | ms/batch 237.2139 | train_loss 6.200148e-01 | lr 4.342105e-05
05/14/2024 10:50:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2400/  4000] | 2399/3832 batches | ms/batch 240.2645 | train_loss 6.198411e-01 | lr 4.210526e-05
05/14/2024 10:51:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2450/  4000] | 2449/3832 batches | ms/batch 244.0758 | train_loss 6.200769e-01 | lr 4.078947e-05
05/14/2024 10:51:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2500/  4000] | 2499/3832 batches | ms/batch 234.6244 | train_loss 6.195520e-01 | lr 3.947368e-05
05/14/2024 10:51:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2550/  4000] | 2549/3832 batches | ms/batch 244.6498 | train_loss 6.178519e-01 | lr 3.815789e-05
05/14/2024 10:51:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2600/  4000] | 2599/3832 batches | ms/batch 228.8429 | train_loss 6.175781e-01 | lr 3.684211e-05
05/14/2024 10:52:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2650/  4000] | 2649/3832 batches | ms/batch 245.9745 | train_loss 6.173866e-01 | lr 3.552632e-05
05/14/2024 10:52:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2700/  4000] | 2699/3832 batches | ms/batch 235.4914 | train_loss 6.185407e-01 | lr 3.421053e-05
05/14/2024 10:52:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2750/  4000] | 2749/3832 batches | ms/batch 228.6005 | train_loss 6.177750e-01 | lr 3.289474e-05
05/14/2024 10:52:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2800/  4000] | 2799/3832 batches | ms/batch 236.9842 | train_loss 6.181414e-01 | lr 3.157895e-05
05/14/2024 10:52:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2850/  4000] | 2849/3832 batches | ms/batch 246.7182 | train_loss 6.178169e-01 | lr 3.026316e-05
05/14/2024 10:53:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2900/  4000] | 2899/3832 batches | ms/batch 237.9453 | train_loss 6.167536e-01 | lr 2.894737e-05
05/14/2024 10:53:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2950/  4000] | 2949/3832 batches | ms/batch 237.1957 | train_loss 6.158126e-01 | lr 2.763158e-05
05/14/2024 10:53:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3000/  4000] | 2999/3832 batches | ms/batch 245.5231 | train_loss 6.163037e-01 | lr 2.631579e-05
05/14/2024 10:53:32 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp33xp01ua at global_step 3000 ****
05/14/2024 10:53:33 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 10:53:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3050/  4000] | 3049/3832 batches | ms/batch 244.6314 | train_loss 6.167598e-01 | lr 2.500000e-05
05/14/2024 10:53:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3100/  4000] | 3099/3832 batches | ms/batch 224.6195 | train_loss 6.158526e-01 | lr 2.368421e-05
05/14/2024 10:54:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3150/  4000] | 3149/3832 batches | ms/batch 252.3100 | train_loss 6.161261e-01 | lr 2.236842e-05
05/14/2024 10:54:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3200/  4000] | 3199/3832 batches | ms/batch 241.1521 | train_loss 6.156984e-01 | lr 2.105263e-05
05/14/2024 10:54:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3250/  4000] | 3249/3832 batches | ms/batch 236.4275 | train_loss 6.160700e-01 | lr 1.973684e-05
05/14/2024 10:54:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3300/  4000] | 3299/3832 batches | ms/batch 237.2823 | train_loss 6.160995e-01 | lr 1.842105e-05
05/14/2024 10:55:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3350/  4000] | 3349/3832 batches | ms/batch 240.0841 | train_loss 6.161250e-01 | lr 1.710526e-05
05/14/2024 10:55:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3400/  4000] | 3399/3832 batches | ms/batch 231.4498 | train_loss 6.161784e-01 | lr 1.578947e-05
05/14/2024 10:55:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3450/  4000] | 3449/3832 batches | ms/batch 247.6828 | train_loss 6.153671e-01 | lr 1.447368e-05
05/14/2024 10:55:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3500/  4000] | 3499/3832 batches | ms/batch 231.7987 | train_loss 6.144237e-01 | lr 1.315789e-05
05/14/2024 10:55:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3550/  4000] | 3549/3832 batches | ms/batch 243.7521 | train_loss 6.151782e-01 | lr 1.184211e-05
05/14/2024 10:56:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3600/  4000] | 3599/3832 batches | ms/batch 232.7479 | train_loss 6.139187e-01 | lr 1.052632e-05
05/14/2024 10:56:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3650/  4000] | 3649/3832 batches | ms/batch 226.4978 | train_loss 6.151398e-01 | lr 9.210526e-06
05/14/2024 10:56:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3700/  4000] | 3699/3832 batches | ms/batch 227.4825 | train_loss 6.132352e-01 | lr 7.894737e-06
05/14/2024 10:56:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3750/  4000] | 3749/3832 batches | ms/batch 234.2362 | train_loss 6.133024e-01 | lr 6.578947e-06
05/14/2024 10:57:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3800/  4000] | 3799/3832 batches | ms/batch 247.2286 | train_loss 6.146593e-01 | lr 5.263158e-06
05/14/2024 10:57:19 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  3850/  4000] |   17/3832 batches | ms/batch 224.4983 | train_loss 6.120977e-01 | lr 3.947368e-06
05/14/2024 10:57:33 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  3900/  4000] |   67/3832 batches | ms/batch 249.4210 | train_loss 6.097263e-01 | lr 2.631579e-06
05/14/2024 10:57:46 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  3950/  4000] |  117/3832 batches | ms/batch 246.0529 | train_loss 6.093081e-01 | lr 1.315789e-06
05/14/2024 10:58:00 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  4000/  4000] |  167/3832 batches | ms/batch 248.8748 | train_loss 6.093953e-01 | lr 0.000000e+00
05/14/2024 10:58:00 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp33xp01ua at global_step 4000 ****
05/14/2024 10:58:00 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 10:58:01 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23597246/tmp33xp01ua
05/14/2024 10:58:02 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((490449, 2048)) with avr_nnz=80.0
05/14/2024 10:58:02 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
05/14/2024 11:04:30 - INFO - pecos.xmc.xtransformer.matcher - Concatenating instance embeddings with features...
05/14/2024 11:04:40 - INFO - pecos.xmc.xtransformer.matcher - Start training concat_model of transformer matcher...
05/14/2024 11:05:44 - INFO - pecos.xmc.xtransformer.matcher - Using concat-only for transformer/concat ensemble of pred_csr
05/14/2024 11:05:53 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn+man at level 2, nr_labels=32768, avr_M_nnz=5.202526664342266
05/14/2024 11:05:55 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-uncased model from s3.
05/14/2024 11:06:23 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23597246/tmp9pak7jj1/X_trn.pt
05/14/2024 11:06:23 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
05/14/2024 11:07:12 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
05/14/2024 11:07:12 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 4
05/14/2024 11:07:12 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
05/14/2024 11:07:12 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
/home/ul/ul_student/ul_ruw26/.local/lib/python3.9/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
05/14/2024 11:07:30 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
05/14/2024 11:07:30 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 490449
05/14/2024 11:07:30 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 32768
05/14/2024 11:07:30 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 192
05/14/2024 11:07:30 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 4
05/14/2024 11:07:30 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
05/14/2024 11:07:30 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 128
05/14/2024 11:07:30 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
05/14/2024 11:07:30 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 12000
05/14/2024 11:07:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][    50/ 12000] |   49/3832 batches | ms/batch 248.9551 | train_loss 6.563330e-01 | lr 2.500000e-05
05/14/2024 11:08:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   100/ 12000] |   99/3832 batches | ms/batch 238.2294 | train_loss 6.567669e-01 | lr 5.000000e-05
05/14/2024 11:08:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   150/ 12000] |  149/3832 batches | ms/batch 236.7580 | train_loss 6.614919e-01 | lr 7.500000e-05
05/14/2024 11:08:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   200/ 12000] |  199/3832 batches | ms/batch 235.0284 | train_loss 6.641856e-01 | lr 1.000000e-04
05/14/2024 11:08:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   250/ 12000] |  249/3832 batches | ms/batch 248.8337 | train_loss 6.686114e-01 | lr 9.957627e-05
05/14/2024 11:08:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   300/ 12000] |  299/3832 batches | ms/batch 240.5646 | train_loss 6.712592e-01 | lr 9.915254e-05
05/14/2024 11:09:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   350/ 12000] |  349/3832 batches | ms/batch 235.5116 | train_loss 6.683998e-01 | lr 9.872881e-05
05/14/2024 11:09:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   400/ 12000] |  399/3832 batches | ms/batch 239.5439 | train_loss 6.721634e-01 | lr 9.830508e-05
05/14/2024 11:09:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   450/ 12000] |  449/3832 batches | ms/batch 236.7757 | train_loss 6.677887e-01 | lr 9.788136e-05
05/14/2024 11:09:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   500/ 12000] |  499/3832 batches | ms/batch 229.5765 | train_loss 6.672727e-01 | lr 9.745763e-05
05/14/2024 11:10:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   550/ 12000] |  549/3832 batches | ms/batch 229.9463 | train_loss 6.667047e-01 | lr 9.703390e-05
05/14/2024 11:10:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   600/ 12000] |  599/3832 batches | ms/batch 247.9880 | train_loss 6.658192e-01 | lr 9.661017e-05
05/14/2024 11:10:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   650/ 12000] |  649/3832 batches | ms/batch 241.4314 | train_loss 6.648763e-01 | lr 9.618644e-05
05/14/2024 11:10:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   700/ 12000] |  699/3832 batches | ms/batch 231.6401 | train_loss 6.664144e-01 | lr 9.576271e-05
05/14/2024 11:10:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   750/ 12000] |  749/3832 batches | ms/batch 243.4209 | train_loss 6.634965e-01 | lr 9.533898e-05
05/14/2024 11:11:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   800/ 12000] |  799/3832 batches | ms/batch 244.0496 | train_loss 6.649268e-01 | lr 9.491525e-05
05/14/2024 11:11:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   850/ 12000] |  849/3832 batches | ms/batch 235.6667 | train_loss 6.628994e-01 | lr 9.449153e-05
05/14/2024 11:11:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   900/ 12000] |  899/3832 batches | ms/batch 249.6008 | train_loss 6.608725e-01 | lr 9.406780e-05
05/14/2024 11:11:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   950/ 12000] |  949/3832 batches | ms/batch 249.4112 | train_loss 6.621008e-01 | lr 9.364407e-05
05/14/2024 11:11:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1000/ 12000] |  999/3832 batches | ms/batch 236.2939 | train_loss 6.582788e-01 | lr 9.322034e-05
05/14/2024 11:11:59 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp7vr37lzz at global_step 1000 ****
05/14/2024 11:12:00 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 11:12:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1050/ 12000] | 1049/3832 batches | ms/batch 235.5820 | train_loss 6.600260e-01 | lr 9.279661e-05
05/14/2024 11:12:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1100/ 12000] | 1099/3832 batches | ms/batch 245.7466 | train_loss 6.593992e-01 | lr 9.237288e-05
05/14/2024 11:12:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1150/ 12000] | 1149/3832 batches | ms/batch 235.6024 | train_loss 6.626679e-01 | lr 9.194915e-05
05/14/2024 11:12:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1200/ 12000] | 1199/3832 batches | ms/batch 243.3718 | train_loss 6.569526e-01 | lr 9.152542e-05
05/14/2024 11:13:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1250/ 12000] | 1249/3832 batches | ms/batch 239.3153 | train_loss 6.563744e-01 | lr 9.110169e-05
05/14/2024 11:13:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1300/ 12000] | 1299/3832 batches | ms/batch 234.0938 | train_loss 6.611976e-01 | lr 9.067797e-05
05/14/2024 11:13:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1350/ 12000] | 1349/3832 batches | ms/batch 241.6953 | train_loss 6.560502e-01 | lr 9.025424e-05
05/14/2024 11:13:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1400/ 12000] | 1399/3832 batches | ms/batch 242.9524 | train_loss 6.579956e-01 | lr 8.983051e-05
05/14/2024 11:13:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1450/ 12000] | 1449/3832 batches | ms/batch 232.7467 | train_loss 6.585121e-01 | lr 8.940678e-05
05/14/2024 11:14:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1500/ 12000] | 1499/3832 batches | ms/batch 248.3169 | train_loss 6.547250e-01 | lr 8.898305e-05
05/14/2024 11:14:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1550/ 12000] | 1549/3832 batches | ms/batch 239.1427 | train_loss 6.555277e-01 | lr 8.855932e-05
05/14/2024 11:14:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1600/ 12000] | 1599/3832 batches | ms/batch 234.4227 | train_loss 6.545193e-01 | lr 8.813559e-05
05/14/2024 11:14:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1650/ 12000] | 1649/3832 batches | ms/batch 229.8992 | train_loss 6.532536e-01 | lr 8.771186e-05
05/14/2024 11:15:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1700/ 12000] | 1699/3832 batches | ms/batch 260.0029 | train_loss 6.528311e-01 | lr 8.728814e-05
05/14/2024 11:15:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1750/ 12000] | 1749/3832 batches | ms/batch 234.1109 | train_loss 6.533318e-01 | lr 8.686441e-05
05/14/2024 11:15:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1800/ 12000] | 1799/3832 batches | ms/batch 234.3804 | train_loss 6.531119e-01 | lr 8.644068e-05
05/14/2024 11:15:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1850/ 12000] | 1849/3832 batches | ms/batch 252.2186 | train_loss 6.516377e-01 | lr 8.601695e-05
05/14/2024 11:15:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1900/ 12000] | 1899/3832 batches | ms/batch 238.1297 | train_loss 6.525231e-01 | lr 8.559322e-05
05/14/2024 11:16:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1950/ 12000] | 1949/3832 batches | ms/batch 234.9458 | train_loss 6.512262e-01 | lr 8.516949e-05
05/14/2024 11:16:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2000/ 12000] | 1999/3832 batches | ms/batch 288.0090 | train_loss 6.523022e-01 | lr 8.474576e-05
05/14/2024 11:16:26 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp7vr37lzz at global_step 2000 ****
05/14/2024 11:16:27 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 11:16:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2050/ 12000] | 2049/3832 batches | ms/batch 242.9582 | train_loss 6.516648e-01 | lr 8.432203e-05
05/14/2024 11:16:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2100/ 12000] | 2099/3832 batches | ms/batch 251.7679 | train_loss 6.498187e-01 | lr 8.389831e-05
05/14/2024 11:17:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2150/ 12000] | 2149/3832 batches | ms/batch 262.0600 | train_loss 6.506830e-01 | lr 8.347458e-05
05/14/2024 11:17:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2200/ 12000] | 2199/3832 batches | ms/batch 260.5316 | train_loss 6.488087e-01 | lr 8.305085e-05
05/14/2024 11:17:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2250/ 12000] | 2249/3832 batches | ms/batch 246.8951 | train_loss 6.483034e-01 | lr 8.262712e-05
05/14/2024 11:17:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2300/ 12000] | 2299/3832 batches | ms/batch 234.5528 | train_loss 6.490148e-01 | lr 8.220339e-05
05/14/2024 11:18:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2350/ 12000] | 2349/3832 batches | ms/batch 256.1400 | train_loss 6.484813e-01 | lr 8.177966e-05
05/14/2024 11:18:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2400/ 12000] | 2399/3832 batches | ms/batch 245.6878 | train_loss 6.479548e-01 | lr 8.135593e-05
05/14/2024 11:18:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2450/ 12000] | 2449/3832 batches | ms/batch 233.2595 | train_loss 6.477493e-01 | lr 8.093220e-05
05/14/2024 11:18:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2500/ 12000] | 2499/3832 batches | ms/batch 255.2565 | train_loss 6.465753e-01 | lr 8.050847e-05
05/14/2024 11:18:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2550/ 12000] | 2549/3832 batches | ms/batch 248.5401 | train_loss 6.473476e-01 | lr 8.008475e-05
05/14/2024 11:19:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2600/ 12000] | 2599/3832 batches | ms/batch 233.5932 | train_loss 6.462088e-01 | lr 7.966102e-05
05/14/2024 11:19:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2650/ 12000] | 2649/3832 batches | ms/batch 248.4617 | train_loss 6.469064e-01 | lr 7.923729e-05
05/14/2024 11:19:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2700/ 12000] | 2699/3832 batches | ms/batch 237.6316 | train_loss 6.466176e-01 | lr 7.881356e-05
05/14/2024 11:19:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2750/ 12000] | 2749/3832 batches | ms/batch 243.0932 | train_loss 6.446164e-01 | lr 7.838983e-05
05/14/2024 11:20:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2800/ 12000] | 2799/3832 batches | ms/batch 238.2669 | train_loss 6.453150e-01 | lr 7.796610e-05
05/14/2024 11:20:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2850/ 12000] | 2849/3832 batches | ms/batch 248.3006 | train_loss 6.471399e-01 | lr 7.754237e-05
05/14/2024 11:20:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2900/ 12000] | 2899/3832 batches | ms/batch 237.6842 | train_loss 6.437295e-01 | lr 7.711864e-05
05/14/2024 11:20:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2950/ 12000] | 2949/3832 batches | ms/batch 241.3090 | train_loss 6.436126e-01 | lr 7.669492e-05
05/14/2024 11:20:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3000/ 12000] | 2999/3832 batches | ms/batch 245.8936 | train_loss 6.440037e-01 | lr 7.627119e-05
05/14/2024 11:20:55 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp7vr37lzz at global_step 3000 ****
05/14/2024 11:20:56 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 11:21:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3050/ 12000] | 3049/3832 batches | ms/batch 232.4967 | train_loss 6.424791e-01 | lr 7.584746e-05
05/14/2024 11:21:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3100/ 12000] | 3099/3832 batches | ms/batch 240.4559 | train_loss 6.439843e-01 | lr 7.542373e-05
05/14/2024 11:21:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3150/ 12000] | 3149/3832 batches | ms/batch 238.3964 | train_loss 6.442208e-01 | lr 7.500000e-05
05/14/2024 11:21:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3200/ 12000] | 3199/3832 batches | ms/batch 236.3630 | train_loss 6.443296e-01 | lr 7.457627e-05
05/14/2024 11:22:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3250/ 12000] | 3249/3832 batches | ms/batch 242.6876 | train_loss 6.410226e-01 | lr 7.415254e-05
05/14/2024 11:22:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3300/ 12000] | 3299/3832 batches | ms/batch 254.9830 | train_loss 6.396724e-01 | lr 7.372881e-05
05/14/2024 11:22:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3350/ 12000] | 3349/3832 batches | ms/batch 237.6579 | train_loss 6.401973e-01 | lr 7.330508e-05
05/14/2024 11:22:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3400/ 12000] | 3399/3832 batches | ms/batch 236.6980 | train_loss 6.409341e-01 | lr 7.288136e-05
05/14/2024 11:22:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3450/ 12000] | 3449/3832 batches | ms/batch 257.1828 | train_loss 6.415437e-01 | lr 7.245763e-05
05/14/2024 11:23:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3500/ 12000] | 3499/3832 batches | ms/batch 237.7809 | train_loss 6.414844e-01 | lr 7.203390e-05
05/14/2024 11:23:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3550/ 12000] | 3549/3832 batches | ms/batch 234.4777 | train_loss 6.408191e-01 | lr 7.161017e-05
05/14/2024 11:23:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3600/ 12000] | 3599/3832 batches | ms/batch 250.5293 | train_loss 6.400310e-01 | lr 7.118644e-05
05/14/2024 11:23:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3650/ 12000] | 3649/3832 batches | ms/batch 242.0552 | train_loss 6.410510e-01 | lr 7.076271e-05
05/14/2024 11:24:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3700/ 12000] | 3699/3832 batches | ms/batch 241.3745 | train_loss 6.402134e-01 | lr 7.033898e-05
05/14/2024 11:24:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3750/ 12000] | 3749/3832 batches | ms/batch 256.8992 | train_loss 6.394447e-01 | lr 6.991525e-05
05/14/2024 11:24:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3800/ 12000] | 3799/3832 batches | ms/batch 235.9039 | train_loss 6.400801e-01 | lr 6.949153e-05
05/14/2024 11:24:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  3850/ 12000] |   17/3832 batches | ms/batch 242.2820 | train_loss 6.327311e-01 | lr 6.906780e-05
05/14/2024 11:25:03 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  3900/ 12000] |   67/3832 batches | ms/batch 257.6477 | train_loss 6.253596e-01 | lr 6.864407e-05
05/14/2024 11:25:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  3950/ 12000] |  117/3832 batches | ms/batch 254.2130 | train_loss 6.276479e-01 | lr 6.822034e-05
05/14/2024 11:25:30 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4000/ 12000] |  167/3832 batches | ms/batch 239.3937 | train_loss 6.271410e-01 | lr 6.779661e-05
05/14/2024 11:25:30 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp7vr37lzz at global_step 4000 ****
05/14/2024 11:25:31 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 11:25:44 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4050/ 12000] |  217/3832 batches | ms/batch 251.0263 | train_loss 6.283956e-01 | lr 6.737288e-05
05/14/2024 11:25:57 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4100/ 12000] |  267/3832 batches | ms/batch 237.2599 | train_loss 6.278972e-01 | lr 6.694915e-05
05/14/2024 11:26:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4150/ 12000] |  317/3832 batches | ms/batch 233.5123 | train_loss 6.259412e-01 | lr 6.652542e-05
05/14/2024 11:26:24 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4200/ 12000] |  367/3832 batches | ms/batch 260.7806 | train_loss 6.277846e-01 | lr 6.610169e-05
05/14/2024 11:26:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4250/ 12000] |  417/3832 batches | ms/batch 242.0071 | train_loss 6.260130e-01 | lr 6.567797e-05
05/14/2024 11:26:51 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4300/ 12000] |  467/3832 batches | ms/batch 249.6578 | train_loss 6.273110e-01 | lr 6.525424e-05
05/14/2024 11:27:05 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4350/ 12000] |  517/3832 batches | ms/batch 250.1215 | train_loss 6.269917e-01 | lr 6.483051e-05
05/14/2024 11:27:18 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4400/ 12000] |  567/3832 batches | ms/batch 232.1531 | train_loss 6.279816e-01 | lr 6.440678e-05
05/14/2024 11:27:31 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4450/ 12000] |  617/3832 batches | ms/batch 254.3120 | train_loss 6.277933e-01 | lr 6.398305e-05
05/14/2024 11:27:46 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4500/ 12000] |  667/3832 batches | ms/batch 254.7375 | train_loss 6.270805e-01 | lr 6.355932e-05
05/14/2024 11:27:58 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4550/ 12000] |  717/3832 batches | ms/batch 231.6886 | train_loss 6.263886e-01 | lr 6.313559e-05
05/14/2024 11:28:11 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4600/ 12000] |  767/3832 batches | ms/batch 238.3666 | train_loss 6.273430e-01 | lr 6.271186e-05
05/14/2024 11:28:24 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4650/ 12000] |  817/3832 batches | ms/batch 242.4641 | train_loss 6.261462e-01 | lr 6.228814e-05
05/14/2024 11:28:37 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4700/ 12000] |  867/3832 batches | ms/batch 232.5906 | train_loss 6.241548e-01 | lr 6.186441e-05
05/14/2024 11:28:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4750/ 12000] |  917/3832 batches | ms/batch 222.8766 | train_loss 6.253685e-01 | lr 6.144068e-05
05/14/2024 11:29:03 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4800/ 12000] |  967/3832 batches | ms/batch 243.1695 | train_loss 6.257483e-01 | lr 6.101695e-05
05/14/2024 11:29:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4850/ 12000] | 1017/3832 batches | ms/batch 251.0660 | train_loss 6.248828e-01 | lr 6.059322e-05
05/14/2024 11:29:30 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4900/ 12000] | 1067/3832 batches | ms/batch 241.6940 | train_loss 6.258976e-01 | lr 6.016949e-05
05/14/2024 11:29:44 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4950/ 12000] | 1117/3832 batches | ms/batch 254.5627 | train_loss 6.247619e-01 | lr 5.974576e-05
05/14/2024 11:29:56 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5000/ 12000] | 1167/3832 batches | ms/batch 234.0292 | train_loss 6.252735e-01 | lr 5.932203e-05
05/14/2024 11:29:56 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp7vr37lzz at global_step 5000 ****
05/14/2024 11:29:57 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 11:30:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5050/ 12000] | 1217/3832 batches | ms/batch 236.7913 | train_loss 6.262398e-01 | lr 5.889831e-05
05/14/2024 11:30:24 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5100/ 12000] | 1267/3832 batches | ms/batch 251.1538 | train_loss 6.248604e-01 | lr 5.847458e-05
05/14/2024 11:30:37 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5150/ 12000] | 1317/3832 batches | ms/batch 243.4929 | train_loss 6.250590e-01 | lr 5.805085e-05
05/14/2024 11:30:50 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5200/ 12000] | 1367/3832 batches | ms/batch 237.1940 | train_loss 6.241344e-01 | lr 5.762712e-05
05/14/2024 11:31:04 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5250/ 12000] | 1417/3832 batches | ms/batch 253.4171 | train_loss 6.244069e-01 | lr 5.720339e-05
05/14/2024 11:31:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5300/ 12000] | 1467/3832 batches | ms/batch 249.7237 | train_loss 6.231683e-01 | lr 5.677966e-05
05/14/2024 11:31:31 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5350/ 12000] | 1517/3832 batches | ms/batch 247.7571 | train_loss 6.239805e-01 | lr 5.635593e-05
05/14/2024 11:31:45 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5400/ 12000] | 1567/3832 batches | ms/batch 252.6971 | train_loss 6.256210e-01 | lr 5.593220e-05
05/14/2024 11:31:58 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5450/ 12000] | 1617/3832 batches | ms/batch 236.1083 | train_loss 6.242305e-01 | lr 5.550847e-05
05/14/2024 11:32:11 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5500/ 12000] | 1667/3832 batches | ms/batch 236.1542 | train_loss 6.227141e-01 | lr 5.508475e-05
05/14/2024 11:32:24 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5550/ 12000] | 1717/3832 batches | ms/batch 254.8506 | train_loss 6.222657e-01 | lr 5.466102e-05
05/14/2024 11:32:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5600/ 12000] | 1767/3832 batches | ms/batch 235.9738 | train_loss 6.230303e-01 | lr 5.423729e-05
05/14/2024 11:32:51 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5650/ 12000] | 1817/3832 batches | ms/batch 239.6442 | train_loss 6.230968e-01 | lr 5.381356e-05
05/14/2024 11:33:04 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5700/ 12000] | 1867/3832 batches | ms/batch 251.5663 | train_loss 6.232430e-01 | lr 5.338983e-05
05/14/2024 11:33:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5750/ 12000] | 1917/3832 batches | ms/batch 233.9662 | train_loss 6.233030e-01 | lr 5.296610e-05
05/14/2024 11:33:30 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5800/ 12000] | 1967/3832 batches | ms/batch 238.2412 | train_loss 6.232163e-01 | lr 5.254237e-05
05/14/2024 11:33:43 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5850/ 12000] | 2017/3832 batches | ms/batch 240.6131 | train_loss 6.234828e-01 | lr 5.211864e-05
05/14/2024 11:33:56 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5900/ 12000] | 2067/3832 batches | ms/batch 238.1954 | train_loss 6.229128e-01 | lr 5.169492e-05
05/14/2024 11:34:09 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5950/ 12000] | 2117/3832 batches | ms/batch 239.2728 | train_loss 6.224990e-01 | lr 5.127119e-05
05/14/2024 11:34:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6000/ 12000] | 2167/3832 batches | ms/batch 231.5318 | train_loss 6.227046e-01 | lr 5.084746e-05
05/14/2024 11:34:22 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp7vr37lzz at global_step 6000 ****
05/14/2024 11:34:23 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 11:34:36 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6050/ 12000] | 2217/3832 batches | ms/batch 232.5047 | train_loss 6.223009e-01 | lr 5.042373e-05
05/14/2024 11:34:48 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6100/ 12000] | 2267/3832 batches | ms/batch 234.8644 | train_loss 6.219116e-01 | lr 5.000000e-05
05/14/2024 11:35:01 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6150/ 12000] | 2317/3832 batches | ms/batch 236.2838 | train_loss 6.214536e-01 | lr 4.957627e-05
05/14/2024 11:35:14 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6200/ 12000] | 2367/3832 batches | ms/batch 238.7084 | train_loss 6.218546e-01 | lr 4.915254e-05
05/14/2024 11:35:27 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6250/ 12000] | 2417/3832 batches | ms/batch 231.1151 | train_loss 6.225979e-01 | lr 4.872881e-05
05/14/2024 11:35:40 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6300/ 12000] | 2467/3832 batches | ms/batch 226.3594 | train_loss 6.210926e-01 | lr 4.830508e-05
05/14/2024 11:35:53 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6350/ 12000] | 2517/3832 batches | ms/batch 244.9154 | train_loss 6.213861e-01 | lr 4.788136e-05
05/14/2024 11:36:06 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6400/ 12000] | 2567/3832 batches | ms/batch 234.1765 | train_loss 6.207966e-01 | lr 4.745763e-05
05/14/2024 11:36:19 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6450/ 12000] | 2617/3832 batches | ms/batch 233.5682 | train_loss 6.212878e-01 | lr 4.703390e-05
05/14/2024 11:36:32 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6500/ 12000] | 2667/3832 batches | ms/batch 239.0497 | train_loss 6.212156e-01 | lr 4.661017e-05
05/14/2024 11:36:45 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6550/ 12000] | 2717/3832 batches | ms/batch 245.0431 | train_loss 6.200977e-01 | lr 4.618644e-05
05/14/2024 11:36:57 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6600/ 12000] | 2767/3832 batches | ms/batch 227.1672 | train_loss 6.213616e-01 | lr 4.576271e-05
05/14/2024 11:37:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6650/ 12000] | 2817/3832 batches | ms/batch 238.4318 | train_loss 6.206818e-01 | lr 4.533898e-05
05/14/2024 11:37:24 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6700/ 12000] | 2867/3832 batches | ms/batch 258.1782 | train_loss 6.205955e-01 | lr 4.491525e-05
05/14/2024 11:37:37 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6750/ 12000] | 2917/3832 batches | ms/batch 235.2765 | train_loss 6.208335e-01 | lr 4.449153e-05
05/14/2024 11:37:50 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6800/ 12000] | 2967/3832 batches | ms/batch 238.3581 | train_loss 6.210242e-01 | lr 4.406780e-05
05/14/2024 11:38:04 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6850/ 12000] | 3017/3832 batches | ms/batch 252.2720 | train_loss 6.207792e-01 | lr 4.364407e-05
05/14/2024 11:38:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6900/ 12000] | 3067/3832 batches | ms/batch 232.6545 | train_loss 6.192873e-01 | lr 4.322034e-05
05/14/2024 11:38:29 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6950/ 12000] | 3117/3832 batches | ms/batch 229.5070 | train_loss 6.198223e-01 | lr 4.279661e-05
05/14/2024 11:38:43 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7000/ 12000] | 3167/3832 batches | ms/batch 240.3346 | train_loss 6.199154e-01 | lr 4.237288e-05
05/14/2024 11:38:43 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp7vr37lzz at global_step 7000 ****
05/14/2024 11:38:43 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 11:38:57 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7050/ 12000] | 3217/3832 batches | ms/batch 246.3991 | train_loss 6.192147e-01 | lr 4.194915e-05
05/14/2024 11:39:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7100/ 12000] | 3267/3832 batches | ms/batch 237.6009 | train_loss 6.190285e-01 | lr 4.152542e-05
05/14/2024 11:39:23 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7150/ 12000] | 3317/3832 batches | ms/batch 246.8646 | train_loss 6.189934e-01 | lr 4.110169e-05
05/14/2024 11:39:36 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7200/ 12000] | 3367/3832 batches | ms/batch 237.1581 | train_loss 6.198947e-01 | lr 4.067797e-05
05/14/2024 11:39:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7250/ 12000] | 3417/3832 batches | ms/batch 236.3972 | train_loss 6.193597e-01 | lr 4.025424e-05
05/14/2024 11:40:03 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7300/ 12000] | 3467/3832 batches | ms/batch 252.5456 | train_loss 6.189311e-01 | lr 3.983051e-05
05/14/2024 11:40:16 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7350/ 12000] | 3517/3832 batches | ms/batch 236.0453 | train_loss 6.190559e-01 | lr 3.940678e-05
05/14/2024 11:40:29 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7400/ 12000] | 3567/3832 batches | ms/batch 240.6603 | train_loss 6.179101e-01 | lr 3.898305e-05
05/14/2024 11:40:43 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7450/ 12000] | 3617/3832 batches | ms/batch 249.3357 | train_loss 6.176563e-01 | lr 3.855932e-05
05/14/2024 11:40:56 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7500/ 12000] | 3667/3832 batches | ms/batch 240.0020 | train_loss 6.173538e-01 | lr 3.813559e-05
05/14/2024 11:41:09 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7550/ 12000] | 3717/3832 batches | ms/batch 231.8239 | train_loss 6.174884e-01 | lr 3.771186e-05
05/14/2024 11:41:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7600/ 12000] | 3767/3832 batches | ms/batch 238.1390 | train_loss 6.177723e-01 | lr 3.728814e-05
05/14/2024 11:41:35 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7650/ 12000] | 3817/3832 batches | ms/batch 242.6389 | train_loss 6.183598e-01 | lr 3.686441e-05
05/14/2024 11:41:55 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  7700/ 12000] |   35/3832 batches | ms/batch 234.3792 | train_loss 6.110887e-01 | lr 3.644068e-05
05/14/2024 11:42:08 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  7750/ 12000] |   85/3832 batches | ms/batch 232.0166 | train_loss 6.074220e-01 | lr 3.601695e-05
05/14/2024 11:42:21 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  7800/ 12000] |  135/3832 batches | ms/batch 235.2051 | train_loss 6.072322e-01 | lr 3.559322e-05
05/14/2024 11:42:34 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  7850/ 12000] |  185/3832 batches | ms/batch 250.7636 | train_loss 6.061940e-01 | lr 3.516949e-05
05/14/2024 11:42:47 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  7900/ 12000] |  235/3832 batches | ms/batch 237.3444 | train_loss 6.070468e-01 | lr 3.474576e-05
05/14/2024 11:43:00 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  7950/ 12000] |  285/3832 batches | ms/batch 233.0338 | train_loss 6.071759e-01 | lr 3.432203e-05
05/14/2024 11:43:14 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8000/ 12000] |  335/3832 batches | ms/batch 252.1432 | train_loss 6.075730e-01 | lr 3.389831e-05
05/14/2024 11:43:14 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp7vr37lzz at global_step 8000 ****
05/14/2024 11:43:15 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 11:43:28 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8050/ 12000] |  385/3832 batches | ms/batch 233.7954 | train_loss 6.078607e-01 | lr 3.347458e-05
05/14/2024 11:43:40 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8100/ 12000] |  435/3832 batches | ms/batch 238.6108 | train_loss 6.075115e-01 | lr 3.305085e-05
05/14/2024 11:43:54 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8150/ 12000] |  485/3832 batches | ms/batch 247.0505 | train_loss 6.084674e-01 | lr 3.262712e-05
05/14/2024 11:44:07 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8200/ 12000] |  535/3832 batches | ms/batch 236.0267 | train_loss 6.081486e-01 | lr 3.220339e-05
05/14/2024 11:44:20 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8250/ 12000] |  585/3832 batches | ms/batch 234.1450 | train_loss 6.071497e-01 | lr 3.177966e-05
05/14/2024 11:44:33 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8300/ 12000] |  635/3832 batches | ms/batch 248.1232 | train_loss 6.073652e-01 | lr 3.135593e-05
05/14/2024 11:44:46 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8350/ 12000] |  685/3832 batches | ms/batch 232.7460 | train_loss 6.081867e-01 | lr 3.093220e-05
05/14/2024 11:44:59 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8400/ 12000] |  735/3832 batches | ms/batch 232.5545 | train_loss 6.079655e-01 | lr 3.050847e-05
05/14/2024 11:45:12 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8450/ 12000] |  785/3832 batches | ms/batch 242.2388 | train_loss 6.066710e-01 | lr 3.008475e-05
05/14/2024 11:45:25 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8500/ 12000] |  835/3832 batches | ms/batch 249.2550 | train_loss 6.072460e-01 | lr 2.966102e-05
05/14/2024 11:45:38 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8550/ 12000] |  885/3832 batches | ms/batch 234.3616 | train_loss 6.083741e-01 | lr 2.923729e-05
05/14/2024 11:45:51 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8600/ 12000] |  935/3832 batches | ms/batch 233.5265 | train_loss 6.064300e-01 | lr 2.881356e-05
05/14/2024 11:46:04 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8650/ 12000] |  985/3832 batches | ms/batch 237.0870 | train_loss 6.074517e-01 | lr 2.838983e-05
05/14/2024 11:46:17 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8700/ 12000] | 1035/3832 batches | ms/batch 237.6178 | train_loss 6.074638e-01 | lr 2.796610e-05
05/14/2024 11:46:29 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8750/ 12000] | 1085/3832 batches | ms/batch 233.6093 | train_loss 6.077274e-01 | lr 2.754237e-05
05/14/2024 11:46:43 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8800/ 12000] | 1135/3832 batches | ms/batch 251.2352 | train_loss 6.071346e-01 | lr 2.711864e-05
05/14/2024 11:46:56 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8850/ 12000] | 1185/3832 batches | ms/batch 239.4302 | train_loss 6.066951e-01 | lr 2.669492e-05
05/14/2024 11:47:09 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8900/ 12000] | 1235/3832 batches | ms/batch 231.9063 | train_loss 6.063800e-01 | lr 2.627119e-05
05/14/2024 11:47:22 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8950/ 12000] | 1285/3832 batches | ms/batch 245.2177 | train_loss 6.070078e-01 | lr 2.584746e-05
05/14/2024 11:47:35 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9000/ 12000] | 1335/3832 batches | ms/batch 240.2334 | train_loss 6.064131e-01 | lr 2.542373e-05
05/14/2024 11:47:35 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp7vr37lzz at global_step 9000 ****
05/14/2024 11:47:36 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 11:47:49 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9050/ 12000] | 1385/3832 batches | ms/batch 238.7430 | train_loss 6.063889e-01 | lr 2.500000e-05
05/14/2024 11:48:03 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9100/ 12000] | 1435/3832 batches | ms/batch 249.1759 | train_loss 6.068833e-01 | lr 2.457627e-05
05/14/2024 11:48:16 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9150/ 12000] | 1485/3832 batches | ms/batch 245.1060 | train_loss 6.059185e-01 | lr 2.415254e-05
05/14/2024 11:48:29 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9200/ 12000] | 1535/3832 batches | ms/batch 230.7812 | train_loss 6.057961e-01 | lr 2.372881e-05
05/14/2024 11:48:42 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9250/ 12000] | 1585/3832 batches | ms/batch 245.0572 | train_loss 6.060339e-01 | lr 2.330508e-05
05/14/2024 11:48:55 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9300/ 12000] | 1635/3832 batches | ms/batch 243.2563 | train_loss 6.060809e-01 | lr 2.288136e-05
05/14/2024 11:49:08 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9350/ 12000] | 1685/3832 batches | ms/batch 234.9152 | train_loss 6.055388e-01 | lr 2.245763e-05
05/14/2024 11:49:21 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9400/ 12000] | 1735/3832 batches | ms/batch 239.1601 | train_loss 6.061493e-01 | lr 2.203390e-05
05/14/2024 11:49:34 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9450/ 12000] | 1785/3832 batches | ms/batch 245.0946 | train_loss 6.050047e-01 | lr 2.161017e-05
05/14/2024 11:49:47 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9500/ 12000] | 1835/3832 batches | ms/batch 218.8238 | train_loss 6.058212e-01 | lr 2.118644e-05
05/14/2024 11:49:59 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9550/ 12000] | 1885/3832 batches | ms/batch 218.0161 | train_loss 6.054806e-01 | lr 2.076271e-05
05/14/2024 11:50:12 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9600/ 12000] | 1935/3832 batches | ms/batch 240.6478 | train_loss 6.054076e-01 | lr 2.033898e-05
05/14/2024 11:50:25 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9650/ 12000] | 1985/3832 batches | ms/batch 236.7189 | train_loss 6.058750e-01 | lr 1.991525e-05
05/14/2024 11:50:38 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9700/ 12000] | 2035/3832 batches | ms/batch 219.2705 | train_loss 6.052591e-01 | lr 1.949153e-05
05/14/2024 11:50:50 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9750/ 12000] | 2085/3832 batches | ms/batch 223.9388 | train_loss 6.053373e-01 | lr 1.906780e-05
05/14/2024 11:51:02 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9800/ 12000] | 2135/3832 batches | ms/batch 225.8161 | train_loss 6.051285e-01 | lr 1.864407e-05
05/14/2024 11:51:15 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9850/ 12000] | 2185/3832 batches | ms/batch 224.3830 | train_loss 6.053463e-01 | lr 1.822034e-05
05/14/2024 11:51:28 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9900/ 12000] | 2235/3832 batches | ms/batch 222.4202 | train_loss 6.048825e-01 | lr 1.779661e-05
05/14/2024 11:51:40 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9950/ 12000] | 2285/3832 batches | ms/batch 218.9790 | train_loss 6.047212e-01 | lr 1.737288e-05
05/14/2024 11:51:52 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10000/ 12000] | 2335/3832 batches | ms/batch 228.7432 | train_loss 6.041673e-01 | lr 1.694915e-05
05/14/2024 11:51:52 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp7vr37lzz at global_step 10000 ****
05/14/2024 11:51:53 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 11:52:06 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10050/ 12000] | 2385/3832 batches | ms/batch 242.1508 | train_loss 6.046788e-01 | lr 1.652542e-05
05/14/2024 11:52:19 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10100/ 12000] | 2435/3832 batches | ms/batch 235.7783 | train_loss 6.054037e-01 | lr 1.610169e-05
05/14/2024 11:52:32 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10150/ 12000] | 2485/3832 batches | ms/batch 242.5839 | train_loss 6.053484e-01 | lr 1.567797e-05
05/14/2024 11:52:45 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10200/ 12000] | 2535/3832 batches | ms/batch 237.4533 | train_loss 6.047851e-01 | lr 1.525424e-05
05/14/2024 11:52:58 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10250/ 12000] | 2585/3832 batches | ms/batch 230.3847 | train_loss 6.047904e-01 | lr 1.483051e-05
05/14/2024 11:53:11 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10300/ 12000] | 2635/3832 batches | ms/batch 240.0760 | train_loss 6.037796e-01 | lr 1.440678e-05
05/14/2024 11:53:25 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10350/ 12000] | 2685/3832 batches | ms/batch 252.9015 | train_loss 6.056096e-01 | lr 1.398305e-05
05/14/2024 11:53:38 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10400/ 12000] | 2735/3832 batches | ms/batch 236.1394 | train_loss 6.051665e-01 | lr 1.355932e-05
05/14/2024 11:53:50 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10450/ 12000] | 2785/3832 batches | ms/batch 231.4958 | train_loss 6.053952e-01 | lr 1.313559e-05
05/14/2024 11:54:03 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10500/ 12000] | 2835/3832 batches | ms/batch 242.8903 | train_loss 6.037311e-01 | lr 1.271186e-05
05/14/2024 11:54:17 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10550/ 12000] | 2885/3832 batches | ms/batch 238.3037 | train_loss 6.033719e-01 | lr 1.228814e-05
05/14/2024 11:54:29 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10600/ 12000] | 2935/3832 batches | ms/batch 230.0952 | train_loss 6.041200e-01 | lr 1.186441e-05
05/14/2024 11:54:43 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10650/ 12000] | 2985/3832 batches | ms/batch 250.5086 | train_loss 6.044801e-01 | lr 1.144068e-05
05/14/2024 11:54:56 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10700/ 12000] | 3035/3832 batches | ms/batch 246.3387 | train_loss 6.042140e-01 | lr 1.101695e-05
05/14/2024 11:55:09 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10750/ 12000] | 3085/3832 batches | ms/batch 234.8735 | train_loss 6.037485e-01 | lr 1.059322e-05
05/14/2024 11:55:23 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10800/ 12000] | 3135/3832 batches | ms/batch 252.1485 | train_loss 6.050118e-01 | lr 1.016949e-05
05/14/2024 11:55:36 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10850/ 12000] | 3185/3832 batches | ms/batch 247.2000 | train_loss 6.049648e-01 | lr 9.745763e-06
05/14/2024 11:55:49 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10900/ 12000] | 3235/3832 batches | ms/batch 231.5563 | train_loss 6.032508e-01 | lr 9.322034e-06
05/14/2024 11:56:03 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10950/ 12000] | 3285/3832 batches | ms/batch 249.7991 | train_loss 6.027607e-01 | lr 8.898305e-06
05/14/2024 11:56:16 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11000/ 12000] | 3335/3832 batches | ms/batch 245.0916 | train_loss 6.032933e-01 | lr 8.474576e-06
05/14/2024 11:56:16 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp7vr37lzz at global_step 11000 ****
05/14/2024 11:56:17 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 11:56:29 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11050/ 12000] | 3385/3832 batches | ms/batch 233.0762 | train_loss 6.028337e-01 | lr 8.050847e-06
05/14/2024 11:56:43 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11100/ 12000] | 3435/3832 batches | ms/batch 243.0433 | train_loss 6.028284e-01 | lr 7.627119e-06
05/14/2024 11:56:56 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11150/ 12000] | 3485/3832 batches | ms/batch 245.8411 | train_loss 6.034896e-01 | lr 7.203390e-06
05/14/2024 11:57:09 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11200/ 12000] | 3535/3832 batches | ms/batch 241.6624 | train_loss 6.035764e-01 | lr 6.779661e-06
05/14/2024 11:57:23 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11250/ 12000] | 3585/3832 batches | ms/batch 248.7129 | train_loss 6.034051e-01 | lr 6.355932e-06
05/14/2024 11:57:36 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11300/ 12000] | 3635/3832 batches | ms/batch 247.3833 | train_loss 6.030378e-01 | lr 5.932203e-06
05/14/2024 11:57:49 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11350/ 12000] | 3685/3832 batches | ms/batch 234.5529 | train_loss 6.029821e-01 | lr 5.508475e-06
05/14/2024 11:58:02 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11400/ 12000] | 3735/3832 batches | ms/batch 247.1842 | train_loss 6.023878e-01 | lr 5.084746e-06
05/14/2024 11:58:16 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11450/ 12000] | 3785/3832 batches | ms/batch 249.3596 | train_loss 6.015152e-01 | lr 4.661017e-06
05/14/2024 11:58:36 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11500/ 12000] |    3/3832 batches | ms/batch 234.3397 | train_loss 6.022942e-01 | lr 4.237288e-06
05/14/2024 11:58:49 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11550/ 12000] |   53/3832 batches | ms/batch 233.0484 | train_loss 5.987038e-01 | lr 3.813559e-06
05/14/2024 11:59:02 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11600/ 12000] |  103/3832 batches | ms/batch 237.8257 | train_loss 5.988650e-01 | lr 3.389831e-06
05/14/2024 11:59:15 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11650/ 12000] |  153/3832 batches | ms/batch 247.3233 | train_loss 5.972412e-01 | lr 2.966102e-06
05/14/2024 11:59:28 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11700/ 12000] |  203/3832 batches | ms/batch 239.2378 | train_loss 5.981101e-01 | lr 2.542373e-06
05/14/2024 11:59:41 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11750/ 12000] |  253/3832 batches | ms/batch 238.3274 | train_loss 5.982915e-01 | lr 2.118644e-06
05/14/2024 11:59:55 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11800/ 12000] |  303/3832 batches | ms/batch 249.2872 | train_loss 5.979755e-01 | lr 1.694915e-06
05/14/2024 12:00:07 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11850/ 12000] |  353/3832 batches | ms/batch 230.9705 | train_loss 5.982288e-01 | lr 1.271186e-06
05/14/2024 12:00:20 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11900/ 12000] |  403/3832 batches | ms/batch 237.4408 | train_loss 5.987249e-01 | lr 8.474576e-07
05/14/2024 12:00:34 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11950/ 12000] |  453/3832 batches | ms/batch 249.8775 | train_loss 5.982696e-01 | lr 4.237288e-07
05/14/2024 12:00:47 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 12000/ 12000] |  503/3832 batches | ms/batch 235.3488 | train_loss 5.976114e-01 | lr 0.000000e+00
05/14/2024 12:00:47 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp7vr37lzz at global_step 12000 ****
05/14/2024 12:00:48 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 12:00:49 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23597246/tmp7vr37lzz
05/14/2024 12:00:51 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((490449, 32768)) with avr_nnz=80.0
05/14/2024 12:00:51 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
05/14/2024 12:07:32 - INFO - pecos.xmc.xtransformer.model - Constructed instance feature matrix with shape=(490449, 136677)
05/14/2024 12:08:11 - INFO - pecos.xmc.xtransformer.model - Hierarchical label tree for ranker: [8, 256, 8192, 670091]
05/14/2024 12:08:11 - INFO - pecos.xmc.xtransformer.model - Start training ranker...
05/14/2024 12:08:11 - INFO - pecos.xmc.base - Training Layer 0 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
05/14/2024 12:08:33 - INFO - pecos.xmc.base - Training Layer 1 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
05/14/2024 12:08:56 - INFO - pecos.xmc.base - Training Layer 2 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
05/14/2024 12:09:43 - INFO - pecos.xmc.base - Training Layer 3 of 4 Layers in HierarchicalMLModel, neg_mining=tfn+man..
05/14/2024 12:33:54 - INFO - pecos.xmc.xtransformer.model - Parameters saved to ./trained-models/amazon-670k/bert1/param.json
05/14/2024 12:34:13 - INFO - pecos.xmc.xtransformer.model - Model saved to ./trained-models/amazon-670k/bert1
--- start prediction of bert1 ---
--- start evaluation of bert1 ---
--- start training of bert2 ---
05/14/2024 12:43:35 - INFO - __main__ - Setting random seed 0
05/14/2024 12:43:37 - INFO - __main__ - Loaded training feature matrix with shape=(490449, 135909)
05/14/2024 12:43:38 - INFO - __main__ - Loaded training label matrix with shape=(490449, 670091)
05/14/2024 12:43:39 - INFO - __main__ - Loaded 490449 training sequences
05/14/2024 12:43:52 - INFO - pecos.xmc.xtransformer.model - Hierarchical label tree: [128, 2048, 32768, 670091]
05/14/2024 12:43:52 - INFO - pecos.xmc.xtransformer.model - Fine-tune Transformers with nr_labels=[128, 2048, 32768]
05/14/2024 12:43:52 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn+man at level 0, nr_labels=128, avr_M_nnz=128
05/14/2024 12:43:55 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-uncased model from s3.
05/14/2024 12:43:55 - INFO - pecos.xmc.xtransformer.matcher - ***** Encoding data len=490449 truncation=128*****
05/14/2024 12:44:29 - INFO - pecos.xmc.xtransformer.matcher - ***** Finished with time cost=33.72246050834656 *****
05/14/2024 12:44:52 - INFO - pecos.xmc.xtransformer.matcher - trn tensors saved to /scratch/slurm_tmpdir/job_23597246/tmpcn4b_eot/X_trn.pt
05/14/2024 12:44:52 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 4
05/14/2024 12:44:53 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
05/14/2024 12:44:53 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
/home/ul/ul_student/ul_ruw26/.local/lib/python3.9/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
05/14/2024 12:44:53 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
05/14/2024 12:44:53 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 490449
05/14/2024 12:44:53 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 128
05/14/2024 12:44:53 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 2
05/14/2024 12:44:53 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
05/14/2024 12:44:53 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 128
05/14/2024 12:44:53 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
05/14/2024 12:44:53 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
05/14/2024 12:45:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][    50/  4000] |   49/3832 batches | ms/batch 323.2592 | train_loss 9.056080e-01 | lr 2.500000e-05
05/14/2024 12:45:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   100/  4000] |   99/3832 batches | ms/batch 210.2242 | train_loss 2.153197e-01 | lr 5.000000e-05
05/14/2024 12:45:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   150/  4000] |  149/3832 batches | ms/batch 211.1162 | train_loss 1.715035e-01 | lr 7.500000e-05
05/14/2024 12:45:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   200/  4000] |  199/3832 batches | ms/batch 211.4614 | train_loss 1.518585e-01 | lr 1.000000e-04
05/14/2024 12:46:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   250/  4000] |  249/3832 batches | ms/batch 212.4041 | train_loss 1.250426e-01 | lr 9.868421e-05
05/14/2024 12:46:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   300/  4000] |  299/3832 batches | ms/batch 215.7776 | train_loss 1.073247e-01 | lr 9.736842e-05
05/14/2024 12:46:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   350/  4000] |  349/3832 batches | ms/batch 214.3170 | train_loss 9.640998e-02 | lr 9.605263e-05
05/14/2024 12:46:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   400/  4000] |  399/3832 batches | ms/batch 213.8928 | train_loss 8.808321e-02 | lr 9.473684e-05
05/14/2024 12:46:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   450/  4000] |  449/3832 batches | ms/batch 214.6092 | train_loss 8.563083e-02 | lr 9.342105e-05
05/14/2024 12:46:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   500/  4000] |  499/3832 batches | ms/batch 214.1648 | train_loss 8.248381e-02 | lr 9.210526e-05
05/14/2024 12:47:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   550/  4000] |  549/3832 batches | ms/batch 215.7749 | train_loss 8.102963e-02 | lr 9.078947e-05
05/14/2024 12:47:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   600/  4000] |  599/3832 batches | ms/batch 214.6923 | train_loss 7.888786e-02 | lr 8.947368e-05
05/14/2024 12:47:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   650/  4000] |  649/3832 batches | ms/batch 214.8287 | train_loss 7.787988e-02 | lr 8.815789e-05
05/14/2024 12:47:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   700/  4000] |  699/3832 batches | ms/batch 214.0311 | train_loss 7.627527e-02 | lr 8.684211e-05
05/14/2024 12:47:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   750/  4000] |  749/3832 batches | ms/batch 216.0604 | train_loss 7.369401e-02 | lr 8.552632e-05
05/14/2024 12:48:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   800/  4000] |  799/3832 batches | ms/batch 214.7001 | train_loss 7.479819e-02 | lr 8.421053e-05
05/14/2024 12:48:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   850/  4000] |  849/3832 batches | ms/batch 215.2770 | train_loss 7.312245e-02 | lr 8.289474e-05
05/14/2024 12:48:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   900/  4000] |  899/3832 batches | ms/batch 213.8015 | train_loss 7.220064e-02 | lr 8.157895e-05
05/14/2024 12:48:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   950/  4000] |  949/3832 batches | ms/batch 215.2327 | train_loss 7.202152e-02 | lr 8.026316e-05
05/14/2024 12:48:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1000/  4000] |  999/3832 batches | ms/batch 215.2769 | train_loss 7.157576e-02 | lr 7.894737e-05
05/14/2024 12:48:55 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmpltghqc8c at global_step 1000 ****
05/14/2024 12:48:55 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 12:49:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1050/  4000] | 1049/3832 batches | ms/batch 214.7659 | train_loss 7.053187e-02 | lr 7.763158e-05
05/14/2024 12:49:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1100/  4000] | 1099/3832 batches | ms/batch 214.8083 | train_loss 7.017879e-02 | lr 7.631579e-05
05/14/2024 12:49:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1150/  4000] | 1149/3832 batches | ms/batch 214.6192 | train_loss 6.921085e-02 | lr 7.500000e-05
05/14/2024 12:49:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1200/  4000] | 1199/3832 batches | ms/batch 214.8078 | train_loss 6.921652e-02 | lr 7.368421e-05
05/14/2024 12:49:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1250/  4000] | 1249/3832 batches | ms/batch 215.5177 | train_loss 6.949834e-02 | lr 7.236842e-05
05/14/2024 12:50:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1300/  4000] | 1299/3832 batches | ms/batch 215.2006 | train_loss 6.849272e-02 | lr 7.105263e-05
05/14/2024 12:50:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1350/  4000] | 1349/3832 batches | ms/batch 214.9737 | train_loss 6.897515e-02 | lr 6.973684e-05
05/14/2024 12:50:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1400/  4000] | 1399/3832 batches | ms/batch 215.3444 | train_loss 6.773655e-02 | lr 6.842105e-05
05/14/2024 12:50:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1450/  4000] | 1449/3832 batches | ms/batch 215.8510 | train_loss 6.626625e-02 | lr 6.710526e-05
05/14/2024 12:50:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1500/  4000] | 1499/3832 batches | ms/batch 215.2288 | train_loss 6.724151e-02 | lr 6.578947e-05
05/14/2024 12:51:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1550/  4000] | 1549/3832 batches | ms/batch 216.0784 | train_loss 6.701447e-02 | lr 6.447368e-05
05/14/2024 12:51:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1600/  4000] | 1599/3832 batches | ms/batch 214.5935 | train_loss 6.499928e-02 | lr 6.315789e-05
05/14/2024 12:51:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1650/  4000] | 1649/3832 batches | ms/batch 215.5400 | train_loss 6.699777e-02 | lr 6.184211e-05
05/14/2024 12:51:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1700/  4000] | 1699/3832 batches | ms/batch 214.7898 | train_loss 6.813705e-02 | lr 6.052632e-05
05/14/2024 12:51:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1750/  4000] | 1749/3832 batches | ms/batch 214.7257 | train_loss 6.626626e-02 | lr 5.921053e-05
05/14/2024 12:52:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1800/  4000] | 1799/3832 batches | ms/batch 215.3314 | train_loss 6.406681e-02 | lr 5.789474e-05
05/14/2024 12:52:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1850/  4000] | 1849/3832 batches | ms/batch 216.2651 | train_loss 6.559678e-02 | lr 5.657895e-05
05/14/2024 12:52:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1900/  4000] | 1899/3832 batches | ms/batch 214.9115 | train_loss 6.527390e-02 | lr 5.526316e-05
05/14/2024 12:52:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1950/  4000] | 1949/3832 batches | ms/batch 214.1369 | train_loss 6.524331e-02 | lr 5.394737e-05
05/14/2024 12:52:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2000/  4000] | 1999/3832 batches | ms/batch 214.8956 | train_loss 6.468510e-02 | lr 5.263158e-05
05/14/2024 12:52:48 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmpltghqc8c at global_step 2000 ****
05/14/2024 12:52:48 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 12:53:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2050/  4000] | 2049/3832 batches | ms/batch 215.1362 | train_loss 6.561068e-02 | lr 5.131579e-05
05/14/2024 12:53:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2100/  4000] | 2099/3832 batches | ms/batch 215.1407 | train_loss 6.494944e-02 | lr 5.000000e-05
05/14/2024 12:53:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2150/  4000] | 2149/3832 batches | ms/batch 214.5803 | train_loss 6.506496e-02 | lr 4.868421e-05
05/14/2024 12:53:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2200/  4000] | 2199/3832 batches | ms/batch 214.5985 | train_loss 6.382352e-02 | lr 4.736842e-05
05/14/2024 12:53:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2250/  4000] | 2249/3832 batches | ms/batch 214.9860 | train_loss 6.386649e-02 | lr 4.605263e-05
05/14/2024 12:53:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2300/  4000] | 2299/3832 batches | ms/batch 215.0785 | train_loss 6.348427e-02 | lr 4.473684e-05
05/14/2024 12:54:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2350/  4000] | 2349/3832 batches | ms/batch 215.1264 | train_loss 6.364129e-02 | lr 4.342105e-05
05/14/2024 12:54:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2400/  4000] | 2399/3832 batches | ms/batch 215.2527 | train_loss 6.330467e-02 | lr 4.210526e-05
05/14/2024 12:54:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2450/  4000] | 2449/3832 batches | ms/batch 214.4730 | train_loss 6.209477e-02 | lr 4.078947e-05
05/14/2024 12:54:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2500/  4000] | 2499/3832 batches | ms/batch 215.6757 | train_loss 6.287732e-02 | lr 3.947368e-05
05/14/2024 12:54:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2550/  4000] | 2549/3832 batches | ms/batch 215.6804 | train_loss 6.295679e-02 | lr 3.815789e-05
05/14/2024 12:55:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2600/  4000] | 2599/3832 batches | ms/batch 214.5587 | train_loss 6.193645e-02 | lr 3.684211e-05
05/14/2024 12:55:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2650/  4000] | 2649/3832 batches | ms/batch 212.9744 | train_loss 6.297095e-02 | lr 3.552632e-05
05/14/2024 12:55:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2700/  4000] | 2699/3832 batches | ms/batch 213.5204 | train_loss 6.346660e-02 | lr 3.421053e-05
05/14/2024 12:55:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2750/  4000] | 2749/3832 batches | ms/batch 215.9674 | train_loss 6.235540e-02 | lr 3.289474e-05
05/14/2024 12:55:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2800/  4000] | 2799/3832 batches | ms/batch 215.1423 | train_loss 6.173690e-02 | lr 3.157895e-05
05/14/2024 12:56:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2850/  4000] | 2849/3832 batches | ms/batch 215.5546 | train_loss 6.220741e-02 | lr 3.026316e-05
05/14/2024 12:56:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2900/  4000] | 2899/3832 batches | ms/batch 214.9582 | train_loss 6.278707e-02 | lr 2.894737e-05
05/14/2024 12:56:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2950/  4000] | 2949/3832 batches | ms/batch 215.6640 | train_loss 6.112769e-02 | lr 2.763158e-05
05/14/2024 12:56:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3000/  4000] | 2999/3832 batches | ms/batch 215.2795 | train_loss 6.096318e-02 | lr 2.631579e-05
05/14/2024 12:56:41 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmpltghqc8c at global_step 3000 ****
05/14/2024 12:56:41 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 12:56:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3050/  4000] | 3049/3832 batches | ms/batch 215.7715 | train_loss 6.104711e-02 | lr 2.500000e-05
05/14/2024 12:57:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3100/  4000] | 3099/3832 batches | ms/batch 215.9909 | train_loss 6.103571e-02 | lr 2.368421e-05
05/14/2024 12:57:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3150/  4000] | 3149/3832 batches | ms/batch 215.6636 | train_loss 6.094436e-02 | lr 2.236842e-05
05/14/2024 12:57:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3200/  4000] | 3199/3832 batches | ms/batch 216.0881 | train_loss 6.200737e-02 | lr 2.105263e-05
05/14/2024 12:57:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3250/  4000] | 3249/3832 batches | ms/batch 214.3932 | train_loss 6.106402e-02 | lr 1.973684e-05
05/14/2024 12:57:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3300/  4000] | 3299/3832 batches | ms/batch 214.1076 | train_loss 5.998858e-02 | lr 1.842105e-05
05/14/2024 12:58:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3350/  4000] | 3349/3832 batches | ms/batch 216.7291 | train_loss 6.106998e-02 | lr 1.710526e-05
05/14/2024 12:58:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3400/  4000] | 3399/3832 batches | ms/batch 216.2277 | train_loss 5.954767e-02 | lr 1.578947e-05
05/14/2024 12:58:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3450/  4000] | 3449/3832 batches | ms/batch 215.3427 | train_loss 6.082640e-02 | lr 1.447368e-05
05/14/2024 12:58:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3500/  4000] | 3499/3832 batches | ms/batch 215.4773 | train_loss 6.099381e-02 | lr 1.315789e-05
05/14/2024 12:58:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3550/  4000] | 3549/3832 batches | ms/batch 214.7713 | train_loss 6.032867e-02 | lr 1.184211e-05
05/14/2024 12:59:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3600/  4000] | 3599/3832 batches | ms/batch 216.1797 | train_loss 5.914779e-02 | lr 1.052632e-05
05/14/2024 12:59:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3650/  4000] | 3649/3832 batches | ms/batch 215.3873 | train_loss 5.996813e-02 | lr 9.210526e-06
05/14/2024 12:59:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3700/  4000] | 3699/3832 batches | ms/batch 215.0414 | train_loss 6.032744e-02 | lr 7.894737e-06
05/14/2024 12:59:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3750/  4000] | 3749/3832 batches | ms/batch 214.9471 | train_loss 5.914777e-02 | lr 6.578947e-06
05/14/2024 12:59:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3800/  4000] | 3799/3832 batches | ms/batch 216.8952 | train_loss 6.005874e-02 | lr 5.263158e-06
05/14/2024 13:00:03 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  3850/  4000] |   17/3832 batches | ms/batch 214.2315 | train_loss 5.863140e-02 | lr 3.947368e-06
05/14/2024 13:00:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  3900/  4000] |   67/3832 batches | ms/batch 214.7071 | train_loss 5.449270e-02 | lr 2.631579e-06
05/14/2024 13:00:27 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  3950/  4000] |  117/3832 batches | ms/batch 215.0723 | train_loss 5.456559e-02 | lr 1.315789e-06
05/14/2024 13:00:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  4000/  4000] |  167/3832 batches | ms/batch 216.7869 | train_loss 5.489357e-02 | lr 0.000000e+00
05/14/2024 13:00:38 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmpltghqc8c at global_step 4000 ****
05/14/2024 13:00:39 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 13:00:40 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23597246/tmpltghqc8c
05/14/2024 13:00:40 - INFO - pecos.xmc.xtransformer.matcher - Predict on input text tensors(torch.Size([490449, 128])) in OVA mode
05/14/2024 13:00:40 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
05/14/2024 13:07:03 - INFO - pecos.xmc.xtransformer.matcher - Concatenating instance embeddings with features...
05/14/2024 13:07:13 - INFO - pecos.xmc.xtransformer.matcher - Start training concat_model of transformer matcher...
05/14/2024 13:08:20 - INFO - pecos.xmc.xtransformer.matcher - Using concat-only for transformer/concat ensemble of pred_csr
05/14/2024 13:08:35 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn+man at level 1, nr_labels=2048, avr_M_nnz=5.100246916600911
05/14/2024 13:08:36 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-uncased model from s3.
05/14/2024 13:09:07 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23597246/tmpcn4b_eot/X_trn.pt
05/14/2024 13:09:07 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
05/14/2024 13:11:20 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
05/14/2024 13:11:20 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 4
05/14/2024 13:11:20 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
05/14/2024 13:11:20 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
/home/ul/ul_student/ul_ruw26/.local/lib/python3.9/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
05/14/2024 13:11:38 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
05/14/2024 13:11:38 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 490449
05/14/2024 13:11:38 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 2048
05/14/2024 13:11:38 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 176
05/14/2024 13:11:38 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 2
05/14/2024 13:11:38 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
05/14/2024 13:11:38 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 128
05/14/2024 13:11:38 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
05/14/2024 13:11:38 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
05/14/2024 13:12:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][    50/  4000] |   49/3832 batches | ms/batch 277.1809 | train_loss 8.467348e-01 | lr 2.500000e-05
05/14/2024 13:12:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   100/  4000] |   99/3832 batches | ms/batch 273.9055 | train_loss 7.116890e-01 | lr 5.000000e-05
05/14/2024 13:12:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   150/  4000] |  149/3832 batches | ms/batch 259.1530 | train_loss 6.802500e-01 | lr 7.500000e-05
05/14/2024 13:12:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   200/  4000] |  199/3832 batches | ms/batch 266.6745 | train_loss 6.693148e-01 | lr 1.000000e-04
05/14/2024 13:12:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   250/  4000] |  249/3832 batches | ms/batch 271.7063 | train_loss 6.598519e-01 | lr 9.868421e-05
05/14/2024 13:13:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   300/  4000] |  299/3832 batches | ms/batch 278.6613 | train_loss 6.547082e-01 | lr 9.736842e-05
05/14/2024 13:13:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   350/  4000] |  349/3832 batches | ms/batch 271.7257 | train_loss 6.508025e-01 | lr 9.605263e-05
05/14/2024 13:13:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   400/  4000] |  399/3832 batches | ms/batch 254.0116 | train_loss 6.483834e-01 | lr 9.473684e-05
05/14/2024 13:13:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   450/  4000] |  449/3832 batches | ms/batch 239.4381 | train_loss 6.436644e-01 | lr 9.342105e-05
05/14/2024 13:14:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   500/  4000] |  499/3832 batches | ms/batch 244.8562 | train_loss 6.425169e-01 | lr 9.210526e-05
05/14/2024 13:14:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   550/  4000] |  549/3832 batches | ms/batch 249.0954 | train_loss 6.408011e-01 | lr 9.078947e-05
05/14/2024 13:14:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   600/  4000] |  599/3832 batches | ms/batch 247.5160 | train_loss 6.392032e-01 | lr 8.947368e-05
05/14/2024 13:14:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   650/  4000] |  649/3832 batches | ms/batch 239.9292 | train_loss 6.387928e-01 | lr 8.815789e-05
05/14/2024 13:15:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   700/  4000] |  699/3832 batches | ms/batch 241.0119 | train_loss 6.370661e-01 | lr 8.684211e-05
05/14/2024 13:15:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   750/  4000] |  749/3832 batches | ms/batch 238.2943 | train_loss 6.352832e-01 | lr 8.552632e-05
05/14/2024 13:15:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   800/  4000] |  799/3832 batches | ms/batch 241.9841 | train_loss 6.329547e-01 | lr 8.421053e-05
05/14/2024 13:15:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   850/  4000] |  849/3832 batches | ms/batch 256.4236 | train_loss 6.319487e-01 | lr 8.289474e-05
05/14/2024 13:15:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   900/  4000] |  899/3832 batches | ms/batch 238.0485 | train_loss 6.315301e-01 | lr 8.157895e-05
05/14/2024 13:16:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   950/  4000] |  949/3832 batches | ms/batch 240.3879 | train_loss 6.318792e-01 | lr 8.026316e-05
05/14/2024 13:16:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1000/  4000] |  999/3832 batches | ms/batch 246.2927 | train_loss 6.307872e-01 | lr 7.894737e-05
05/14/2024 13:16:21 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp1trxy53t at global_step 1000 ****
05/14/2024 13:16:22 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 13:16:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1050/  4000] | 1049/3832 batches | ms/batch 237.6234 | train_loss 6.291683e-01 | lr 7.763158e-05
05/14/2024 13:16:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1100/  4000] | 1099/3832 batches | ms/batch 243.7768 | train_loss 6.284527e-01 | lr 7.631579e-05
05/14/2024 13:17:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1150/  4000] | 1149/3832 batches | ms/batch 245.8425 | train_loss 6.285080e-01 | lr 7.500000e-05
05/14/2024 13:17:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1200/  4000] | 1199/3832 batches | ms/batch 252.0336 | train_loss 6.283178e-01 | lr 7.368421e-05
05/14/2024 13:17:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1250/  4000] | 1249/3832 batches | ms/batch 243.6893 | train_loss 6.270477e-01 | lr 7.236842e-05
05/14/2024 13:17:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1300/  4000] | 1299/3832 batches | ms/batch 257.2269 | train_loss 6.270537e-01 | lr 7.105263e-05
05/14/2024 13:17:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1350/  4000] | 1349/3832 batches | ms/batch 256.0585 | train_loss 6.275831e-01 | lr 6.973684e-05
05/14/2024 13:18:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1400/  4000] | 1399/3832 batches | ms/batch 249.7251 | train_loss 6.251237e-01 | lr 6.842105e-05
05/14/2024 13:18:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1450/  4000] | 1449/3832 batches | ms/batch 247.0902 | train_loss 6.253106e-01 | lr 6.710526e-05
05/14/2024 13:18:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1500/  4000] | 1499/3832 batches | ms/batch 243.7377 | train_loss 6.262648e-01 | lr 6.578947e-05
05/14/2024 13:18:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1550/  4000] | 1549/3832 batches | ms/batch 244.2216 | train_loss 6.245434e-01 | lr 6.447368e-05
05/14/2024 13:19:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1600/  4000] | 1599/3832 batches | ms/batch 242.1577 | train_loss 6.238673e-01 | lr 6.315789e-05
05/14/2024 13:19:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1650/  4000] | 1649/3832 batches | ms/batch 243.2269 | train_loss 6.239406e-01 | lr 6.184211e-05
05/14/2024 13:19:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1700/  4000] | 1699/3832 batches | ms/batch 228.8102 | train_loss 6.243086e-01 | lr 6.052632e-05
05/14/2024 13:19:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1750/  4000] | 1749/3832 batches | ms/batch 247.8368 | train_loss 6.231782e-01 | lr 5.921053e-05
05/14/2024 13:19:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1800/  4000] | 1799/3832 batches | ms/batch 242.1977 | train_loss 6.223165e-01 | lr 5.789474e-05
05/14/2024 13:20:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1850/  4000] | 1849/3832 batches | ms/batch 239.9231 | train_loss 6.218495e-01 | lr 5.657895e-05
05/14/2024 13:20:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1900/  4000] | 1899/3832 batches | ms/batch 241.1673 | train_loss 6.214839e-01 | lr 5.526316e-05
05/14/2024 13:20:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1950/  4000] | 1949/3832 batches | ms/batch 248.4545 | train_loss 6.210539e-01 | lr 5.394737e-05
05/14/2024 13:20:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2000/  4000] | 1999/3832 batches | ms/batch 238.6187 | train_loss 6.211144e-01 | lr 5.263158e-05
05/14/2024 13:20:48 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp1trxy53t at global_step 2000 ****
05/14/2024 13:20:48 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 13:21:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2050/  4000] | 2049/3832 batches | ms/batch 253.6450 | train_loss 6.205085e-01 | lr 5.131579e-05
05/14/2024 13:21:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2100/  4000] | 2099/3832 batches | ms/batch 241.2597 | train_loss 6.213416e-01 | lr 5.000000e-05
05/14/2024 13:21:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2150/  4000] | 2149/3832 batches | ms/batch 240.4075 | train_loss 6.207358e-01 | lr 4.868421e-05
05/14/2024 13:21:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2200/  4000] | 2199/3832 batches | ms/batch 237.3454 | train_loss 6.207440e-01 | lr 4.736842e-05
05/14/2024 13:21:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2250/  4000] | 2249/3832 batches | ms/batch 260.6273 | train_loss 6.195394e-01 | lr 4.605263e-05
05/14/2024 13:22:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2300/  4000] | 2299/3832 batches | ms/batch 235.4834 | train_loss 6.202170e-01 | lr 4.473684e-05
05/14/2024 13:22:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2350/  4000] | 2349/3832 batches | ms/batch 233.0676 | train_loss 6.193860e-01 | lr 4.342105e-05
05/14/2024 13:22:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2400/  4000] | 2399/3832 batches | ms/batch 249.5444 | train_loss 6.187873e-01 | lr 4.210526e-05
05/14/2024 13:22:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2450/  4000] | 2449/3832 batches | ms/batch 234.4926 | train_loss 6.195972e-01 | lr 4.078947e-05
05/14/2024 13:23:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2500/  4000] | 2499/3832 batches | ms/batch 232.9740 | train_loss 6.184480e-01 | lr 3.947368e-05
05/14/2024 13:23:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2550/  4000] | 2549/3832 batches | ms/batch 250.3465 | train_loss 6.167945e-01 | lr 3.815789e-05
05/14/2024 13:23:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2600/  4000] | 2599/3832 batches | ms/batch 236.1229 | train_loss 6.178434e-01 | lr 3.684211e-05
05/14/2024 13:23:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2650/  4000] | 2649/3832 batches | ms/batch 243.6139 | train_loss 6.172148e-01 | lr 3.552632e-05
05/14/2024 13:23:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2700/  4000] | 2699/3832 batches | ms/batch 249.9024 | train_loss 6.174200e-01 | lr 3.421053e-05
05/14/2024 13:24:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2750/  4000] | 2749/3832 batches | ms/batch 240.9792 | train_loss 6.172436e-01 | lr 3.289474e-05
05/14/2024 13:24:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2800/  4000] | 2799/3832 batches | ms/batch 249.2002 | train_loss 6.183549e-01 | lr 3.157895e-05
05/14/2024 13:24:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2850/  4000] | 2849/3832 batches | ms/batch 253.3411 | train_loss 6.181329e-01 | lr 3.026316e-05
05/14/2024 13:24:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2900/  4000] | 2899/3832 batches | ms/batch 238.4053 | train_loss 6.155530e-01 | lr 2.894737e-05
05/14/2024 13:24:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2950/  4000] | 2949/3832 batches | ms/batch 235.2364 | train_loss 6.159571e-01 | lr 2.763158e-05
05/14/2024 13:25:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3000/  4000] | 2999/3832 batches | ms/batch 246.0014 | train_loss 6.159870e-01 | lr 2.631579e-05
05/14/2024 13:25:12 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp1trxy53t at global_step 3000 ****
05/14/2024 13:25:13 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 13:25:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3050/  4000] | 3049/3832 batches | ms/batch 238.0812 | train_loss 6.169083e-01 | lr 2.500000e-05
05/14/2024 13:25:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3100/  4000] | 3099/3832 batches | ms/batch 244.9329 | train_loss 6.153114e-01 | lr 2.368421e-05
05/14/2024 13:25:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3150/  4000] | 3149/3832 batches | ms/batch 240.9772 | train_loss 6.157634e-01 | lr 2.236842e-05
05/14/2024 13:26:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3200/  4000] | 3199/3832 batches | ms/batch 244.7156 | train_loss 6.150347e-01 | lr 2.105263e-05
05/14/2024 13:26:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3250/  4000] | 3249/3832 batches | ms/batch 237.9082 | train_loss 6.155760e-01 | lr 1.973684e-05
05/14/2024 13:26:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3300/  4000] | 3299/3832 batches | ms/batch 246.8239 | train_loss 6.151106e-01 | lr 1.842105e-05
05/14/2024 13:26:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3350/  4000] | 3349/3832 batches | ms/batch 240.7177 | train_loss 6.154406e-01 | lr 1.710526e-05
05/14/2024 13:26:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3400/  4000] | 3399/3832 batches | ms/batch 234.4380 | train_loss 6.158235e-01 | lr 1.578947e-05
05/14/2024 13:27:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3450/  4000] | 3449/3832 batches | ms/batch 242.3457 | train_loss 6.157730e-01 | lr 1.447368e-05
05/14/2024 13:27:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3500/  4000] | 3499/3832 batches | ms/batch 250.2428 | train_loss 6.131009e-01 | lr 1.315789e-05
05/14/2024 13:27:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3550/  4000] | 3549/3832 batches | ms/batch 236.3091 | train_loss 6.149396e-01 | lr 1.184211e-05
05/14/2024 13:27:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3600/  4000] | 3599/3832 batches | ms/batch 232.1808 | train_loss 6.136428e-01 | lr 1.052632e-05
05/14/2024 13:28:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3650/  4000] | 3649/3832 batches | ms/batch 235.4329 | train_loss 6.136234e-01 | lr 9.210526e-06
05/14/2024 13:28:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3700/  4000] | 3699/3832 batches | ms/batch 236.2372 | train_loss 6.139493e-01 | lr 7.894737e-06
05/14/2024 13:28:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3750/  4000] | 3749/3832 batches | ms/batch 240.2202 | train_loss 6.131531e-01 | lr 6.578947e-06
05/14/2024 13:28:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3800/  4000] | 3799/3832 batches | ms/batch 248.5726 | train_loss 6.145506e-01 | lr 5.263158e-06
05/14/2024 13:29:03 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  3850/  4000] |   17/3832 batches | ms/batch 252.2032 | train_loss 6.113353e-01 | lr 3.947368e-06
05/14/2024 13:29:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  3900/  4000] |   67/3832 batches | ms/batch 250.2474 | train_loss 6.101633e-01 | lr 2.631579e-06
05/14/2024 13:29:31 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  3950/  4000] |  117/3832 batches | ms/batch 254.2468 | train_loss 6.088012e-01 | lr 1.315789e-06
05/14/2024 13:29:45 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  4000/  4000] |  167/3832 batches | ms/batch 258.2885 | train_loss 6.086944e-01 | lr 0.000000e+00
05/14/2024 13:29:45 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp1trxy53t at global_step 4000 ****
05/14/2024 13:29:45 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 13:29:46 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23597246/tmp1trxy53t
05/14/2024 13:29:47 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((490449, 2048)) with avr_nnz=80.0
05/14/2024 13:29:47 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
05/14/2024 13:36:17 - INFO - pecos.xmc.xtransformer.matcher - Concatenating instance embeddings with features...
05/14/2024 13:36:27 - INFO - pecos.xmc.xtransformer.matcher - Start training concat_model of transformer matcher...
05/14/2024 13:37:29 - INFO - pecos.xmc.xtransformer.matcher - Using concat-only for transformer/concat ensemble of pred_csr
05/14/2024 13:37:39 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn+man at level 2, nr_labels=32768, avr_M_nnz=5.203519632010668
05/14/2024 13:37:41 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-uncased model from s3.
05/14/2024 13:38:09 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23597246/tmpcn4b_eot/X_trn.pt
05/14/2024 13:38:09 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
05/14/2024 13:38:58 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
05/14/2024 13:38:58 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 4
05/14/2024 13:38:58 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
05/14/2024 13:38:58 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
/home/ul/ul_student/ul_ruw26/.local/lib/python3.9/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
05/14/2024 13:39:16 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
05/14/2024 13:39:16 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 490449
05/14/2024 13:39:16 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 32768
05/14/2024 13:39:16 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 192
05/14/2024 13:39:16 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 4
05/14/2024 13:39:16 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
05/14/2024 13:39:16 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 128
05/14/2024 13:39:16 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
05/14/2024 13:39:16 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 12000
05/14/2024 13:39:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][    50/ 12000] |   49/3832 batches | ms/batch 255.1044 | train_loss 6.587382e-01 | lr 2.500000e-05
05/14/2024 13:39:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   100/ 12000] |   99/3832 batches | ms/batch 234.8915 | train_loss 6.571603e-01 | lr 5.000000e-05
05/14/2024 13:40:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   150/ 12000] |  149/3832 batches | ms/batch 251.1987 | train_loss 6.611415e-01 | lr 7.500000e-05
05/14/2024 13:40:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   200/ 12000] |  199/3832 batches | ms/batch 249.5850 | train_loss 6.694896e-01 | lr 1.000000e-04
05/14/2024 13:40:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   250/ 12000] |  249/3832 batches | ms/batch 259.9871 | train_loss 6.739518e-01 | lr 9.957627e-05
05/14/2024 13:40:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   300/ 12000] |  299/3832 batches | ms/batch 252.1225 | train_loss 6.718062e-01 | lr 9.915254e-05
05/14/2024 13:40:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   350/ 12000] |  349/3832 batches | ms/batch 228.2501 | train_loss 6.683627e-01 | lr 9.872881e-05
05/14/2024 13:41:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   400/ 12000] |  399/3832 batches | ms/batch 271.0595 | train_loss 6.681309e-01 | lr 9.830508e-05
05/14/2024 13:41:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   450/ 12000] |  449/3832 batches | ms/batch 242.3053 | train_loss 6.675062e-01 | lr 9.788136e-05
05/14/2024 13:41:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   500/ 12000] |  499/3832 batches | ms/batch 247.5055 | train_loss 6.686512e-01 | lr 9.745763e-05
05/14/2024 13:41:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   550/ 12000] |  549/3832 batches | ms/batch 243.6702 | train_loss 6.708144e-01 | lr 9.703390e-05
05/14/2024 13:42:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   600/ 12000] |  599/3832 batches | ms/batch 239.8911 | train_loss 6.696026e-01 | lr 9.661017e-05
05/14/2024 13:42:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   650/ 12000] |  649/3832 batches | ms/batch 233.1258 | train_loss 6.640884e-01 | lr 9.618644e-05
05/14/2024 13:42:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   700/ 12000] |  699/3832 batches | ms/batch 246.7204 | train_loss 6.662639e-01 | lr 9.576271e-05
05/14/2024 13:42:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   750/ 12000] |  749/3832 batches | ms/batch 238.3085 | train_loss 6.668372e-01 | lr 9.533898e-05
05/14/2024 13:42:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   800/ 12000] |  799/3832 batches | ms/batch 233.7906 | train_loss 6.621027e-01 | lr 9.491525e-05
05/14/2024 13:43:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   850/ 12000] |  849/3832 batches | ms/batch 224.9208 | train_loss 6.643284e-01 | lr 9.449153e-05
05/14/2024 13:43:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   900/ 12000] |  899/3832 batches | ms/batch 229.8912 | train_loss 6.610350e-01 | lr 9.406780e-05
05/14/2024 13:43:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   950/ 12000] |  949/3832 batches | ms/batch 224.8864 | train_loss 6.607369e-01 | lr 9.364407e-05
05/14/2024 13:43:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1000/ 12000] |  999/3832 batches | ms/batch 218.1198 | train_loss 6.612311e-01 | lr 9.322034e-05
05/14/2024 13:43:48 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp4mms48cc at global_step 1000 ****
05/14/2024 13:43:50 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 13:44:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1050/ 12000] | 1049/3832 batches | ms/batch 235.1431 | train_loss 6.595293e-01 | lr 9.279661e-05
05/14/2024 13:44:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1100/ 12000] | 1099/3832 batches | ms/batch 246.4690 | train_loss 6.582603e-01 | lr 9.237288e-05
05/14/2024 13:44:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1150/ 12000] | 1149/3832 batches | ms/batch 229.0027 | train_loss 6.598063e-01 | lr 9.194915e-05
05/14/2024 13:44:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1200/ 12000] | 1199/3832 batches | ms/batch 240.0003 | train_loss 6.586613e-01 | lr 9.152542e-05
05/14/2024 13:44:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1250/ 12000] | 1249/3832 batches | ms/batch 235.8332 | train_loss 6.602994e-01 | lr 9.110169e-05
05/14/2024 13:45:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1300/ 12000] | 1299/3832 batches | ms/batch 232.6466 | train_loss 6.602062e-01 | lr 9.067797e-05
05/14/2024 13:45:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1350/ 12000] | 1349/3832 batches | ms/batch 235.9867 | train_loss 6.552721e-01 | lr 9.025424e-05
05/14/2024 13:45:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1400/ 12000] | 1399/3832 batches | ms/batch 233.8273 | train_loss 6.568267e-01 | lr 8.983051e-05
05/14/2024 13:45:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1450/ 12000] | 1449/3832 batches | ms/batch 249.0563 | train_loss 6.579547e-01 | lr 8.940678e-05
05/14/2024 13:46:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1500/ 12000] | 1499/3832 batches | ms/batch 237.1521 | train_loss 6.566291e-01 | lr 8.898305e-05
05/14/2024 13:46:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1550/ 12000] | 1549/3832 batches | ms/batch 261.4013 | train_loss 6.602826e-01 | lr 8.855932e-05
05/14/2024 13:46:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1600/ 12000] | 1599/3832 batches | ms/batch 237.9741 | train_loss 6.547399e-01 | lr 8.813559e-05
05/14/2024 13:46:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1650/ 12000] | 1649/3832 batches | ms/batch 235.8611 | train_loss 6.534411e-01 | lr 8.771186e-05
05/14/2024 13:46:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1700/ 12000] | 1699/3832 batches | ms/batch 237.4698 | train_loss 6.551509e-01 | lr 8.728814e-05
05/14/2024 13:47:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1750/ 12000] | 1749/3832 batches | ms/batch 228.5880 | train_loss 6.530901e-01 | lr 8.686441e-05
05/14/2024 13:47:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1800/ 12000] | 1799/3832 batches | ms/batch 229.5451 | train_loss 6.530053e-01 | lr 8.644068e-05
05/14/2024 13:47:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1850/ 12000] | 1849/3832 batches | ms/batch 234.7114 | train_loss 6.521837e-01 | lr 8.601695e-05
05/14/2024 13:47:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1900/ 12000] | 1899/3832 batches | ms/batch 237.9998 | train_loss 6.520624e-01 | lr 8.559322e-05
05/14/2024 13:47:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1950/ 12000] | 1949/3832 batches | ms/batch 228.7052 | train_loss 6.525349e-01 | lr 8.516949e-05
05/14/2024 13:48:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2000/ 12000] | 1999/3832 batches | ms/batch 235.1631 | train_loss 6.540748e-01 | lr 8.474576e-05
05/14/2024 13:48:10 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp4mms48cc at global_step 2000 ****
05/14/2024 13:48:10 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 13:48:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2050/ 12000] | 2049/3832 batches | ms/batch 246.9872 | train_loss 6.517208e-01 | lr 8.432203e-05
05/14/2024 13:48:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2100/ 12000] | 2099/3832 batches | ms/batch 225.8807 | train_loss 6.532949e-01 | lr 8.389831e-05
05/14/2024 13:48:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2150/ 12000] | 2149/3832 batches | ms/batch 297.7971 | train_loss 6.485591e-01 | lr 8.347458e-05
05/14/2024 13:49:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2200/ 12000] | 2199/3832 batches | ms/batch 245.1811 | train_loss 6.470675e-01 | lr 8.305085e-05
05/14/2024 13:49:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2250/ 12000] | 2249/3832 batches | ms/batch 232.1718 | train_loss 6.495236e-01 | lr 8.262712e-05
05/14/2024 13:49:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2300/ 12000] | 2299/3832 batches | ms/batch 247.2906 | train_loss 6.499096e-01 | lr 8.220339e-05
05/14/2024 13:49:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2350/ 12000] | 2349/3832 batches | ms/batch 247.0228 | train_loss 6.483645e-01 | lr 8.177966e-05
05/14/2024 13:49:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2400/ 12000] | 2399/3832 batches | ms/batch 233.9927 | train_loss 6.485582e-01 | lr 8.135593e-05
05/14/2024 13:50:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2450/ 12000] | 2449/3832 batches | ms/batch 242.2895 | train_loss 6.482943e-01 | lr 8.093220e-05
05/14/2024 13:50:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2500/ 12000] | 2499/3832 batches | ms/batch 238.8332 | train_loss 6.465365e-01 | lr 8.050847e-05
05/14/2024 13:50:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2550/ 12000] | 2549/3832 batches | ms/batch 235.1961 | train_loss 6.481698e-01 | lr 8.008475e-05
05/14/2024 13:50:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2600/ 12000] | 2599/3832 batches | ms/batch 238.7626 | train_loss 6.465940e-01 | lr 7.966102e-05
05/14/2024 13:51:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2650/ 12000] | 2649/3832 batches | ms/batch 252.6120 | train_loss 6.453216e-01 | lr 7.923729e-05
05/14/2024 13:51:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2700/ 12000] | 2699/3832 batches | ms/batch 236.3470 | train_loss 6.454979e-01 | lr 7.881356e-05
05/14/2024 13:51:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2750/ 12000] | 2749/3832 batches | ms/batch 236.8398 | train_loss 6.452492e-01 | lr 7.838983e-05
05/14/2024 13:51:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2800/ 12000] | 2799/3832 batches | ms/batch 247.3303 | train_loss 6.460116e-01 | lr 7.796610e-05
05/14/2024 13:51:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2850/ 12000] | 2849/3832 batches | ms/batch 229.4708 | train_loss 6.448426e-01 | lr 7.754237e-05
05/14/2024 13:52:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2900/ 12000] | 2899/3832 batches | ms/batch 235.1451 | train_loss 6.441390e-01 | lr 7.711864e-05
05/14/2024 13:52:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2950/ 12000] | 2949/3832 batches | ms/batch 240.9593 | train_loss 6.445365e-01 | lr 7.669492e-05
05/14/2024 13:52:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3000/ 12000] | 2999/3832 batches | ms/batch 229.7713 | train_loss 6.429031e-01 | lr 7.627119e-05
05/14/2024 13:52:36 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp4mms48cc at global_step 3000 ****
05/14/2024 13:52:37 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 13:52:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3050/ 12000] | 3049/3832 batches | ms/batch 237.5060 | train_loss 6.452049e-01 | lr 7.584746e-05
05/14/2024 13:53:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3100/ 12000] | 3099/3832 batches | ms/batch 239.9893 | train_loss 6.427892e-01 | lr 7.542373e-05
05/14/2024 13:53:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3150/ 12000] | 3149/3832 batches | ms/batch 234.5763 | train_loss 6.446063e-01 | lr 7.500000e-05
05/14/2024 13:53:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3200/ 12000] | 3199/3832 batches | ms/batch 230.5705 | train_loss 6.438328e-01 | lr 7.457627e-05
05/14/2024 13:53:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3250/ 12000] | 3249/3832 batches | ms/batch 234.8095 | train_loss 6.431424e-01 | lr 7.415254e-05
05/14/2024 13:53:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3300/ 12000] | 3299/3832 batches | ms/batch 246.7437 | train_loss 6.422441e-01 | lr 7.372881e-05
05/14/2024 13:54:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3350/ 12000] | 3349/3832 batches | ms/batch 230.6295 | train_loss 6.399144e-01 | lr 7.330508e-05
05/14/2024 13:54:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3400/ 12000] | 3399/3832 batches | ms/batch 234.2101 | train_loss 6.427819e-01 | lr 7.288136e-05
05/14/2024 13:54:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3450/ 12000] | 3449/3832 batches | ms/batch 252.1426 | train_loss 6.401828e-01 | lr 7.245763e-05
05/14/2024 13:54:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3500/ 12000] | 3499/3832 batches | ms/batch 236.2945 | train_loss 6.424813e-01 | lr 7.203390e-05
05/14/2024 13:55:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3550/ 12000] | 3549/3832 batches | ms/batch 237.0726 | train_loss 6.428561e-01 | lr 7.161017e-05
05/14/2024 13:55:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3600/ 12000] | 3599/3832 batches | ms/batch 233.5532 | train_loss 6.399890e-01 | lr 7.118644e-05
05/14/2024 13:55:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3650/ 12000] | 3649/3832 batches | ms/batch 229.4300 | train_loss 6.410724e-01 | lr 7.076271e-05
05/14/2024 13:55:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3700/ 12000] | 3699/3832 batches | ms/batch 231.0721 | train_loss 6.393476e-01 | lr 7.033898e-05
05/14/2024 13:55:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3750/ 12000] | 3749/3832 batches | ms/batch 231.4606 | train_loss 6.394148e-01 | lr 6.991525e-05
05/14/2024 13:56:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3800/ 12000] | 3799/3832 batches | ms/batch 236.2254 | train_loss 6.397425e-01 | lr 6.949153e-05
05/14/2024 13:56:26 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  3850/ 12000] |   17/3832 batches | ms/batch 247.1002 | train_loss 6.358817e-01 | lr 6.906780e-05
05/14/2024 13:56:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  3900/ 12000] |   67/3832 batches | ms/batch 233.1949 | train_loss 6.268596e-01 | lr 6.864407e-05
05/14/2024 13:56:52 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  3950/ 12000] |  117/3832 batches | ms/batch 237.0006 | train_loss 6.275456e-01 | lr 6.822034e-05
05/14/2024 13:57:05 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4000/ 12000] |  167/3832 batches | ms/batch 248.9302 | train_loss 6.284016e-01 | lr 6.779661e-05
05/14/2024 13:57:05 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp4mms48cc at global_step 4000 ****
05/14/2024 13:57:06 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 13:57:19 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4050/ 12000] |  217/3832 batches | ms/batch 237.6762 | train_loss 6.274485e-01 | lr 6.737288e-05
05/14/2024 13:57:32 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4100/ 12000] |  267/3832 batches | ms/batch 237.0502 | train_loss 6.293692e-01 | lr 6.694915e-05
05/14/2024 13:57:45 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4150/ 12000] |  317/3832 batches | ms/batch 235.1973 | train_loss 6.268783e-01 | lr 6.652542e-05
05/14/2024 13:57:58 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4200/ 12000] |  367/3832 batches | ms/batch 230.0727 | train_loss 6.272747e-01 | lr 6.610169e-05
05/14/2024 13:58:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4250/ 12000] |  417/3832 batches | ms/batch 230.6767 | train_loss 6.277308e-01 | lr 6.567797e-05
05/14/2024 13:58:24 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4300/ 12000] |  467/3832 batches | ms/batch 245.8040 | train_loss 6.268522e-01 | lr 6.525424e-05
05/14/2024 13:58:36 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4350/ 12000] |  517/3832 batches | ms/batch 232.7288 | train_loss 6.276802e-01 | lr 6.483051e-05
05/14/2024 13:58:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4400/ 12000] |  567/3832 batches | ms/batch 229.3903 | train_loss 6.287948e-01 | lr 6.440678e-05
05/14/2024 13:59:02 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4450/ 12000] |  617/3832 batches | ms/batch 232.5032 | train_loss 6.272212e-01 | lr 6.398305e-05
05/14/2024 13:59:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4500/ 12000] |  667/3832 batches | ms/batch 240.8861 | train_loss 6.272033e-01 | lr 6.355932e-05
05/14/2024 13:59:28 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4550/ 12000] |  717/3832 batches | ms/batch 229.4413 | train_loss 6.278248e-01 | lr 6.313559e-05
05/14/2024 13:59:40 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4600/ 12000] |  767/3832 batches | ms/batch 235.9781 | train_loss 6.266107e-01 | lr 6.271186e-05
05/14/2024 13:59:54 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4650/ 12000] |  817/3832 batches | ms/batch 253.5511 | train_loss 6.266341e-01 | lr 6.228814e-05
05/14/2024 14:00:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4700/ 12000] |  867/3832 batches | ms/batch 231.2336 | train_loss 6.266487e-01 | lr 6.186441e-05
05/14/2024 14:00:20 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4750/ 12000] |  917/3832 batches | ms/batch 238.4662 | train_loss 6.255827e-01 | lr 6.144068e-05
05/14/2024 14:00:34 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4800/ 12000] |  967/3832 batches | ms/batch 256.4573 | train_loss 6.268887e-01 | lr 6.101695e-05
05/14/2024 14:00:47 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4850/ 12000] | 1017/3832 batches | ms/batch 231.8243 | train_loss 6.272582e-01 | lr 6.059322e-05
05/14/2024 14:00:59 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4900/ 12000] | 1067/3832 batches | ms/batch 224.3992 | train_loss 6.259497e-01 | lr 6.016949e-05
05/14/2024 14:01:12 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4950/ 12000] | 1117/3832 batches | ms/batch 242.6312 | train_loss 6.251962e-01 | lr 5.974576e-05
05/14/2024 14:01:26 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5000/ 12000] | 1167/3832 batches | ms/batch 244.7064 | train_loss 6.250938e-01 | lr 5.932203e-05
05/14/2024 14:01:26 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp4mms48cc at global_step 5000 ****
05/14/2024 14:01:27 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 14:01:39 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5050/ 12000] | 1217/3832 batches | ms/batch 235.1243 | train_loss 6.258011e-01 | lr 5.889831e-05
05/14/2024 14:01:53 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5100/ 12000] | 1267/3832 batches | ms/batch 243.2416 | train_loss 6.254876e-01 | lr 5.847458e-05
05/14/2024 14:02:06 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5150/ 12000] | 1317/3832 batches | ms/batch 242.3080 | train_loss 6.241536e-01 | lr 5.805085e-05
05/14/2024 14:02:19 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5200/ 12000] | 1367/3832 batches | ms/batch 231.7465 | train_loss 6.254821e-01 | lr 5.762712e-05
05/14/2024 14:02:32 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5250/ 12000] | 1417/3832 batches | ms/batch 240.4614 | train_loss 6.238237e-01 | lr 5.720339e-05
05/14/2024 14:02:45 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5300/ 12000] | 1467/3832 batches | ms/batch 241.8101 | train_loss 6.249887e-01 | lr 5.677966e-05
05/14/2024 14:02:58 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5350/ 12000] | 1517/3832 batches | ms/batch 231.4663 | train_loss 6.255899e-01 | lr 5.635593e-05
05/14/2024 14:03:11 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5400/ 12000] | 1567/3832 batches | ms/batch 243.2531 | train_loss 6.257714e-01 | lr 5.593220e-05
05/14/2024 14:03:26 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5450/ 12000] | 1617/3832 batches | ms/batch 262.9835 | train_loss 6.247981e-01 | lr 5.550847e-05
05/14/2024 14:03:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5500/ 12000] | 1667/3832 batches | ms/batch 230.4252 | train_loss 6.222827e-01 | lr 5.508475e-05
05/14/2024 14:03:51 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5550/ 12000] | 1717/3832 batches | ms/batch 239.8208 | train_loss 6.226326e-01 | lr 5.466102e-05
05/14/2024 14:04:04 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5600/ 12000] | 1767/3832 batches | ms/batch 238.7712 | train_loss 6.229662e-01 | lr 5.423729e-05
05/14/2024 14:04:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5650/ 12000] | 1817/3832 batches | ms/batch 235.5011 | train_loss 6.244359e-01 | lr 5.381356e-05
05/14/2024 14:04:30 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5700/ 12000] | 1867/3832 batches | ms/batch 231.1593 | train_loss 6.242297e-01 | lr 5.338983e-05
05/14/2024 14:04:43 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5750/ 12000] | 1917/3832 batches | ms/batch 242.5660 | train_loss 6.239248e-01 | lr 5.296610e-05
05/14/2024 14:04:56 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5800/ 12000] | 1967/3832 batches | ms/batch 229.4631 | train_loss 6.240890e-01 | lr 5.254237e-05
05/14/2024 14:05:09 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5850/ 12000] | 2017/3832 batches | ms/batch 231.4068 | train_loss 6.234692e-01 | lr 5.211864e-05
05/14/2024 14:05:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5900/ 12000] | 2067/3832 batches | ms/batch 237.7960 | train_loss 6.230726e-01 | lr 5.169492e-05
05/14/2024 14:05:35 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5950/ 12000] | 2117/3832 batches | ms/batch 236.2632 | train_loss 6.218651e-01 | lr 5.127119e-05
05/14/2024 14:05:47 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6000/ 12000] | 2167/3832 batches | ms/batch 227.8516 | train_loss 6.235395e-01 | lr 5.084746e-05
05/14/2024 14:05:47 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp4mms48cc at global_step 6000 ****
05/14/2024 14:05:48 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 14:06:01 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6050/ 12000] | 2217/3832 batches | ms/batch 239.5186 | train_loss 6.209778e-01 | lr 5.042373e-05
05/14/2024 14:06:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6100/ 12000] | 2267/3832 batches | ms/batch 249.9686 | train_loss 6.228091e-01 | lr 5.000000e-05
05/14/2024 14:06:28 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6150/ 12000] | 2317/3832 batches | ms/batch 232.9626 | train_loss 6.230697e-01 | lr 4.957627e-05
05/14/2024 14:06:41 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6200/ 12000] | 2367/3832 batches | ms/batch 243.5371 | train_loss 6.224267e-01 | lr 4.915254e-05
05/14/2024 14:06:54 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6250/ 12000] | 2417/3832 batches | ms/batch 247.9185 | train_loss 6.226861e-01 | lr 4.872881e-05
05/14/2024 14:07:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6300/ 12000] | 2467/3832 batches | ms/batch 233.4480 | train_loss 6.217022e-01 | lr 4.830508e-05
05/14/2024 14:07:20 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6350/ 12000] | 2517/3832 batches | ms/batch 236.6732 | train_loss 6.228332e-01 | lr 4.788136e-05
05/14/2024 14:07:33 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6400/ 12000] | 2567/3832 batches | ms/batch 247.5706 | train_loss 6.203994e-01 | lr 4.745763e-05
05/14/2024 14:07:47 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6450/ 12000] | 2617/3832 batches | ms/batch 242.2161 | train_loss 6.209962e-01 | lr 4.703390e-05
05/14/2024 14:07:59 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6500/ 12000] | 2667/3832 batches | ms/batch 235.3820 | train_loss 6.212900e-01 | lr 4.661017e-05
05/14/2024 14:08:13 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6550/ 12000] | 2717/3832 batches | ms/batch 255.2128 | train_loss 6.206878e-01 | lr 4.618644e-05
05/14/2024 14:08:27 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6600/ 12000] | 2767/3832 batches | ms/batch 242.5607 | train_loss 6.211042e-01 | lr 4.576271e-05
05/14/2024 14:08:40 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6650/ 12000] | 2817/3832 batches | ms/batch 241.5482 | train_loss 6.206252e-01 | lr 4.533898e-05
05/14/2024 14:08:54 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6700/ 12000] | 2867/3832 batches | ms/batch 252.9354 | train_loss 6.202106e-01 | lr 4.491525e-05
05/14/2024 14:09:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6750/ 12000] | 2917/3832 batches | ms/batch 244.6991 | train_loss 6.211108e-01 | lr 4.449153e-05
05/14/2024 14:09:20 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6800/ 12000] | 2967/3832 batches | ms/batch 243.2676 | train_loss 6.203707e-01 | lr 4.406780e-05
05/14/2024 14:09:33 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6850/ 12000] | 3017/3832 batches | ms/batch 243.5037 | train_loss 6.199329e-01 | lr 4.364407e-05
05/14/2024 14:09:46 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6900/ 12000] | 3067/3832 batches | ms/batch 232.3408 | train_loss 6.200188e-01 | lr 4.322034e-05
05/14/2024 14:09:59 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6950/ 12000] | 3117/3832 batches | ms/batch 232.6281 | train_loss 6.196827e-01 | lr 4.279661e-05
05/14/2024 14:10:12 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7000/ 12000] | 3167/3832 batches | ms/batch 245.5127 | train_loss 6.198483e-01 | lr 4.237288e-05
05/14/2024 14:10:12 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp4mms48cc at global_step 7000 ****
05/14/2024 14:10:13 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 14:10:27 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7050/ 12000] | 3217/3832 batches | ms/batch 240.4211 | train_loss 6.192779e-01 | lr 4.194915e-05
05/14/2024 14:10:39 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7100/ 12000] | 3267/3832 batches | ms/batch 238.1222 | train_loss 6.185068e-01 | lr 4.152542e-05
05/14/2024 14:10:53 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7150/ 12000] | 3317/3832 batches | ms/batch 254.4864 | train_loss 6.203062e-01 | lr 4.110169e-05
05/14/2024 14:11:06 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7200/ 12000] | 3367/3832 batches | ms/batch 237.3478 | train_loss 6.195659e-01 | lr 4.067797e-05
05/14/2024 14:11:19 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7250/ 12000] | 3417/3832 batches | ms/batch 234.3286 | train_loss 6.176044e-01 | lr 4.025424e-05
05/14/2024 14:11:32 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7300/ 12000] | 3467/3832 batches | ms/batch 239.5668 | train_loss 6.192207e-01 | lr 3.983051e-05
05/14/2024 14:11:46 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7350/ 12000] | 3517/3832 batches | ms/batch 243.0928 | train_loss 6.187173e-01 | lr 3.940678e-05
05/14/2024 14:11:58 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7400/ 12000] | 3567/3832 batches | ms/batch 235.8046 | train_loss 6.178022e-01 | lr 3.898305e-05
05/14/2024 14:12:12 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7450/ 12000] | 3617/3832 batches | ms/batch 247.0237 | train_loss 6.181951e-01 | lr 3.855932e-05
05/14/2024 14:12:25 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7500/ 12000] | 3667/3832 batches | ms/batch 245.1232 | train_loss 6.177683e-01 | lr 3.813559e-05
05/14/2024 14:12:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7550/ 12000] | 3717/3832 batches | ms/batch 234.9347 | train_loss 6.176851e-01 | lr 3.771186e-05
05/14/2024 14:12:51 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7600/ 12000] | 3767/3832 batches | ms/batch 235.8462 | train_loss 6.174505e-01 | lr 3.728814e-05
05/14/2024 14:13:04 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7650/ 12000] | 3817/3832 batches | ms/batch 239.4901 | train_loss 6.177957e-01 | lr 3.686441e-05
05/14/2024 14:13:25 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  7700/ 12000] |   35/3832 batches | ms/batch 230.8010 | train_loss 6.113458e-01 | lr 3.644068e-05
05/14/2024 14:13:38 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  7750/ 12000] |   85/3832 batches | ms/batch 238.1330 | train_loss 6.064829e-01 | lr 3.601695e-05
05/14/2024 14:13:52 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  7800/ 12000] |  135/3832 batches | ms/batch 249.0247 | train_loss 6.076836e-01 | lr 3.559322e-05
05/14/2024 14:14:05 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  7850/ 12000] |  185/3832 batches | ms/batch 241.8088 | train_loss 6.067781e-01 | lr 3.516949e-05
05/14/2024 14:14:19 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  7900/ 12000] |  235/3832 batches | ms/batch 249.6452 | train_loss 6.066167e-01 | lr 3.474576e-05
05/14/2024 14:14:32 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  7950/ 12000] |  285/3832 batches | ms/batch 248.3614 | train_loss 6.071887e-01 | lr 3.432203e-05
05/14/2024 14:14:46 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8000/ 12000] |  335/3832 batches | ms/batch 241.6035 | train_loss 6.073836e-01 | lr 3.389831e-05
05/14/2024 14:14:46 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp4mms48cc at global_step 8000 ****
05/14/2024 14:14:47 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 14:15:00 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8050/ 12000] |  385/3832 batches | ms/batch 224.8500 | train_loss 6.086615e-01 | lr 3.347458e-05
05/14/2024 14:15:12 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8100/ 12000] |  435/3832 batches | ms/batch 230.4737 | train_loss 6.070404e-01 | lr 3.305085e-05
05/14/2024 14:15:26 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8150/ 12000] |  485/3832 batches | ms/batch 245.7659 | train_loss 6.079910e-01 | lr 3.262712e-05
05/14/2024 14:15:38 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8200/ 12000] |  535/3832 batches | ms/batch 230.4737 | train_loss 6.081597e-01 | lr 3.220339e-05
05/14/2024 14:15:51 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8250/ 12000] |  585/3832 batches | ms/batch 238.9257 | train_loss 6.072751e-01 | lr 3.177966e-05
05/14/2024 14:16:05 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8300/ 12000] |  635/3832 batches | ms/batch 246.1045 | train_loss 6.077064e-01 | lr 3.135593e-05
05/14/2024 14:16:18 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8350/ 12000] |  685/3832 batches | ms/batch 236.3396 | train_loss 6.079825e-01 | lr 3.093220e-05
05/14/2024 14:16:31 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8400/ 12000] |  735/3832 batches | ms/batch 235.4668 | train_loss 6.081709e-01 | lr 3.050847e-05
05/14/2024 14:16:44 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8450/ 12000] |  785/3832 batches | ms/batch 246.2377 | train_loss 6.070637e-01 | lr 3.008475e-05
05/14/2024 14:16:57 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8500/ 12000] |  835/3832 batches | ms/batch 240.8440 | train_loss 6.070354e-01 | lr 2.966102e-05
05/14/2024 14:17:10 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8550/ 12000] |  885/3832 batches | ms/batch 236.1274 | train_loss 6.079104e-01 | lr 2.923729e-05
05/14/2024 14:17:24 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8600/ 12000] |  935/3832 batches | ms/batch 252.3234 | train_loss 6.072180e-01 | lr 2.881356e-05
05/14/2024 14:17:37 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8650/ 12000] |  985/3832 batches | ms/batch 238.5278 | train_loss 6.070694e-01 | lr 2.838983e-05
05/14/2024 14:17:50 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8700/ 12000] | 1035/3832 batches | ms/batch 235.7712 | train_loss 6.070828e-01 | lr 2.796610e-05
05/14/2024 14:18:04 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8750/ 12000] | 1085/3832 batches | ms/batch 255.7723 | train_loss 6.072443e-01 | lr 2.754237e-05
05/14/2024 14:18:17 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8800/ 12000] | 1135/3832 batches | ms/batch 242.1453 | train_loss 6.071084e-01 | lr 2.711864e-05
05/14/2024 14:18:30 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8850/ 12000] | 1185/3832 batches | ms/batch 242.0915 | train_loss 6.070559e-01 | lr 2.669492e-05
05/14/2024 14:18:44 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8900/ 12000] | 1235/3832 batches | ms/batch 257.6314 | train_loss 6.064847e-01 | lr 2.627119e-05
05/14/2024 14:18:57 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8950/ 12000] | 1285/3832 batches | ms/batch 235.8102 | train_loss 6.071621e-01 | lr 2.584746e-05
05/14/2024 14:19:11 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9000/ 12000] | 1335/3832 batches | ms/batch 241.4299 | train_loss 6.074106e-01 | lr 2.542373e-05
05/14/2024 14:19:11 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp4mms48cc at global_step 9000 ****
05/14/2024 14:19:11 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 14:19:24 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9050/ 12000] | 1385/3832 batches | ms/batch 247.3851 | train_loss 6.064874e-01 | lr 2.500000e-05
05/14/2024 14:19:38 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9100/ 12000] | 1435/3832 batches | ms/batch 243.8528 | train_loss 6.067518e-01 | lr 2.457627e-05
05/14/2024 14:19:51 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9150/ 12000] | 1485/3832 batches | ms/batch 240.8621 | train_loss 6.072449e-01 | lr 2.415254e-05
05/14/2024 14:20:05 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9200/ 12000] | 1535/3832 batches | ms/batch 249.5441 | train_loss 6.061992e-01 | lr 2.372881e-05
05/14/2024 14:20:18 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9250/ 12000] | 1585/3832 batches | ms/batch 234.8639 | train_loss 6.054467e-01 | lr 2.330508e-05
05/14/2024 14:20:31 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9300/ 12000] | 1635/3832 batches | ms/batch 242.7885 | train_loss 6.061757e-01 | lr 2.288136e-05
05/14/2024 14:20:44 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9350/ 12000] | 1685/3832 batches | ms/batch 253.5082 | train_loss 6.054139e-01 | lr 2.245763e-05
05/14/2024 14:20:57 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9400/ 12000] | 1735/3832 batches | ms/batch 232.5204 | train_loss 6.066886e-01 | lr 2.203390e-05
05/14/2024 14:21:10 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9450/ 12000] | 1785/3832 batches | ms/batch 239.5909 | train_loss 6.055004e-01 | lr 2.161017e-05
05/14/2024 14:21:24 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9500/ 12000] | 1835/3832 batches | ms/batch 246.5829 | train_loss 6.057084e-01 | lr 2.118644e-05
05/14/2024 14:21:37 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9550/ 12000] | 1885/3832 batches | ms/batch 234.1416 | train_loss 6.059197e-01 | lr 2.076271e-05
05/14/2024 14:21:50 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9600/ 12000] | 1935/3832 batches | ms/batch 240.3207 | train_loss 6.054494e-01 | lr 2.033898e-05
05/14/2024 14:22:04 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9650/ 12000] | 1985/3832 batches | ms/batch 248.1753 | train_loss 6.063574e-01 | lr 1.991525e-05
05/14/2024 14:22:17 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9700/ 12000] | 2035/3832 batches | ms/batch 240.6707 | train_loss 6.064711e-01 | lr 1.949153e-05
05/14/2024 14:22:30 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9750/ 12000] | 2085/3832 batches | ms/batch 236.3595 | train_loss 6.053893e-01 | lr 1.906780e-05
05/14/2024 14:22:43 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9800/ 12000] | 2135/3832 batches | ms/batch 250.5183 | train_loss 6.060876e-01 | lr 1.864407e-05
05/14/2024 14:22:57 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9850/ 12000] | 2185/3832 batches | ms/batch 243.8697 | train_loss 6.058817e-01 | lr 1.822034e-05
05/14/2024 14:23:10 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9900/ 12000] | 2235/3832 batches | ms/batch 234.3172 | train_loss 6.053974e-01 | lr 1.779661e-05
05/14/2024 14:23:23 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9950/ 12000] | 2285/3832 batches | ms/batch 250.3844 | train_loss 6.048717e-01 | lr 1.737288e-05
05/14/2024 14:23:37 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10000/ 12000] | 2335/3832 batches | ms/batch 246.7975 | train_loss 6.048558e-01 | lr 1.694915e-05
05/14/2024 14:23:37 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp4mms48cc at global_step 10000 ****
05/14/2024 14:23:37 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 14:23:51 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10050/ 12000] | 2385/3832 batches | ms/batch 243.9185 | train_loss 6.042740e-01 | lr 1.652542e-05
05/14/2024 14:24:05 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10100/ 12000] | 2435/3832 batches | ms/batch 257.8805 | train_loss 6.050250e-01 | lr 1.610169e-05
05/14/2024 14:24:18 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10150/ 12000] | 2485/3832 batches | ms/batch 236.2275 | train_loss 6.055154e-01 | lr 1.567797e-05
05/14/2024 14:24:30 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10200/ 12000] | 2535/3832 batches | ms/batch 236.4373 | train_loss 6.054155e-01 | lr 1.525424e-05
05/14/2024 14:24:44 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10250/ 12000] | 2585/3832 batches | ms/batch 247.8285 | train_loss 6.045665e-01 | lr 1.483051e-05
05/14/2024 14:24:57 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10300/ 12000] | 2635/3832 batches | ms/batch 241.3119 | train_loss 6.032447e-01 | lr 1.440678e-05
05/14/2024 14:25:10 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10350/ 12000] | 2685/3832 batches | ms/batch 239.1168 | train_loss 6.054686e-01 | lr 1.398305e-05
05/14/2024 14:25:24 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10400/ 12000] | 2735/3832 batches | ms/batch 247.6751 | train_loss 6.039535e-01 | lr 1.355932e-05
05/14/2024 14:25:37 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10450/ 12000] | 2785/3832 batches | ms/batch 234.8586 | train_loss 6.051551e-01 | lr 1.313559e-05
05/14/2024 14:25:49 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10500/ 12000] | 2835/3832 batches | ms/batch 231.9117 | train_loss 6.036920e-01 | lr 1.271186e-05
05/14/2024 14:26:03 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10550/ 12000] | 2885/3832 batches | ms/batch 242.2607 | train_loss 6.036422e-01 | lr 1.228814e-05
05/14/2024 14:26:16 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10600/ 12000] | 2935/3832 batches | ms/batch 243.4426 | train_loss 6.039245e-01 | lr 1.186441e-05
05/14/2024 14:26:29 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10650/ 12000] | 2985/3832 batches | ms/batch 232.7674 | train_loss 6.043283e-01 | lr 1.144068e-05
05/14/2024 14:26:43 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10700/ 12000] | 3035/3832 batches | ms/batch 249.7530 | train_loss 6.031229e-01 | lr 1.101695e-05
05/14/2024 14:26:56 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10750/ 12000] | 3085/3832 batches | ms/batch 244.0417 | train_loss 6.034486e-01 | lr 1.059322e-05
05/14/2024 14:27:09 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10800/ 12000] | 3135/3832 batches | ms/batch 234.4162 | train_loss 6.049788e-01 | lr 1.016949e-05
05/14/2024 14:27:22 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10850/ 12000] | 3185/3832 batches | ms/batch 245.7513 | train_loss 6.040571e-01 | lr 9.745763e-06
05/14/2024 14:27:36 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10900/ 12000] | 3235/3832 batches | ms/batch 246.3869 | train_loss 6.030821e-01 | lr 9.322034e-06
05/14/2024 14:27:48 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10950/ 12000] | 3285/3832 batches | ms/batch 229.3836 | train_loss 6.027344e-01 | lr 8.898305e-06
05/14/2024 14:28:02 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11000/ 12000] | 3335/3832 batches | ms/batch 246.4201 | train_loss 6.048704e-01 | lr 8.474576e-06
05/14/2024 14:28:02 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp4mms48cc at global_step 11000 ****
05/14/2024 14:28:02 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 14:28:16 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11050/ 12000] | 3385/3832 batches | ms/batch 248.7517 | train_loss 6.027792e-01 | lr 8.050847e-06
05/14/2024 14:28:28 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11100/ 12000] | 3435/3832 batches | ms/batch 236.4224 | train_loss 6.023757e-01 | lr 7.627119e-06
05/14/2024 14:28:42 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11150/ 12000] | 3485/3832 batches | ms/batch 247.1226 | train_loss 6.036582e-01 | lr 7.203390e-06
05/14/2024 14:28:55 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11200/ 12000] | 3535/3832 batches | ms/batch 245.6036 | train_loss 6.029447e-01 | lr 6.779661e-06
05/14/2024 14:29:08 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11250/ 12000] | 3585/3832 batches | ms/batch 232.5529 | train_loss 6.030248e-01 | lr 6.355932e-06
05/14/2024 14:29:22 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11300/ 12000] | 3635/3832 batches | ms/batch 248.1038 | train_loss 6.030344e-01 | lr 5.932203e-06
05/14/2024 14:29:36 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11350/ 12000] | 3685/3832 batches | ms/batch 256.8745 | train_loss 6.024843e-01 | lr 5.508475e-06
05/14/2024 14:29:49 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11400/ 12000] | 3735/3832 batches | ms/batch 235.8376 | train_loss 6.028041e-01 | lr 5.084746e-06
05/14/2024 14:30:02 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11450/ 12000] | 3785/3832 batches | ms/batch 243.6685 | train_loss 6.027846e-01 | lr 4.661017e-06
05/14/2024 14:30:23 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11500/ 12000] |    3/3832 batches | ms/batch 251.0382 | train_loss 6.021022e-01 | lr 4.237288e-06
05/14/2024 14:30:37 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11550/ 12000] |   53/3832 batches | ms/batch 243.2853 | train_loss 5.989790e-01 | lr 3.813559e-06
05/14/2024 14:30:49 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11600/ 12000] |  103/3832 batches | ms/batch 232.4311 | train_loss 5.982815e-01 | lr 3.389831e-06
05/14/2024 14:31:03 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11650/ 12000] |  153/3832 batches | ms/batch 249.2588 | train_loss 5.981639e-01 | lr 2.966102e-06
05/14/2024 14:31:16 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11700/ 12000] |  203/3832 batches | ms/batch 243.5987 | train_loss 5.976754e-01 | lr 2.542373e-06
05/14/2024 14:31:29 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11750/ 12000] |  253/3832 batches | ms/batch 239.5274 | train_loss 5.978333e-01 | lr 2.118644e-06
05/14/2024 14:31:43 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11800/ 12000] |  303/3832 batches | ms/batch 254.4131 | train_loss 5.982653e-01 | lr 1.694915e-06
05/14/2024 14:31:56 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11850/ 12000] |  353/3832 batches | ms/batch 242.3341 | train_loss 5.980354e-01 | lr 1.271186e-06
05/14/2024 14:32:09 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11900/ 12000] |  403/3832 batches | ms/batch 234.0547 | train_loss 5.985713e-01 | lr 8.474576e-07
05/14/2024 14:32:22 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11950/ 12000] |  453/3832 batches | ms/batch 245.8563 | train_loss 5.981562e-01 | lr 4.237288e-07
05/14/2024 14:32:36 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 12000/ 12000] |  503/3832 batches | ms/batch 249.5630 | train_loss 5.984329e-01 | lr 0.000000e+00
05/14/2024 14:32:36 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp4mms48cc at global_step 12000 ****
05/14/2024 14:32:37 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 14:32:38 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23597246/tmp4mms48cc
05/14/2024 14:32:40 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((490449, 32768)) with avr_nnz=80.0
05/14/2024 14:32:40 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
05/14/2024 14:39:22 - INFO - pecos.xmc.xtransformer.model - Constructed instance feature matrix with shape=(490449, 136677)
05/14/2024 14:40:05 - INFO - pecos.xmc.xtransformer.model - Hierarchical label tree for ranker: [8, 256, 8192, 670091]
05/14/2024 14:40:05 - INFO - pecos.xmc.xtransformer.model - Start training ranker...
05/14/2024 14:40:06 - INFO - pecos.xmc.base - Training Layer 0 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
05/14/2024 14:40:29 - INFO - pecos.xmc.base - Training Layer 1 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
05/14/2024 14:40:54 - INFO - pecos.xmc.base - Training Layer 2 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
05/14/2024 14:41:41 - INFO - pecos.xmc.base - Training Layer 3 of 4 Layers in HierarchicalMLModel, neg_mining=tfn+man..
05/14/2024 15:05:55 - INFO - pecos.xmc.xtransformer.model - Parameters saved to ./trained-models/amazon-670k/bert2/param.json
05/14/2024 15:06:13 - INFO - pecos.xmc.xtransformer.model - Model saved to ./trained-models/amazon-670k/bert2
--- start prediction of bert2 ---
--- start evaluation of bert2 ---
--- start training of bert3 ---
05/14/2024 15:15:16 - INFO - __main__ - Setting random seed 0
05/14/2024 15:15:19 - INFO - __main__ - Loaded training feature matrix with shape=(490449, 135909)
05/14/2024 15:15:19 - INFO - __main__ - Loaded training label matrix with shape=(490449, 670091)
05/14/2024 15:15:20 - INFO - __main__ - Loaded 490449 training sequences
05/14/2024 15:15:32 - INFO - pecos.xmc.xtransformer.model - Hierarchical label tree: [128, 2048, 32768, 670091]
05/14/2024 15:15:32 - INFO - pecos.xmc.xtransformer.model - Fine-tune Transformers with nr_labels=[128, 2048, 32768]
05/14/2024 15:15:33 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn+man at level 0, nr_labels=128, avr_M_nnz=128
05/14/2024 15:15:35 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-uncased model from s3.
05/14/2024 15:15:35 - INFO - pecos.xmc.xtransformer.matcher - ***** Encoding data len=490449 truncation=128*****
05/14/2024 15:16:12 - INFO - pecos.xmc.xtransformer.matcher - ***** Finished with time cost=36.76425766944885 *****
05/14/2024 15:16:35 - INFO - pecos.xmc.xtransformer.matcher - trn tensors saved to /scratch/slurm_tmpdir/job_23597246/tmppk35kh8s/X_trn.pt
05/14/2024 15:16:35 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 4
05/14/2024 15:16:36 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
05/14/2024 15:16:36 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
/home/ul/ul_student/ul_ruw26/.local/lib/python3.9/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
05/14/2024 15:16:36 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
05/14/2024 15:16:36 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 490449
05/14/2024 15:16:36 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 128
05/14/2024 15:16:36 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 2
05/14/2024 15:16:36 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
05/14/2024 15:16:36 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 128
05/14/2024 15:16:36 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
05/14/2024 15:16:36 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
05/14/2024 15:16:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][    50/  4000] |   49/3832 batches | ms/batch 331.9322 | train_loss 9.057219e-01 | lr 2.500000e-05
05/14/2024 15:17:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   100/  4000] |   99/3832 batches | ms/batch 210.9246 | train_loss 2.148664e-01 | lr 5.000000e-05
05/14/2024 15:17:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   150/  4000] |  149/3832 batches | ms/batch 211.4031 | train_loss 1.706801e-01 | lr 7.500000e-05
05/14/2024 15:17:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   200/  4000] |  199/3832 batches | ms/batch 211.6203 | train_loss 1.513705e-01 | lr 1.000000e-04
05/14/2024 15:17:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   250/  4000] |  249/3832 batches | ms/batch 212.5033 | train_loss 1.248479e-01 | lr 9.868421e-05
05/14/2024 15:17:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   300/  4000] |  299/3832 batches | ms/batch 214.7447 | train_loss 1.078235e-01 | lr 9.736842e-05
05/14/2024 15:18:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   350/  4000] |  349/3832 batches | ms/batch 215.8261 | train_loss 9.708350e-02 | lr 9.605263e-05
05/14/2024 15:18:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   400/  4000] |  399/3832 batches | ms/batch 215.7249 | train_loss 8.903308e-02 | lr 9.473684e-05
05/14/2024 15:18:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   450/  4000] |  449/3832 batches | ms/batch 214.7283 | train_loss 8.650802e-02 | lr 9.342105e-05
05/14/2024 15:18:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   500/  4000] |  499/3832 batches | ms/batch 215.1243 | train_loss 8.263356e-02 | lr 9.210526e-05
05/14/2024 15:18:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   550/  4000] |  549/3832 batches | ms/batch 216.7190 | train_loss 8.168400e-02 | lr 9.078947e-05
05/14/2024 15:19:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   600/  4000] |  599/3832 batches | ms/batch 214.0679 | train_loss 7.976928e-02 | lr 8.947368e-05
05/14/2024 15:19:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   650/  4000] |  649/3832 batches | ms/batch 214.3266 | train_loss 7.800896e-02 | lr 8.815789e-05
05/14/2024 15:19:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   700/  4000] |  699/3832 batches | ms/batch 216.3042 | train_loss 7.700082e-02 | lr 8.684211e-05
05/14/2024 15:19:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   750/  4000] |  749/3832 batches | ms/batch 214.5981 | train_loss 7.465699e-02 | lr 8.552632e-05
05/14/2024 15:19:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   800/  4000] |  799/3832 batches | ms/batch 215.0080 | train_loss 7.486726e-02 | lr 8.421053e-05
05/14/2024 15:20:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   850/  4000] |  849/3832 batches | ms/batch 215.4482 | train_loss 7.348015e-02 | lr 8.289474e-05
05/14/2024 15:20:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   900/  4000] |  899/3832 batches | ms/batch 214.1750 | train_loss 7.245558e-02 | lr 8.157895e-05
05/14/2024 15:20:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   950/  4000] |  949/3832 batches | ms/batch 215.2982 | train_loss 7.290869e-02 | lr 8.026316e-05
05/14/2024 15:20:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1000/  4000] |  999/3832 batches | ms/batch 215.9268 | train_loss 7.204003e-02 | lr 7.894737e-05
05/14/2024 15:20:38 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmprlqnkbg7 at global_step 1000 ****
05/14/2024 15:20:39 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 15:20:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1050/  4000] | 1049/3832 batches | ms/batch 215.2307 | train_loss 7.165832e-02 | lr 7.763158e-05
05/14/2024 15:21:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1100/  4000] | 1099/3832 batches | ms/batch 215.8983 | train_loss 6.991053e-02 | lr 7.631579e-05
05/14/2024 15:21:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1150/  4000] | 1149/3832 batches | ms/batch 214.9761 | train_loss 6.976830e-02 | lr 7.500000e-05
05/14/2024 15:21:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1200/  4000] | 1199/3832 batches | ms/batch 215.6438 | train_loss 6.936889e-02 | lr 7.368421e-05
05/14/2024 15:21:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1250/  4000] | 1249/3832 batches | ms/batch 214.5196 | train_loss 6.954214e-02 | lr 7.236842e-05
05/14/2024 15:21:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1300/  4000] | 1299/3832 batches | ms/batch 216.7256 | train_loss 6.892548e-02 | lr 7.105263e-05
05/14/2024 15:22:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1350/  4000] | 1349/3832 batches | ms/batch 215.7606 | train_loss 6.893617e-02 | lr 6.973684e-05
05/14/2024 15:22:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1400/  4000] | 1399/3832 batches | ms/batch 216.1525 | train_loss 6.774756e-02 | lr 6.842105e-05
05/14/2024 15:22:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1450/  4000] | 1449/3832 batches | ms/batch 216.3297 | train_loss 6.820183e-02 | lr 6.710526e-05
05/14/2024 15:22:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1500/  4000] | 1499/3832 batches | ms/batch 216.1495 | train_loss 6.743684e-02 | lr 6.578947e-05
05/14/2024 15:22:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1550/  4000] | 1549/3832 batches | ms/batch 214.7459 | train_loss 6.790021e-02 | lr 6.447368e-05
05/14/2024 15:22:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1600/  4000] | 1599/3832 batches | ms/batch 215.6217 | train_loss 6.525537e-02 | lr 6.315789e-05
05/14/2024 15:23:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1650/  4000] | 1649/3832 batches | ms/batch 216.4645 | train_loss 6.751216e-02 | lr 6.184211e-05
05/14/2024 15:23:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1700/  4000] | 1699/3832 batches | ms/batch 215.8846 | train_loss 6.720840e-02 | lr 6.052632e-05
05/14/2024 15:23:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1750/  4000] | 1749/3832 batches | ms/batch 215.3774 | train_loss 6.605093e-02 | lr 5.921053e-05
05/14/2024 15:23:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1800/  4000] | 1799/3832 batches | ms/batch 215.7409 | train_loss 6.457899e-02 | lr 5.789474e-05
05/14/2024 15:23:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1850/  4000] | 1849/3832 batches | ms/batch 215.5932 | train_loss 6.542661e-02 | lr 5.657895e-05
05/14/2024 15:24:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1900/  4000] | 1899/3832 batches | ms/batch 215.8046 | train_loss 6.530237e-02 | lr 5.526316e-05
05/14/2024 15:24:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1950/  4000] | 1949/3832 batches | ms/batch 215.8964 | train_loss 6.535416e-02 | lr 5.394737e-05
05/14/2024 15:24:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2000/  4000] | 1999/3832 batches | ms/batch 215.9598 | train_loss 6.452872e-02 | lr 5.263158e-05
05/14/2024 15:24:31 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmprlqnkbg7 at global_step 2000 ****
05/14/2024 15:24:31 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 15:24:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2050/  4000] | 2049/3832 batches | ms/batch 215.6041 | train_loss 6.583469e-02 | lr 5.131579e-05
05/14/2024 15:24:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2100/  4000] | 2099/3832 batches | ms/batch 216.4744 | train_loss 6.454953e-02 | lr 5.000000e-05
05/14/2024 15:25:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2150/  4000] | 2149/3832 batches | ms/batch 215.1866 | train_loss 6.428469e-02 | lr 4.868421e-05
05/14/2024 15:25:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2200/  4000] | 2199/3832 batches | ms/batch 215.6810 | train_loss 6.473641e-02 | lr 4.736842e-05
05/14/2024 15:25:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2250/  4000] | 2249/3832 batches | ms/batch 215.5486 | train_loss 6.471404e-02 | lr 4.605263e-05
05/14/2024 15:25:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2300/  4000] | 2299/3832 batches | ms/batch 215.0914 | train_loss 6.354616e-02 | lr 4.473684e-05
05/14/2024 15:25:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2350/  4000] | 2349/3832 batches | ms/batch 216.2108 | train_loss 6.434614e-02 | lr 4.342105e-05
05/14/2024 15:26:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2400/  4000] | 2399/3832 batches | ms/batch 216.4024 | train_loss 6.315975e-02 | lr 4.210526e-05
05/14/2024 15:26:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2450/  4000] | 2449/3832 batches | ms/batch 215.0294 | train_loss 6.200861e-02 | lr 4.078947e-05
05/14/2024 15:26:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2500/  4000] | 2499/3832 batches | ms/batch 216.0606 | train_loss 6.302382e-02 | lr 3.947368e-05
05/14/2024 15:26:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2550/  4000] | 2549/3832 batches | ms/batch 216.3386 | train_loss 6.254187e-02 | lr 3.815789e-05
05/14/2024 15:26:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2600/  4000] | 2599/3832 batches | ms/batch 216.2733 | train_loss 6.231429e-02 | lr 3.684211e-05
05/14/2024 15:27:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2650/  4000] | 2649/3832 batches | ms/batch 215.1335 | train_loss 6.237013e-02 | lr 3.552632e-05
05/14/2024 15:27:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2700/  4000] | 2699/3832 batches | ms/batch 214.7669 | train_loss 6.309572e-02 | lr 3.421053e-05
05/14/2024 15:27:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2750/  4000] | 2749/3832 batches | ms/batch 215.6625 | train_loss 6.223813e-02 | lr 3.289474e-05
05/14/2024 15:27:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2800/  4000] | 2799/3832 batches | ms/batch 216.7331 | train_loss 6.187026e-02 | lr 3.157895e-05
05/14/2024 15:27:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2850/  4000] | 2849/3832 batches | ms/batch 215.4750 | train_loss 6.216858e-02 | lr 3.026316e-05
05/14/2024 15:28:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2900/  4000] | 2899/3832 batches | ms/batch 215.0235 | train_loss 6.268752e-02 | lr 2.894737e-05
05/14/2024 15:28:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2950/  4000] | 2949/3832 batches | ms/batch 214.7772 | train_loss 6.163604e-02 | lr 2.763158e-05
05/14/2024 15:28:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3000/  4000] | 2999/3832 batches | ms/batch 215.9286 | train_loss 6.043452e-02 | lr 2.631579e-05
05/14/2024 15:28:24 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmprlqnkbg7 at global_step 3000 ****
05/14/2024 15:28:25 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 15:28:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3050/  4000] | 3049/3832 batches | ms/batch 215.8272 | train_loss 6.111496e-02 | lr 2.500000e-05
05/14/2024 15:28:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3100/  4000] | 3099/3832 batches | ms/batch 215.1814 | train_loss 6.148152e-02 | lr 2.368421e-05
05/14/2024 15:28:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3150/  4000] | 3149/3832 batches | ms/batch 215.6714 | train_loss 6.063781e-02 | lr 2.236842e-05
05/14/2024 15:29:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3200/  4000] | 3199/3832 batches | ms/batch 216.1365 | train_loss 6.139651e-02 | lr 2.105263e-05
05/14/2024 15:29:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3250/  4000] | 3249/3832 batches | ms/batch 215.8125 | train_loss 6.052965e-02 | lr 1.973684e-05
05/14/2024 15:29:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3300/  4000] | 3299/3832 batches | ms/batch 215.2651 | train_loss 6.033533e-02 | lr 1.842105e-05
05/14/2024 15:29:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3350/  4000] | 3349/3832 batches | ms/batch 215.6549 | train_loss 6.188668e-02 | lr 1.710526e-05
05/14/2024 15:29:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3400/  4000] | 3399/3832 batches | ms/batch 215.4572 | train_loss 5.970973e-02 | lr 1.578947e-05
05/14/2024 15:30:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3450/  4000] | 3449/3832 batches | ms/batch 215.4067 | train_loss 6.057815e-02 | lr 1.447368e-05
05/14/2024 15:30:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3500/  4000] | 3499/3832 batches | ms/batch 215.4265 | train_loss 6.098083e-02 | lr 1.315789e-05
05/14/2024 15:30:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3550/  4000] | 3549/3832 batches | ms/batch 216.2463 | train_loss 5.988125e-02 | lr 1.184211e-05
05/14/2024 15:30:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3600/  4000] | 3599/3832 batches | ms/batch 215.7199 | train_loss 5.929466e-02 | lr 1.052632e-05
05/14/2024 15:30:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3650/  4000] | 3649/3832 batches | ms/batch 216.8137 | train_loss 5.939409e-02 | lr 9.210526e-06
05/14/2024 15:31:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3700/  4000] | 3699/3832 batches | ms/batch 214.3952 | train_loss 6.013701e-02 | lr 7.894737e-06
05/14/2024 15:31:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3750/  4000] | 3749/3832 batches | ms/batch 215.5517 | train_loss 5.872917e-02 | lr 6.578947e-06
05/14/2024 15:31:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3800/  4000] | 3799/3832 batches | ms/batch 216.2525 | train_loss 5.947771e-02 | lr 5.263158e-06
05/14/2024 15:31:47 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  3850/  4000] |   17/3832 batches | ms/batch 214.8328 | train_loss 5.832368e-02 | lr 3.947368e-06
05/14/2024 15:31:58 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  3900/  4000] |   67/3832 batches | ms/batch 216.1620 | train_loss 5.439701e-02 | lr 2.631579e-06
05/14/2024 15:32:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  3950/  4000] |  117/3832 batches | ms/batch 216.1548 | train_loss 5.428575e-02 | lr 1.315789e-06
05/14/2024 15:32:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  4000/  4000] |  167/3832 batches | ms/batch 215.6570 | train_loss 5.486039e-02 | lr 0.000000e+00
05/14/2024 15:32:22 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmprlqnkbg7 at global_step 4000 ****
05/14/2024 15:32:22 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 15:32:23 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23597246/tmprlqnkbg7
05/14/2024 15:32:23 - INFO - pecos.xmc.xtransformer.matcher - Predict on input text tensors(torch.Size([490449, 128])) in OVA mode
05/14/2024 15:32:23 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
05/14/2024 15:38:46 - INFO - pecos.xmc.xtransformer.matcher - Concatenating instance embeddings with features...
05/14/2024 15:38:56 - INFO - pecos.xmc.xtransformer.matcher - Start training concat_model of transformer matcher...
05/14/2024 15:40:17 - INFO - pecos.xmc.xtransformer.matcher - Using concat-only for transformer/concat ensemble of pred_csr
05/14/2024 15:40:31 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn+man at level 1, nr_labels=2048, avr_M_nnz=5.097384233630816
05/14/2024 15:40:32 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-uncased model from s3.
05/14/2024 15:41:02 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23597246/tmppk35kh8s/X_trn.pt
05/14/2024 15:41:02 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
05/14/2024 15:43:05 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
05/14/2024 15:43:05 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 4
05/14/2024 15:43:06 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
05/14/2024 15:43:06 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
/home/ul/ul_student/ul_ruw26/.local/lib/python3.9/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
05/14/2024 15:43:24 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
05/14/2024 15:43:24 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 490449
05/14/2024 15:43:24 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 2048
05/14/2024 15:43:24 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 192
05/14/2024 15:43:24 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 2
05/14/2024 15:43:24 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
05/14/2024 15:43:24 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 128
05/14/2024 15:43:24 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
05/14/2024 15:43:24 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
05/14/2024 15:43:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][    50/  4000] |   49/3832 batches | ms/batch 255.9042 | train_loss 8.629462e-01 | lr 2.500000e-05
05/14/2024 15:43:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   100/  4000] |   99/3832 batches | ms/batch 252.7111 | train_loss 7.376702e-01 | lr 5.000000e-05
05/14/2024 15:44:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   150/  4000] |  149/3832 batches | ms/batch 258.8437 | train_loss 7.059642e-01 | lr 7.500000e-05
05/14/2024 15:44:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   200/  4000] |  199/3832 batches | ms/batch 262.0135 | train_loss 6.972991e-01 | lr 1.000000e-04
05/14/2024 15:44:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   250/  4000] |  249/3832 batches | ms/batch 263.2166 | train_loss 6.891322e-01 | lr 9.868421e-05
05/14/2024 15:44:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   300/  4000] |  299/3832 batches | ms/batch 244.5626 | train_loss 6.831614e-01 | lr 9.736842e-05
05/14/2024 15:45:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   350/  4000] |  349/3832 batches | ms/batch 243.7331 | train_loss 6.803322e-01 | lr 9.605263e-05
05/14/2024 15:45:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   400/  4000] |  399/3832 batches | ms/batch 250.7251 | train_loss 6.777315e-01 | lr 9.473684e-05
05/14/2024 15:45:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   450/  4000] |  449/3832 batches | ms/batch 247.9998 | train_loss 6.741421e-01 | lr 9.342105e-05
05/14/2024 15:45:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   500/  4000] |  499/3832 batches | ms/batch 246.9680 | train_loss 6.720113e-01 | lr 9.210526e-05
05/14/2024 15:46:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   550/  4000] |  549/3832 batches | ms/batch 246.4778 | train_loss 6.711372e-01 | lr 9.078947e-05
05/14/2024 15:46:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   600/  4000] |  599/3832 batches | ms/batch 237.1935 | train_loss 6.709317e-01 | lr 8.947368e-05
05/14/2024 15:46:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   650/  4000] |  649/3832 batches | ms/batch 235.4642 | train_loss 6.684566e-01 | lr 8.815789e-05
05/14/2024 15:46:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   700/  4000] |  699/3832 batches | ms/batch 228.1711 | train_loss 6.661463e-01 | lr 8.684211e-05
05/14/2024 15:46:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   750/  4000] |  749/3832 batches | ms/batch 233.3095 | train_loss 6.656033e-01 | lr 8.552632e-05
05/14/2024 15:47:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   800/  4000] |  799/3832 batches | ms/batch 232.4111 | train_loss 6.645805e-01 | lr 8.421053e-05
05/14/2024 15:47:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   850/  4000] |  849/3832 batches | ms/batch 230.5197 | train_loss 6.640781e-01 | lr 8.289474e-05
05/14/2024 15:47:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   900/  4000] |  899/3832 batches | ms/batch 235.6870 | train_loss 6.634535e-01 | lr 8.157895e-05
05/14/2024 15:47:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   950/  4000] |  949/3832 batches | ms/batch 228.1184 | train_loss 6.624460e-01 | lr 8.026316e-05
05/14/2024 15:47:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1000/  4000] |  999/3832 batches | ms/batch 229.3917 | train_loss 6.616057e-01 | lr 7.894737e-05
05/14/2024 15:47:58 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp24t4uyio at global_step 1000 ****
05/14/2024 15:47:58 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 15:48:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1050/  4000] | 1049/3832 batches | ms/batch 230.0231 | train_loss 6.601192e-01 | lr 7.763158e-05
05/14/2024 15:48:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1100/  4000] | 1099/3832 batches | ms/batch 238.1126 | train_loss 6.592171e-01 | lr 7.631579e-05
05/14/2024 15:48:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1150/  4000] | 1149/3832 batches | ms/batch 230.5860 | train_loss 6.597678e-01 | lr 7.500000e-05
05/14/2024 15:48:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1200/  4000] | 1199/3832 batches | ms/batch 230.9613 | train_loss 6.594387e-01 | lr 7.368421e-05
05/14/2024 15:49:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1250/  4000] | 1249/3832 batches | ms/batch 244.2050 | train_loss 6.585534e-01 | lr 7.236842e-05
05/14/2024 15:49:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1300/  4000] | 1299/3832 batches | ms/batch 243.5563 | train_loss 6.590501e-01 | lr 7.105263e-05
05/14/2024 15:49:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1350/  4000] | 1349/3832 batches | ms/batch 233.5421 | train_loss 6.581780e-01 | lr 6.973684e-05
05/14/2024 15:49:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1400/  4000] | 1399/3832 batches | ms/batch 252.7160 | train_loss 6.564299e-01 | lr 6.842105e-05
05/14/2024 15:49:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1450/  4000] | 1449/3832 batches | ms/batch 246.6856 | train_loss 6.573778e-01 | lr 6.710526e-05
05/14/2024 15:50:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1500/  4000] | 1499/3832 batches | ms/batch 232.2675 | train_loss 6.583854e-01 | lr 6.578947e-05
05/14/2024 15:50:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1550/  4000] | 1549/3832 batches | ms/batch 243.1002 | train_loss 6.553483e-01 | lr 6.447368e-05
05/14/2024 15:50:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1600/  4000] | 1599/3832 batches | ms/batch 252.4571 | train_loss 6.546396e-01 | lr 6.315789e-05
05/14/2024 15:50:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1650/  4000] | 1649/3832 batches | ms/batch 240.4412 | train_loss 6.556649e-01 | lr 6.184211e-05
05/14/2024 15:51:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1700/  4000] | 1699/3832 batches | ms/batch 229.5714 | train_loss 6.549047e-01 | lr 6.052632e-05
05/14/2024 15:51:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1750/  4000] | 1749/3832 batches | ms/batch 229.9883 | train_loss 6.547064e-01 | lr 5.921053e-05
05/14/2024 15:51:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1800/  4000] | 1799/3832 batches | ms/batch 241.0185 | train_loss 6.533579e-01 | lr 5.789474e-05
05/14/2024 15:51:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1850/  4000] | 1849/3832 batches | ms/batch 246.3549 | train_loss 6.531192e-01 | lr 5.657895e-05
05/14/2024 15:51:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1900/  4000] | 1899/3832 batches | ms/batch 236.6864 | train_loss 6.538992e-01 | lr 5.526316e-05
05/14/2024 15:52:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1950/  4000] | 1949/3832 batches | ms/batch 246.8240 | train_loss 6.529281e-01 | lr 5.394737e-05
05/14/2024 15:52:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2000/  4000] | 1999/3832 batches | ms/batch 235.1814 | train_loss 6.530892e-01 | lr 5.263158e-05
05/14/2024 15:52:19 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp24t4uyio at global_step 2000 ****
05/14/2024 15:52:20 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 15:52:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2050/  4000] | 2049/3832 batches | ms/batch 252.4668 | train_loss 6.526010e-01 | lr 5.131579e-05
05/14/2024 15:52:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2100/  4000] | 2099/3832 batches | ms/batch 230.9310 | train_loss 6.528041e-01 | lr 5.000000e-05
05/14/2024 15:52:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2150/  4000] | 2149/3832 batches | ms/batch 231.6757 | train_loss 6.522289e-01 | lr 4.868421e-05
05/14/2024 15:53:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2200/  4000] | 2199/3832 batches | ms/batch 235.1892 | train_loss 6.519504e-01 | lr 4.736842e-05
05/14/2024 15:53:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2250/  4000] | 2249/3832 batches | ms/batch 243.4759 | train_loss 6.515473e-01 | lr 4.605263e-05
05/14/2024 15:53:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2300/  4000] | 2299/3832 batches | ms/batch 253.0470 | train_loss 6.510606e-01 | lr 4.473684e-05
05/14/2024 15:53:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2350/  4000] | 2349/3832 batches | ms/batch 237.7349 | train_loss 6.514194e-01 | lr 4.342105e-05
05/14/2024 15:54:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2400/  4000] | 2399/3832 batches | ms/batch 234.0507 | train_loss 6.510826e-01 | lr 4.210526e-05
05/14/2024 15:54:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2450/  4000] | 2449/3832 batches | ms/batch 239.3772 | train_loss 6.518324e-01 | lr 4.078947e-05
05/14/2024 15:54:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2500/  4000] | 2499/3832 batches | ms/batch 236.7907 | train_loss 6.514172e-01 | lr 3.947368e-05
05/14/2024 15:54:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2550/  4000] | 2549/3832 batches | ms/batch 241.8699 | train_loss 6.499497e-01 | lr 3.815789e-05
05/14/2024 15:54:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2600/  4000] | 2599/3832 batches | ms/batch 239.5264 | train_loss 6.502626e-01 | lr 3.684211e-05
05/14/2024 15:55:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2650/  4000] | 2649/3832 batches | ms/batch 242.0746 | train_loss 6.491840e-01 | lr 3.552632e-05
05/14/2024 15:55:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2700/  4000] | 2699/3832 batches | ms/batch 244.8046 | train_loss 6.501876e-01 | lr 3.421053e-05
05/14/2024 15:55:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2750/  4000] | 2749/3832 batches | ms/batch 243.1337 | train_loss 6.493116e-01 | lr 3.289474e-05
05/14/2024 15:55:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2800/  4000] | 2799/3832 batches | ms/batch 235.9685 | train_loss 6.500409e-01 | lr 3.157895e-05
05/14/2024 15:56:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2850/  4000] | 2849/3832 batches | ms/batch 248.0492 | train_loss 6.491929e-01 | lr 3.026316e-05
05/14/2024 15:56:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2900/  4000] | 2899/3832 batches | ms/batch 246.6625 | train_loss 6.479845e-01 | lr 2.894737e-05
05/14/2024 15:56:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2950/  4000] | 2949/3832 batches | ms/batch 234.4309 | train_loss 6.482425e-01 | lr 2.763158e-05
05/14/2024 15:56:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3000/  4000] | 2999/3832 batches | ms/batch 245.2253 | train_loss 6.481402e-01 | lr 2.631579e-05
05/14/2024 15:56:42 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp24t4uyio at global_step 3000 ****
05/14/2024 15:56:43 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 15:56:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3050/  4000] | 3049/3832 batches | ms/batch 241.2496 | train_loss 6.486943e-01 | lr 2.500000e-05
05/14/2024 15:57:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3100/  4000] | 3099/3832 batches | ms/batch 248.1821 | train_loss 6.476940e-01 | lr 2.368421e-05
05/14/2024 15:57:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3150/  4000] | 3149/3832 batches | ms/batch 243.3819 | train_loss 6.481102e-01 | lr 2.236842e-05
05/14/2024 15:57:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3200/  4000] | 3199/3832 batches | ms/batch 250.5219 | train_loss 6.471449e-01 | lr 2.105263e-05
05/14/2024 15:57:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3250/  4000] | 3249/3832 batches | ms/batch 238.0291 | train_loss 6.482709e-01 | lr 1.973684e-05
05/14/2024 15:58:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3300/  4000] | 3299/3832 batches | ms/batch 246.2098 | train_loss 6.475211e-01 | lr 1.842105e-05
05/14/2024 15:58:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3350/  4000] | 3349/3832 batches | ms/batch 251.4811 | train_loss 6.472983e-01 | lr 1.710526e-05
05/14/2024 15:58:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3400/  4000] | 3399/3832 batches | ms/batch 242.8421 | train_loss 6.479849e-01 | lr 1.578947e-05
05/14/2024 15:58:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3450/  4000] | 3449/3832 batches | ms/batch 250.7823 | train_loss 6.474368e-01 | lr 1.447368e-05
05/14/2024 15:58:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3500/  4000] | 3499/3832 batches | ms/batch 238.4553 | train_loss 6.464862e-01 | lr 1.315789e-05
05/14/2024 15:59:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3550/  4000] | 3549/3832 batches | ms/batch 239.5774 | train_loss 6.474229e-01 | lr 1.184211e-05
05/14/2024 15:59:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3600/  4000] | 3599/3832 batches | ms/batch 236.4901 | train_loss 6.462758e-01 | lr 1.052632e-05
05/14/2024 15:59:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3650/  4000] | 3649/3832 batches | ms/batch 236.8069 | train_loss 6.463064e-01 | lr 9.210526e-06
05/14/2024 15:59:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3700/  4000] | 3699/3832 batches | ms/batch 233.5636 | train_loss 6.458838e-01 | lr 7.894737e-06
05/14/2024 16:00:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3750/  4000] | 3749/3832 batches | ms/batch 252.5206 | train_loss 6.452872e-01 | lr 6.578947e-06
05/14/2024 16:00:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3800/  4000] | 3799/3832 batches | ms/batch 252.9745 | train_loss 6.470805e-01 | lr 5.263158e-06
05/14/2024 16:00:37 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  3850/  4000] |   17/3832 batches | ms/batch 244.4974 | train_loss 6.442138e-01 | lr 3.947368e-06
05/14/2024 16:00:50 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  3900/  4000] |   67/3832 batches | ms/batch 235.1675 | train_loss 6.419560e-01 | lr 2.631579e-06
05/14/2024 16:01:04 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  3950/  4000] |  117/3832 batches | ms/batch 254.3911 | train_loss 6.412864e-01 | lr 1.315789e-06
05/14/2024 16:01:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  4000/  4000] |  167/3832 batches | ms/batch 241.5478 | train_loss 6.415465e-01 | lr 0.000000e+00
05/14/2024 16:01:17 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp24t4uyio at global_step 4000 ****
05/14/2024 16:01:18 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 16:01:19 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23597246/tmp24t4uyio
05/14/2024 16:01:19 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((490449, 2048)) with avr_nnz=80.0
05/14/2024 16:01:19 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
05/14/2024 16:07:51 - INFO - pecos.xmc.xtransformer.matcher - Concatenating instance embeddings with features...
05/14/2024 16:08:01 - INFO - pecos.xmc.xtransformer.matcher - Start training concat_model of transformer matcher...
05/14/2024 16:08:59 - INFO - pecos.xmc.xtransformer.matcher - Using concat-only for transformer/concat ensemble of pred_csr
05/14/2024 16:09:09 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn+man at level 2, nr_labels=32768, avr_M_nnz=5.203782656300655
05/14/2024 16:09:11 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-uncased model from s3.
05/14/2024 16:09:39 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23597246/tmppk35kh8s/X_trn.pt
05/14/2024 16:09:39 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
05/14/2024 16:10:27 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
05/14/2024 16:10:27 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 4
05/14/2024 16:10:27 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
05/14/2024 16:10:27 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
/home/ul/ul_student/ul_ruw26/.local/lib/python3.9/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
05/14/2024 16:10:46 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
05/14/2024 16:10:46 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 490449
05/14/2024 16:10:46 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 32768
05/14/2024 16:10:46 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 192
05/14/2024 16:10:46 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 4
05/14/2024 16:10:46 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
05/14/2024 16:10:46 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 128
05/14/2024 16:10:46 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
05/14/2024 16:10:46 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 12000
05/14/2024 16:11:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][    50/ 12000] |   49/3832 batches | ms/batch 256.5473 | train_loss 6.577556e-01 | lr 2.500000e-05
05/14/2024 16:11:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   100/ 12000] |   99/3832 batches | ms/batch 221.5794 | train_loss 6.565373e-01 | lr 5.000000e-05
05/14/2024 16:11:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   150/ 12000] |  149/3832 batches | ms/batch 234.6103 | train_loss 6.611702e-01 | lr 7.500000e-05
05/14/2024 16:11:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   200/ 12000] |  199/3832 batches | ms/batch 243.7145 | train_loss 6.696008e-01 | lr 1.000000e-04
05/14/2024 16:11:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   250/ 12000] |  249/3832 batches | ms/batch 238.4733 | train_loss 6.695394e-01 | lr 9.957627e-05
05/14/2024 16:12:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   300/ 12000] |  299/3832 batches | ms/batch 234.8078 | train_loss 6.775862e-01 | lr 9.915254e-05
05/14/2024 16:12:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   350/ 12000] |  349/3832 batches | ms/batch 251.3537 | train_loss 6.651034e-01 | lr 9.872881e-05
05/14/2024 16:12:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   400/ 12000] |  399/3832 batches | ms/batch 233.7270 | train_loss 6.717065e-01 | lr 9.830508e-05
05/14/2024 16:12:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   450/ 12000] |  449/3832 batches | ms/batch 239.5871 | train_loss 6.709133e-01 | lr 9.788136e-05
05/14/2024 16:13:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   500/ 12000] |  499/3832 batches | ms/batch 243.9065 | train_loss 6.687934e-01 | lr 9.745763e-05
05/14/2024 16:13:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   550/ 12000] |  549/3832 batches | ms/batch 236.2728 | train_loss 6.674971e-01 | lr 9.703390e-05
05/14/2024 16:13:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   600/ 12000] |  599/3832 batches | ms/batch 232.0866 | train_loss 6.687257e-01 | lr 9.661017e-05
05/14/2024 16:13:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   650/ 12000] |  649/3832 batches | ms/batch 245.2255 | train_loss 6.644556e-01 | lr 9.618644e-05
05/14/2024 16:13:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   700/ 12000] |  699/3832 batches | ms/batch 239.9196 | train_loss 6.633591e-01 | lr 9.576271e-05
05/14/2024 16:14:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   750/ 12000] |  749/3832 batches | ms/batch 245.8884 | train_loss 6.631742e-01 | lr 9.533898e-05
05/14/2024 16:14:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   800/ 12000] |  799/3832 batches | ms/batch 268.7053 | train_loss 6.623809e-01 | lr 9.491525e-05
05/14/2024 16:14:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   850/ 12000] |  849/3832 batches | ms/batch 251.0016 | train_loss 6.647954e-01 | lr 9.449153e-05
05/14/2024 16:14:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   900/ 12000] |  899/3832 batches | ms/batch 237.1235 | train_loss 6.594450e-01 | lr 9.406780e-05
05/14/2024 16:15:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][   950/ 12000] |  949/3832 batches | ms/batch 246.6436 | train_loss 6.624157e-01 | lr 9.364407e-05
05/14/2024 16:15:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1000/ 12000] |  999/3832 batches | ms/batch 233.1980 | train_loss 6.596952e-01 | lr 9.322034e-05
05/14/2024 16:15:18 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp8_qnwwaw at global_step 1000 ****
05/14/2024 16:15:19 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 16:15:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1050/ 12000] | 1049/3832 batches | ms/batch 245.0130 | train_loss 6.595101e-01 | lr 9.279661e-05
05/14/2024 16:15:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1100/ 12000] | 1099/3832 batches | ms/batch 240.1054 | train_loss 6.593189e-01 | lr 9.237288e-05
05/14/2024 16:15:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1150/ 12000] | 1149/3832 batches | ms/batch 232.2923 | train_loss 6.591162e-01 | lr 9.194915e-05
05/14/2024 16:16:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1200/ 12000] | 1199/3832 batches | ms/batch 237.7079 | train_loss 6.597297e-01 | lr 9.152542e-05
05/14/2024 16:16:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1250/ 12000] | 1249/3832 batches | ms/batch 241.5812 | train_loss 6.543655e-01 | lr 9.110169e-05
05/14/2024 16:16:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1300/ 12000] | 1299/3832 batches | ms/batch 239.7477 | train_loss 6.574955e-01 | lr 9.067797e-05
05/14/2024 16:16:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1350/ 12000] | 1349/3832 batches | ms/batch 254.2878 | train_loss 6.584785e-01 | lr 9.025424e-05
05/14/2024 16:17:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1400/ 12000] | 1399/3832 batches | ms/batch 246.1234 | train_loss 6.564270e-01 | lr 8.983051e-05
05/14/2024 16:17:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1450/ 12000] | 1449/3832 batches | ms/batch 237.8415 | train_loss 6.576384e-01 | lr 8.940678e-05
05/14/2024 16:17:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1500/ 12000] | 1499/3832 batches | ms/batch 252.3477 | train_loss 6.556518e-01 | lr 8.898305e-05
05/14/2024 16:17:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1550/ 12000] | 1549/3832 batches | ms/batch 246.1804 | train_loss 6.568335e-01 | lr 8.855932e-05
05/14/2024 16:17:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1600/ 12000] | 1599/3832 batches | ms/batch 234.6031 | train_loss 6.536742e-01 | lr 8.813559e-05
05/14/2024 16:18:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1650/ 12000] | 1649/3832 batches | ms/batch 237.8736 | train_loss 6.545218e-01 | lr 8.771186e-05
05/14/2024 16:18:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1700/ 12000] | 1699/3832 batches | ms/batch 246.2346 | train_loss 6.538540e-01 | lr 8.728814e-05
05/14/2024 16:18:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1750/ 12000] | 1749/3832 batches | ms/batch 232.7109 | train_loss 6.532709e-01 | lr 8.686441e-05
05/14/2024 16:18:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1800/ 12000] | 1799/3832 batches | ms/batch 242.3296 | train_loss 6.534612e-01 | lr 8.644068e-05
05/14/2024 16:19:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1850/ 12000] | 1849/3832 batches | ms/batch 238.8313 | train_loss 6.528534e-01 | lr 8.601695e-05
05/14/2024 16:19:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1900/ 12000] | 1899/3832 batches | ms/batch 243.5237 | train_loss 6.521844e-01 | lr 8.559322e-05
05/14/2024 16:19:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  1950/ 12000] | 1949/3832 batches | ms/batch 258.0516 | train_loss 6.518590e-01 | lr 8.516949e-05
05/14/2024 16:19:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2000/ 12000] | 1999/3832 batches | ms/batch 246.0767 | train_loss 6.525642e-01 | lr 8.474576e-05
05/14/2024 16:19:46 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp8_qnwwaw at global_step 2000 ****
05/14/2024 16:19:47 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 16:20:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2050/ 12000] | 2049/3832 batches | ms/batch 237.2568 | train_loss 6.514359e-01 | lr 8.432203e-05
05/14/2024 16:20:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2100/ 12000] | 2099/3832 batches | ms/batch 248.0932 | train_loss 6.503779e-01 | lr 8.389831e-05
05/14/2024 16:20:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2150/ 12000] | 2149/3832 batches | ms/batch 333.4401 | train_loss 6.487142e-01 | lr 8.347458e-05
05/14/2024 16:20:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2200/ 12000] | 2199/3832 batches | ms/batch 301.2725 | train_loss 6.475747e-01 | lr 8.305085e-05
05/14/2024 16:21:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2250/ 12000] | 2249/3832 batches | ms/batch 250.4763 | train_loss 6.491846e-01 | lr 8.262712e-05
05/14/2024 16:21:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2300/ 12000] | 2299/3832 batches | ms/batch 247.5958 | train_loss 6.502714e-01 | lr 8.220339e-05
05/14/2024 16:21:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2350/ 12000] | 2349/3832 batches | ms/batch 246.8688 | train_loss 6.481367e-01 | lr 8.177966e-05
05/14/2024 16:21:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2400/ 12000] | 2399/3832 batches | ms/batch 260.1827 | train_loss 6.480556e-01 | lr 8.135593e-05
05/14/2024 16:21:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2450/ 12000] | 2449/3832 batches | ms/batch 264.4497 | train_loss 6.484397e-01 | lr 8.093220e-05
05/14/2024 16:22:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2500/ 12000] | 2499/3832 batches | ms/batch 274.5015 | train_loss 6.460232e-01 | lr 8.050847e-05
05/14/2024 16:22:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2550/ 12000] | 2549/3832 batches | ms/batch 260.2485 | train_loss 6.482079e-01 | lr 8.008475e-05
05/14/2024 16:22:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2600/ 12000] | 2599/3832 batches | ms/batch 229.4935 | train_loss 6.460311e-01 | lr 7.966102e-05
05/14/2024 16:22:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2650/ 12000] | 2649/3832 batches | ms/batch 240.3402 | train_loss 6.465871e-01 | lr 7.923729e-05
05/14/2024 16:23:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2700/ 12000] | 2699/3832 batches | ms/batch 237.1789 | train_loss 6.458874e-01 | lr 7.881356e-05
05/14/2024 16:23:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2750/ 12000] | 2749/3832 batches | ms/batch 245.3366 | train_loss 6.449513e-01 | lr 7.838983e-05
05/14/2024 16:23:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2800/ 12000] | 2799/3832 batches | ms/batch 243.1978 | train_loss 6.472546e-01 | lr 7.796610e-05
05/14/2024 16:23:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2850/ 12000] | 2849/3832 batches | ms/batch 234.8372 | train_loss 6.453427e-01 | lr 7.754237e-05
05/14/2024 16:24:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2900/ 12000] | 2899/3832 batches | ms/batch 231.2176 | train_loss 6.437071e-01 | lr 7.711864e-05
05/14/2024 16:24:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  2950/ 12000] | 2949/3832 batches | ms/batch 245.3300 | train_loss 6.441185e-01 | lr 7.669492e-05
05/14/2024 16:24:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3000/ 12000] | 2999/3832 batches | ms/batch 244.7981 | train_loss 6.427196e-01 | lr 7.627119e-05
05/14/2024 16:24:27 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp8_qnwwaw at global_step 3000 ****
05/14/2024 16:24:29 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 16:24:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3050/ 12000] | 3049/3832 batches | ms/batch 241.9742 | train_loss 6.434738e-01 | lr 7.584746e-05
05/14/2024 16:24:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3100/ 12000] | 3099/3832 batches | ms/batch 243.5696 | train_loss 6.429933e-01 | lr 7.542373e-05
05/14/2024 16:25:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3150/ 12000] | 3149/3832 batches | ms/batch 234.7524 | train_loss 6.438252e-01 | lr 7.500000e-05
05/14/2024 16:25:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3200/ 12000] | 3199/3832 batches | ms/batch 236.9141 | train_loss 6.449249e-01 | lr 7.457627e-05
05/14/2024 16:25:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3250/ 12000] | 3249/3832 batches | ms/batch 244.2913 | train_loss 6.428248e-01 | lr 7.415254e-05
05/14/2024 16:25:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3300/ 12000] | 3299/3832 batches | ms/batch 256.6222 | train_loss 6.423391e-01 | lr 7.372881e-05
05/14/2024 16:26:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3350/ 12000] | 3349/3832 batches | ms/batch 267.0984 | train_loss 6.416098e-01 | lr 7.330508e-05
05/14/2024 16:26:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3400/ 12000] | 3399/3832 batches | ms/batch 258.1202 | train_loss 6.417732e-01 | lr 7.288136e-05
05/14/2024 16:26:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3450/ 12000] | 3449/3832 batches | ms/batch 265.7023 | train_loss 6.399837e-01 | lr 7.245763e-05
05/14/2024 16:26:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3500/ 12000] | 3499/3832 batches | ms/batch 260.8599 | train_loss 6.407734e-01 | lr 7.203390e-05
05/14/2024 16:27:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3550/ 12000] | 3549/3832 batches | ms/batch 256.1353 | train_loss 6.404357e-01 | lr 7.161017e-05
05/14/2024 16:27:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3600/ 12000] | 3599/3832 batches | ms/batch 263.0413 | train_loss 6.390292e-01 | lr 7.118644e-05
05/14/2024 16:27:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3650/ 12000] | 3649/3832 batches | ms/batch 261.1028 | train_loss 6.403697e-01 | lr 7.076271e-05
05/14/2024 16:27:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3700/ 12000] | 3699/3832 batches | ms/batch 257.5047 | train_loss 6.401816e-01 | lr 7.033898e-05
05/14/2024 16:27:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3750/ 12000] | 3749/3832 batches | ms/batch 253.5263 | train_loss 6.396709e-01 | lr 6.991525e-05
05/14/2024 16:28:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   4][  3800/ 12000] | 3799/3832 batches | ms/batch 261.4632 | train_loss 6.408155e-01 | lr 6.949153e-05
05/14/2024 16:28:35 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  3850/ 12000] |   17/3832 batches | ms/batch 274.1536 | train_loss 6.341790e-01 | lr 6.906780e-05
05/14/2024 16:28:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  3900/ 12000] |   67/3832 batches | ms/batch 262.5391 | train_loss 6.251044e-01 | lr 6.864407e-05
05/14/2024 16:29:04 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  3950/ 12000] |  117/3832 batches | ms/batch 269.5881 | train_loss 6.267678e-01 | lr 6.822034e-05
05/14/2024 16:29:18 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4000/ 12000] |  167/3832 batches | ms/batch 264.9021 | train_loss 6.280804e-01 | lr 6.779661e-05
05/14/2024 16:29:18 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp8_qnwwaw at global_step 4000 ****
05/14/2024 16:29:19 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 16:29:33 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4050/ 12000] |  217/3832 batches | ms/batch 246.9862 | train_loss 6.263832e-01 | lr 6.737288e-05
05/14/2024 16:29:46 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4100/ 12000] |  267/3832 batches | ms/batch 238.0026 | train_loss 6.271756e-01 | lr 6.694915e-05
05/14/2024 16:29:58 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4150/ 12000] |  317/3832 batches | ms/batch 228.8691 | train_loss 6.267321e-01 | lr 6.652542e-05
05/14/2024 16:30:12 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4200/ 12000] |  367/3832 batches | ms/batch 246.4516 | train_loss 6.265042e-01 | lr 6.610169e-05
05/14/2024 16:30:25 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4250/ 12000] |  417/3832 batches | ms/batch 246.7649 | train_loss 6.259799e-01 | lr 6.567797e-05
05/14/2024 16:30:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4300/ 12000] |  467/3832 batches | ms/batch 233.0100 | train_loss 6.255087e-01 | lr 6.525424e-05
05/14/2024 16:30:51 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4350/ 12000] |  517/3832 batches | ms/batch 240.5911 | train_loss 6.258754e-01 | lr 6.483051e-05
05/14/2024 16:31:04 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4400/ 12000] |  567/3832 batches | ms/batch 239.6362 | train_loss 6.273719e-01 | lr 6.440678e-05
05/14/2024 16:31:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4450/ 12000] |  617/3832 batches | ms/batch 233.0214 | train_loss 6.264606e-01 | lr 6.398305e-05
05/14/2024 16:31:30 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4500/ 12000] |  667/3832 batches | ms/batch 232.3477 | train_loss 6.261350e-01 | lr 6.355932e-05
05/14/2024 16:31:43 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4550/ 12000] |  717/3832 batches | ms/batch 239.9937 | train_loss 6.264752e-01 | lr 6.313559e-05
05/14/2024 16:31:56 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4600/ 12000] |  767/3832 batches | ms/batch 236.3958 | train_loss 6.258745e-01 | lr 6.271186e-05
05/14/2024 16:32:09 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4650/ 12000] |  817/3832 batches | ms/batch 231.1398 | train_loss 6.259262e-01 | lr 6.228814e-05
05/14/2024 16:32:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4700/ 12000] |  867/3832 batches | ms/batch 246.8820 | train_loss 6.248044e-01 | lr 6.186441e-05
05/14/2024 16:32:35 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4750/ 12000] |  917/3832 batches | ms/batch 241.3730 | train_loss 6.253392e-01 | lr 6.144068e-05
05/14/2024 16:32:48 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4800/ 12000] |  967/3832 batches | ms/batch 231.1115 | train_loss 6.260340e-01 | lr 6.101695e-05
05/14/2024 16:33:01 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4850/ 12000] | 1017/3832 batches | ms/batch 240.9382 | train_loss 6.266144e-01 | lr 6.059322e-05
05/14/2024 16:33:14 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4900/ 12000] | 1067/3832 batches | ms/batch 237.5693 | train_loss 6.253972e-01 | lr 6.016949e-05
05/14/2024 16:33:27 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  4950/ 12000] | 1117/3832 batches | ms/batch 241.3921 | train_loss 6.250083e-01 | lr 5.974576e-05
05/14/2024 16:33:40 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5000/ 12000] | 1167/3832 batches | ms/batch 231.8659 | train_loss 6.253704e-01 | lr 5.932203e-05
05/14/2024 16:33:40 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp8_qnwwaw at global_step 5000 ****
05/14/2024 16:33:40 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 16:33:54 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5050/ 12000] | 1217/3832 batches | ms/batch 246.3950 | train_loss 6.244077e-01 | lr 5.889831e-05
05/14/2024 16:34:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5100/ 12000] | 1267/3832 batches | ms/batch 234.1865 | train_loss 6.252010e-01 | lr 5.847458e-05
05/14/2024 16:34:19 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5150/ 12000] | 1317/3832 batches | ms/batch 228.8080 | train_loss 6.244477e-01 | lr 5.805085e-05
05/14/2024 16:34:32 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5200/ 12000] | 1367/3832 batches | ms/batch 231.3021 | train_loss 6.239679e-01 | lr 5.762712e-05
05/14/2024 16:34:45 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5250/ 12000] | 1417/3832 batches | ms/batch 243.5070 | train_loss 6.238456e-01 | lr 5.720339e-05
05/14/2024 16:34:58 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5300/ 12000] | 1467/3832 batches | ms/batch 236.1193 | train_loss 6.241595e-01 | lr 5.677966e-05
05/14/2024 16:35:11 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5350/ 12000] | 1517/3832 batches | ms/batch 237.5830 | train_loss 6.242511e-01 | lr 5.635593e-05
05/14/2024 16:35:24 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5400/ 12000] | 1567/3832 batches | ms/batch 238.6334 | train_loss 6.239506e-01 | lr 5.593220e-05
05/14/2024 16:35:37 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5450/ 12000] | 1617/3832 batches | ms/batch 230.2065 | train_loss 6.234241e-01 | lr 5.550847e-05
05/14/2024 16:35:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5500/ 12000] | 1667/3832 batches | ms/batch 224.6802 | train_loss 6.234816e-01 | lr 5.508475e-05
05/14/2024 16:36:03 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5550/ 12000] | 1717/3832 batches | ms/batch 244.0795 | train_loss 6.229219e-01 | lr 5.466102e-05
05/14/2024 16:36:16 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5600/ 12000] | 1767/3832 batches | ms/batch 244.0385 | train_loss 6.228619e-01 | lr 5.423729e-05
05/14/2024 16:36:29 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5650/ 12000] | 1817/3832 batches | ms/batch 235.2313 | train_loss 6.233148e-01 | lr 5.381356e-05
05/14/2024 16:36:42 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5700/ 12000] | 1867/3832 batches | ms/batch 244.3076 | train_loss 6.225584e-01 | lr 5.338983e-05
05/14/2024 16:36:55 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5750/ 12000] | 1917/3832 batches | ms/batch 241.6640 | train_loss 6.245292e-01 | lr 5.296610e-05
05/14/2024 16:37:08 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5800/ 12000] | 1967/3832 batches | ms/batch 240.8008 | train_loss 6.239389e-01 | lr 5.254237e-05
05/14/2024 16:37:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5850/ 12000] | 2017/3832 batches | ms/batch 248.7534 | train_loss 6.234364e-01 | lr 5.211864e-05
05/14/2024 16:37:36 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5900/ 12000] | 2067/3832 batches | ms/batch 251.0967 | train_loss 6.219613e-01 | lr 5.169492e-05
05/14/2024 16:37:48 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  5950/ 12000] | 2117/3832 batches | ms/batch 229.5031 | train_loss 6.219933e-01 | lr 5.127119e-05
05/14/2024 16:38:02 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6000/ 12000] | 2167/3832 batches | ms/batch 246.1744 | train_loss 6.219834e-01 | lr 5.084746e-05
05/14/2024 16:38:02 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp8_qnwwaw at global_step 6000 ****
05/14/2024 16:38:02 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 16:38:16 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6050/ 12000] | 2217/3832 batches | ms/batch 244.7904 | train_loss 6.224925e-01 | lr 5.042373e-05
05/14/2024 16:38:29 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6100/ 12000] | 2267/3832 batches | ms/batch 238.4891 | train_loss 6.218403e-01 | lr 5.000000e-05
05/14/2024 16:38:43 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6150/ 12000] | 2317/3832 batches | ms/batch 250.9956 | train_loss 6.214254e-01 | lr 4.957627e-05
05/14/2024 16:38:56 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6200/ 12000] | 2367/3832 batches | ms/batch 237.1411 | train_loss 6.219069e-01 | lr 4.915254e-05
05/14/2024 16:39:08 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6250/ 12000] | 2417/3832 batches | ms/batch 236.6240 | train_loss 6.227935e-01 | lr 4.872881e-05
05/14/2024 16:39:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6300/ 12000] | 2467/3832 batches | ms/batch 240.5577 | train_loss 6.212636e-01 | lr 4.830508e-05
05/14/2024 16:39:35 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6350/ 12000] | 2517/3832 batches | ms/batch 246.4106 | train_loss 6.215255e-01 | lr 4.788136e-05
05/14/2024 16:39:48 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6400/ 12000] | 2567/3832 batches | ms/batch 232.2125 | train_loss 6.201750e-01 | lr 4.745763e-05
05/14/2024 16:40:01 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6450/ 12000] | 2617/3832 batches | ms/batch 233.4363 | train_loss 6.205999e-01 | lr 4.703390e-05
05/14/2024 16:40:13 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6500/ 12000] | 2667/3832 batches | ms/batch 230.8263 | train_loss 6.204301e-01 | lr 4.661017e-05
05/14/2024 16:40:27 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6550/ 12000] | 2717/3832 batches | ms/batch 239.6006 | train_loss 6.200995e-01 | lr 4.618644e-05
05/14/2024 16:40:39 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6600/ 12000] | 2767/3832 batches | ms/batch 231.8969 | train_loss 6.214326e-01 | lr 4.576271e-05
05/14/2024 16:40:53 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6650/ 12000] | 2817/3832 batches | ms/batch 247.6448 | train_loss 6.207121e-01 | lr 4.533898e-05
05/14/2024 16:41:06 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6700/ 12000] | 2867/3832 batches | ms/batch 242.2890 | train_loss 6.189213e-01 | lr 4.491525e-05
05/14/2024 16:41:19 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6750/ 12000] | 2917/3832 batches | ms/batch 232.6738 | train_loss 6.205637e-01 | lr 4.449153e-05
05/14/2024 16:41:32 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6800/ 12000] | 2967/3832 batches | ms/batch 233.8928 | train_loss 6.200030e-01 | lr 4.406780e-05
05/14/2024 16:41:45 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6850/ 12000] | 3017/3832 batches | ms/batch 244.3805 | train_loss 6.186422e-01 | lr 4.364407e-05
05/14/2024 16:41:58 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6900/ 12000] | 3067/3832 batches | ms/batch 233.6772 | train_loss 6.196400e-01 | lr 4.322034e-05
05/14/2024 16:42:11 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  6950/ 12000] | 3117/3832 batches | ms/batch 241.7996 | train_loss 6.202883e-01 | lr 4.279661e-05
05/14/2024 16:42:24 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7000/ 12000] | 3167/3832 batches | ms/batch 238.4969 | train_loss 6.196628e-01 | lr 4.237288e-05
05/14/2024 16:42:24 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp8_qnwwaw at global_step 7000 ****
05/14/2024 16:42:25 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 16:42:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7050/ 12000] | 3217/3832 batches | ms/batch 233.6700 | train_loss 6.187724e-01 | lr 4.194915e-05
05/14/2024 16:42:51 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7100/ 12000] | 3267/3832 batches | ms/batch 243.8201 | train_loss 6.185478e-01 | lr 4.152542e-05
05/14/2024 16:43:05 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7150/ 12000] | 3317/3832 batches | ms/batch 243.8409 | train_loss 6.193372e-01 | lr 4.110169e-05
05/14/2024 16:43:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7200/ 12000] | 3367/3832 batches | ms/batch 233.6777 | train_loss 6.204371e-01 | lr 4.067797e-05
05/14/2024 16:43:31 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7250/ 12000] | 3417/3832 batches | ms/batch 239.1503 | train_loss 6.185837e-01 | lr 4.025424e-05
05/14/2024 16:43:44 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7300/ 12000] | 3467/3832 batches | ms/batch 234.6153 | train_loss 6.186952e-01 | lr 3.983051e-05
05/14/2024 16:43:57 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7350/ 12000] | 3517/3832 batches | ms/batch 240.8025 | train_loss 6.184154e-01 | lr 3.940678e-05
05/14/2024 16:44:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7400/ 12000] | 3567/3832 batches | ms/batch 240.8466 | train_loss 6.174010e-01 | lr 3.898305e-05
05/14/2024 16:44:23 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7450/ 12000] | 3617/3832 batches | ms/batch 241.8929 | train_loss 6.180466e-01 | lr 3.855932e-05
05/14/2024 16:44:36 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7500/ 12000] | 3667/3832 batches | ms/batch 237.2041 | train_loss 6.173346e-01 | lr 3.813559e-05
05/14/2024 16:44:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7550/ 12000] | 3717/3832 batches | ms/batch 234.0479 | train_loss 6.173989e-01 | lr 3.771186e-05
05/14/2024 16:45:02 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7600/ 12000] | 3767/3832 batches | ms/batch 241.2005 | train_loss 6.171787e-01 | lr 3.728814e-05
05/14/2024 16:45:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   4][  7650/ 12000] | 3817/3832 batches | ms/batch 236.2442 | train_loss 6.171994e-01 | lr 3.686441e-05
05/14/2024 16:45:36 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  7700/ 12000] |   35/3832 batches | ms/batch 229.0030 | train_loss 6.103756e-01 | lr 3.644068e-05
05/14/2024 16:45:49 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  7750/ 12000] |   85/3832 batches | ms/batch 237.4206 | train_loss 6.075634e-01 | lr 3.601695e-05
05/14/2024 16:46:03 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  7800/ 12000] |  135/3832 batches | ms/batch 249.8414 | train_loss 6.065615e-01 | lr 3.559322e-05
05/14/2024 16:46:16 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  7850/ 12000] |  185/3832 batches | ms/batch 237.7778 | train_loss 6.065689e-01 | lr 3.516949e-05
05/14/2024 16:46:29 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  7900/ 12000] |  235/3832 batches | ms/batch 238.7268 | train_loss 6.067200e-01 | lr 3.474576e-05
05/14/2024 16:46:43 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  7950/ 12000] |  285/3832 batches | ms/batch 251.8574 | train_loss 6.075367e-01 | lr 3.432203e-05
05/14/2024 16:46:56 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8000/ 12000] |  335/3832 batches | ms/batch 238.8987 | train_loss 6.078741e-01 | lr 3.389831e-05
05/14/2024 16:46:56 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp8_qnwwaw at global_step 8000 ****
05/14/2024 16:46:56 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 16:47:09 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8050/ 12000] |  385/3832 batches | ms/batch 230.1110 | train_loss 6.073558e-01 | lr 3.347458e-05
05/14/2024 16:47:23 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8100/ 12000] |  435/3832 batches | ms/batch 245.2283 | train_loss 6.068846e-01 | lr 3.305085e-05
05/14/2024 16:47:35 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8150/ 12000] |  485/3832 batches | ms/batch 238.2564 | train_loss 6.069168e-01 | lr 3.262712e-05
05/14/2024 16:47:48 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8200/ 12000] |  535/3832 batches | ms/batch 234.5919 | train_loss 6.068982e-01 | lr 3.220339e-05
05/14/2024 16:48:02 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8250/ 12000] |  585/3832 batches | ms/batch 246.4197 | train_loss 6.068067e-01 | lr 3.177966e-05
05/14/2024 16:48:15 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8300/ 12000] |  635/3832 batches | ms/batch 246.2871 | train_loss 6.076670e-01 | lr 3.135593e-05
05/14/2024 16:48:28 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8350/ 12000] |  685/3832 batches | ms/batch 230.7513 | train_loss 6.076921e-01 | lr 3.093220e-05
05/14/2024 16:48:41 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8400/ 12000] |  735/3832 batches | ms/batch 235.0346 | train_loss 6.079696e-01 | lr 3.050847e-05
05/14/2024 16:48:54 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8450/ 12000] |  785/3832 batches | ms/batch 248.0910 | train_loss 6.063206e-01 | lr 3.008475e-05
05/14/2024 16:49:07 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8500/ 12000] |  835/3832 batches | ms/batch 237.9883 | train_loss 6.073847e-01 | lr 2.966102e-05
05/14/2024 16:49:21 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8550/ 12000] |  885/3832 batches | ms/batch 246.4158 | train_loss 6.074670e-01 | lr 2.923729e-05
05/14/2024 16:49:35 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8600/ 12000] |  935/3832 batches | ms/batch 253.1375 | train_loss 6.063969e-01 | lr 2.881356e-05
05/14/2024 16:49:47 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8650/ 12000] |  985/3832 batches | ms/batch 232.5628 | train_loss 6.069921e-01 | lr 2.838983e-05
05/14/2024 16:50:01 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8700/ 12000] | 1035/3832 batches | ms/batch 239.8717 | train_loss 6.061029e-01 | lr 2.796610e-05
05/14/2024 16:50:14 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8750/ 12000] | 1085/3832 batches | ms/batch 246.0974 | train_loss 6.074015e-01 | lr 2.754237e-05
05/14/2024 16:50:27 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8800/ 12000] | 1135/3832 batches | ms/batch 241.7385 | train_loss 6.066445e-01 | lr 2.711864e-05
05/14/2024 16:50:40 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8850/ 12000] | 1185/3832 batches | ms/batch 238.5564 | train_loss 6.062001e-01 | lr 2.669492e-05
05/14/2024 16:50:53 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8900/ 12000] | 1235/3832 batches | ms/batch 241.3965 | train_loss 6.068646e-01 | lr 2.627119e-05
05/14/2024 16:51:06 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  8950/ 12000] | 1285/3832 batches | ms/batch 237.3732 | train_loss 6.059140e-01 | lr 2.584746e-05
05/14/2024 16:51:20 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9000/ 12000] | 1335/3832 batches | ms/batch 242.0319 | train_loss 6.059096e-01 | lr 2.542373e-05
05/14/2024 16:51:20 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp8_qnwwaw at global_step 9000 ****
05/14/2024 16:51:20 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 16:51:34 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9050/ 12000] | 1385/3832 batches | ms/batch 252.7713 | train_loss 6.059471e-01 | lr 2.500000e-05
05/14/2024 16:51:47 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9100/ 12000] | 1435/3832 batches | ms/batch 239.8676 | train_loss 6.064649e-01 | lr 2.457627e-05
05/14/2024 16:52:00 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9150/ 12000] | 1485/3832 batches | ms/batch 235.4761 | train_loss 6.061378e-01 | lr 2.415254e-05
05/14/2024 16:52:14 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9200/ 12000] | 1535/3832 batches | ms/batch 251.1443 | train_loss 6.064351e-01 | lr 2.372881e-05
05/14/2024 16:52:27 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9250/ 12000] | 1585/3832 batches | ms/batch 244.8577 | train_loss 6.052063e-01 | lr 2.330508e-05
05/14/2024 16:52:40 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9300/ 12000] | 1635/3832 batches | ms/batch 238.3774 | train_loss 6.058942e-01 | lr 2.288136e-05
05/14/2024 16:52:53 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9350/ 12000] | 1685/3832 batches | ms/batch 238.1104 | train_loss 6.051621e-01 | lr 2.245763e-05
05/14/2024 16:53:06 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9400/ 12000] | 1735/3832 batches | ms/batch 237.0274 | train_loss 6.057203e-01 | lr 2.203390e-05
05/14/2024 16:53:19 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9450/ 12000] | 1785/3832 batches | ms/batch 234.4071 | train_loss 6.046339e-01 | lr 2.161017e-05
05/14/2024 16:53:33 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9500/ 12000] | 1835/3832 batches | ms/batch 254.7585 | train_loss 6.051637e-01 | lr 2.118644e-05
05/14/2024 16:53:46 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9550/ 12000] | 1885/3832 batches | ms/batch 244.7288 | train_loss 6.060081e-01 | lr 2.076271e-05
05/14/2024 16:54:00 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9600/ 12000] | 1935/3832 batches | ms/batch 240.5572 | train_loss 6.047168e-01 | lr 2.033898e-05
05/14/2024 16:54:13 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9650/ 12000] | 1985/3832 batches | ms/batch 247.1785 | train_loss 6.051062e-01 | lr 1.991525e-05
05/14/2024 16:54:26 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9700/ 12000] | 2035/3832 batches | ms/batch 241.9190 | train_loss 6.054960e-01 | lr 1.949153e-05
05/14/2024 16:54:39 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9750/ 12000] | 2085/3832 batches | ms/batch 235.9769 | train_loss 6.043712e-01 | lr 1.906780e-05
05/14/2024 16:54:53 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9800/ 12000] | 2135/3832 batches | ms/batch 248.4487 | train_loss 6.050504e-01 | lr 1.864407e-05
05/14/2024 16:55:06 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9850/ 12000] | 2185/3832 batches | ms/batch 241.4605 | train_loss 6.048484e-01 | lr 1.822034e-05
05/14/2024 16:55:18 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9900/ 12000] | 2235/3832 batches | ms/batch 231.0477 | train_loss 6.038653e-01 | lr 1.779661e-05
05/14/2024 16:55:32 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][  9950/ 12000] | 2285/3832 batches | ms/batch 247.8992 | train_loss 6.050144e-01 | lr 1.737288e-05
05/14/2024 16:55:46 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10000/ 12000] | 2335/3832 batches | ms/batch 250.3514 | train_loss 6.035727e-01 | lr 1.694915e-05
05/14/2024 16:55:46 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp8_qnwwaw at global_step 10000 ****
05/14/2024 16:55:46 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 16:55:59 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10050/ 12000] | 2385/3832 batches | ms/batch 237.2275 | train_loss 6.047207e-01 | lr 1.652542e-05
05/14/2024 16:56:13 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10100/ 12000] | 2435/3832 batches | ms/batch 244.7046 | train_loss 6.044103e-01 | lr 1.610169e-05
05/14/2024 16:56:26 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10150/ 12000] | 2485/3832 batches | ms/batch 246.0606 | train_loss 6.042303e-01 | lr 1.567797e-05
05/14/2024 16:56:39 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10200/ 12000] | 2535/3832 batches | ms/batch 237.4791 | train_loss 6.055566e-01 | lr 1.525424e-05
05/14/2024 16:56:52 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10250/ 12000] | 2585/3832 batches | ms/batch 240.4770 | train_loss 6.043133e-01 | lr 1.483051e-05
05/14/2024 16:57:06 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10300/ 12000] | 2635/3832 batches | ms/batch 248.8236 | train_loss 6.040494e-01 | lr 1.440678e-05
05/14/2024 16:57:19 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10350/ 12000] | 2685/3832 batches | ms/batch 240.1196 | train_loss 6.042913e-01 | lr 1.398305e-05
05/14/2024 16:57:32 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10400/ 12000] | 2735/3832 batches | ms/batch 244.3843 | train_loss 6.037045e-01 | lr 1.355932e-05
05/14/2024 16:57:46 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10450/ 12000] | 2785/3832 batches | ms/batch 250.5344 | train_loss 6.039197e-01 | lr 1.313559e-05
05/14/2024 16:57:59 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10500/ 12000] | 2835/3832 batches | ms/batch 240.9534 | train_loss 6.034207e-01 | lr 1.271186e-05
05/14/2024 16:58:12 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10550/ 12000] | 2885/3832 batches | ms/batch 242.8869 | train_loss 6.033859e-01 | lr 1.228814e-05
05/14/2024 16:58:26 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10600/ 12000] | 2935/3832 batches | ms/batch 251.4853 | train_loss 6.031137e-01 | lr 1.186441e-05
05/14/2024 16:58:38 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10650/ 12000] | 2985/3832 batches | ms/batch 230.6902 | train_loss 6.037940e-01 | lr 1.144068e-05
05/14/2024 16:58:52 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10700/ 12000] | 3035/3832 batches | ms/batch 248.7317 | train_loss 6.040716e-01 | lr 1.101695e-05
05/14/2024 16:59:05 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10750/ 12000] | 3085/3832 batches | ms/batch 249.2528 | train_loss 6.029106e-01 | lr 1.059322e-05
05/14/2024 16:59:18 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10800/ 12000] | 3135/3832 batches | ms/batch 238.1453 | train_loss 6.036834e-01 | lr 1.016949e-05
05/14/2024 16:59:32 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10850/ 12000] | 3185/3832 batches | ms/batch 251.3868 | train_loss 6.039405e-01 | lr 9.745763e-06
05/14/2024 16:59:45 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10900/ 12000] | 3235/3832 batches | ms/batch 241.0444 | train_loss 6.033903e-01 | lr 9.322034e-06
05/14/2024 16:59:58 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 10950/ 12000] | 3285/3832 batches | ms/batch 239.8351 | train_loss 6.022043e-01 | lr 8.898305e-06
05/14/2024 17:00:12 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11000/ 12000] | 3335/3832 batches | ms/batch 249.1113 | train_loss 6.023853e-01 | lr 8.474576e-06
05/14/2024 17:00:12 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp8_qnwwaw at global_step 11000 ****
05/14/2024 17:00:13 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 17:00:26 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11050/ 12000] | 3385/3832 batches | ms/batch 239.9404 | train_loss 6.025508e-01 | lr 8.050847e-06
05/14/2024 17:00:38 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11100/ 12000] | 3435/3832 batches | ms/batch 229.6731 | train_loss 6.027787e-01 | lr 7.627119e-06
05/14/2024 17:00:52 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11150/ 12000] | 3485/3832 batches | ms/batch 244.4848 | train_loss 6.030517e-01 | lr 7.203390e-06
05/14/2024 17:01:06 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11200/ 12000] | 3535/3832 batches | ms/batch 251.5593 | train_loss 6.033941e-01 | lr 6.779661e-06
05/14/2024 17:01:18 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11250/ 12000] | 3585/3832 batches | ms/batch 235.4950 | train_loss 6.029897e-01 | lr 6.355932e-06
05/14/2024 17:01:32 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11300/ 12000] | 3635/3832 batches | ms/batch 249.6468 | train_loss 6.028258e-01 | lr 5.932203e-06
05/14/2024 17:01:45 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11350/ 12000] | 3685/3832 batches | ms/batch 242.5405 | train_loss 6.027629e-01 | lr 5.508475e-06
05/14/2024 17:01:58 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11400/ 12000] | 3735/3832 batches | ms/batch 233.8724 | train_loss 6.024405e-01 | lr 5.084746e-06
05/14/2024 17:02:12 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   4][ 11450/ 12000] | 3785/3832 batches | ms/batch 245.2775 | train_loss 6.012398e-01 | lr 4.661017e-06
05/14/2024 17:02:33 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11500/ 12000] |    3/3832 batches | ms/batch 253.6583 | train_loss 6.023029e-01 | lr 4.237288e-06
05/14/2024 17:02:46 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11550/ 12000] |   53/3832 batches | ms/batch 239.6168 | train_loss 5.977778e-01 | lr 3.813559e-06
05/14/2024 17:02:59 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11600/ 12000] |  103/3832 batches | ms/batch 230.5078 | train_loss 5.978101e-01 | lr 3.389831e-06
05/14/2024 17:03:12 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11650/ 12000] |  153/3832 batches | ms/batch 243.4445 | train_loss 5.979028e-01 | lr 2.966102e-06
05/14/2024 17:03:26 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11700/ 12000] |  203/3832 batches | ms/batch 242.3903 | train_loss 5.976006e-01 | lr 2.542373e-06
05/14/2024 17:03:38 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11750/ 12000] |  253/3832 batches | ms/batch 229.2483 | train_loss 5.971118e-01 | lr 2.118644e-06
05/14/2024 17:03:51 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11800/ 12000] |  303/3832 batches | ms/batch 235.7150 | train_loss 5.967836e-01 | lr 1.694915e-06
05/14/2024 17:04:05 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11850/ 12000] |  353/3832 batches | ms/batch 248.6984 | train_loss 5.981321e-01 | lr 1.271186e-06
05/14/2024 17:04:17 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11900/ 12000] |  403/3832 batches | ms/batch 234.7903 | train_loss 5.969649e-01 | lr 8.474576e-07
05/14/2024 17:04:31 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 11950/ 12000] |  453/3832 batches | ms/batch 234.4769 | train_loss 5.987086e-01 | lr 4.237288e-07
05/14/2024 17:04:44 - INFO - pecos.xmc.xtransformer.matcher - | [   4/   4][ 12000/ 12000] |  503/3832 batches | ms/batch 250.1589 | train_loss 5.983878e-01 | lr 0.000000e+00
05/14/2024 17:04:44 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23597246/tmp8_qnwwaw at global_step 12000 ****
05/14/2024 17:04:45 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
05/14/2024 17:04:46 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23597246/tmp8_qnwwaw
05/14/2024 17:04:49 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((490449, 32768)) with avr_nnz=80.0
05/14/2024 17:04:49 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
05/14/2024 17:11:35 - INFO - pecos.xmc.xtransformer.model - Constructed instance feature matrix with shape=(490449, 136677)
05/14/2024 17:12:12 - INFO - pecos.xmc.xtransformer.model - Hierarchical label tree for ranker: [8, 256, 8192, 670091]
05/14/2024 17:12:12 - INFO - pecos.xmc.xtransformer.model - Start training ranker...
05/14/2024 17:12:13 - INFO - pecos.xmc.base - Training Layer 0 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
05/14/2024 17:12:36 - INFO - pecos.xmc.base - Training Layer 1 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
05/14/2024 17:12:56 - INFO - pecos.xmc.base - Training Layer 2 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
05/14/2024 17:13:43 - INFO - pecos.xmc.base - Training Layer 3 of 4 Layers in HierarchicalMLModel, neg_mining=tfn+man..
05/14/2024 17:37:42 - INFO - pecos.xmc.xtransformer.model - Parameters saved to ./trained-models/amazon-670k/bert3/param.json
05/14/2024 17:38:01 - INFO - pecos.xmc.xtransformer.model - Model saved to ./trained-models/amazon-670k/bert3
--- start prediction of bert3 ---
--- start evaluation of bert3 ---

============================= JOB FEEDBACK =============================

NodeName=uc2n904
Job ID: 23597246
Cluster: uc2
User/Group: ul_ruw26/ul_student
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 64
CPU Utilized: 4-17:50:26
CPU Efficiency: 23.43% of 20-05:47:44 core-walltime
Job Wall-clock time: 07:35:26
Memory Utilized: 123.85 GB
Memory Efficiency: 24.87% of 498.05 GB
