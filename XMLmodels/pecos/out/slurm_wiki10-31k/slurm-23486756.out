04/24/2024 14:44:33 - INFO - __main__ - Setting random seed 0
04/24/2024 14:44:33 - INFO - __main__ - Loaded training feature matrix with shape=(14146, 101938)
04/24/2024 14:44:33 - INFO - __main__ - Loaded training label matrix with shape=(14146, 30938)
04/24/2024 14:44:34 - INFO - __main__ - Loaded 14146 training sequences
04/24/2024 14:44:43 - INFO - pecos.xmc.xtransformer.model - Hierarchical label tree: [2, 32, 512, 30938]
04/24/2024 14:44:43 - INFO - pecos.xmc.xtransformer.model - Fine-tune Transformers with nr_labels=[2, 32, 512, 30938]
04/24/2024 14:44:43 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn at level 0, nr_labels=2, avr_M_nnz=2
04/24/2024 14:44:48 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-cased model from s3.
04/24/2024 14:44:48 - INFO - pecos.xmc.xtransformer.matcher - ***** Encoding data len=14146 truncation=256*****
04/24/2024 14:45:05 - INFO - pecos.xmc.xtransformer.matcher - ***** Finished with time cost=17.026344537734985 *****
04/24/2024 14:45:16 - INFO - pecos.xmc.xtransformer.matcher - trn tensors saved to /scratch/slurm_tmpdir/job_23486756/tmpka3gw8ve/X_trn.pt
04/24/2024 14:45:16 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 1
04/24/2024 14:45:38 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
04/24/2024 14:45:38 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
/home/ul/ul_student/ul_ruw26/.local/lib/python3.9/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
04/24/2024 14:45:38 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
04/24/2024 14:45:38 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 14146
04/24/2024 14:45:38 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 2
04/24/2024 14:45:38 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 3
04/24/2024 14:45:38 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
04/24/2024 14:45:38 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 8
04/24/2024 14:45:38 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
04/24/2024 14:45:38 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
04/24/2024 14:45:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][    50/  4000] |   49/1769 batches | ms/batch 285.2585 | train_loss 3.287692e-01 | lr 9.875000e-05
04/24/2024 14:46:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   100/  4000] |   99/1769 batches | ms/batch 108.1199 | train_loss 2.736668e-01 | lr 9.750000e-05
04/24/2024 14:46:02 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 100 ****
04/24/2024 14:46:03 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:46:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   150/  4000] |  149/1769 batches | ms/batch 107.8813 | train_loss 2.471865e-01 | lr 9.625000e-05
04/24/2024 14:46:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   200/  4000] |  199/1769 batches | ms/batch 108.1132 | train_loss 2.214904e-01 | lr 9.500000e-05
04/24/2024 14:46:16 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 200 ****
04/24/2024 14:46:16 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:46:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   250/  4000] |  249/1769 batches | ms/batch 108.0889 | train_loss 2.329297e-01 | lr 9.375000e-05
04/24/2024 14:46:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   300/  4000] |  299/1769 batches | ms/batch 108.0758 | train_loss 2.240005e-01 | lr 9.250000e-05
04/24/2024 14:46:29 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 300 ****
04/24/2024 14:46:30 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:46:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   350/  4000] |  349/1769 batches | ms/batch 107.9064 | train_loss 2.447918e-01 | lr 9.125000e-05
04/24/2024 14:46:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   400/  4000] |  399/1769 batches | ms/batch 108.7067 | train_loss 2.479854e-01 | lr 9.000000e-05
04/24/2024 14:46:43 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 400 ****
04/24/2024 14:46:43 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:46:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   450/  4000] |  449/1769 batches | ms/batch 108.2840 | train_loss 1.750621e-01 | lr 8.875000e-05
04/24/2024 14:46:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   500/  4000] |  499/1769 batches | ms/batch 108.6327 | train_loss 2.410800e-01 | lr 8.750000e-05
04/24/2024 14:46:56 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 500 ****
04/24/2024 14:46:56 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:47:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   550/  4000] |  549/1769 batches | ms/batch 108.5925 | train_loss 2.500334e-01 | lr 8.625000e-05
04/24/2024 14:47:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   600/  4000] |  599/1769 batches | ms/batch 108.5373 | train_loss 1.967428e-01 | lr 8.500000e-05
04/24/2024 14:47:09 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 600 ****
04/24/2024 14:47:10 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:47:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   650/  4000] |  649/1769 batches | ms/batch 107.7383 | train_loss 2.042740e-01 | lr 8.375000e-05
04/24/2024 14:47:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   700/  4000] |  699/1769 batches | ms/batch 108.1919 | train_loss 2.186699e-01 | lr 8.250000e-05
04/24/2024 14:47:23 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 700 ****
04/24/2024 14:47:23 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:47:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   750/  4000] |  749/1769 batches | ms/batch 108.7880 | train_loss 2.749361e-01 | lr 8.125000e-05
04/24/2024 14:47:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   800/  4000] |  799/1769 batches | ms/batch 108.8298 | train_loss 2.574511e-01 | lr 8.000000e-05
04/24/2024 14:47:36 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 800 ****
04/24/2024 14:47:36 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:47:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   850/  4000] |  849/1769 batches | ms/batch 108.6872 | train_loss 2.390957e-01 | lr 7.875000e-05
04/24/2024 14:47:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   900/  4000] |  899/1769 batches | ms/batch 109.2963 | train_loss 2.532062e-01 | lr 7.750000e-05
04/24/2024 14:47:49 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 900 ****
04/24/2024 14:47:50 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:47:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   950/  4000] |  949/1769 batches | ms/batch 109.0897 | train_loss 2.727655e-01 | lr 7.625000e-05
04/24/2024 14:48:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1000/  4000] |  999/1769 batches | ms/batch 108.6127 | train_loss 1.954234e-01 | lr 7.500000e-05
04/24/2024 14:48:03 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 1000 ****
04/24/2024 14:48:04 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:48:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1050/  4000] | 1049/1769 batches | ms/batch 108.5760 | train_loss 2.003824e-01 | lr 7.375000e-05
04/24/2024 14:48:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1100/  4000] | 1099/1769 batches | ms/batch 109.4398 | train_loss 3.098347e-01 | lr 7.250000e-05
04/24/2024 14:48:18 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 1100 ****
04/24/2024 14:48:18 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:48:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1150/  4000] | 1149/1769 batches | ms/batch 108.8395 | train_loss 2.049502e-01 | lr 7.125000e-05
04/24/2024 14:48:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1200/  4000] | 1199/1769 batches | ms/batch 108.6008 | train_loss 1.818969e-01 | lr 7.000000e-05
04/24/2024 14:48:32 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 1200 ****
04/24/2024 14:48:32 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:48:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1250/  4000] | 1249/1769 batches | ms/batch 108.9145 | train_loss 2.335273e-01 | lr 6.875000e-05
04/24/2024 14:48:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1300/  4000] | 1299/1769 batches | ms/batch 109.1178 | train_loss 2.741250e-01 | lr 6.750000e-05
04/24/2024 14:48:45 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 1300 ****
04/24/2024 14:48:46 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:48:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1350/  4000] | 1349/1769 batches | ms/batch 109.1625 | train_loss 2.292755e-01 | lr 6.625000e-05
04/24/2024 14:48:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1400/  4000] | 1399/1769 batches | ms/batch 109.4983 | train_loss 3.308355e-01 | lr 6.500000e-05
04/24/2024 14:48:59 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 1400 ****
04/24/2024 14:49:00 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:49:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1450/  4000] | 1449/1769 batches | ms/batch 109.0748 | train_loss 2.000582e-01 | lr 6.375000e-05
04/24/2024 14:49:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1500/  4000] | 1499/1769 batches | ms/batch 108.6469 | train_loss 1.808963e-01 | lr 6.250000e-05
04/24/2024 14:49:13 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 1500 ****
04/24/2024 14:49:14 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:49:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1550/  4000] | 1549/1769 batches | ms/batch 109.2245 | train_loss 2.366961e-01 | lr 6.125000e-05
04/24/2024 14:49:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1600/  4000] | 1599/1769 batches | ms/batch 108.9470 | train_loss 1.825001e-01 | lr 6.000000e-05
04/24/2024 14:49:27 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 1600 ****
04/24/2024 14:49:27 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:49:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1650/  4000] | 1649/1769 batches | ms/batch 108.5191 | train_loss 1.561529e-01 | lr 5.875000e-05
04/24/2024 14:49:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1700/  4000] | 1699/1769 batches | ms/batch 109.1687 | train_loss 2.620293e-01 | lr 5.750000e-05
04/24/2024 14:49:40 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 1700 ****
04/24/2024 14:49:41 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:49:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1750/  4000] | 1749/1769 batches | ms/batch 108.7691 | train_loss 2.074000e-01 | lr 5.625000e-05
04/24/2024 14:49:55 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1800/  4000] |   30/1769 batches | ms/batch 107.8779 | train_loss 2.392684e-01 | lr 5.500000e-05
04/24/2024 14:49:55 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 1800 ****
04/24/2024 14:49:56 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:50:02 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1850/  4000] |   80/1769 batches | ms/batch 109.1392 | train_loss 2.456084e-01 | lr 5.375000e-05
04/24/2024 14:50:09 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1900/  4000] |  130/1769 batches | ms/batch 108.8710 | train_loss 1.837301e-01 | lr 5.250000e-05
04/24/2024 14:50:09 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 1900 ****
04/24/2024 14:50:10 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:50:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1950/  4000] |  180/1769 batches | ms/batch 109.0179 | train_loss 2.460127e-01 | lr 5.125000e-05
04/24/2024 14:50:23 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2000/  4000] |  230/1769 batches | ms/batch 109.2422 | train_loss 2.503598e-01 | lr 5.000000e-05
04/24/2024 14:50:23 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 2000 ****
04/24/2024 14:50:24 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:50:31 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2050/  4000] |  280/1769 batches | ms/batch 108.7556 | train_loss 1.610543e-01 | lr 4.875000e-05
04/24/2024 14:50:37 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2100/  4000] |  330/1769 batches | ms/batch 108.6406 | train_loss 1.626863e-01 | lr 4.750000e-05
04/24/2024 14:50:37 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 2100 ****
04/24/2024 14:50:38 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:50:45 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2150/  4000] |  380/1769 batches | ms/batch 108.8616 | train_loss 2.116245e-01 | lr 4.625000e-05
04/24/2024 14:50:51 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2200/  4000] |  430/1769 batches | ms/batch 109.3521 | train_loss 2.249361e-01 | lr 4.500000e-05
04/24/2024 14:50:51 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 2200 ****
04/24/2024 14:50:52 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:50:59 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2250/  4000] |  480/1769 batches | ms/batch 109.3004 | train_loss 2.151489e-01 | lr 4.375000e-05
04/24/2024 14:51:05 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2300/  4000] |  530/1769 batches | ms/batch 109.1171 | train_loss 1.996027e-01 | lr 4.250000e-05
04/24/2024 14:51:05 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 2300 ****
04/24/2024 14:51:06 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:51:12 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2350/  4000] |  580/1769 batches | ms/batch 109.3565 | train_loss 2.025165e-01 | lr 4.125000e-05
04/24/2024 14:51:19 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2400/  4000] |  630/1769 batches | ms/batch 109.2965 | train_loss 2.397778e-01 | lr 4.000000e-05
04/24/2024 14:51:19 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 2400 ****
04/24/2024 14:51:19 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:51:26 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2450/  4000] |  680/1769 batches | ms/batch 109.3959 | train_loss 2.352967e-01 | lr 3.875000e-05
04/24/2024 14:51:32 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2500/  4000] |  730/1769 batches | ms/batch 109.5906 | train_loss 2.712094e-01 | lr 3.750000e-05
04/24/2024 14:51:32 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 2500 ****
04/24/2024 14:51:32 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:51:39 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2550/  4000] |  780/1769 batches | ms/batch 109.2741 | train_loss 2.161326e-01 | lr 3.625000e-05
04/24/2024 14:51:45 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2600/  4000] |  830/1769 batches | ms/batch 108.8278 | train_loss 2.354678e-01 | lr 3.500000e-05
04/24/2024 14:51:45 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 2600 ****
04/24/2024 14:51:46 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:51:52 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2650/  4000] |  880/1769 batches | ms/batch 109.4413 | train_loss 2.643880e-01 | lr 3.375000e-05
04/24/2024 14:51:59 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2700/  4000] |  930/1769 batches | ms/batch 109.3931 | train_loss 2.502709e-01 | lr 3.250000e-05
04/24/2024 14:51:59 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 2700 ****
04/24/2024 14:52:00 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:52:06 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2750/  4000] |  980/1769 batches | ms/batch 109.0279 | train_loss 1.721633e-01 | lr 3.125000e-05
04/24/2024 14:52:13 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2800/  4000] | 1030/1769 batches | ms/batch 109.1413 | train_loss 2.142879e-01 | lr 3.000000e-05
04/24/2024 14:52:13 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 2800 ****
04/24/2024 14:52:14 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:52:20 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2850/  4000] | 1080/1769 batches | ms/batch 109.0039 | train_loss 1.837000e-01 | lr 2.875000e-05
04/24/2024 14:52:27 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2900/  4000] | 1130/1769 batches | ms/batch 109.2070 | train_loss 2.543318e-01 | lr 2.750000e-05
04/24/2024 14:52:27 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 2900 ****
04/24/2024 14:52:28 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:52:34 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2950/  4000] | 1180/1769 batches | ms/batch 108.5794 | train_loss 1.825238e-01 | lr 2.625000e-05
04/24/2024 14:52:41 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3000/  4000] | 1230/1769 batches | ms/batch 109.1375 | train_loss 2.225529e-01 | lr 2.500000e-05
04/24/2024 14:52:41 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 3000 ****
04/24/2024 14:52:42 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:52:48 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3050/  4000] | 1280/1769 batches | ms/batch 109.5695 | train_loss 2.523900e-01 | lr 2.375000e-05
04/24/2024 14:52:55 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3100/  4000] | 1330/1769 batches | ms/batch 109.4803 | train_loss 1.944376e-01 | lr 2.250000e-05
04/24/2024 14:52:55 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 3100 ****
04/24/2024 14:52:55 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:53:02 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3150/  4000] | 1380/1769 batches | ms/batch 109.2868 | train_loss 2.257248e-01 | lr 2.125000e-05
04/24/2024 14:53:08 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3200/  4000] | 1430/1769 batches | ms/batch 109.3072 | train_loss 2.609444e-01 | lr 2.000000e-05
04/24/2024 14:53:08 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 3200 ****
04/24/2024 14:53:09 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:53:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3250/  4000] | 1480/1769 batches | ms/batch 109.3466 | train_loss 2.285397e-01 | lr 1.875000e-05
04/24/2024 14:53:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3300/  4000] | 1530/1769 batches | ms/batch 109.6805 | train_loss 2.593087e-01 | lr 1.750000e-05
04/24/2024 14:53:22 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 3300 ****
04/24/2024 14:53:22 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:53:29 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3350/  4000] | 1580/1769 batches | ms/batch 109.5254 | train_loss 2.618899e-01 | lr 1.625000e-05
04/24/2024 14:53:35 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3400/  4000] | 1630/1769 batches | ms/batch 109.5911 | train_loss 2.201487e-01 | lr 1.500000e-05
04/24/2024 14:53:35 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 3400 ****
04/24/2024 14:53:36 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:53:42 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3450/  4000] | 1680/1769 batches | ms/batch 109.4871 | train_loss 2.466426e-01 | lr 1.375000e-05
04/24/2024 14:53:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3500/  4000] | 1730/1769 batches | ms/batch 109.0595 | train_loss 1.858095e-01 | lr 1.250000e-05
04/24/2024 14:53:49 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 3500 ****
04/24/2024 14:53:49 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:53:57 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3550/  4000] |   11/1769 batches | ms/batch 107.7810 | train_loss 1.897224e-01 | lr 1.125000e-05
04/24/2024 14:54:03 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3600/  4000] |   61/1769 batches | ms/batch 109.2739 | train_loss 2.828891e-01 | lr 1.000000e-05
04/24/2024 14:54:03 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 3600 ****
04/24/2024 14:54:04 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:54:10 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3650/  4000] |  111/1769 batches | ms/batch 109.3513 | train_loss 2.060229e-01 | lr 8.750000e-06
04/24/2024 14:54:17 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3700/  4000] |  161/1769 batches | ms/batch 109.2112 | train_loss 2.306875e-01 | lr 7.500000e-06
04/24/2024 14:54:17 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 3700 ****
04/24/2024 14:54:17 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:54:24 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3750/  4000] |  211/1769 batches | ms/batch 109.5307 | train_loss 1.802271e-01 | lr 6.250000e-06
04/24/2024 14:54:30 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3800/  4000] |  261/1769 batches | ms/batch 109.3611 | train_loss 2.448175e-01 | lr 5.000000e-06
04/24/2024 14:54:30 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 3800 ****
04/24/2024 14:54:31 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:54:37 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3850/  4000] |  311/1769 batches | ms/batch 109.4509 | train_loss 2.220399e-01 | lr 3.750000e-06
04/24/2024 14:54:44 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3900/  4000] |  361/1769 batches | ms/batch 109.4638 | train_loss 2.389014e-01 | lr 2.500000e-06
04/24/2024 14:54:44 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 3900 ****
04/24/2024 14:54:44 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:54:51 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3950/  4000] |  411/1769 batches | ms/batch 109.3981 | train_loss 2.258494e-01 | lr 1.250000e-06
04/24/2024 14:54:57 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  4000/  4000] |  461/1769 batches | ms/batch 109.3388 | train_loss 1.786925e-01 | lr 0.000000e+00
04/24/2024 14:54:57 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28 at global_step 4000 ****
04/24/2024 14:54:58 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:54:58 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23486756/tmpiol8_j28
04/24/2024 14:54:59 - INFO - pecos.xmc.xtransformer.matcher - Predict on input text tensors(torch.Size([14146, 256])) in OVA mode
04/24/2024 14:54:59 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/24/2024 14:56:11 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn at level 1, nr_labels=32, avr_M_nnz=1.8872472783825816
04/24/2024 14:56:12 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-cased model from s3.
04/24/2024 14:56:24 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23486756/tmpka3gw8ve/X_trn.pt
04/24/2024 14:56:24 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
04/24/2024 14:56:34 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
04/24/2024 14:56:34 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 1
04/24/2024 14:56:34 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
04/24/2024 14:56:34 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/24/2024 14:56:35 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
04/24/2024 14:56:35 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 14146
04/24/2024 14:56:35 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 32
04/24/2024 14:56:35 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 32
04/24/2024 14:56:35 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 3
04/24/2024 14:56:35 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
04/24/2024 14:56:35 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 8
04/24/2024 14:56:35 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
04/24/2024 14:56:35 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
04/24/2024 14:56:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][    50/  4000] |   49/1769 batches | ms/batch 119.9184 | train_loss 6.306157e+00 | lr 9.875000e-05
04/24/2024 14:56:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   100/  4000] |   99/1769 batches | ms/batch 109.6505 | train_loss 2.128735e+00 | lr 9.750000e-05
04/24/2024 14:56:52 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 100 ****
04/24/2024 14:56:52 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:56:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   150/  4000] |  149/1769 batches | ms/batch 109.6670 | train_loss 2.094356e+00 | lr 9.625000e-05
04/24/2024 14:57:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   200/  4000] |  199/1769 batches | ms/batch 109.8425 | train_loss 2.380812e+00 | lr 9.500000e-05
04/24/2024 14:57:06 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 200 ****
04/24/2024 14:57:07 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:57:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   250/  4000] |  249/1769 batches | ms/batch 109.8903 | train_loss 2.111720e+00 | lr 9.375000e-05
04/24/2024 14:57:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   300/  4000] |  299/1769 batches | ms/batch 109.8985 | train_loss 1.885176e+00 | lr 9.250000e-05
04/24/2024 14:57:21 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 300 ****
04/24/2024 14:57:21 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:57:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   350/  4000] |  349/1769 batches | ms/batch 109.8682 | train_loss 1.750816e+00 | lr 9.125000e-05
04/24/2024 14:57:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   400/  4000] |  399/1769 batches | ms/batch 110.1660 | train_loss 1.532837e+00 | lr 9.000000e-05
04/24/2024 14:57:35 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 400 ****
04/24/2024 14:57:35 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:57:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   450/  4000] |  449/1769 batches | ms/batch 110.1022 | train_loss 1.685312e+00 | lr 8.875000e-05
04/24/2024 14:57:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   500/  4000] |  499/1769 batches | ms/batch 110.1538 | train_loss 2.086196e+00 | lr 8.750000e-05
04/24/2024 14:57:49 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 500 ****
04/24/2024 14:57:49 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:57:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   550/  4000] |  549/1769 batches | ms/batch 110.0875 | train_loss 1.419042e+00 | lr 8.625000e-05
04/24/2024 14:58:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   600/  4000] |  599/1769 batches | ms/batch 110.0529 | train_loss 1.694276e+00 | lr 8.500000e-05
04/24/2024 14:58:03 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 600 ****
04/24/2024 14:58:03 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:58:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   650/  4000] |  649/1769 batches | ms/batch 110.0531 | train_loss 1.374584e+00 | lr 8.375000e-05
04/24/2024 14:58:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   700/  4000] |  699/1769 batches | ms/batch 110.0463 | train_loss 1.501581e+00 | lr 8.250000e-05
04/24/2024 14:58:17 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 700 ****
04/24/2024 14:58:17 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:58:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   750/  4000] |  749/1769 batches | ms/batch 110.1064 | train_loss 1.323411e+00 | lr 8.125000e-05
04/24/2024 14:58:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   800/  4000] |  799/1769 batches | ms/batch 110.1700 | train_loss 1.590419e+00 | lr 8.000000e-05
04/24/2024 14:58:30 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 800 ****
04/24/2024 14:58:31 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:58:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   850/  4000] |  849/1769 batches | ms/batch 110.1278 | train_loss 1.266486e+00 | lr 7.875000e-05
04/24/2024 14:58:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   900/  4000] |  899/1769 batches | ms/batch 110.1897 | train_loss 1.312596e+00 | lr 7.750000e-05
04/24/2024 14:58:45 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 900 ****
04/24/2024 14:58:45 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:58:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   950/  4000] |  949/1769 batches | ms/batch 110.4989 | train_loss 1.440899e+00 | lr 7.625000e-05
04/24/2024 14:58:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1000/  4000] |  999/1769 batches | ms/batch 110.3878 | train_loss 1.184906e+00 | lr 7.500000e-05
04/24/2024 14:58:59 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 1000 ****
04/24/2024 14:58:59 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:59:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1050/  4000] | 1049/1769 batches | ms/batch 110.0632 | train_loss 1.470939e+00 | lr 7.375000e-05
04/24/2024 14:59:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1100/  4000] | 1099/1769 batches | ms/batch 110.2205 | train_loss 1.439396e+00 | lr 7.250000e-05
04/24/2024 14:59:13 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 1100 ****
04/24/2024 14:59:13 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:59:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1150/  4000] | 1149/1769 batches | ms/batch 110.1505 | train_loss 1.128162e+00 | lr 7.125000e-05
04/24/2024 14:59:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1200/  4000] | 1199/1769 batches | ms/batch 110.2440 | train_loss 1.150385e+00 | lr 7.000000e-05
04/24/2024 14:59:27 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 1200 ****
04/24/2024 14:59:27 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:59:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1250/  4000] | 1249/1769 batches | ms/batch 110.3163 | train_loss 1.083350e+00 | lr 6.875000e-05
04/24/2024 14:59:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1300/  4000] | 1299/1769 batches | ms/batch 110.3376 | train_loss 1.099967e+00 | lr 6.750000e-05
04/24/2024 14:59:41 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 1300 ****
04/24/2024 14:59:41 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 14:59:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1350/  4000] | 1349/1769 batches | ms/batch 110.2285 | train_loss 1.249143e+00 | lr 6.625000e-05
04/24/2024 14:59:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1400/  4000] | 1399/1769 batches | ms/batch 110.2280 | train_loss 1.186586e+00 | lr 6.500000e-05
04/24/2024 14:59:55 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 1400 ****
04/24/2024 14:59:55 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:00:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1450/  4000] | 1449/1769 batches | ms/batch 110.2506 | train_loss 1.089539e+00 | lr 6.375000e-05
04/24/2024 15:00:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1500/  4000] | 1499/1769 batches | ms/batch 110.3777 | train_loss 1.069489e+00 | lr 6.250000e-05
04/24/2024 15:00:08 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 1500 ****
04/24/2024 15:00:09 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:00:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1550/  4000] | 1549/1769 batches | ms/batch 110.1153 | train_loss 1.095430e+00 | lr 6.125000e-05
04/24/2024 15:00:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1600/  4000] | 1599/1769 batches | ms/batch 110.2184 | train_loss 1.082562e+00 | lr 6.000000e-05
04/24/2024 15:00:23 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 1600 ****
04/24/2024 15:00:23 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:00:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1650/  4000] | 1649/1769 batches | ms/batch 110.1475 | train_loss 1.014849e+00 | lr 5.875000e-05
04/24/2024 15:00:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1700/  4000] | 1699/1769 batches | ms/batch 110.1745 | train_loss 1.120682e+00 | lr 5.750000e-05
04/24/2024 15:00:37 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 1700 ****
04/24/2024 15:00:37 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:00:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1750/  4000] | 1749/1769 batches | ms/batch 110.2206 | train_loss 1.067872e+00 | lr 5.625000e-05
04/24/2024 15:00:52 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1800/  4000] |   30/1769 batches | ms/batch 108.8874 | train_loss 9.500650e-01 | lr 5.500000e-05
04/24/2024 15:00:52 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 1800 ****
04/24/2024 15:00:53 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:01:00 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1850/  4000] |   80/1769 batches | ms/batch 110.2734 | train_loss 9.262631e-01 | lr 5.375000e-05
04/24/2024 15:01:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1900/  4000] |  130/1769 batches | ms/batch 110.2970 | train_loss 9.944673e-01 | lr 5.250000e-05
04/24/2024 15:01:07 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 1900 ****
04/24/2024 15:01:08 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:01:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1950/  4000] |  180/1769 batches | ms/batch 110.3129 | train_loss 9.887760e-01 | lr 5.125000e-05
04/24/2024 15:01:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2000/  4000] |  230/1769 batches | ms/batch 109.9909 | train_loss 9.375870e-01 | lr 5.000000e-05
04/24/2024 15:01:22 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 2000 ****
04/24/2024 15:01:22 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:01:29 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2050/  4000] |  280/1769 batches | ms/batch 110.0654 | train_loss 9.544230e-01 | lr 4.875000e-05
04/24/2024 15:01:36 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2100/  4000] |  330/1769 batches | ms/batch 109.9987 | train_loss 9.475495e-01 | lr 4.750000e-05
04/24/2024 15:01:36 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 2100 ****
04/24/2024 15:01:37 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:01:44 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2150/  4000] |  380/1769 batches | ms/batch 110.2131 | train_loss 1.014496e+00 | lr 4.625000e-05
04/24/2024 15:01:51 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2200/  4000] |  430/1769 batches | ms/batch 110.3413 | train_loss 9.434594e-01 | lr 4.500000e-05
04/24/2024 15:01:51 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 2200 ****
04/24/2024 15:01:51 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:01:58 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2250/  4000] |  480/1769 batches | ms/batch 110.2390 | train_loss 8.542034e-01 | lr 4.375000e-05
04/24/2024 15:02:05 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2300/  4000] |  530/1769 batches | ms/batch 110.2089 | train_loss 8.584079e-01 | lr 4.250000e-05
04/24/2024 15:02:05 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 2300 ****
04/24/2024 15:02:06 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:02:13 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2350/  4000] |  580/1769 batches | ms/batch 110.3015 | train_loss 9.125480e-01 | lr 4.125000e-05
04/24/2024 15:02:20 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2400/  4000] |  630/1769 batches | ms/batch 110.4220 | train_loss 8.799554e-01 | lr 4.000000e-05
04/24/2024 15:02:20 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 2400 ****
04/24/2024 15:02:20 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:02:27 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2450/  4000] |  680/1769 batches | ms/batch 110.2456 | train_loss 9.280402e-01 | lr 3.875000e-05
04/24/2024 15:02:34 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2500/  4000] |  730/1769 batches | ms/batch 110.1582 | train_loss 9.131311e-01 | lr 3.750000e-05
04/24/2024 15:02:34 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 2500 ****
04/24/2024 15:02:35 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:02:42 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2550/  4000] |  780/1769 batches | ms/batch 110.1790 | train_loss 8.450577e-01 | lr 3.625000e-05
04/24/2024 15:02:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2600/  4000] |  830/1769 batches | ms/batch 110.3542 | train_loss 9.253120e-01 | lr 3.500000e-05
04/24/2024 15:02:49 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 2600 ****
04/24/2024 15:02:49 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:02:56 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2650/  4000] |  880/1769 batches | ms/batch 110.1524 | train_loss 9.087605e-01 | lr 3.375000e-05
04/24/2024 15:03:03 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2700/  4000] |  930/1769 batches | ms/batch 110.1977 | train_loss 8.664038e-01 | lr 3.250000e-05
04/24/2024 15:03:03 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 2700 ****
04/24/2024 15:03:04 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:03:11 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2750/  4000] |  980/1769 batches | ms/batch 110.1437 | train_loss 8.953489e-01 | lr 3.125000e-05
04/24/2024 15:03:18 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2800/  4000] | 1030/1769 batches | ms/batch 110.3154 | train_loss 8.655113e-01 | lr 3.000000e-05
04/24/2024 15:03:18 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 2800 ****
04/24/2024 15:03:18 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:03:25 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2850/  4000] | 1080/1769 batches | ms/batch 110.2824 | train_loss 8.598719e-01 | lr 2.875000e-05
04/24/2024 15:03:32 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2900/  4000] | 1130/1769 batches | ms/batch 110.3204 | train_loss 8.667807e-01 | lr 2.750000e-05
04/24/2024 15:03:32 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 2900 ****
04/24/2024 15:03:33 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:03:40 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2950/  4000] | 1180/1769 batches | ms/batch 110.1168 | train_loss 7.967502e-01 | lr 2.625000e-05
04/24/2024 15:03:47 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3000/  4000] | 1230/1769 batches | ms/batch 110.2054 | train_loss 8.549523e-01 | lr 2.500000e-05
04/24/2024 15:03:47 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 3000 ****
04/24/2024 15:03:47 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:03:54 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3050/  4000] | 1280/1769 batches | ms/batch 110.1577 | train_loss 7.964075e-01 | lr 2.375000e-05
04/24/2024 15:04:01 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3100/  4000] | 1330/1769 batches | ms/batch 110.2276 | train_loss 8.311238e-01 | lr 2.250000e-05
04/24/2024 15:04:01 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 3100 ****
04/24/2024 15:04:02 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:04:09 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3150/  4000] | 1380/1769 batches | ms/batch 110.1889 | train_loss 8.867289e-01 | lr 2.125000e-05
04/24/2024 15:04:16 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3200/  4000] | 1430/1769 batches | ms/batch 110.2403 | train_loss 9.094970e-01 | lr 2.000000e-05
04/24/2024 15:04:16 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 3200 ****
04/24/2024 15:04:16 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:04:23 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3250/  4000] | 1480/1769 batches | ms/batch 110.2122 | train_loss 8.153249e-01 | lr 1.875000e-05
04/24/2024 15:04:30 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3300/  4000] | 1530/1769 batches | ms/batch 110.2541 | train_loss 7.973667e-01 | lr 1.750000e-05
04/24/2024 15:04:30 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 3300 ****
04/24/2024 15:04:31 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:04:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3350/  4000] | 1580/1769 batches | ms/batch 110.2268 | train_loss 7.998514e-01 | lr 1.625000e-05
04/24/2024 15:04:45 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3400/  4000] | 1630/1769 batches | ms/batch 110.2259 | train_loss 1.127258e+00 | lr 1.500000e-05
04/24/2024 15:04:45 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 3400 ****
04/24/2024 15:04:45 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:04:52 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3450/  4000] | 1680/1769 batches | ms/batch 110.0680 | train_loss 8.106898e-01 | lr 1.375000e-05
04/24/2024 15:04:59 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3500/  4000] | 1730/1769 batches | ms/batch 110.2635 | train_loss 8.026561e-01 | lr 1.250000e-05
04/24/2024 15:04:59 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 3500 ****
04/24/2024 15:05:00 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:05:08 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3550/  4000] |   11/1769 batches | ms/batch 108.6985 | train_loss 8.121636e-01 | lr 1.125000e-05
04/24/2024 15:05:15 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3600/  4000] |   61/1769 batches | ms/batch 110.0465 | train_loss 7.714892e-01 | lr 1.000000e-05
04/24/2024 15:05:15 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 3600 ****
04/24/2024 15:05:15 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:05:22 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3650/  4000] |  111/1769 batches | ms/batch 110.1343 | train_loss 7.635844e-01 | lr 8.750000e-06
04/24/2024 15:05:29 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3700/  4000] |  161/1769 batches | ms/batch 110.1940 | train_loss 8.180976e-01 | lr 7.500000e-06
04/24/2024 15:05:29 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 3700 ****
04/24/2024 15:05:30 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:05:36 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3750/  4000] |  211/1769 batches | ms/batch 110.1443 | train_loss 7.999861e-01 | lr 6.250000e-06
04/24/2024 15:05:43 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3800/  4000] |  261/1769 batches | ms/batch 110.3027 | train_loss 8.008691e-01 | lr 5.000000e-06
04/24/2024 15:05:43 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 3800 ****
04/24/2024 15:05:44 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:05:50 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3850/  4000] |  311/1769 batches | ms/batch 110.1486 | train_loss 7.739540e-01 | lr 3.750000e-06
04/24/2024 15:05:57 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3900/  4000] |  361/1769 batches | ms/batch 110.1545 | train_loss 7.567799e-01 | lr 2.500000e-06
04/24/2024 15:05:57 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 3900 ****
04/24/2024 15:05:58 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:06:04 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3950/  4000] |  411/1769 batches | ms/batch 110.1027 | train_loss 7.434545e-01 | lr 1.250000e-06
04/24/2024 15:06:11 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  4000/  4000] |  461/1769 batches | ms/batch 110.1388 | train_loss 7.441933e-01 | lr 0.000000e+00
04/24/2024 15:06:11 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v at global_step 4000 ****
04/24/2024 15:06:12 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:06:12 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23486756/tmp3rr8zd6v
04/24/2024 15:06:12 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((14146, 32)) with avr_nnz=32.0
04/24/2024 15:06:12 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/24/2024 15:07:26 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn at level 2, nr_labels=512, avr_M_nnz=7.868372684857911
04/24/2024 15:07:26 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-cased model from s3.
04/24/2024 15:07:38 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23486756/tmpka3gw8ve/X_trn.pt
04/24/2024 15:07:38 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
04/24/2024 15:08:13 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
04/24/2024 15:08:13 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 1
04/24/2024 15:08:13 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
04/24/2024 15:08:13 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/24/2024 15:08:14 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
04/24/2024 15:08:14 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 14146
04/24/2024 15:08:14 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 512
04/24/2024 15:08:14 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 304
04/24/2024 15:08:14 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 3
04/24/2024 15:08:14 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
04/24/2024 15:08:14 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 8
04/24/2024 15:08:14 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
04/24/2024 15:08:14 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
04/24/2024 15:08:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][    50/  4000] |   49/1769 batches | ms/batch 109.6836 | train_loss 7.254807e-01 | lr 9.875000e-05
04/24/2024 15:08:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   100/  4000] |   99/1769 batches | ms/batch 109.2683 | train_loss 7.159118e-01 | lr 9.750000e-05
04/24/2024 15:08:28 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 100 ****
04/24/2024 15:08:29 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:08:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   150/  4000] |  149/1769 batches | ms/batch 109.5539 | train_loss 7.102917e-01 | lr 9.625000e-05
04/24/2024 15:08:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   200/  4000] |  199/1769 batches | ms/batch 109.6999 | train_loss 7.031978e-01 | lr 9.500000e-05
04/24/2024 15:08:42 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 200 ****
04/24/2024 15:08:43 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:08:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   250/  4000] |  249/1769 batches | ms/batch 109.8196 | train_loss 7.119347e-01 | lr 9.375000e-05
04/24/2024 15:08:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   300/  4000] |  299/1769 batches | ms/batch 110.0202 | train_loss 7.089423e-01 | lr 9.250000e-05
04/24/2024 15:08:57 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 300 ****
04/24/2024 15:08:57 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:09:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   350/  4000] |  349/1769 batches | ms/batch 109.9662 | train_loss 7.090479e-01 | lr 9.125000e-05
04/24/2024 15:09:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   400/  4000] |  399/1769 batches | ms/batch 109.7841 | train_loss 7.025425e-01 | lr 9.000000e-05
04/24/2024 15:09:11 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 400 ****
04/24/2024 15:09:11 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:09:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   450/  4000] |  449/1769 batches | ms/batch 109.8132 | train_loss 6.969236e-01 | lr 8.875000e-05
04/24/2024 15:09:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   500/  4000] |  499/1769 batches | ms/batch 109.7797 | train_loss 6.955863e-01 | lr 8.750000e-05
04/24/2024 15:09:25 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 500 ****
04/24/2024 15:09:25 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:09:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   550/  4000] |  549/1769 batches | ms/batch 109.7489 | train_loss 6.984305e-01 | lr 8.625000e-05
04/24/2024 15:09:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   600/  4000] |  599/1769 batches | ms/batch 110.0020 | train_loss 7.008849e-01 | lr 8.500000e-05
04/24/2024 15:09:39 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 600 ****
04/24/2024 15:09:39 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:09:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   650/  4000] |  649/1769 batches | ms/batch 110.0050 | train_loss 7.008391e-01 | lr 8.375000e-05
04/24/2024 15:09:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   700/  4000] |  699/1769 batches | ms/batch 110.1033 | train_loss 7.005856e-01 | lr 8.250000e-05
04/24/2024 15:09:53 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 700 ****
04/24/2024 15:09:53 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:10:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   750/  4000] |  749/1769 batches | ms/batch 109.9633 | train_loss 7.033289e-01 | lr 8.125000e-05
04/24/2024 15:10:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   800/  4000] |  799/1769 batches | ms/batch 110.1779 | train_loss 7.073241e-01 | lr 8.000000e-05
04/24/2024 15:10:07 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 800 ****
04/24/2024 15:10:07 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:10:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   850/  4000] |  849/1769 batches | ms/batch 110.2325 | train_loss 6.961715e-01 | lr 7.875000e-05
04/24/2024 15:10:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   900/  4000] |  899/1769 batches | ms/batch 110.0275 | train_loss 7.002299e-01 | lr 7.750000e-05
04/24/2024 15:10:21 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 900 ****
04/24/2024 15:10:21 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:10:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   950/  4000] |  949/1769 batches | ms/batch 109.9607 | train_loss 7.042602e-01 | lr 7.625000e-05
04/24/2024 15:10:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1000/  4000] |  999/1769 batches | ms/batch 110.0860 | train_loss 7.036793e-01 | lr 7.500000e-05
04/24/2024 15:10:35 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 1000 ****
04/24/2024 15:10:35 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:10:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1050/  4000] | 1049/1769 batches | ms/batch 109.8478 | train_loss 6.929269e-01 | lr 7.375000e-05
04/24/2024 15:10:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1100/  4000] | 1099/1769 batches | ms/batch 110.2450 | train_loss 7.052447e-01 | lr 7.250000e-05
04/24/2024 15:10:49 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 1100 ****
04/24/2024 15:10:50 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:10:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1150/  4000] | 1149/1769 batches | ms/batch 110.1439 | train_loss 7.031813e-01 | lr 7.125000e-05
04/24/2024 15:11:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1200/  4000] | 1199/1769 batches | ms/batch 110.3021 | train_loss 7.001558e-01 | lr 7.000000e-05
04/24/2024 15:11:03 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 1200 ****
04/24/2024 15:11:04 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:11:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1250/  4000] | 1249/1769 batches | ms/batch 110.1439 | train_loss 7.044237e-01 | lr 6.875000e-05
04/24/2024 15:11:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1300/  4000] | 1299/1769 batches | ms/batch 110.2949 | train_loss 7.114156e-01 | lr 6.750000e-05
04/24/2024 15:11:17 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 1300 ****
04/24/2024 15:11:18 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:11:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1350/  4000] | 1349/1769 batches | ms/batch 110.1470 | train_loss 7.092291e-01 | lr 6.625000e-05
04/24/2024 15:11:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1400/  4000] | 1399/1769 batches | ms/batch 110.1997 | train_loss 6.999990e-01 | lr 6.500000e-05
04/24/2024 15:11:31 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 1400 ****
04/24/2024 15:11:32 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:11:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1450/  4000] | 1449/1769 batches | ms/batch 110.2011 | train_loss 6.987820e-01 | lr 6.375000e-05
04/24/2024 15:11:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1500/  4000] | 1499/1769 batches | ms/batch 110.1503 | train_loss 6.982457e-01 | lr 6.250000e-05
04/24/2024 15:11:45 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 1500 ****
04/24/2024 15:11:46 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:11:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1550/  4000] | 1549/1769 batches | ms/batch 110.2244 | train_loss 7.033907e-01 | lr 6.125000e-05
04/24/2024 15:11:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1600/  4000] | 1599/1769 batches | ms/batch 110.1786 | train_loss 6.987772e-01 | lr 6.000000e-05
04/24/2024 15:11:59 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 1600 ****
04/24/2024 15:12:00 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:12:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1650/  4000] | 1649/1769 batches | ms/batch 110.1747 | train_loss 6.948966e-01 | lr 5.875000e-05
04/24/2024 15:12:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1700/  4000] | 1699/1769 batches | ms/batch 110.2367 | train_loss 7.016681e-01 | lr 5.750000e-05
04/24/2024 15:12:13 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 1700 ****
04/24/2024 15:12:14 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:12:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1750/  4000] | 1749/1769 batches | ms/batch 110.3554 | train_loss 7.032298e-01 | lr 5.625000e-05
04/24/2024 15:12:29 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1800/  4000] |   30/1769 batches | ms/batch 108.8640 | train_loss 6.963219e-01 | lr 5.500000e-05
04/24/2024 15:12:29 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 1800 ****
04/24/2024 15:12:29 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:12:37 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1850/  4000] |   80/1769 batches | ms/batch 110.1899 | train_loss 6.966941e-01 | lr 5.375000e-05
04/24/2024 15:12:43 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1900/  4000] |  130/1769 batches | ms/batch 110.2802 | train_loss 7.100732e-01 | lr 5.250000e-05
04/24/2024 15:12:43 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 1900 ****
04/24/2024 15:12:44 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:12:51 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1950/  4000] |  180/1769 batches | ms/batch 110.3282 | train_loss 6.952273e-01 | lr 5.125000e-05
04/24/2024 15:12:58 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2000/  4000] |  230/1769 batches | ms/batch 110.1917 | train_loss 6.973165e-01 | lr 5.000000e-05
04/24/2024 15:12:58 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 2000 ****
04/24/2024 15:12:58 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:13:05 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2050/  4000] |  280/1769 batches | ms/batch 110.2459 | train_loss 6.944151e-01 | lr 4.875000e-05
04/24/2024 15:13:12 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2100/  4000] |  330/1769 batches | ms/batch 110.2655 | train_loss 7.098253e-01 | lr 4.750000e-05
04/24/2024 15:13:12 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 2100 ****
04/24/2024 15:13:12 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:13:19 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2150/  4000] |  380/1769 batches | ms/batch 110.1467 | train_loss 6.975418e-01 | lr 4.625000e-05
04/24/2024 15:13:26 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2200/  4000] |  430/1769 batches | ms/batch 110.3195 | train_loss 7.053044e-01 | lr 4.500000e-05
04/24/2024 15:13:26 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 2200 ****
04/24/2024 15:13:26 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:13:33 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2250/  4000] |  480/1769 batches | ms/batch 110.4329 | train_loss 7.028241e-01 | lr 4.375000e-05
04/24/2024 15:13:40 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2300/  4000] |  530/1769 batches | ms/batch 110.3173 | train_loss 6.979321e-01 | lr 4.250000e-05
04/24/2024 15:13:40 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 2300 ****
04/24/2024 15:13:41 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:13:47 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2350/  4000] |  580/1769 batches | ms/batch 110.2599 | train_loss 7.089822e-01 | lr 4.125000e-05
04/24/2024 15:13:54 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2400/  4000] |  630/1769 batches | ms/batch 110.3836 | train_loss 7.062915e-01 | lr 4.000000e-05
04/24/2024 15:13:54 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 2400 ****
04/24/2024 15:13:55 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:14:01 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2450/  4000] |  680/1769 batches | ms/batch 110.1311 | train_loss 7.084516e-01 | lr 3.875000e-05
04/24/2024 15:14:08 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2500/  4000] |  730/1769 batches | ms/batch 110.2821 | train_loss 7.043002e-01 | lr 3.750000e-05
04/24/2024 15:14:08 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 2500 ****
04/24/2024 15:14:09 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:14:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2550/  4000] |  780/1769 batches | ms/batch 110.3259 | train_loss 7.179420e-01 | lr 3.625000e-05
04/24/2024 15:14:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2600/  4000] |  830/1769 batches | ms/batch 110.4019 | train_loss 6.949469e-01 | lr 3.500000e-05
04/24/2024 15:14:22 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 2600 ****
04/24/2024 15:14:23 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:14:30 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2650/  4000] |  880/1769 batches | ms/batch 110.2928 | train_loss 7.071559e-01 | lr 3.375000e-05
04/24/2024 15:14:36 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2700/  4000] |  930/1769 batches | ms/batch 110.4296 | train_loss 6.967868e-01 | lr 3.250000e-05
04/24/2024 15:14:36 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 2700 ****
04/24/2024 15:14:37 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:14:44 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2750/  4000] |  980/1769 batches | ms/batch 110.3072 | train_loss 6.974841e-01 | lr 3.125000e-05
04/24/2024 15:14:50 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2800/  4000] | 1030/1769 batches | ms/batch 110.3224 | train_loss 7.013758e-01 | lr 3.000000e-05
04/24/2024 15:14:50 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 2800 ****
04/24/2024 15:14:51 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:14:58 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2850/  4000] | 1080/1769 batches | ms/batch 110.3041 | train_loss 6.917107e-01 | lr 2.875000e-05
04/24/2024 15:15:04 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2900/  4000] | 1130/1769 batches | ms/batch 110.2523 | train_loss 7.077086e-01 | lr 2.750000e-05
04/24/2024 15:15:04 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 2900 ****
04/24/2024 15:15:05 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:15:12 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2950/  4000] | 1180/1769 batches | ms/batch 110.3172 | train_loss 6.903803e-01 | lr 2.625000e-05
04/24/2024 15:15:19 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3000/  4000] | 1230/1769 batches | ms/batch 110.3581 | train_loss 7.003222e-01 | lr 2.500000e-05
04/24/2024 15:15:19 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 3000 ****
04/24/2024 15:15:19 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:15:26 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3050/  4000] | 1280/1769 batches | ms/batch 110.2439 | train_loss 7.026097e-01 | lr 2.375000e-05
04/24/2024 15:15:33 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3100/  4000] | 1330/1769 batches | ms/batch 110.2979 | train_loss 7.078016e-01 | lr 2.250000e-05
04/24/2024 15:15:33 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 3100 ****
04/24/2024 15:15:33 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:15:40 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3150/  4000] | 1380/1769 batches | ms/batch 110.2913 | train_loss 7.031884e-01 | lr 2.125000e-05
04/24/2024 15:15:47 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3200/  4000] | 1430/1769 batches | ms/batch 110.4005 | train_loss 7.078010e-01 | lr 2.000000e-05
04/24/2024 15:15:47 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 3200 ****
04/24/2024 15:15:47 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:15:54 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3250/  4000] | 1480/1769 batches | ms/batch 110.1564 | train_loss 7.046394e-01 | lr 1.875000e-05
04/24/2024 15:16:01 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3300/  4000] | 1530/1769 batches | ms/batch 110.1390 | train_loss 7.072732e-01 | lr 1.750000e-05
04/24/2024 15:16:01 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 3300 ****
04/24/2024 15:16:01 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:16:08 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3350/  4000] | 1580/1769 batches | ms/batch 110.2705 | train_loss 6.964365e-01 | lr 1.625000e-05
04/24/2024 15:16:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3400/  4000] | 1630/1769 batches | ms/batch 110.4383 | train_loss 6.988881e-01 | lr 1.500000e-05
04/24/2024 15:16:15 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 3400 ****
04/24/2024 15:16:15 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:16:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3450/  4000] | 1680/1769 batches | ms/batch 110.1288 | train_loss 6.917209e-01 | lr 1.375000e-05
04/24/2024 15:16:29 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3500/  4000] | 1730/1769 batches | ms/batch 110.2042 | train_loss 7.047573e-01 | lr 1.250000e-05
04/24/2024 15:16:29 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 3500 ****
04/24/2024 15:16:29 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:16:38 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3550/  4000] |   11/1769 batches | ms/batch 108.8420 | train_loss 6.968547e-01 | lr 1.125000e-05
04/24/2024 15:16:44 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3600/  4000] |   61/1769 batches | ms/batch 110.3496 | train_loss 7.049321e-01 | lr 1.000000e-05
04/24/2024 15:16:44 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 3600 ****
04/24/2024 15:16:45 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:16:52 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3650/  4000] |  111/1769 batches | ms/batch 110.2817 | train_loss 6.935299e-01 | lr 8.750000e-06
04/24/2024 15:16:59 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3700/  4000] |  161/1769 batches | ms/batch 110.1790 | train_loss 7.030391e-01 | lr 7.500000e-06
04/24/2024 15:16:59 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 3700 ****
04/24/2024 15:16:59 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:17:06 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3750/  4000] |  211/1769 batches | ms/batch 110.3008 | train_loss 6.936129e-01 | lr 6.250000e-06
04/24/2024 15:17:13 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3800/  4000] |  261/1769 batches | ms/batch 110.2676 | train_loss 7.016335e-01 | lr 5.000000e-06
04/24/2024 15:17:13 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 3800 ****
04/24/2024 15:17:13 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:17:20 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3850/  4000] |  311/1769 batches | ms/batch 110.3186 | train_loss 6.990028e-01 | lr 3.750000e-06
04/24/2024 15:17:27 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3900/  4000] |  361/1769 batches | ms/batch 110.3775 | train_loss 7.052687e-01 | lr 2.500000e-06
04/24/2024 15:17:27 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 3900 ****
04/24/2024 15:17:27 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:17:34 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3950/  4000] |  411/1769 batches | ms/batch 110.1900 | train_loss 7.006985e-01 | lr 1.250000e-06
04/24/2024 15:17:41 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  4000/  4000] |  461/1769 batches | ms/batch 110.2417 | train_loss 7.077459e-01 | lr 0.000000e+00
04/24/2024 15:17:41 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7 at global_step 4000 ****
04/24/2024 15:17:41 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:17:42 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23486756/tmp7ceqhir7
04/24/2024 15:17:42 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((14146, 512)) with avr_nnz=320.0
04/24/2024 15:17:42 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/24/2024 15:18:56 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn at level 3, nr_labels=30938, avr_M_nnz=12.53068005089778
04/24/2024 15:18:58 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-cased model from s3.
04/24/2024 15:19:09 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23486756/tmpka3gw8ve/X_trn.pt
04/24/2024 15:19:09 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
04/24/2024 15:22:20 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
04/24/2024 15:22:20 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 1
04/24/2024 15:22:20 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
04/24/2024 15:22:20 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/24/2024 15:22:22 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
04/24/2024 15:22:22 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 14146
04/24/2024 15:22:22 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 30938
04/24/2024 15:22:22 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 1631
04/24/2024 15:22:22 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 3
04/24/2024 15:22:22 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
04/24/2024 15:22:22 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 8
04/24/2024 15:22:22 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
04/24/2024 15:22:22 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
04/24/2024 15:22:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][    50/  4000] |   49/1769 batches | ms/batch 109.6932 | train_loss 5.960173e-01 | lr 9.875000e-05
04/24/2024 15:22:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   100/  4000] |   99/1769 batches | ms/batch 109.1769 | train_loss 5.813400e-01 | lr 9.750000e-05
04/24/2024 15:22:36 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 100 ****
04/24/2024 15:22:37 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:22:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   150/  4000] |  149/1769 batches | ms/batch 109.2695 | train_loss 5.684962e-01 | lr 9.625000e-05
04/24/2024 15:22:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   200/  4000] |  199/1769 batches | ms/batch 109.3700 | train_loss 5.638793e-01 | lr 9.500000e-05
04/24/2024 15:22:51 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 200 ****
04/24/2024 15:22:51 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:22:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   250/  4000] |  249/1769 batches | ms/batch 109.4736 | train_loss 5.759795e-01 | lr 9.375000e-05
04/24/2024 15:23:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   300/  4000] |  299/1769 batches | ms/batch 109.5573 | train_loss 5.736758e-01 | lr 9.250000e-05
04/24/2024 15:23:05 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 300 ****
04/24/2024 15:23:06 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:23:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   350/  4000] |  349/1769 batches | ms/batch 109.7561 | train_loss 5.739052e-01 | lr 9.125000e-05
04/24/2024 15:23:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   400/  4000] |  399/1769 batches | ms/batch 109.7912 | train_loss 5.615318e-01 | lr 9.000000e-05
04/24/2024 15:23:19 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 400 ****
04/24/2024 15:23:20 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:23:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   450/  4000] |  449/1769 batches | ms/batch 109.8018 | train_loss 5.791908e-01 | lr 8.875000e-05
04/24/2024 15:23:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   500/  4000] |  499/1769 batches | ms/batch 109.9433 | train_loss 5.912473e-01 | lr 8.750000e-05
04/24/2024 15:23:33 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 500 ****
04/24/2024 15:23:34 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:23:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   550/  4000] |  549/1769 batches | ms/batch 109.8258 | train_loss 5.764662e-01 | lr 8.625000e-05
04/24/2024 15:23:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   600/  4000] |  599/1769 batches | ms/batch 109.9462 | train_loss 5.753617e-01 | lr 8.500000e-05
04/24/2024 15:23:48 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 600 ****
04/24/2024 15:23:48 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:23:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   650/  4000] |  649/1769 batches | ms/batch 110.1015 | train_loss 5.582244e-01 | lr 8.375000e-05
04/24/2024 15:24:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   700/  4000] |  699/1769 batches | ms/batch 109.9273 | train_loss 5.781556e-01 | lr 8.250000e-05
04/24/2024 15:24:02 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 700 ****
04/24/2024 15:24:03 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:24:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   750/  4000] |  749/1769 batches | ms/batch 110.0850 | train_loss 5.773289e-01 | lr 8.125000e-05
04/24/2024 15:24:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   800/  4000] |  799/1769 batches | ms/batch 110.0365 | train_loss 5.776330e-01 | lr 8.000000e-05
04/24/2024 15:24:17 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 800 ****
04/24/2024 15:24:18 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:24:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   850/  4000] |  849/1769 batches | ms/batch 110.0983 | train_loss 5.688894e-01 | lr 7.875000e-05
04/24/2024 15:24:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   900/  4000] |  899/1769 batches | ms/batch 110.0017 | train_loss 5.702952e-01 | lr 7.750000e-05
04/24/2024 15:24:32 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 900 ****
04/24/2024 15:24:32 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:24:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   950/  4000] |  949/1769 batches | ms/batch 110.2600 | train_loss 5.668399e-01 | lr 7.625000e-05
04/24/2024 15:24:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1000/  4000] |  999/1769 batches | ms/batch 110.2325 | train_loss 5.713154e-01 | lr 7.500000e-05
04/24/2024 15:24:47 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 1000 ****
04/24/2024 15:24:47 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:24:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1050/  4000] | 1049/1769 batches | ms/batch 110.1392 | train_loss 5.676723e-01 | lr 7.375000e-05
04/24/2024 15:25:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1100/  4000] | 1099/1769 batches | ms/batch 110.1645 | train_loss 5.911500e-01 | lr 7.250000e-05
04/24/2024 15:25:01 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 1100 ****
04/24/2024 15:25:02 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:25:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1150/  4000] | 1149/1769 batches | ms/batch 110.1698 | train_loss 5.734821e-01 | lr 7.125000e-05
04/24/2024 15:25:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1200/  4000] | 1199/1769 batches | ms/batch 110.2740 | train_loss 5.857128e-01 | lr 7.000000e-05
04/24/2024 15:25:16 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 1200 ****
04/24/2024 15:25:17 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:25:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1250/  4000] | 1249/1769 batches | ms/batch 110.2733 | train_loss 5.794080e-01 | lr 6.875000e-05
04/24/2024 15:25:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1300/  4000] | 1299/1769 batches | ms/batch 110.2240 | train_loss 5.623322e-01 | lr 6.750000e-05
04/24/2024 15:25:31 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 1300 ****
04/24/2024 15:25:32 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:25:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1350/  4000] | 1349/1769 batches | ms/batch 110.2173 | train_loss 5.709505e-01 | lr 6.625000e-05
04/24/2024 15:25:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1400/  4000] | 1399/1769 batches | ms/batch 110.3116 | train_loss 5.876704e-01 | lr 6.500000e-05
04/24/2024 15:25:46 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 1400 ****
04/24/2024 15:25:46 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:25:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1450/  4000] | 1449/1769 batches | ms/batch 110.1837 | train_loss 5.774641e-01 | lr 6.375000e-05
04/24/2024 15:26:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1500/  4000] | 1499/1769 batches | ms/batch 110.2434 | train_loss 5.730826e-01 | lr 6.250000e-05
04/24/2024 15:26:00 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 1500 ****
04/24/2024 15:26:01 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:26:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1550/  4000] | 1549/1769 batches | ms/batch 110.2347 | train_loss 5.653962e-01 | lr 6.125000e-05
04/24/2024 15:26:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1600/  4000] | 1599/1769 batches | ms/batch 110.0885 | train_loss 5.751553e-01 | lr 6.000000e-05
04/24/2024 15:26:15 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 1600 ****
04/24/2024 15:26:16 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:26:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1650/  4000] | 1649/1769 batches | ms/batch 110.1901 | train_loss 5.712275e-01 | lr 5.875000e-05
04/24/2024 15:26:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1700/  4000] | 1699/1769 batches | ms/batch 110.2650 | train_loss 5.654733e-01 | lr 5.750000e-05
04/24/2024 15:26:30 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 1700 ****
04/24/2024 15:26:31 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:26:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1750/  4000] | 1749/1769 batches | ms/batch 110.2017 | train_loss 5.648027e-01 | lr 5.625000e-05
04/24/2024 15:26:46 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1800/  4000] |   30/1769 batches | ms/batch 108.7833 | train_loss 5.664326e-01 | lr 5.500000e-05
04/24/2024 15:26:46 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 1800 ****
04/24/2024 15:26:47 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:26:54 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1850/  4000] |   80/1769 batches | ms/batch 110.3908 | train_loss 5.649393e-01 | lr 5.375000e-05
04/24/2024 15:27:01 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1900/  4000] |  130/1769 batches | ms/batch 110.2000 | train_loss 5.790019e-01 | lr 5.250000e-05
04/24/2024 15:27:01 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 1900 ****
04/24/2024 15:27:01 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:27:08 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1950/  4000] |  180/1769 batches | ms/batch 110.1489 | train_loss 5.581513e-01 | lr 5.125000e-05
04/24/2024 15:27:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2000/  4000] |  230/1769 batches | ms/batch 110.1012 | train_loss 5.717561e-01 | lr 5.000000e-05
04/24/2024 15:27:15 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 2000 ****
04/24/2024 15:27:16 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:27:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2050/  4000] |  280/1769 batches | ms/batch 110.1351 | train_loss 5.822099e-01 | lr 4.875000e-05
04/24/2024 15:27:29 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2100/  4000] |  330/1769 batches | ms/batch 110.1680 | train_loss 5.697744e-01 | lr 4.750000e-05
04/24/2024 15:27:29 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 2100 ****
04/24/2024 15:27:30 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:27:37 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2150/  4000] |  380/1769 batches | ms/batch 110.2216 | train_loss 5.810198e-01 | lr 4.625000e-05
04/24/2024 15:27:44 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2200/  4000] |  430/1769 batches | ms/batch 110.3328 | train_loss 5.510528e-01 | lr 4.500000e-05
04/24/2024 15:27:44 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 2200 ****
04/24/2024 15:27:44 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:27:51 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2250/  4000] |  480/1769 batches | ms/batch 110.3150 | train_loss 5.827095e-01 | lr 4.375000e-05
04/24/2024 15:27:58 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2300/  4000] |  530/1769 batches | ms/batch 110.2653 | train_loss 5.836237e-01 | lr 4.250000e-05
04/24/2024 15:27:58 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 2300 ****
04/24/2024 15:27:59 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:28:05 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2350/  4000] |  580/1769 batches | ms/batch 110.2285 | train_loss 5.748843e-01 | lr 4.125000e-05
04/24/2024 15:28:12 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2400/  4000] |  630/1769 batches | ms/batch 110.2602 | train_loss 5.871607e-01 | lr 4.000000e-05
04/24/2024 15:28:12 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 2400 ****
04/24/2024 15:28:13 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:28:20 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2450/  4000] |  680/1769 batches | ms/batch 110.1733 | train_loss 5.628355e-01 | lr 3.875000e-05
04/24/2024 15:28:27 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2500/  4000] |  730/1769 batches | ms/batch 110.3342 | train_loss 5.614446e-01 | lr 3.750000e-05
04/24/2024 15:28:27 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 2500 ****
04/24/2024 15:28:27 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:28:34 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2550/  4000] |  780/1769 batches | ms/batch 110.1244 | train_loss 5.665174e-01 | lr 3.625000e-05
04/24/2024 15:28:41 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2600/  4000] |  830/1769 batches | ms/batch 110.0489 | train_loss 5.535990e-01 | lr 3.500000e-05
04/24/2024 15:28:41 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 2600 ****
04/24/2024 15:28:42 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:28:48 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2650/  4000] |  880/1769 batches | ms/batch 110.0832 | train_loss 5.802221e-01 | lr 3.375000e-05
04/24/2024 15:28:55 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2700/  4000] |  930/1769 batches | ms/batch 110.2872 | train_loss 5.658956e-01 | lr 3.250000e-05
04/24/2024 15:28:55 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 2700 ****
04/24/2024 15:28:56 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:29:03 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2750/  4000] |  980/1769 batches | ms/batch 110.1291 | train_loss 5.720235e-01 | lr 3.125000e-05
04/24/2024 15:29:09 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2800/  4000] | 1030/1769 batches | ms/batch 110.5272 | train_loss 5.786037e-01 | lr 3.000000e-05
04/24/2024 15:29:09 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 2800 ****
04/24/2024 15:29:10 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:29:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2850/  4000] | 1080/1769 batches | ms/batch 110.5508 | train_loss 5.643023e-01 | lr 2.875000e-05
04/24/2024 15:29:24 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2900/  4000] | 1130/1769 batches | ms/batch 110.4191 | train_loss 5.714868e-01 | lr 2.750000e-05
04/24/2024 15:29:24 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 2900 ****
04/24/2024 15:29:24 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:29:31 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2950/  4000] | 1180/1769 batches | ms/batch 110.4614 | train_loss 5.888615e-01 | lr 2.625000e-05
04/24/2024 15:29:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3000/  4000] | 1230/1769 batches | ms/batch 110.4390 | train_loss 5.751023e-01 | lr 2.500000e-05
04/24/2024 15:29:38 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 3000 ****
04/24/2024 15:29:39 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:29:46 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3050/  4000] | 1280/1769 batches | ms/batch 110.3084 | train_loss 5.650277e-01 | lr 2.375000e-05
04/24/2024 15:29:53 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3100/  4000] | 1330/1769 batches | ms/batch 110.3973 | train_loss 5.771725e-01 | lr 2.250000e-05
04/24/2024 15:29:53 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 3100 ****
04/24/2024 15:29:53 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:30:00 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3150/  4000] | 1380/1769 batches | ms/batch 110.4603 | train_loss 5.736816e-01 | lr 2.125000e-05
04/24/2024 15:30:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3200/  4000] | 1430/1769 batches | ms/batch 110.5028 | train_loss 5.769310e-01 | lr 2.000000e-05
04/24/2024 15:30:07 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 3200 ****
04/24/2024 15:30:08 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:30:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3250/  4000] | 1480/1769 batches | ms/batch 110.3422 | train_loss 5.691652e-01 | lr 1.875000e-05
04/24/2024 15:30:21 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3300/  4000] | 1530/1769 batches | ms/batch 110.3311 | train_loss 5.605348e-01 | lr 1.750000e-05
04/24/2024 15:30:21 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 3300 ****
04/24/2024 15:30:22 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:30:29 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3350/  4000] | 1580/1769 batches | ms/batch 110.2898 | train_loss 5.743923e-01 | lr 1.625000e-05
04/24/2024 15:30:36 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3400/  4000] | 1630/1769 batches | ms/batch 110.4097 | train_loss 5.608376e-01 | lr 1.500000e-05
04/24/2024 15:30:36 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 3400 ****
04/24/2024 15:30:36 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:30:43 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3450/  4000] | 1680/1769 batches | ms/batch 110.4068 | train_loss 5.869301e-01 | lr 1.375000e-05
04/24/2024 15:30:50 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3500/  4000] | 1730/1769 batches | ms/batch 110.5170 | train_loss 5.644076e-01 | lr 1.250000e-05
04/24/2024 15:30:50 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 3500 ****
04/24/2024 15:30:51 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:30:59 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3550/  4000] |   11/1769 batches | ms/batch 108.9069 | train_loss 5.707440e-01 | lr 1.125000e-05
04/24/2024 15:31:06 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3600/  4000] |   61/1769 batches | ms/batch 110.2269 | train_loss 5.731999e-01 | lr 1.000000e-05
04/24/2024 15:31:06 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 3600 ****
04/24/2024 15:31:07 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:31:14 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3650/  4000] |  111/1769 batches | ms/batch 110.3055 | train_loss 5.558721e-01 | lr 8.750000e-06
04/24/2024 15:31:21 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3700/  4000] |  161/1769 batches | ms/batch 110.3379 | train_loss 5.656892e-01 | lr 7.500000e-06
04/24/2024 15:31:21 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 3700 ****
04/24/2024 15:31:21 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:31:28 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3750/  4000] |  211/1769 batches | ms/batch 110.3402 | train_loss 5.672773e-01 | lr 6.250000e-06
04/24/2024 15:31:35 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3800/  4000] |  261/1769 batches | ms/batch 110.4402 | train_loss 5.640968e-01 | lr 5.000000e-06
04/24/2024 15:31:35 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 3800 ****
04/24/2024 15:31:35 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:31:42 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3850/  4000] |  311/1769 batches | ms/batch 110.3897 | train_loss 5.712375e-01 | lr 3.750000e-06
04/24/2024 15:31:49 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3900/  4000] |  361/1769 batches | ms/batch 110.2700 | train_loss 5.681694e-01 | lr 2.500000e-06
04/24/2024 15:31:49 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 3900 ****
04/24/2024 15:31:50 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:31:57 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3950/  4000] |  411/1769 batches | ms/batch 110.2712 | train_loss 5.592541e-01 | lr 1.250000e-06
04/24/2024 15:32:04 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  4000/  4000] |  461/1769 batches | ms/batch 110.3516 | train_loss 5.762119e-01 | lr 0.000000e+00
04/24/2024 15:32:04 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57 at global_step 4000 ****
04/24/2024 15:32:05 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/24/2024 15:32:05 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23486756/tmpaa3wst57
04/24/2024 15:32:06 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((14146, 30938)) with avr_nnz=1206.0
04/24/2024 15:32:06 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/24/2024 15:33:20 - INFO - pecos.xmc.xtransformer.model - Constructed instance feature matrix with shape=(14146, 102706)
04/24/2024 15:33:26 - INFO - pecos.xmc.xtransformer.model - Hierarchical label tree for ranker: [2, 32, 512, 30938]
04/24/2024 15:33:26 - INFO - pecos.xmc.xtransformer.model - Start training ranker...
04/24/2024 15:33:26 - INFO - pecos.xmc.base - Training Layer 0 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
04/24/2024 15:33:27 - INFO - pecos.xmc.base - Training Layer 1 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
04/24/2024 15:33:33 - INFO - pecos.xmc.base - Training Layer 2 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
04/24/2024 15:33:50 - INFO - pecos.xmc.base - Training Layer 3 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
04/24/2024 15:34:58 - INFO - pecos.xmc.xtransformer.model - Parameters saved to ./trained-models/xr_model_wiki10-31k/param.json
04/24/2024 15:34:59 - INFO - pecos.xmc.xtransformer.model - Model saved to ./trained-models/xr_model_wiki10-31k

============================= JOB FEEDBACK =============================

NodeName=uc2n489
Job ID: 23486756
Cluster: uc2
User/Group: ul_ruw26/ul_student
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 01:44:16
CPU Efficiency: 19.52% of 08:54:10 core-walltime
Job Wall-clock time: 00:53:25
Memory Utilized: 19.62 GB
Memory Efficiency: 66.97% of 29.30 GB
