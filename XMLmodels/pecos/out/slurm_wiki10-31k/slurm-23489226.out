04/26/2024 01:51:47 - INFO - __main__ - Setting random seed 0
04/26/2024 01:51:47 - INFO - __main__ - Loaded training feature matrix with shape=(14146, 101938)
04/26/2024 01:51:47 - INFO - __main__ - Loaded training label matrix with shape=(14146, 30938)
04/26/2024 01:51:48 - INFO - __main__ - Loaded 14146 training sequences
04/26/2024 01:51:54 - INFO - pecos.xmc.xtransformer.model - Hierarchical label tree: [2, 32, 512, 30938]
04/26/2024 01:51:54 - INFO - pecos.xmc.xtransformer.model - Fine-tune Transformers with nr_labels=[2, 32, 512, 30938]
04/26/2024 01:51:54 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn at level 0, nr_labels=2, avr_M_nnz=2
04/26/2024 01:52:00 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-cased model from s3.
04/26/2024 01:52:00 - INFO - pecos.xmc.xtransformer.matcher - ***** Encoding data len=14146 truncation=256*****
04/26/2024 01:52:17 - INFO - pecos.xmc.xtransformer.matcher - ***** Finished with time cost=17.19448161125183 *****
04/26/2024 01:52:27 - INFO - pecos.xmc.xtransformer.matcher - trn tensors saved to /scratch/slurm_tmpdir/job_23489226/tmphqwmzk9r/X_trn.pt
04/26/2024 01:52:28 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 1
04/26/2024 01:52:44 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
04/26/2024 01:52:44 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
/home/ul/ul_student/ul_ruw26/.local/lib/python3.9/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
04/26/2024 01:52:44 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
04/26/2024 01:52:44 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 14146
04/26/2024 01:52:44 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 2
04/26/2024 01:52:44 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 3
04/26/2024 01:52:44 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
04/26/2024 01:52:44 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 8
04/26/2024 01:52:44 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
04/26/2024 01:52:44 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
04/26/2024 01:52:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][    50/  4000] |   49/1769 batches | ms/batch 249.2690 | train_loss 3.287692e-01 | lr 9.875000e-05
04/26/2024 01:53:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   100/  4000] |   99/1769 batches | ms/batch 106.4549 | train_loss 2.736668e-01 | lr 9.750000e-05
04/26/2024 01:53:06 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 100 ****
04/26/2024 01:53:07 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:53:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   150/  4000] |  149/1769 batches | ms/batch 106.4994 | train_loss 2.471865e-01 | lr 9.625000e-05
04/26/2024 01:53:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   200/  4000] |  199/1769 batches | ms/batch 106.5818 | train_loss 2.214904e-01 | lr 9.500000e-05
04/26/2024 01:53:20 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 200 ****
04/26/2024 01:53:20 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:53:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   250/  4000] |  249/1769 batches | ms/batch 106.6177 | train_loss 2.329297e-01 | lr 9.375000e-05
04/26/2024 01:53:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   300/  4000] |  299/1769 batches | ms/batch 106.6083 | train_loss 2.240005e-01 | lr 9.250000e-05
04/26/2024 01:53:33 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 300 ****
04/26/2024 01:53:34 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:53:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   350/  4000] |  349/1769 batches | ms/batch 106.4597 | train_loss 2.447918e-01 | lr 9.125000e-05
04/26/2024 01:53:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   400/  4000] |  399/1769 batches | ms/batch 106.7946 | train_loss 2.479854e-01 | lr 9.000000e-05
04/26/2024 01:53:47 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 400 ****
04/26/2024 01:53:47 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:53:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   450/  4000] |  449/1769 batches | ms/batch 106.6729 | train_loss 1.750621e-01 | lr 8.875000e-05
04/26/2024 01:54:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   500/  4000] |  499/1769 batches | ms/batch 106.7891 | train_loss 2.410800e-01 | lr 8.750000e-05
04/26/2024 01:54:01 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 500 ****
04/26/2024 01:54:01 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:54:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   550/  4000] |  549/1769 batches | ms/batch 106.9227 | train_loss 2.500334e-01 | lr 8.625000e-05
04/26/2024 01:54:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   600/  4000] |  599/1769 batches | ms/batch 106.8800 | train_loss 1.967428e-01 | lr 8.500000e-05
04/26/2024 01:54:14 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 600 ****
04/26/2024 01:54:15 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:54:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   650/  4000] |  649/1769 batches | ms/batch 106.3701 | train_loss 2.042740e-01 | lr 8.375000e-05
04/26/2024 01:54:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   700/  4000] |  699/1769 batches | ms/batch 106.6165 | train_loss 2.186699e-01 | lr 8.250000e-05
04/26/2024 01:54:28 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 700 ****
04/26/2024 01:54:29 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:54:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   750/  4000] |  749/1769 batches | ms/batch 107.0674 | train_loss 2.749361e-01 | lr 8.125000e-05
04/26/2024 01:54:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   800/  4000] |  799/1769 batches | ms/batch 107.0603 | train_loss 2.574511e-01 | lr 8.000000e-05
04/26/2024 01:54:42 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 800 ****
04/26/2024 01:54:42 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:54:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   850/  4000] |  849/1769 batches | ms/batch 106.9953 | train_loss 2.390957e-01 | lr 7.875000e-05
04/26/2024 01:54:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   900/  4000] |  899/1769 batches | ms/batch 107.2979 | train_loss 2.532062e-01 | lr 7.750000e-05
04/26/2024 01:54:56 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 900 ****
04/26/2024 01:54:56 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:55:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   950/  4000] |  949/1769 batches | ms/batch 107.3092 | train_loss 2.727655e-01 | lr 7.625000e-05
04/26/2024 01:55:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1000/  4000] |  999/1769 batches | ms/batch 106.8877 | train_loss 1.954234e-01 | lr 7.500000e-05
04/26/2024 01:55:09 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 1000 ****
04/26/2024 01:55:10 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:55:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1050/  4000] | 1049/1769 batches | ms/batch 106.8868 | train_loss 2.003824e-01 | lr 7.375000e-05
04/26/2024 01:55:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1100/  4000] | 1099/1769 batches | ms/batch 107.5149 | train_loss 3.098347e-01 | lr 7.250000e-05
04/26/2024 01:55:23 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 1100 ****
04/26/2024 01:55:24 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:55:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1150/  4000] | 1149/1769 batches | ms/batch 107.0231 | train_loss 2.049502e-01 | lr 7.125000e-05
04/26/2024 01:55:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1200/  4000] | 1199/1769 batches | ms/batch 106.9427 | train_loss 1.818969e-01 | lr 7.000000e-05
04/26/2024 01:55:37 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 1200 ****
04/26/2024 01:55:38 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:55:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1250/  4000] | 1249/1769 batches | ms/batch 107.2473 | train_loss 2.335273e-01 | lr 6.875000e-05
04/26/2024 01:55:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1300/  4000] | 1299/1769 batches | ms/batch 107.1929 | train_loss 2.741250e-01 | lr 6.750000e-05
04/26/2024 01:55:51 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 1300 ****
04/26/2024 01:55:51 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:55:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1350/  4000] | 1349/1769 batches | ms/batch 107.2115 | train_loss 2.292755e-01 | lr 6.625000e-05
04/26/2024 01:56:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1400/  4000] | 1399/1769 batches | ms/batch 107.4299 | train_loss 3.308355e-01 | lr 6.500000e-05
04/26/2024 01:56:05 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 1400 ****
04/26/2024 01:56:05 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:56:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1450/  4000] | 1449/1769 batches | ms/batch 107.1652 | train_loss 2.000582e-01 | lr 6.375000e-05
04/26/2024 01:56:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1500/  4000] | 1499/1769 batches | ms/batch 106.7994 | train_loss 1.808963e-01 | lr 6.250000e-05
04/26/2024 01:56:19 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 1500 ****
04/26/2024 01:56:19 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:56:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1550/  4000] | 1549/1769 batches | ms/batch 107.2766 | train_loss 2.366961e-01 | lr 6.125000e-05
04/26/2024 01:56:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1600/  4000] | 1599/1769 batches | ms/batch 107.0467 | train_loss 1.825001e-01 | lr 6.000000e-05
04/26/2024 01:56:32 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 1600 ****
04/26/2024 01:56:33 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:56:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1650/  4000] | 1649/1769 batches | ms/batch 106.9486 | train_loss 1.561529e-01 | lr 5.875000e-05
04/26/2024 01:56:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1700/  4000] | 1699/1769 batches | ms/batch 107.3167 | train_loss 2.620293e-01 | lr 5.750000e-05
04/26/2024 01:56:46 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 1700 ****
04/26/2024 01:56:46 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:56:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1750/  4000] | 1749/1769 batches | ms/batch 106.9511 | train_loss 2.074000e-01 | lr 5.625000e-05
04/26/2024 01:57:00 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1800/  4000] |   30/1769 batches | ms/batch 105.8976 | train_loss 2.392684e-01 | lr 5.500000e-05
04/26/2024 01:57:00 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 1800 ****
04/26/2024 01:57:01 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:57:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1850/  4000] |   80/1769 batches | ms/batch 107.1138 | train_loss 2.456084e-01 | lr 5.375000e-05
04/26/2024 01:57:14 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1900/  4000] |  130/1769 batches | ms/batch 107.0026 | train_loss 1.837301e-01 | lr 5.250000e-05
04/26/2024 01:57:14 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 1900 ****
04/26/2024 01:57:14 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:57:20 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1950/  4000] |  180/1769 batches | ms/batch 107.1338 | train_loss 2.460127e-01 | lr 5.125000e-05
04/26/2024 01:57:27 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2000/  4000] |  230/1769 batches | ms/batch 107.4174 | train_loss 2.503598e-01 | lr 5.000000e-05
04/26/2024 01:57:27 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 2000 ****
04/26/2024 01:57:27 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:57:34 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2050/  4000] |  280/1769 batches | ms/batch 107.1583 | train_loss 1.610543e-01 | lr 4.875000e-05
04/26/2024 01:57:40 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2100/  4000] |  330/1769 batches | ms/batch 107.0469 | train_loss 1.626863e-01 | lr 4.750000e-05
04/26/2024 01:57:40 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 2100 ****
04/26/2024 01:57:41 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:57:47 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2150/  4000] |  380/1769 batches | ms/batch 107.1029 | train_loss 2.116245e-01 | lr 4.625000e-05
04/26/2024 01:57:53 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2200/  4000] |  430/1769 batches | ms/batch 107.6685 | train_loss 2.249361e-01 | lr 4.500000e-05
04/26/2024 01:57:53 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 2200 ****
04/26/2024 01:57:54 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:58:00 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2250/  4000] |  480/1769 batches | ms/batch 107.3651 | train_loss 2.151489e-01 | lr 4.375000e-05
04/26/2024 01:58:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2300/  4000] |  530/1769 batches | ms/batch 107.1401 | train_loss 1.996027e-01 | lr 4.250000e-05
04/26/2024 01:58:07 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 2300 ****
04/26/2024 01:58:07 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:58:13 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2350/  4000] |  580/1769 batches | ms/batch 107.3291 | train_loss 2.025165e-01 | lr 4.125000e-05
04/26/2024 01:58:20 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2400/  4000] |  630/1769 batches | ms/batch 107.5075 | train_loss 2.397778e-01 | lr 4.000000e-05
04/26/2024 01:58:20 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 2400 ****
04/26/2024 01:58:20 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:58:27 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2450/  4000] |  680/1769 batches | ms/batch 107.2492 | train_loss 2.352967e-01 | lr 3.875000e-05
04/26/2024 01:58:33 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2500/  4000] |  730/1769 batches | ms/batch 107.5319 | train_loss 2.712094e-01 | lr 3.750000e-05
04/26/2024 01:58:33 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 2500 ****
04/26/2024 01:58:34 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:58:40 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2550/  4000] |  780/1769 batches | ms/batch 107.4593 | train_loss 2.161326e-01 | lr 3.625000e-05
04/26/2024 01:58:47 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2600/  4000] |  830/1769 batches | ms/batch 107.0375 | train_loss 2.354678e-01 | lr 3.500000e-05
04/26/2024 01:58:47 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 2600 ****
04/26/2024 01:58:47 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:58:54 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2650/  4000] |  880/1769 batches | ms/batch 107.5461 | train_loss 2.643880e-01 | lr 3.375000e-05
04/26/2024 01:59:01 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2700/  4000] |  930/1769 batches | ms/batch 107.4976 | train_loss 2.502709e-01 | lr 3.250000e-05
04/26/2024 01:59:01 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 2700 ****
04/26/2024 01:59:01 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:59:08 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2750/  4000] |  980/1769 batches | ms/batch 107.1683 | train_loss 1.721633e-01 | lr 3.125000e-05
04/26/2024 01:59:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2800/  4000] | 1030/1769 batches | ms/batch 107.2304 | train_loss 2.142879e-01 | lr 3.000000e-05
04/26/2024 01:59:15 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 2800 ****
04/26/2024 01:59:15 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:59:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2850/  4000] | 1080/1769 batches | ms/batch 107.2209 | train_loss 1.837000e-01 | lr 2.875000e-05
04/26/2024 01:59:28 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2900/  4000] | 1130/1769 batches | ms/batch 107.4551 | train_loss 2.543318e-01 | lr 2.750000e-05
04/26/2024 01:59:28 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 2900 ****
04/26/2024 01:59:29 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:59:36 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2950/  4000] | 1180/1769 batches | ms/batch 106.9142 | train_loss 1.825238e-01 | lr 2.625000e-05
04/26/2024 01:59:42 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3000/  4000] | 1230/1769 batches | ms/batch 107.2630 | train_loss 2.225529e-01 | lr 2.500000e-05
04/26/2024 01:59:42 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 3000 ****
04/26/2024 01:59:43 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 01:59:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3050/  4000] | 1280/1769 batches | ms/batch 107.7083 | train_loss 2.523900e-01 | lr 2.375000e-05
04/26/2024 01:59:55 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3100/  4000] | 1330/1769 batches | ms/batch 107.5965 | train_loss 1.944376e-01 | lr 2.250000e-05
04/26/2024 01:59:55 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 3100 ****
04/26/2024 01:59:56 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:00:02 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3150/  4000] | 1380/1769 batches | ms/batch 107.4063 | train_loss 2.257248e-01 | lr 2.125000e-05
04/26/2024 02:00:09 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3200/  4000] | 1430/1769 batches | ms/batch 107.5094 | train_loss 2.609444e-01 | lr 2.000000e-05
04/26/2024 02:00:09 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 3200 ****
04/26/2024 02:00:09 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:00:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3250/  4000] | 1480/1769 batches | ms/batch 107.6738 | train_loss 2.285397e-01 | lr 1.875000e-05
04/26/2024 02:00:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3300/  4000] | 1530/1769 batches | ms/batch 107.6524 | train_loss 2.593087e-01 | lr 1.750000e-05
04/26/2024 02:00:22 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 3300 ****
04/26/2024 02:00:22 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:00:29 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3350/  4000] | 1580/1769 batches | ms/batch 107.7161 | train_loss 2.618899e-01 | lr 1.625000e-05
04/26/2024 02:00:35 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3400/  4000] | 1630/1769 batches | ms/batch 107.7092 | train_loss 2.201487e-01 | lr 1.500000e-05
04/26/2024 02:00:35 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 3400 ****
04/26/2024 02:00:35 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:00:42 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3450/  4000] | 1680/1769 batches | ms/batch 107.6639 | train_loss 2.466426e-01 | lr 1.375000e-05
04/26/2024 02:00:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3500/  4000] | 1730/1769 batches | ms/batch 107.1378 | train_loss 1.858095e-01 | lr 1.250000e-05
04/26/2024 02:00:49 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 3500 ****
04/26/2024 02:00:49 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:00:57 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3550/  4000] |   11/1769 batches | ms/batch 106.0472 | train_loss 1.897224e-01 | lr 1.125000e-05
04/26/2024 02:01:03 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3600/  4000] |   61/1769 batches | ms/batch 107.5573 | train_loss 2.828891e-01 | lr 1.000000e-05
04/26/2024 02:01:03 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 3600 ****
04/26/2024 02:01:04 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:01:11 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3650/  4000] |  111/1769 batches | ms/batch 107.4720 | train_loss 2.060229e-01 | lr 8.750000e-06
04/26/2024 02:01:17 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3700/  4000] |  161/1769 batches | ms/batch 107.3375 | train_loss 2.306875e-01 | lr 7.500000e-06
04/26/2024 02:01:17 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 3700 ****
04/26/2024 02:01:18 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:01:25 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3750/  4000] |  211/1769 batches | ms/batch 107.8117 | train_loss 1.802271e-01 | lr 6.250000e-06
04/26/2024 02:01:31 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3800/  4000] |  261/1769 batches | ms/batch 107.5075 | train_loss 2.448175e-01 | lr 5.000000e-06
04/26/2024 02:01:31 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 3800 ****
04/26/2024 02:01:32 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:01:38 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3850/  4000] |  311/1769 batches | ms/batch 107.6183 | train_loss 2.220399e-01 | lr 3.750000e-06
04/26/2024 02:01:45 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3900/  4000] |  361/1769 batches | ms/batch 107.5491 | train_loss 2.389014e-01 | lr 2.500000e-06
04/26/2024 02:01:45 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 3900 ****
04/26/2024 02:01:46 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:01:52 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3950/  4000] |  411/1769 batches | ms/batch 107.6012 | train_loss 2.258494e-01 | lr 1.250000e-06
04/26/2024 02:01:59 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  4000/  4000] |  461/1769 batches | ms/batch 107.3925 | train_loss 1.786925e-01 | lr 0.000000e+00
04/26/2024 02:01:59 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmplj91nabo at global_step 4000 ****
04/26/2024 02:01:59 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:02:00 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23489226/tmplj91nabo
04/26/2024 02:02:00 - INFO - pecos.xmc.xtransformer.matcher - Predict on input text tensors(torch.Size([14146, 256])) in OVA mode
04/26/2024 02:02:00 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/26/2024 02:03:12 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn at level 1, nr_labels=32, avr_M_nnz=1.8872472783825816
04/26/2024 02:03:13 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-cased model from s3.
04/26/2024 02:03:25 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23489226/tmphqwmzk9r/X_trn.pt
04/26/2024 02:03:25 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
04/26/2024 02:03:35 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
04/26/2024 02:03:35 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 1
04/26/2024 02:03:36 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
04/26/2024 02:03:36 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/26/2024 02:03:36 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
04/26/2024 02:03:36 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 14146
04/26/2024 02:03:36 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 32
04/26/2024 02:03:36 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 32
04/26/2024 02:03:36 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 3
04/26/2024 02:03:36 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
04/26/2024 02:03:36 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 8
04/26/2024 02:03:36 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
04/26/2024 02:03:36 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
04/26/2024 02:03:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][    50/  4000] |   49/1769 batches | ms/batch 118.3059 | train_loss 6.306157e+00 | lr 9.875000e-05
04/26/2024 02:03:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   100/  4000] |   99/1769 batches | ms/batch 107.7687 | train_loss 2.128735e+00 | lr 9.750000e-05
04/26/2024 02:03:52 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 100 ****
04/26/2024 02:03:53 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:03:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   150/  4000] |  149/1769 batches | ms/batch 107.7851 | train_loss 2.094356e+00 | lr 9.625000e-05
04/26/2024 02:04:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   200/  4000] |  199/1769 batches | ms/batch 107.9057 | train_loss 2.380812e+00 | lr 9.500000e-05
04/26/2024 02:04:06 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 200 ****
04/26/2024 02:04:07 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:04:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   250/  4000] |  249/1769 batches | ms/batch 108.0196 | train_loss 2.111720e+00 | lr 9.375000e-05
04/26/2024 02:04:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   300/  4000] |  299/1769 batches | ms/batch 108.0677 | train_loss 1.885176e+00 | lr 9.250000e-05
04/26/2024 02:04:20 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 300 ****
04/26/2024 02:04:20 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:04:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   350/  4000] |  349/1769 batches | ms/batch 108.0243 | train_loss 1.750816e+00 | lr 9.125000e-05
04/26/2024 02:04:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   400/  4000] |  399/1769 batches | ms/batch 108.2401 | train_loss 1.532837e+00 | lr 9.000000e-05
04/26/2024 02:04:34 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 400 ****
04/26/2024 02:04:35 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:04:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   450/  4000] |  449/1769 batches | ms/batch 107.9808 | train_loss 1.685312e+00 | lr 8.875000e-05
04/26/2024 02:04:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   500/  4000] |  499/1769 batches | ms/batch 108.1753 | train_loss 2.086196e+00 | lr 8.750000e-05
04/26/2024 02:04:48 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 500 ****
04/26/2024 02:04:48 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:04:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   550/  4000] |  549/1769 batches | ms/batch 108.0537 | train_loss 1.419042e+00 | lr 8.625000e-05
04/26/2024 02:05:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   600/  4000] |  599/1769 batches | ms/batch 108.1539 | train_loss 1.694276e+00 | lr 8.500000e-05
04/26/2024 02:05:02 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 600 ****
04/26/2024 02:05:02 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:05:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   650/  4000] |  649/1769 batches | ms/batch 108.0347 | train_loss 1.374584e+00 | lr 8.375000e-05
04/26/2024 02:05:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   700/  4000] |  699/1769 batches | ms/batch 108.0695 | train_loss 1.501581e+00 | lr 8.250000e-05
04/26/2024 02:05:16 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 700 ****
04/26/2024 02:05:16 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:05:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   750/  4000] |  749/1769 batches | ms/batch 108.1165 | train_loss 1.323411e+00 | lr 8.125000e-05
04/26/2024 02:05:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   800/  4000] |  799/1769 batches | ms/batch 108.1657 | train_loss 1.590419e+00 | lr 8.000000e-05
04/26/2024 02:05:29 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 800 ****
04/26/2024 02:05:30 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:05:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   850/  4000] |  849/1769 batches | ms/batch 108.1696 | train_loss 1.266486e+00 | lr 7.875000e-05
04/26/2024 02:05:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   900/  4000] |  899/1769 batches | ms/batch 108.1669 | train_loss 1.312596e+00 | lr 7.750000e-05
04/26/2024 02:05:43 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 900 ****
04/26/2024 02:05:44 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:05:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   950/  4000] |  949/1769 batches | ms/batch 108.1263 | train_loss 1.440899e+00 | lr 7.625000e-05
04/26/2024 02:05:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1000/  4000] |  999/1769 batches | ms/batch 108.1879 | train_loss 1.184906e+00 | lr 7.500000e-05
04/26/2024 02:05:57 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 1000 ****
04/26/2024 02:05:58 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:06:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1050/  4000] | 1049/1769 batches | ms/batch 108.2179 | train_loss 1.470939e+00 | lr 7.375000e-05
04/26/2024 02:06:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1100/  4000] | 1099/1769 batches | ms/batch 108.1834 | train_loss 1.439396e+00 | lr 7.250000e-05
04/26/2024 02:06:11 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 1100 ****
04/26/2024 02:06:12 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:06:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1150/  4000] | 1149/1769 batches | ms/batch 108.1401 | train_loss 1.128162e+00 | lr 7.125000e-05
04/26/2024 02:06:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1200/  4000] | 1199/1769 batches | ms/batch 108.2271 | train_loss 1.150385e+00 | lr 7.000000e-05
04/26/2024 02:06:25 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 1200 ****
04/26/2024 02:06:25 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:06:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1250/  4000] | 1249/1769 batches | ms/batch 108.1903 | train_loss 1.083350e+00 | lr 6.875000e-05
04/26/2024 02:06:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1300/  4000] | 1299/1769 batches | ms/batch 108.1447 | train_loss 1.099967e+00 | lr 6.750000e-05
04/26/2024 02:06:39 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 1300 ****
04/26/2024 02:06:39 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:06:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1350/  4000] | 1349/1769 batches | ms/batch 108.1476 | train_loss 1.249143e+00 | lr 6.625000e-05
04/26/2024 02:06:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1400/  4000] | 1399/1769 batches | ms/batch 108.2628 | train_loss 1.186586e+00 | lr 6.500000e-05
04/26/2024 02:06:52 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 1400 ****
04/26/2024 02:06:53 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:06:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1450/  4000] | 1449/1769 batches | ms/batch 108.0918 | train_loss 1.089539e+00 | lr 6.375000e-05
04/26/2024 02:07:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1500/  4000] | 1499/1769 batches | ms/batch 108.1809 | train_loss 1.069489e+00 | lr 6.250000e-05
04/26/2024 02:07:06 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 1500 ****
04/26/2024 02:07:06 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:07:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1550/  4000] | 1549/1769 batches | ms/batch 108.1908 | train_loss 1.095430e+00 | lr 6.125000e-05
04/26/2024 02:07:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1600/  4000] | 1599/1769 batches | ms/batch 108.1252 | train_loss 1.082562e+00 | lr 6.000000e-05
04/26/2024 02:07:20 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 1600 ****
04/26/2024 02:07:20 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:07:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1650/  4000] | 1649/1769 batches | ms/batch 108.1710 | train_loss 1.014849e+00 | lr 5.875000e-05
04/26/2024 02:07:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1700/  4000] | 1699/1769 batches | ms/batch 108.2241 | train_loss 1.120682e+00 | lr 5.750000e-05
04/26/2024 02:07:33 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 1700 ****
04/26/2024 02:07:34 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:07:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1750/  4000] | 1749/1769 batches | ms/batch 108.0941 | train_loss 1.067872e+00 | lr 5.625000e-05
04/26/2024 02:07:48 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1800/  4000] |   30/1769 batches | ms/batch 106.9038 | train_loss 9.500650e-01 | lr 5.500000e-05
04/26/2024 02:07:48 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 1800 ****
04/26/2024 02:07:49 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:07:56 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1850/  4000] |   80/1769 batches | ms/batch 108.0951 | train_loss 9.262631e-01 | lr 5.375000e-05
04/26/2024 02:08:02 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1900/  4000] |  130/1769 batches | ms/batch 108.1153 | train_loss 9.944673e-01 | lr 5.250000e-05
04/26/2024 02:08:02 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 1900 ****
04/26/2024 02:08:03 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:08:09 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1950/  4000] |  180/1769 batches | ms/batch 108.1200 | train_loss 9.887760e-01 | lr 5.125000e-05
04/26/2024 02:08:16 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2000/  4000] |  230/1769 batches | ms/batch 108.1874 | train_loss 9.375870e-01 | lr 5.000000e-05
04/26/2024 02:08:16 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 2000 ****
04/26/2024 02:08:16 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:08:23 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2050/  4000] |  280/1769 batches | ms/batch 108.2688 | train_loss 9.544230e-01 | lr 4.875000e-05
04/26/2024 02:08:30 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2100/  4000] |  330/1769 batches | ms/batch 108.2021 | train_loss 9.475495e-01 | lr 4.750000e-05
04/26/2024 02:08:30 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 2100 ****
04/26/2024 02:08:30 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:08:37 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2150/  4000] |  380/1769 batches | ms/batch 108.1173 | train_loss 1.014496e+00 | lr 4.625000e-05
04/26/2024 02:08:44 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2200/  4000] |  430/1769 batches | ms/batch 108.1951 | train_loss 9.434594e-01 | lr 4.500000e-05
04/26/2024 02:08:44 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 2200 ****
04/26/2024 02:08:44 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:08:51 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2250/  4000] |  480/1769 batches | ms/batch 108.1440 | train_loss 8.542034e-01 | lr 4.375000e-05
04/26/2024 02:08:57 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2300/  4000] |  530/1769 batches | ms/batch 108.2415 | train_loss 8.584079e-01 | lr 4.250000e-05
04/26/2024 02:08:57 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 2300 ****
04/26/2024 02:08:58 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:09:05 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2350/  4000] |  580/1769 batches | ms/batch 108.2587 | train_loss 9.125480e-01 | lr 4.125000e-05
04/26/2024 02:09:11 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2400/  4000] |  630/1769 batches | ms/batch 108.1758 | train_loss 8.799554e-01 | lr 4.000000e-05
04/26/2024 02:09:11 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 2400 ****
04/26/2024 02:09:12 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:09:19 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2450/  4000] |  680/1769 batches | ms/batch 108.1748 | train_loss 9.280402e-01 | lr 3.875000e-05
04/26/2024 02:09:25 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2500/  4000] |  730/1769 batches | ms/batch 108.3228 | train_loss 9.131311e-01 | lr 3.750000e-05
04/26/2024 02:09:25 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 2500 ****
04/26/2024 02:09:26 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:09:33 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2550/  4000] |  780/1769 batches | ms/batch 108.1353 | train_loss 8.450577e-01 | lr 3.625000e-05
04/26/2024 02:09:39 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2600/  4000] |  830/1769 batches | ms/batch 108.1642 | train_loss 9.253120e-01 | lr 3.500000e-05
04/26/2024 02:09:39 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 2600 ****
04/26/2024 02:09:40 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:09:46 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2650/  4000] |  880/1769 batches | ms/batch 108.1127 | train_loss 9.087605e-01 | lr 3.375000e-05
04/26/2024 02:09:53 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2700/  4000] |  930/1769 batches | ms/batch 108.2199 | train_loss 8.664038e-01 | lr 3.250000e-05
04/26/2024 02:09:53 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 2700 ****
04/26/2024 02:09:53 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:10:00 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2750/  4000] |  980/1769 batches | ms/batch 108.1807 | train_loss 8.953489e-01 | lr 3.125000e-05
04/26/2024 02:10:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2800/  4000] | 1030/1769 batches | ms/batch 108.1834 | train_loss 8.655113e-01 | lr 3.000000e-05
04/26/2024 02:10:07 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 2800 ****
04/26/2024 02:10:07 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:10:14 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2850/  4000] | 1080/1769 batches | ms/batch 108.1453 | train_loss 8.598719e-01 | lr 2.875000e-05
04/26/2024 02:10:21 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2900/  4000] | 1130/1769 batches | ms/batch 108.1767 | train_loss 8.667807e-01 | lr 2.750000e-05
04/26/2024 02:10:21 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 2900 ****
04/26/2024 02:10:21 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:10:28 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2950/  4000] | 1180/1769 batches | ms/batch 108.1343 | train_loss 7.967502e-01 | lr 2.625000e-05
04/26/2024 02:10:35 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3000/  4000] | 1230/1769 batches | ms/batch 108.2477 | train_loss 8.549523e-01 | lr 2.500000e-05
04/26/2024 02:10:35 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 3000 ****
04/26/2024 02:10:35 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:10:42 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3050/  4000] | 1280/1769 batches | ms/batch 108.1025 | train_loss 7.964075e-01 | lr 2.375000e-05
04/26/2024 02:10:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3100/  4000] | 1330/1769 batches | ms/batch 108.1442 | train_loss 8.311238e-01 | lr 2.250000e-05
04/26/2024 02:10:49 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 3100 ****
04/26/2024 02:10:49 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:10:56 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3150/  4000] | 1380/1769 batches | ms/batch 108.1562 | train_loss 8.867289e-01 | lr 2.125000e-05
04/26/2024 02:11:03 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3200/  4000] | 1430/1769 batches | ms/batch 108.2162 | train_loss 9.094970e-01 | lr 2.000000e-05
04/26/2024 02:11:03 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 3200 ****
04/26/2024 02:11:03 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:11:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3250/  4000] | 1480/1769 batches | ms/batch 108.1389 | train_loss 8.153249e-01 | lr 1.875000e-05
04/26/2024 02:11:16 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3300/  4000] | 1530/1769 batches | ms/batch 108.2716 | train_loss 7.973667e-01 | lr 1.750000e-05
04/26/2024 02:11:16 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 3300 ****
04/26/2024 02:11:17 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:11:23 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3350/  4000] | 1580/1769 batches | ms/batch 108.2473 | train_loss 7.998514e-01 | lr 1.625000e-05
04/26/2024 02:11:30 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3400/  4000] | 1630/1769 batches | ms/batch 108.2128 | train_loss 1.127258e+00 | lr 1.500000e-05
04/26/2024 02:11:30 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 3400 ****
04/26/2024 02:11:31 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:11:37 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3450/  4000] | 1680/1769 batches | ms/batch 108.1181 | train_loss 8.106898e-01 | lr 1.375000e-05
04/26/2024 02:11:44 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3500/  4000] | 1730/1769 batches | ms/batch 108.2690 | train_loss 8.026561e-01 | lr 1.250000e-05
04/26/2024 02:11:44 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 3500 ****
04/26/2024 02:11:44 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:11:53 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3550/  4000] |   11/1769 batches | ms/batch 106.9093 | train_loss 8.121636e-01 | lr 1.125000e-05
04/26/2024 02:11:59 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3600/  4000] |   61/1769 batches | ms/batch 108.0152 | train_loss 7.714892e-01 | lr 1.000000e-05
04/26/2024 02:11:59 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 3600 ****
04/26/2024 02:12:00 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:12:07 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3650/  4000] |  111/1769 batches | ms/batch 108.1568 | train_loss 7.635844e-01 | lr 8.750000e-06
04/26/2024 02:12:14 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3700/  4000] |  161/1769 batches | ms/batch 108.2100 | train_loss 8.180976e-01 | lr 7.500000e-06
04/26/2024 02:12:14 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 3700 ****
04/26/2024 02:12:14 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:12:21 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3750/  4000] |  211/1769 batches | ms/batch 108.1316 | train_loss 7.999861e-01 | lr 6.250000e-06
04/26/2024 02:12:28 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3800/  4000] |  261/1769 batches | ms/batch 108.2111 | train_loss 8.008691e-01 | lr 5.000000e-06
04/26/2024 02:12:28 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 3800 ****
04/26/2024 02:12:28 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:12:35 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3850/  4000] |  311/1769 batches | ms/batch 108.2369 | train_loss 7.739540e-01 | lr 3.750000e-06
04/26/2024 02:12:42 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3900/  4000] |  361/1769 batches | ms/batch 108.1299 | train_loss 7.567799e-01 | lr 2.500000e-06
04/26/2024 02:12:42 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 3900 ****
04/26/2024 02:12:42 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:12:49 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3950/  4000] |  411/1769 batches | ms/batch 108.2256 | train_loss 7.434545e-01 | lr 1.250000e-06
04/26/2024 02:12:55 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  4000/  4000] |  461/1769 batches | ms/batch 108.1819 | train_loss 7.441933e-01 | lr 0.000000e+00
04/26/2024 02:12:55 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2 at global_step 4000 ****
04/26/2024 02:12:56 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:12:56 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23489226/tmpk4rzu2j2
04/26/2024 02:12:56 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((14146, 32)) with avr_nnz=32.0
04/26/2024 02:12:56 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/26/2024 02:14:08 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn at level 2, nr_labels=512, avr_M_nnz=7.868372684857911
04/26/2024 02:14:09 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-cased model from s3.
04/26/2024 02:14:21 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23489226/tmphqwmzk9r/X_trn.pt
04/26/2024 02:14:21 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
04/26/2024 02:14:56 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
04/26/2024 02:14:56 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 1
04/26/2024 02:14:56 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
04/26/2024 02:14:56 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/26/2024 02:14:56 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
04/26/2024 02:14:56 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 14146
04/26/2024 02:14:56 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 512
04/26/2024 02:14:56 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 304
04/26/2024 02:14:56 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 3
04/26/2024 02:14:56 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
04/26/2024 02:14:56 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 8
04/26/2024 02:14:56 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
04/26/2024 02:14:56 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
04/26/2024 02:15:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][    50/  4000] |   49/1769 batches | ms/batch 107.9800 | train_loss 7.254807e-01 | lr 9.875000e-05
04/26/2024 02:15:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   100/  4000] |   99/1769 batches | ms/batch 107.8198 | train_loss 7.159118e-01 | lr 9.750000e-05
04/26/2024 02:15:11 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 100 ****
04/26/2024 02:15:12 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:15:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   150/  4000] |  149/1769 batches | ms/batch 107.9145 | train_loss 7.102917e-01 | lr 9.625000e-05
04/26/2024 02:15:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   200/  4000] |  199/1769 batches | ms/batch 108.0051 | train_loss 7.031978e-01 | lr 9.500000e-05
04/26/2024 02:15:25 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 200 ****
04/26/2024 02:15:25 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:15:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   250/  4000] |  249/1769 batches | ms/batch 108.0269 | train_loss 7.119347e-01 | lr 9.375000e-05
04/26/2024 02:15:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   300/  4000] |  299/1769 batches | ms/batch 107.9910 | train_loss 7.089423e-01 | lr 9.250000e-05
04/26/2024 02:15:39 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 300 ****
04/26/2024 02:15:39 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:15:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   350/  4000] |  349/1769 batches | ms/batch 107.9545 | train_loss 7.090479e-01 | lr 9.125000e-05
04/26/2024 02:15:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   400/  4000] |  399/1769 batches | ms/batch 108.0636 | train_loss 7.025425e-01 | lr 9.000000e-05
04/26/2024 02:15:53 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 400 ****
04/26/2024 02:15:54 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:16:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   450/  4000] |  449/1769 batches | ms/batch 107.9927 | train_loss 6.969236e-01 | lr 8.875000e-05
04/26/2024 02:16:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   500/  4000] |  499/1769 batches | ms/batch 108.2729 | train_loss 6.955863e-01 | lr 8.750000e-05
04/26/2024 02:16:07 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 500 ****
04/26/2024 02:16:08 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:16:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   550/  4000] |  549/1769 batches | ms/batch 108.3082 | train_loss 6.984305e-01 | lr 8.625000e-05
04/26/2024 02:16:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   600/  4000] |  599/1769 batches | ms/batch 108.2185 | train_loss 7.008849e-01 | lr 8.500000e-05
04/26/2024 02:16:21 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 600 ****
04/26/2024 02:16:21 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:16:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   650/  4000] |  649/1769 batches | ms/batch 108.3180 | train_loss 7.008391e-01 | lr 8.375000e-05
04/26/2024 02:16:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   700/  4000] |  699/1769 batches | ms/batch 108.3200 | train_loss 7.005856e-01 | lr 8.250000e-05
04/26/2024 02:16:35 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 700 ****
04/26/2024 02:16:36 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:16:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   750/  4000] |  749/1769 batches | ms/batch 108.3880 | train_loss 7.033289e-01 | lr 8.125000e-05
04/26/2024 02:16:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   800/  4000] |  799/1769 batches | ms/batch 108.4732 | train_loss 7.073241e-01 | lr 8.000000e-05
04/26/2024 02:16:49 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 800 ****
04/26/2024 02:16:50 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:16:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   850/  4000] |  849/1769 batches | ms/batch 108.3915 | train_loss 6.961715e-01 | lr 7.875000e-05
04/26/2024 02:17:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   900/  4000] |  899/1769 batches | ms/batch 108.4812 | train_loss 7.002299e-01 | lr 7.750000e-05
04/26/2024 02:17:03 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 900 ****
04/26/2024 02:17:04 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:17:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   950/  4000] |  949/1769 batches | ms/batch 108.5093 | train_loss 7.042602e-01 | lr 7.625000e-05
04/26/2024 02:17:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1000/  4000] |  999/1769 batches | ms/batch 108.5158 | train_loss 7.036793e-01 | lr 7.500000e-05
04/26/2024 02:17:17 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 1000 ****
04/26/2024 02:17:18 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:17:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1050/  4000] | 1049/1769 batches | ms/batch 108.4901 | train_loss 6.929269e-01 | lr 7.375000e-05
04/26/2024 02:17:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1100/  4000] | 1099/1769 batches | ms/batch 108.5361 | train_loss 7.052447e-01 | lr 7.250000e-05
04/26/2024 02:17:31 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 1100 ****
04/26/2024 02:17:32 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:17:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1150/  4000] | 1149/1769 batches | ms/batch 108.4125 | train_loss 7.031813e-01 | lr 7.125000e-05
04/26/2024 02:17:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1200/  4000] | 1199/1769 batches | ms/batch 108.4329 | train_loss 7.001558e-01 | lr 7.000000e-05
04/26/2024 02:17:45 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 1200 ****
04/26/2024 02:17:46 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:17:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1250/  4000] | 1249/1769 batches | ms/batch 108.4644 | train_loss 7.044237e-01 | lr 6.875000e-05
04/26/2024 02:17:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1300/  4000] | 1299/1769 batches | ms/batch 108.4148 | train_loss 7.114156e-01 | lr 6.750000e-05
04/26/2024 02:17:59 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 1300 ****
04/26/2024 02:17:59 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:18:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1350/  4000] | 1349/1769 batches | ms/batch 108.4669 | train_loss 7.092291e-01 | lr 6.625000e-05
04/26/2024 02:18:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1400/  4000] | 1399/1769 batches | ms/batch 108.5149 | train_loss 6.999990e-01 | lr 6.500000e-05
04/26/2024 02:18:13 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 1400 ****
04/26/2024 02:18:13 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:18:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1450/  4000] | 1449/1769 batches | ms/batch 108.3592 | train_loss 6.987820e-01 | lr 6.375000e-05
04/26/2024 02:18:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1500/  4000] | 1499/1769 batches | ms/batch 108.4329 | train_loss 6.982457e-01 | lr 6.250000e-05
04/26/2024 02:18:27 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 1500 ****
04/26/2024 02:18:27 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:18:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1550/  4000] | 1549/1769 batches | ms/batch 108.6774 | train_loss 7.033907e-01 | lr 6.125000e-05
04/26/2024 02:18:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1600/  4000] | 1599/1769 batches | ms/batch 108.6383 | train_loss 6.987772e-01 | lr 6.000000e-05
04/26/2024 02:18:41 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 1600 ****
04/26/2024 02:18:41 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:18:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1650/  4000] | 1649/1769 batches | ms/batch 108.3527 | train_loss 6.948966e-01 | lr 5.875000e-05
04/26/2024 02:18:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1700/  4000] | 1699/1769 batches | ms/batch 108.5045 | train_loss 7.016681e-01 | lr 5.750000e-05
04/26/2024 02:18:55 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 1700 ****
04/26/2024 02:18:55 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:19:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1750/  4000] | 1749/1769 batches | ms/batch 108.4577 | train_loss 7.032298e-01 | lr 5.625000e-05
04/26/2024 02:19:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1800/  4000] |   30/1769 batches | ms/batch 106.9093 | train_loss 6.963219e-01 | lr 5.500000e-05
04/26/2024 02:19:10 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 1800 ****
04/26/2024 02:19:11 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:19:18 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1850/  4000] |   80/1769 batches | ms/batch 108.5778 | train_loss 6.966941e-01 | lr 5.375000e-05
04/26/2024 02:19:24 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1900/  4000] |  130/1769 batches | ms/batch 108.5832 | train_loss 7.100732e-01 | lr 5.250000e-05
04/26/2024 02:19:24 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 1900 ****
04/26/2024 02:19:25 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:19:32 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1950/  4000] |  180/1769 batches | ms/batch 108.4591 | train_loss 6.952273e-01 | lr 5.125000e-05
04/26/2024 02:19:39 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2000/  4000] |  230/1769 batches | ms/batch 108.4545 | train_loss 6.973165e-01 | lr 5.000000e-05
04/26/2024 02:19:39 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 2000 ****
04/26/2024 02:19:39 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:19:46 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2050/  4000] |  280/1769 batches | ms/batch 108.5372 | train_loss 6.944151e-01 | lr 4.875000e-05
04/26/2024 02:19:53 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2100/  4000] |  330/1769 batches | ms/batch 108.3906 | train_loss 7.098253e-01 | lr 4.750000e-05
04/26/2024 02:19:53 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 2100 ****
04/26/2024 02:19:53 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:20:00 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2150/  4000] |  380/1769 batches | ms/batch 108.4654 | train_loss 6.975418e-01 | lr 4.625000e-05
04/26/2024 02:20:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2200/  4000] |  430/1769 batches | ms/batch 108.5237 | train_loss 7.053044e-01 | lr 4.500000e-05
04/26/2024 02:20:07 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 2200 ****
04/26/2024 02:20:07 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:20:14 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2250/  4000] |  480/1769 batches | ms/batch 108.3698 | train_loss 7.028241e-01 | lr 4.375000e-05
04/26/2024 02:20:21 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2300/  4000] |  530/1769 batches | ms/batch 108.5641 | train_loss 6.979321e-01 | lr 4.250000e-05
04/26/2024 02:20:21 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 2300 ****
04/26/2024 02:20:22 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:20:29 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2350/  4000] |  580/1769 batches | ms/batch 108.5386 | train_loss 7.089822e-01 | lr 4.125000e-05
04/26/2024 02:20:36 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2400/  4000] |  630/1769 batches | ms/batch 108.4420 | train_loss 7.062915e-01 | lr 4.000000e-05
04/26/2024 02:20:36 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 2400 ****
04/26/2024 02:20:36 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:20:43 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2450/  4000] |  680/1769 batches | ms/batch 108.4823 | train_loss 7.084516e-01 | lr 3.875000e-05
04/26/2024 02:20:50 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2500/  4000] |  730/1769 batches | ms/batch 108.4126 | train_loss 7.043002e-01 | lr 3.750000e-05
04/26/2024 02:20:50 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 2500 ****
04/26/2024 02:20:50 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:20:57 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2550/  4000] |  780/1769 batches | ms/batch 108.3521 | train_loss 7.179420e-01 | lr 3.625000e-05
04/26/2024 02:21:04 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2600/  4000] |  830/1769 batches | ms/batch 108.4835 | train_loss 6.949469e-01 | lr 3.500000e-05
04/26/2024 02:21:04 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 2600 ****
04/26/2024 02:21:04 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:21:11 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2650/  4000] |  880/1769 batches | ms/batch 108.5324 | train_loss 7.071559e-01 | lr 3.375000e-05
04/26/2024 02:21:18 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2700/  4000] |  930/1769 batches | ms/batch 108.5072 | train_loss 6.967868e-01 | lr 3.250000e-05
04/26/2024 02:21:18 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 2700 ****
04/26/2024 02:21:19 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:21:25 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2750/  4000] |  980/1769 batches | ms/batch 108.4939 | train_loss 6.974841e-01 | lr 3.125000e-05
04/26/2024 02:21:32 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2800/  4000] | 1030/1769 batches | ms/batch 108.5944 | train_loss 7.013758e-01 | lr 3.000000e-05
04/26/2024 02:21:32 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 2800 ****
04/26/2024 02:21:33 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:21:39 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2850/  4000] | 1080/1769 batches | ms/batch 108.2851 | train_loss 6.917107e-01 | lr 2.875000e-05
04/26/2024 02:21:46 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2900/  4000] | 1130/1769 batches | ms/batch 108.2492 | train_loss 7.077086e-01 | lr 2.750000e-05
04/26/2024 02:21:46 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 2900 ****
04/26/2024 02:21:46 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:21:53 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2950/  4000] | 1180/1769 batches | ms/batch 108.4364 | train_loss 6.903803e-01 | lr 2.625000e-05
04/26/2024 02:22:00 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3000/  4000] | 1230/1769 batches | ms/batch 108.3534 | train_loss 7.003222e-01 | lr 2.500000e-05
04/26/2024 02:22:00 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 3000 ****
04/26/2024 02:22:00 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:22:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3050/  4000] | 1280/1769 batches | ms/batch 108.2536 | train_loss 7.026097e-01 | lr 2.375000e-05
04/26/2024 02:22:14 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3100/  4000] | 1330/1769 batches | ms/batch 108.3563 | train_loss 7.078016e-01 | lr 2.250000e-05
04/26/2024 02:22:14 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 3100 ****
04/26/2024 02:22:15 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:22:21 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3150/  4000] | 1380/1769 batches | ms/batch 108.2890 | train_loss 7.031884e-01 | lr 2.125000e-05
04/26/2024 02:22:28 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3200/  4000] | 1430/1769 batches | ms/batch 108.2528 | train_loss 7.078010e-01 | lr 2.000000e-05
04/26/2024 02:22:28 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 3200 ****
04/26/2024 02:22:28 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:22:35 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3250/  4000] | 1480/1769 batches | ms/batch 108.3186 | train_loss 7.046394e-01 | lr 1.875000e-05
04/26/2024 02:22:42 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3300/  4000] | 1530/1769 batches | ms/batch 108.3150 | train_loss 7.072732e-01 | lr 1.750000e-05
04/26/2024 02:22:42 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 3300 ****
04/26/2024 02:22:42 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:22:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3350/  4000] | 1580/1769 batches | ms/batch 108.2553 | train_loss 6.964365e-01 | lr 1.625000e-05
04/26/2024 02:22:56 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3400/  4000] | 1630/1769 batches | ms/batch 108.4681 | train_loss 6.988881e-01 | lr 1.500000e-05
04/26/2024 02:22:56 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 3400 ****
04/26/2024 02:22:56 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:23:03 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3450/  4000] | 1680/1769 batches | ms/batch 108.3590 | train_loss 6.917209e-01 | lr 1.375000e-05
04/26/2024 02:23:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3500/  4000] | 1730/1769 batches | ms/batch 108.2301 | train_loss 7.047573e-01 | lr 1.250000e-05
04/26/2024 02:23:10 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 3500 ****
04/26/2024 02:23:10 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:23:19 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3550/  4000] |   11/1769 batches | ms/batch 106.9527 | train_loss 6.968547e-01 | lr 1.125000e-05
04/26/2024 02:23:25 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3600/  4000] |   61/1769 batches | ms/batch 108.4585 | train_loss 7.049321e-01 | lr 1.000000e-05
04/26/2024 02:23:25 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 3600 ****
04/26/2024 02:23:26 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:23:33 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3650/  4000] |  111/1769 batches | ms/batch 108.2214 | train_loss 6.935299e-01 | lr 8.750000e-06
04/26/2024 02:23:39 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3700/  4000] |  161/1769 batches | ms/batch 108.3720 | train_loss 7.030391e-01 | lr 7.500000e-06
04/26/2024 02:23:39 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 3700 ****
04/26/2024 02:23:40 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:23:47 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3750/  4000] |  211/1769 batches | ms/batch 108.3783 | train_loss 6.936129e-01 | lr 6.250000e-06
04/26/2024 02:23:53 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3800/  4000] |  261/1769 batches | ms/batch 108.2768 | train_loss 7.016335e-01 | lr 5.000000e-06
04/26/2024 02:23:53 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 3800 ****
04/26/2024 02:23:54 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:24:00 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3850/  4000] |  311/1769 batches | ms/batch 108.3209 | train_loss 6.990028e-01 | lr 3.750000e-06
04/26/2024 02:24:07 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3900/  4000] |  361/1769 batches | ms/batch 108.3924 | train_loss 7.052687e-01 | lr 2.500000e-06
04/26/2024 02:24:07 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 3900 ****
04/26/2024 02:24:07 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:24:14 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3950/  4000] |  411/1769 batches | ms/batch 108.2531 | train_loss 7.006985e-01 | lr 1.250000e-06
04/26/2024 02:24:20 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  4000/  4000] |  461/1769 batches | ms/batch 108.2817 | train_loss 7.077459e-01 | lr 0.000000e+00
04/26/2024 02:24:20 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_ at global_step 4000 ****
04/26/2024 02:24:21 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:24:22 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23489226/tmpl_vrwja_
04/26/2024 02:24:22 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((14146, 512)) with avr_nnz=320.0
04/26/2024 02:24:22 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/26/2024 02:25:34 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn at level 3, nr_labels=30938, avr_M_nnz=12.53068005089778
04/26/2024 02:25:36 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-cased model from s3.
04/26/2024 02:25:48 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23489226/tmphqwmzk9r/X_trn.pt
04/26/2024 02:25:48 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
04/26/2024 02:29:01 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
04/26/2024 02:29:01 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 1
04/26/2024 02:29:01 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
04/26/2024 02:29:01 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/26/2024 02:29:02 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
04/26/2024 02:29:02 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 14146
04/26/2024 02:29:02 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 30938
04/26/2024 02:29:02 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 1631
04/26/2024 02:29:02 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 3
04/26/2024 02:29:02 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
04/26/2024 02:29:02 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 8
04/26/2024 02:29:02 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
04/26/2024 02:29:02 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
04/26/2024 02:29:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][    50/  4000] |   49/1769 batches | ms/batch 108.2932 | train_loss 5.960173e-01 | lr 9.875000e-05
04/26/2024 02:29:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   100/  4000] |   99/1769 batches | ms/batch 107.8620 | train_loss 5.813400e-01 | lr 9.750000e-05
04/26/2024 02:29:17 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 100 ****
04/26/2024 02:29:18 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:29:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   150/  4000] |  149/1769 batches | ms/batch 107.9140 | train_loss 5.684962e-01 | lr 9.625000e-05
04/26/2024 02:29:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   200/  4000] |  199/1769 batches | ms/batch 108.2117 | train_loss 5.638793e-01 | lr 9.500000e-05
04/26/2024 02:29:31 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 200 ****
04/26/2024 02:29:32 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:29:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   250/  4000] |  249/1769 batches | ms/batch 108.1603 | train_loss 5.759795e-01 | lr 9.375000e-05
04/26/2024 02:29:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   300/  4000] |  299/1769 batches | ms/batch 108.1048 | train_loss 5.736758e-01 | lr 9.250000e-05
04/26/2024 02:29:45 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 300 ****
04/26/2024 02:29:46 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:29:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   350/  4000] |  349/1769 batches | ms/batch 108.2446 | train_loss 5.739052e-01 | lr 9.125000e-05
04/26/2024 02:29:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   400/  4000] |  399/1769 batches | ms/batch 108.3411 | train_loss 5.615318e-01 | lr 9.000000e-05
04/26/2024 02:29:59 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 400 ****
04/26/2024 02:30:00 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:30:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   450/  4000] |  449/1769 batches | ms/batch 108.1345 | train_loss 5.791908e-01 | lr 8.875000e-05
04/26/2024 02:30:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   500/  4000] |  499/1769 batches | ms/batch 108.5227 | train_loss 5.912473e-01 | lr 8.750000e-05
04/26/2024 02:30:14 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 500 ****
04/26/2024 02:30:15 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:30:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   550/  4000] |  549/1769 batches | ms/batch 108.5235 | train_loss 5.764662e-01 | lr 8.625000e-05
04/26/2024 02:30:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   600/  4000] |  599/1769 batches | ms/batch 108.3945 | train_loss 5.753617e-01 | lr 8.500000e-05
04/26/2024 02:30:29 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 600 ****
04/26/2024 02:30:30 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:30:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   650/  4000] |  649/1769 batches | ms/batch 108.6734 | train_loss 5.582244e-01 | lr 8.375000e-05
04/26/2024 02:30:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   700/  4000] |  699/1769 batches | ms/batch 108.8076 | train_loss 5.781556e-01 | lr 8.250000e-05
04/26/2024 02:30:44 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 700 ****
04/26/2024 02:30:45 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:30:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   750/  4000] |  749/1769 batches | ms/batch 108.6362 | train_loss 5.773289e-01 | lr 8.125000e-05
04/26/2024 02:30:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   800/  4000] |  799/1769 batches | ms/batch 108.6363 | train_loss 5.776330e-01 | lr 8.000000e-05
04/26/2024 02:30:59 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 800 ****
04/26/2024 02:31:00 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:31:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   850/  4000] |  849/1769 batches | ms/batch 108.7109 | train_loss 5.688894e-01 | lr 7.875000e-05
04/26/2024 02:31:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   900/  4000] |  899/1769 batches | ms/batch 108.4711 | train_loss 5.702952e-01 | lr 7.750000e-05
04/26/2024 02:31:13 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 900 ****
04/26/2024 02:31:14 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:31:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   950/  4000] |  949/1769 batches | ms/batch 108.5677 | train_loss 5.668399e-01 | lr 7.625000e-05
04/26/2024 02:31:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1000/  4000] |  999/1769 batches | ms/batch 108.8077 | train_loss 5.713154e-01 | lr 7.500000e-05
04/26/2024 02:31:28 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 1000 ****
04/26/2024 02:31:29 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:31:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1050/  4000] | 1049/1769 batches | ms/batch 108.6665 | train_loss 5.676723e-01 | lr 7.375000e-05
04/26/2024 02:31:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1100/  4000] | 1099/1769 batches | ms/batch 108.5232 | train_loss 5.911500e-01 | lr 7.250000e-05
04/26/2024 02:31:42 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 1100 ****
04/26/2024 02:31:43 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:31:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1150/  4000] | 1149/1769 batches | ms/batch 108.7253 | train_loss 5.734821e-01 | lr 7.125000e-05
04/26/2024 02:31:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1200/  4000] | 1199/1769 batches | ms/batch 108.8221 | train_loss 5.857128e-01 | lr 7.000000e-05
04/26/2024 02:31:57 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 1200 ****
04/26/2024 02:31:57 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:32:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1250/  4000] | 1249/1769 batches | ms/batch 108.7244 | train_loss 5.794080e-01 | lr 6.875000e-05
04/26/2024 02:32:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1300/  4000] | 1299/1769 batches | ms/batch 108.5282 | train_loss 5.623322e-01 | lr 6.750000e-05
04/26/2024 02:32:11 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 1300 ****
04/26/2024 02:32:11 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:32:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1350/  4000] | 1349/1769 batches | ms/batch 108.7055 | train_loss 5.709505e-01 | lr 6.625000e-05
04/26/2024 02:32:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1400/  4000] | 1399/1769 batches | ms/batch 108.8178 | train_loss 5.876704e-01 | lr 6.500000e-05
04/26/2024 02:32:25 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 1400 ****
04/26/2024 02:32:26 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:32:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1450/  4000] | 1449/1769 batches | ms/batch 108.7878 | train_loss 5.774641e-01 | lr 6.375000e-05
04/26/2024 02:32:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1500/  4000] | 1499/1769 batches | ms/batch 108.5992 | train_loss 5.730826e-01 | lr 6.250000e-05
04/26/2024 02:32:39 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 1500 ****
04/26/2024 02:32:40 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:32:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1550/  4000] | 1549/1769 batches | ms/batch 108.7266 | train_loss 5.653962e-01 | lr 6.125000e-05
04/26/2024 02:32:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1600/  4000] | 1599/1769 batches | ms/batch 108.7685 | train_loss 5.751553e-01 | lr 6.000000e-05
04/26/2024 02:32:54 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 1600 ****
04/26/2024 02:32:55 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:33:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1650/  4000] | 1649/1769 batches | ms/batch 108.7805 | train_loss 5.712275e-01 | lr 5.875000e-05
04/26/2024 02:33:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1700/  4000] | 1699/1769 batches | ms/batch 108.5283 | train_loss 5.654733e-01 | lr 5.750000e-05
04/26/2024 02:33:08 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 1700 ****
04/26/2024 02:33:09 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:33:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1750/  4000] | 1749/1769 batches | ms/batch 108.6810 | train_loss 5.648027e-01 | lr 5.625000e-05
04/26/2024 02:33:24 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1800/  4000] |   30/1769 batches | ms/batch 107.4314 | train_loss 5.664326e-01 | lr 5.500000e-05
04/26/2024 02:33:24 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 1800 ****
04/26/2024 02:33:25 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:33:32 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1850/  4000] |   80/1769 batches | ms/batch 108.7709 | train_loss 5.649393e-01 | lr 5.375000e-05
04/26/2024 02:33:39 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1900/  4000] |  130/1769 batches | ms/batch 108.5576 | train_loss 5.790019e-01 | lr 5.250000e-05
04/26/2024 02:33:39 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 1900 ****
04/26/2024 02:33:40 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:33:47 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1950/  4000] |  180/1769 batches | ms/batch 108.8394 | train_loss 5.581513e-01 | lr 5.125000e-05
04/26/2024 02:33:54 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2000/  4000] |  230/1769 batches | ms/batch 108.9133 | train_loss 5.717561e-01 | lr 5.000000e-05
04/26/2024 02:33:54 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 2000 ****
04/26/2024 02:33:54 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:34:01 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2050/  4000] |  280/1769 batches | ms/batch 108.7660 | train_loss 5.822099e-01 | lr 4.875000e-05
04/26/2024 02:34:08 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2100/  4000] |  330/1769 batches | ms/batch 108.6298 | train_loss 5.697744e-01 | lr 4.750000e-05
04/26/2024 02:34:08 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 2100 ****
04/26/2024 02:34:09 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:34:16 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2150/  4000] |  380/1769 batches | ms/batch 108.8623 | train_loss 5.810198e-01 | lr 4.625000e-05
04/26/2024 02:34:23 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2200/  4000] |  430/1769 batches | ms/batch 108.9027 | train_loss 5.510528e-01 | lr 4.500000e-05
04/26/2024 02:34:23 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 2200 ****
04/26/2024 02:34:24 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:34:30 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2250/  4000] |  480/1769 batches | ms/batch 108.7434 | train_loss 5.827095e-01 | lr 4.375000e-05
04/26/2024 02:34:37 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2300/  4000] |  530/1769 batches | ms/batch 108.6010 | train_loss 5.836237e-01 | lr 4.250000e-05
04/26/2024 02:34:37 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 2300 ****
04/26/2024 02:34:38 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:34:44 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2350/  4000] |  580/1769 batches | ms/batch 108.8285 | train_loss 5.748843e-01 | lr 4.125000e-05
04/26/2024 02:34:51 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2400/  4000] |  630/1769 batches | ms/batch 108.9003 | train_loss 5.871607e-01 | lr 4.000000e-05
04/26/2024 02:34:51 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 2400 ****
04/26/2024 02:34:52 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:34:59 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2450/  4000] |  680/1769 batches | ms/batch 108.7842 | train_loss 5.628355e-01 | lr 3.875000e-05
04/26/2024 02:35:06 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2500/  4000] |  730/1769 batches | ms/batch 108.6417 | train_loss 5.614446e-01 | lr 3.750000e-05
04/26/2024 02:35:06 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 2500 ****
04/26/2024 02:35:07 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:35:13 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2550/  4000] |  780/1769 batches | ms/batch 108.8605 | train_loss 5.665174e-01 | lr 3.625000e-05
04/26/2024 02:35:20 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2600/  4000] |  830/1769 batches | ms/batch 108.8477 | train_loss 5.535990e-01 | lr 3.500000e-05
04/26/2024 02:35:20 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 2600 ****
04/26/2024 02:35:21 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:35:28 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2650/  4000] |  880/1769 batches | ms/batch 108.8249 | train_loss 5.802221e-01 | lr 3.375000e-05
04/26/2024 02:35:34 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2700/  4000] |  930/1769 batches | ms/batch 108.5893 | train_loss 5.658956e-01 | lr 3.250000e-05
04/26/2024 02:35:34 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 2700 ****
04/26/2024 02:35:35 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:35:42 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2750/  4000] |  980/1769 batches | ms/batch 108.7745 | train_loss 5.720235e-01 | lr 3.125000e-05
04/26/2024 02:35:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2800/  4000] | 1030/1769 batches | ms/batch 108.8881 | train_loss 5.786037e-01 | lr 3.000000e-05
04/26/2024 02:35:49 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 2800 ****
04/26/2024 02:35:50 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:35:57 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2850/  4000] | 1080/1769 batches | ms/batch 108.7868 | train_loss 5.643023e-01 | lr 2.875000e-05
04/26/2024 02:36:04 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2900/  4000] | 1130/1769 batches | ms/batch 108.5982 | train_loss 5.714868e-01 | lr 2.750000e-05
04/26/2024 02:36:04 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 2900 ****
04/26/2024 02:36:04 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:36:11 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2950/  4000] | 1180/1769 batches | ms/batch 108.8565 | train_loss 5.888615e-01 | lr 2.625000e-05
04/26/2024 02:36:18 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3000/  4000] | 1230/1769 batches | ms/batch 108.9125 | train_loss 5.751023e-01 | lr 2.500000e-05
04/26/2024 02:36:18 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 3000 ****
04/26/2024 02:36:19 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:36:26 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3050/  4000] | 1280/1769 batches | ms/batch 108.6720 | train_loss 5.650277e-01 | lr 2.375000e-05
04/26/2024 02:36:33 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3100/  4000] | 1330/1769 batches | ms/batch 108.6245 | train_loss 5.771725e-01 | lr 2.250000e-05
04/26/2024 02:36:33 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 3100 ****
04/26/2024 02:36:33 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:36:40 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3150/  4000] | 1380/1769 batches | ms/batch 108.7993 | train_loss 5.736816e-01 | lr 2.125000e-05
04/26/2024 02:36:47 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3200/  4000] | 1430/1769 batches | ms/batch 108.8934 | train_loss 5.769310e-01 | lr 2.000000e-05
04/26/2024 02:36:47 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 3200 ****
04/26/2024 02:36:48 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:36:55 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3250/  4000] | 1480/1769 batches | ms/batch 108.7116 | train_loss 5.691652e-01 | lr 1.875000e-05
04/26/2024 02:37:02 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3300/  4000] | 1530/1769 batches | ms/batch 108.5639 | train_loss 5.605348e-01 | lr 1.750000e-05
04/26/2024 02:37:02 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 3300 ****
04/26/2024 02:37:02 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:37:09 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3350/  4000] | 1580/1769 batches | ms/batch 108.8108 | train_loss 5.743923e-01 | lr 1.625000e-05
04/26/2024 02:37:16 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3400/  4000] | 1630/1769 batches | ms/batch 108.8504 | train_loss 5.608376e-01 | lr 1.500000e-05
04/26/2024 02:37:16 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 3400 ****
04/26/2024 02:37:17 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:37:24 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3450/  4000] | 1680/1769 batches | ms/batch 108.8216 | train_loss 5.869301e-01 | lr 1.375000e-05
04/26/2024 02:37:31 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3500/  4000] | 1730/1769 batches | ms/batch 108.6520 | train_loss 5.644076e-01 | lr 1.250000e-05
04/26/2024 02:37:31 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 3500 ****
04/26/2024 02:37:31 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:37:39 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3550/  4000] |   11/1769 batches | ms/batch 107.4086 | train_loss 5.707440e-01 | lr 1.125000e-05
04/26/2024 02:37:46 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3600/  4000] |   61/1769 batches | ms/batch 108.8408 | train_loss 5.731999e-01 | lr 1.000000e-05
04/26/2024 02:37:46 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 3600 ****
04/26/2024 02:37:47 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:37:54 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3650/  4000] |  111/1769 batches | ms/batch 108.7328 | train_loss 5.558721e-01 | lr 8.750000e-06
04/26/2024 02:38:00 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3700/  4000] |  161/1769 batches | ms/batch 108.6582 | train_loss 5.656892e-01 | lr 7.500000e-06
04/26/2024 02:38:00 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 3700 ****
04/26/2024 02:38:01 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:38:08 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3750/  4000] |  211/1769 batches | ms/batch 108.8512 | train_loss 5.672773e-01 | lr 6.250000e-06
04/26/2024 02:38:15 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3800/  4000] |  261/1769 batches | ms/batch 108.8575 | train_loss 5.640968e-01 | lr 5.000000e-06
04/26/2024 02:38:15 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 3800 ****
04/26/2024 02:38:16 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:38:22 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3850/  4000] |  311/1769 batches | ms/batch 108.7040 | train_loss 5.712375e-01 | lr 3.750000e-06
04/26/2024 02:38:29 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3900/  4000] |  361/1769 batches | ms/batch 108.7770 | train_loss 5.681694e-01 | lr 2.500000e-06
04/26/2024 02:38:29 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 3900 ****
04/26/2024 02:38:30 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:38:37 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3950/  4000] |  411/1769 batches | ms/batch 108.8288 | train_loss 5.592541e-01 | lr 1.250000e-06
04/26/2024 02:38:44 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  4000/  4000] |  461/1769 batches | ms/batch 108.8969 | train_loss 5.762119e-01 | lr 0.000000e+00
04/26/2024 02:38:44 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u at global_step 4000 ****
04/26/2024 02:38:45 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:38:45 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23489226/tmpx32wxe9u
04/26/2024 02:38:46 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((14146, 30938)) with avr_nnz=1206.0
04/26/2024 02:38:46 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/26/2024 02:39:59 - INFO - pecos.xmc.xtransformer.model - Constructed instance feature matrix with shape=(14146, 102706)
04/26/2024 02:40:06 - INFO - pecos.xmc.xtransformer.model - Hierarchical label tree for ranker: [2, 32, 512, 30938]
04/26/2024 02:40:06 - INFO - pecos.xmc.xtransformer.model - Start training ranker...
04/26/2024 02:40:07 - INFO - pecos.xmc.base - Training Layer 0 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
04/26/2024 02:40:07 - INFO - pecos.xmc.base - Training Layer 1 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
04/26/2024 02:40:13 - INFO - pecos.xmc.base - Training Layer 2 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
04/26/2024 02:40:29 - INFO - pecos.xmc.base - Training Layer 3 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
04/26/2024 02:41:36 - INFO - pecos.xmc.xtransformer.model - Parameters saved to ./trained-models/xr_model_wiki10-31k/param.json
04/26/2024 02:41:38 - INFO - pecos.xmc.xtransformer.model - Model saved to ./trained-models/xr_model_wiki10-31k

============================= JOB FEEDBACK =============================

NodeName=uc2n485
Job ID: 23489226
Cluster: uc2
User/Group: ul_ruw26/ul_student
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 01:43:13
CPU Efficiency: 19.50% of 08:49:20 core-walltime
Job Wall-clock time: 00:52:56
Memory Utilized: 19.62 GB
Memory Efficiency: 66.99% of 29.30 GB
