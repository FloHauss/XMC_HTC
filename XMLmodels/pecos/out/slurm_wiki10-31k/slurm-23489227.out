04/26/2024 02:45:46 - INFO - __main__ - Setting random seed 0
04/26/2024 02:45:46 - INFO - __main__ - Loaded training feature matrix with shape=(14146, 101938)
04/26/2024 02:45:47 - INFO - __main__ - Loaded training label matrix with shape=(14146, 30938)
04/26/2024 02:45:47 - INFO - __main__ - Loaded 14146 training sequences
04/26/2024 02:45:54 - INFO - pecos.xmc.xtransformer.model - Hierarchical label tree: [2, 32, 512, 30938]
04/26/2024 02:45:54 - INFO - pecos.xmc.xtransformer.model - Fine-tune Transformers with nr_labels=[2, 32, 512, 30938]
04/26/2024 02:45:54 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn at level 0, nr_labels=2, avr_M_nnz=2
04/26/2024 02:45:58 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-cased model from s3.
04/26/2024 02:45:58 - INFO - pecos.xmc.xtransformer.matcher - ***** Encoding data len=14146 truncation=256*****
04/26/2024 02:46:16 - INFO - pecos.xmc.xtransformer.matcher - ***** Finished with time cost=18.31361746788025 *****
04/26/2024 02:46:26 - INFO - pecos.xmc.xtransformer.matcher - trn tensors saved to /scratch/slurm_tmpdir/job_23489227/tmpluzkfiug/X_trn.pt
04/26/2024 02:46:26 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 1
04/26/2024 02:46:30 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
04/26/2024 02:46:30 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
/home/ul/ul_student/ul_ruw26/.local/lib/python3.9/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
04/26/2024 02:46:30 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
04/26/2024 02:46:30 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 14146
04/26/2024 02:46:30 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 2
04/26/2024 02:46:30 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 3
04/26/2024 02:46:30 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
04/26/2024 02:46:30 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 8
04/26/2024 02:46:30 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
04/26/2024 02:46:30 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
04/26/2024 02:46:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][    50/  4000] |   49/1769 batches | ms/batch 177.8116 | train_loss 3.287692e-01 | lr 9.875000e-05
04/26/2024 02:46:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   100/  4000] |   99/1769 batches | ms/batch 107.1972 | train_loss 2.736668e-01 | lr 9.750000e-05
04/26/2024 02:46:48 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 100 ****
04/26/2024 02:46:49 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:46:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   150/  4000] |  149/1769 batches | ms/batch 107.1048 | train_loss 2.471865e-01 | lr 9.625000e-05
04/26/2024 02:47:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   200/  4000] |  199/1769 batches | ms/batch 107.2012 | train_loss 2.214904e-01 | lr 9.500000e-05
04/26/2024 02:47:01 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 200 ****
04/26/2024 02:47:02 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:47:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   250/  4000] |  249/1769 batches | ms/batch 107.4053 | train_loss 2.329297e-01 | lr 9.375000e-05
04/26/2024 02:47:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   300/  4000] |  299/1769 batches | ms/batch 107.4730 | train_loss 2.240005e-01 | lr 9.250000e-05
04/26/2024 02:47:15 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 300 ****
04/26/2024 02:47:15 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:47:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   350/  4000] |  349/1769 batches | ms/batch 107.3032 | train_loss 2.447918e-01 | lr 9.125000e-05
04/26/2024 02:47:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   400/  4000] |  399/1769 batches | ms/batch 107.6624 | train_loss 2.479854e-01 | lr 9.000000e-05
04/26/2024 02:47:28 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 400 ****
04/26/2024 02:47:29 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:47:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   450/  4000] |  449/1769 batches | ms/batch 107.5542 | train_loss 1.750621e-01 | lr 8.875000e-05
04/26/2024 02:47:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   500/  4000] |  499/1769 batches | ms/batch 107.7307 | train_loss 2.410800e-01 | lr 8.750000e-05
04/26/2024 02:47:42 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 500 ****
04/26/2024 02:47:42 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:47:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   550/  4000] |  549/1769 batches | ms/batch 107.7985 | train_loss 2.500334e-01 | lr 8.625000e-05
04/26/2024 02:47:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   600/  4000] |  599/1769 batches | ms/batch 107.7189 | train_loss 1.967428e-01 | lr 8.500000e-05
04/26/2024 02:47:55 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 600 ****
04/26/2024 02:47:56 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:48:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   650/  4000] |  649/1769 batches | ms/batch 107.1448 | train_loss 2.042740e-01 | lr 8.375000e-05
04/26/2024 02:48:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   700/  4000] |  699/1769 batches | ms/batch 107.4665 | train_loss 2.186699e-01 | lr 8.250000e-05
04/26/2024 02:48:08 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 700 ****
04/26/2024 02:48:09 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:48:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   750/  4000] |  749/1769 batches | ms/batch 108.0235 | train_loss 2.749361e-01 | lr 8.125000e-05
04/26/2024 02:48:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   800/  4000] |  799/1769 batches | ms/batch 108.2528 | train_loss 2.574511e-01 | lr 8.000000e-05
04/26/2024 02:48:22 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 800 ****
04/26/2024 02:48:22 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:48:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   850/  4000] |  849/1769 batches | ms/batch 108.0093 | train_loss 2.390957e-01 | lr 7.875000e-05
04/26/2024 02:48:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   900/  4000] |  899/1769 batches | ms/batch 108.2632 | train_loss 2.532062e-01 | lr 7.750000e-05
04/26/2024 02:48:36 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 900 ****
04/26/2024 02:48:36 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:48:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   950/  4000] |  949/1769 batches | ms/batch 108.2655 | train_loss 2.727655e-01 | lr 7.625000e-05
04/26/2024 02:48:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1000/  4000] |  999/1769 batches | ms/batch 108.2027 | train_loss 1.954234e-01 | lr 7.500000e-05
04/26/2024 02:48:49 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 1000 ****
04/26/2024 02:48:50 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:48:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1050/  4000] | 1049/1769 batches | ms/batch 107.9074 | train_loss 2.003824e-01 | lr 7.375000e-05
04/26/2024 02:49:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1100/  4000] | 1099/1769 batches | ms/batch 108.5186 | train_loss 3.098347e-01 | lr 7.250000e-05
04/26/2024 02:49:03 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 1100 ****
04/26/2024 02:49:03 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:49:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1150/  4000] | 1149/1769 batches | ms/batch 108.0995 | train_loss 2.049502e-01 | lr 7.125000e-05
04/26/2024 02:49:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1200/  4000] | 1199/1769 batches | ms/batch 107.9026 | train_loss 1.818969e-01 | lr 7.000000e-05
04/26/2024 02:49:16 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 1200 ****
04/26/2024 02:49:17 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:49:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1250/  4000] | 1249/1769 batches | ms/batch 108.0853 | train_loss 2.335273e-01 | lr 6.875000e-05
04/26/2024 02:49:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1300/  4000] | 1299/1769 batches | ms/batch 108.2970 | train_loss 2.741250e-01 | lr 6.750000e-05
04/26/2024 02:49:30 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 1300 ****
04/26/2024 02:49:30 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:49:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1350/  4000] | 1349/1769 batches | ms/batch 108.2398 | train_loss 2.292755e-01 | lr 6.625000e-05
04/26/2024 02:49:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1400/  4000] | 1399/1769 batches | ms/batch 108.4599 | train_loss 3.308355e-01 | lr 6.500000e-05
04/26/2024 02:49:43 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 1400 ****
04/26/2024 02:49:44 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:49:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1450/  4000] | 1449/1769 batches | ms/batch 108.2969 | train_loss 2.000582e-01 | lr 6.375000e-05
04/26/2024 02:49:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1500/  4000] | 1499/1769 batches | ms/batch 107.9567 | train_loss 1.808963e-01 | lr 6.250000e-05
04/26/2024 02:49:56 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 1500 ****
04/26/2024 02:49:57 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:50:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1550/  4000] | 1549/1769 batches | ms/batch 108.3205 | train_loss 2.366961e-01 | lr 6.125000e-05
04/26/2024 02:50:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1600/  4000] | 1599/1769 batches | ms/batch 108.1043 | train_loss 1.825001e-01 | lr 6.000000e-05
04/26/2024 02:50:10 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 1600 ****
04/26/2024 02:50:10 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:50:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1650/  4000] | 1649/1769 batches | ms/batch 108.1769 | train_loss 1.561529e-01 | lr 5.875000e-05
04/26/2024 02:50:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1700/  4000] | 1699/1769 batches | ms/batch 108.5617 | train_loss 2.620293e-01 | lr 5.750000e-05
04/26/2024 02:50:24 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 1700 ****
04/26/2024 02:50:24 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:50:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1750/  4000] | 1749/1769 batches | ms/batch 107.8328 | train_loss 2.074000e-01 | lr 5.625000e-05
04/26/2024 02:50:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1800/  4000] |   30/1769 batches | ms/batch 107.0386 | train_loss 2.392684e-01 | lr 5.500000e-05
04/26/2024 02:50:38 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 1800 ****
04/26/2024 02:50:39 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:50:45 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1850/  4000] |   80/1769 batches | ms/batch 108.4688 | train_loss 2.456084e-01 | lr 5.375000e-05
04/26/2024 02:50:52 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1900/  4000] |  130/1769 batches | ms/batch 107.9733 | train_loss 1.837301e-01 | lr 5.250000e-05
04/26/2024 02:50:52 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 1900 ****
04/26/2024 02:50:53 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:50:59 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1950/  4000] |  180/1769 batches | ms/batch 108.0055 | train_loss 2.460127e-01 | lr 5.125000e-05
04/26/2024 02:51:06 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2000/  4000] |  230/1769 batches | ms/batch 108.4767 | train_loss 2.503598e-01 | lr 5.000000e-05
04/26/2024 02:51:06 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 2000 ****
04/26/2024 02:51:06 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:51:13 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2050/  4000] |  280/1769 batches | ms/batch 108.5263 | train_loss 1.610543e-01 | lr 4.875000e-05
04/26/2024 02:51:19 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2100/  4000] |  330/1769 batches | ms/batch 107.9430 | train_loss 1.626863e-01 | lr 4.750000e-05
04/26/2024 02:51:19 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 2100 ****
04/26/2024 02:51:20 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:51:26 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2150/  4000] |  380/1769 batches | ms/batch 108.1686 | train_loss 2.116245e-01 | lr 4.625000e-05
04/26/2024 02:51:33 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2200/  4000] |  430/1769 batches | ms/batch 108.5511 | train_loss 2.249361e-01 | lr 4.500000e-05
04/26/2024 02:51:33 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 2200 ****
04/26/2024 02:51:33 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:51:40 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2250/  4000] |  480/1769 batches | ms/batch 108.4911 | train_loss 2.151489e-01 | lr 4.375000e-05
04/26/2024 02:51:46 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2300/  4000] |  530/1769 batches | ms/batch 108.3464 | train_loss 1.996027e-01 | lr 4.250000e-05
04/26/2024 02:51:46 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 2300 ****
04/26/2024 02:51:47 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:51:53 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2350/  4000] |  580/1769 batches | ms/batch 108.3757 | train_loss 2.025165e-01 | lr 4.125000e-05
04/26/2024 02:52:00 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2400/  4000] |  630/1769 batches | ms/batch 108.5125 | train_loss 2.397778e-01 | lr 4.000000e-05
04/26/2024 02:52:00 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 2400 ****
04/26/2024 02:52:00 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:52:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2450/  4000] |  680/1769 batches | ms/batch 109.1689 | train_loss 2.352967e-01 | lr 3.875000e-05
04/26/2024 02:52:14 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2500/  4000] |  730/1769 batches | ms/batch 108.7086 | train_loss 2.712094e-01 | lr 3.750000e-05
04/26/2024 02:52:14 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 2500 ****
04/26/2024 02:52:14 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:52:21 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2550/  4000] |  780/1769 batches | ms/batch 108.5108 | train_loss 2.161326e-01 | lr 3.625000e-05
04/26/2024 02:52:27 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2600/  4000] |  830/1769 batches | ms/batch 108.1798 | train_loss 2.354678e-01 | lr 3.500000e-05
04/26/2024 02:52:27 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 2600 ****
04/26/2024 02:52:28 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:52:34 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2650/  4000] |  880/1769 batches | ms/batch 108.5507 | train_loss 2.643880e-01 | lr 3.375000e-05
04/26/2024 02:52:41 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2700/  4000] |  930/1769 batches | ms/batch 109.0300 | train_loss 2.502709e-01 | lr 3.250000e-05
04/26/2024 02:52:41 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 2700 ****
04/26/2024 02:52:41 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:52:48 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2750/  4000] |  980/1769 batches | ms/batch 108.3121 | train_loss 1.721633e-01 | lr 3.125000e-05
04/26/2024 02:52:54 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2800/  4000] | 1030/1769 batches | ms/batch 108.5020 | train_loss 2.142879e-01 | lr 3.000000e-05
04/26/2024 02:52:54 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 2800 ****
04/26/2024 02:52:55 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:53:01 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2850/  4000] | 1080/1769 batches | ms/batch 108.3301 | train_loss 1.837000e-01 | lr 2.875000e-05
04/26/2024 02:53:08 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2900/  4000] | 1130/1769 batches | ms/batch 108.5298 | train_loss 2.543318e-01 | lr 2.750000e-05
04/26/2024 02:53:08 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 2900 ****
04/26/2024 02:53:08 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:53:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2950/  4000] | 1180/1769 batches | ms/batch 108.0266 | train_loss 1.825238e-01 | lr 2.625000e-05
04/26/2024 02:53:21 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3000/  4000] | 1230/1769 batches | ms/batch 108.3834 | train_loss 2.225529e-01 | lr 2.500000e-05
04/26/2024 02:53:21 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 3000 ****
04/26/2024 02:53:22 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:53:29 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3050/  4000] | 1280/1769 batches | ms/batch 108.8934 | train_loss 2.523900e-01 | lr 2.375000e-05
04/26/2024 02:53:35 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3100/  4000] | 1330/1769 batches | ms/batch 108.9091 | train_loss 1.944376e-01 | lr 2.250000e-05
04/26/2024 02:53:35 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 3100 ****
04/26/2024 02:53:36 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:53:42 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3150/  4000] | 1380/1769 batches | ms/batch 108.4791 | train_loss 2.257248e-01 | lr 2.125000e-05
04/26/2024 02:53:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3200/  4000] | 1430/1769 batches | ms/batch 108.4787 | train_loss 2.609444e-01 | lr 2.000000e-05
04/26/2024 02:53:49 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 3200 ****
04/26/2024 02:53:49 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:53:56 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3250/  4000] | 1480/1769 batches | ms/batch 108.8492 | train_loss 2.285397e-01 | lr 1.875000e-05
04/26/2024 02:54:02 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3300/  4000] | 1530/1769 batches | ms/batch 108.8994 | train_loss 2.593087e-01 | lr 1.750000e-05
04/26/2024 02:54:02 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 3300 ****
04/26/2024 02:54:03 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:54:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3350/  4000] | 1580/1769 batches | ms/batch 108.7298 | train_loss 2.618899e-01 | lr 1.625000e-05
04/26/2024 02:54:16 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3400/  4000] | 1630/1769 batches | ms/batch 108.5860 | train_loss 2.201487e-01 | lr 1.500000e-05
04/26/2024 02:54:16 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 3400 ****
04/26/2024 02:54:17 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:54:24 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3450/  4000] | 1680/1769 batches | ms/batch 108.6243 | train_loss 2.466426e-01 | lr 1.375000e-05
04/26/2024 02:54:30 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3500/  4000] | 1730/1769 batches | ms/batch 108.4922 | train_loss 1.858095e-01 | lr 1.250000e-05
04/26/2024 02:54:30 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 3500 ****
04/26/2024 02:54:31 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:54:38 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3550/  4000] |   11/1769 batches | ms/batch 106.9749 | train_loss 1.897224e-01 | lr 1.125000e-05
04/26/2024 02:54:45 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3600/  4000] |   61/1769 batches | ms/batch 108.5580 | train_loss 2.828891e-01 | lr 1.000000e-05
04/26/2024 02:54:45 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 3600 ****
04/26/2024 02:54:46 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:54:52 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3650/  4000] |  111/1769 batches | ms/batch 108.8002 | train_loss 2.060229e-01 | lr 8.750000e-06
04/26/2024 02:54:59 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3700/  4000] |  161/1769 batches | ms/batch 108.5404 | train_loss 2.306875e-01 | lr 7.500000e-06
04/26/2024 02:54:59 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 3700 ****
04/26/2024 02:54:59 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:55:06 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3750/  4000] |  211/1769 batches | ms/batch 108.6677 | train_loss 1.802271e-01 | lr 6.250000e-06
04/26/2024 02:55:12 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3800/  4000] |  261/1769 batches | ms/batch 108.4977 | train_loss 2.448175e-01 | lr 5.000000e-06
04/26/2024 02:55:12 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 3800 ****
04/26/2024 02:55:13 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:55:19 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3850/  4000] |  311/1769 batches | ms/batch 108.8986 | train_loss 2.220399e-01 | lr 3.750000e-06
04/26/2024 02:55:26 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3900/  4000] |  361/1769 batches | ms/batch 108.6489 | train_loss 2.389014e-01 | lr 2.500000e-06
04/26/2024 02:55:26 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 3900 ****
04/26/2024 02:55:26 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:55:33 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3950/  4000] |  411/1769 batches | ms/batch 108.5052 | train_loss 2.258494e-01 | lr 1.250000e-06
04/26/2024 02:55:39 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  4000/  4000] |  461/1769 batches | ms/batch 108.4532 | train_loss 1.786925e-01 | lr 0.000000e+00
04/26/2024 02:55:39 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h at global_step 4000 ****
04/26/2024 02:55:40 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:55:40 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23489227/tmpjflstn3h
04/26/2024 02:55:41 - INFO - pecos.xmc.xtransformer.matcher - Predict on input text tensors(torch.Size([14146, 256])) in OVA mode
04/26/2024 02:55:41 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/26/2024 02:56:55 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn at level 1, nr_labels=32, avr_M_nnz=1.8872472783825816
04/26/2024 02:56:55 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-cased model from s3.
04/26/2024 02:57:09 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23489227/tmpluzkfiug/X_trn.pt
04/26/2024 02:57:09 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
04/26/2024 02:57:20 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
04/26/2024 02:57:20 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 1
04/26/2024 02:57:21 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
04/26/2024 02:57:21 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/26/2024 02:57:21 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
04/26/2024 02:57:21 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 14146
04/26/2024 02:57:21 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 32
04/26/2024 02:57:21 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 32
04/26/2024 02:57:21 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 3
04/26/2024 02:57:21 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
04/26/2024 02:57:21 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 8
04/26/2024 02:57:21 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
04/26/2024 02:57:21 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
04/26/2024 02:57:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][    50/  4000] |   49/1769 batches | ms/batch 112.0300 | train_loss 6.306157e+00 | lr 9.875000e-05
04/26/2024 02:57:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   100/  4000] |   99/1769 batches | ms/batch 108.8649 | train_loss 2.128735e+00 | lr 9.750000e-05
04/26/2024 02:57:37 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 100 ****
04/26/2024 02:57:38 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:57:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   150/  4000] |  149/1769 batches | ms/batch 109.0002 | train_loss 2.094356e+00 | lr 9.625000e-05
04/26/2024 02:57:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   200/  4000] |  199/1769 batches | ms/batch 109.0551 | train_loss 2.380812e+00 | lr 9.500000e-05
04/26/2024 02:57:51 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 200 ****
04/26/2024 02:57:52 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:57:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   250/  4000] |  249/1769 batches | ms/batch 109.1583 | train_loss 2.111720e+00 | lr 9.375000e-05
04/26/2024 02:58:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   300/  4000] |  299/1769 batches | ms/batch 109.1930 | train_loss 1.885176e+00 | lr 9.250000e-05
04/26/2024 02:58:05 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 300 ****
04/26/2024 02:58:06 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:58:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   350/  4000] |  349/1769 batches | ms/batch 109.0519 | train_loss 1.750816e+00 | lr 9.125000e-05
04/26/2024 02:58:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   400/  4000] |  399/1769 batches | ms/batch 109.3354 | train_loss 1.532837e+00 | lr 9.000000e-05
04/26/2024 02:58:19 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 400 ****
04/26/2024 02:58:20 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:58:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   450/  4000] |  449/1769 batches | ms/batch 109.2390 | train_loss 1.685312e+00 | lr 8.875000e-05
04/26/2024 02:58:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   500/  4000] |  499/1769 batches | ms/batch 109.3235 | train_loss 2.086196e+00 | lr 8.750000e-05
04/26/2024 02:58:33 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 500 ****
04/26/2024 02:58:34 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:58:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   550/  4000] |  549/1769 batches | ms/batch 109.3745 | train_loss 1.419042e+00 | lr 8.625000e-05
04/26/2024 02:58:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   600/  4000] |  599/1769 batches | ms/batch 109.2316 | train_loss 1.694276e+00 | lr 8.500000e-05
04/26/2024 02:58:47 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 600 ****
04/26/2024 02:58:48 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:58:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   650/  4000] |  649/1769 batches | ms/batch 109.3712 | train_loss 1.374584e+00 | lr 8.375000e-05
04/26/2024 02:59:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   700/  4000] |  699/1769 batches | ms/batch 109.4100 | train_loss 1.501581e+00 | lr 8.250000e-05
04/26/2024 02:59:02 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 700 ****
04/26/2024 02:59:02 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:59:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   750/  4000] |  749/1769 batches | ms/batch 109.4199 | train_loss 1.323411e+00 | lr 8.125000e-05
04/26/2024 02:59:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   800/  4000] |  799/1769 batches | ms/batch 109.4317 | train_loss 1.590419e+00 | lr 8.000000e-05
04/26/2024 02:59:16 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 800 ****
04/26/2024 02:59:16 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:59:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   850/  4000] |  849/1769 batches | ms/batch 109.2842 | train_loss 1.266486e+00 | lr 7.875000e-05
04/26/2024 02:59:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   900/  4000] |  899/1769 batches | ms/batch 109.4055 | train_loss 1.312596e+00 | lr 7.750000e-05
04/26/2024 02:59:30 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 900 ****
04/26/2024 02:59:30 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:59:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   950/  4000] |  949/1769 batches | ms/batch 109.4758 | train_loss 1.440899e+00 | lr 7.625000e-05
04/26/2024 02:59:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1000/  4000] |  999/1769 batches | ms/batch 109.4821 | train_loss 1.184906e+00 | lr 7.500000e-05
04/26/2024 02:59:44 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 1000 ****
04/26/2024 02:59:44 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 02:59:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1050/  4000] | 1049/1769 batches | ms/batch 109.3354 | train_loss 1.470939e+00 | lr 7.375000e-05
04/26/2024 02:59:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1100/  4000] | 1099/1769 batches | ms/batch 109.4779 | train_loss 1.439396e+00 | lr 7.250000e-05
04/26/2024 02:59:58 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 1100 ****
04/26/2024 02:59:59 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:00:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1150/  4000] | 1149/1769 batches | ms/batch 109.4511 | train_loss 1.128162e+00 | lr 7.125000e-05
04/26/2024 03:00:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1200/  4000] | 1199/1769 batches | ms/batch 109.5500 | train_loss 1.150385e+00 | lr 7.000000e-05
04/26/2024 03:00:12 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 1200 ****
04/26/2024 03:00:13 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:00:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1250/  4000] | 1249/1769 batches | ms/batch 109.4284 | train_loss 1.083350e+00 | lr 6.875000e-05
04/26/2024 03:00:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1300/  4000] | 1299/1769 batches | ms/batch 109.5102 | train_loss 1.099967e+00 | lr 6.750000e-05
04/26/2024 03:00:26 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 1300 ****
04/26/2024 03:00:27 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:00:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1350/  4000] | 1349/1769 batches | ms/batch 109.4044 | train_loss 1.249143e+00 | lr 6.625000e-05
04/26/2024 03:00:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1400/  4000] | 1399/1769 batches | ms/batch 109.4860 | train_loss 1.186586e+00 | lr 6.500000e-05
04/26/2024 03:00:40 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 1400 ****
04/26/2024 03:00:41 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:00:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1450/  4000] | 1449/1769 batches | ms/batch 109.4565 | train_loss 1.089539e+00 | lr 6.375000e-05
04/26/2024 03:00:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1500/  4000] | 1499/1769 batches | ms/batch 109.5450 | train_loss 1.069489e+00 | lr 6.250000e-05
04/26/2024 03:00:54 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 1500 ****
04/26/2024 03:00:55 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:01:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1550/  4000] | 1549/1769 batches | ms/batch 109.5484 | train_loss 1.095430e+00 | lr 6.125000e-05
04/26/2024 03:01:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1600/  4000] | 1599/1769 batches | ms/batch 109.4553 | train_loss 1.082562e+00 | lr 6.000000e-05
04/26/2024 03:01:08 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 1600 ****
04/26/2024 03:01:09 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:01:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1650/  4000] | 1649/1769 batches | ms/batch 109.5224 | train_loss 1.014849e+00 | lr 5.875000e-05
04/26/2024 03:01:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1700/  4000] | 1699/1769 batches | ms/batch 109.4224 | train_loss 1.120682e+00 | lr 5.750000e-05
04/26/2024 03:01:22 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 1700 ****
04/26/2024 03:01:23 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:01:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1750/  4000] | 1749/1769 batches | ms/batch 109.3717 | train_loss 1.067872e+00 | lr 5.625000e-05
04/26/2024 03:01:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1800/  4000] |   30/1769 batches | ms/batch 108.0936 | train_loss 9.500650e-01 | lr 5.500000e-05
04/26/2024 03:01:38 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 1800 ****
04/26/2024 03:01:39 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:01:46 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1850/  4000] |   80/1769 batches | ms/batch 109.3700 | train_loss 9.262631e-01 | lr 5.375000e-05
04/26/2024 03:01:53 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1900/  4000] |  130/1769 batches | ms/batch 109.6151 | train_loss 9.944673e-01 | lr 5.250000e-05
04/26/2024 03:01:53 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 1900 ****
04/26/2024 03:01:53 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:02:00 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1950/  4000] |  180/1769 batches | ms/batch 109.4782 | train_loss 9.887760e-01 | lr 5.125000e-05
04/26/2024 03:02:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2000/  4000] |  230/1769 batches | ms/batch 109.5151 | train_loss 9.375870e-01 | lr 5.000000e-05
04/26/2024 03:02:07 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 2000 ****
04/26/2024 03:02:07 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:02:14 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2050/  4000] |  280/1769 batches | ms/batch 109.4493 | train_loss 9.544230e-01 | lr 4.875000e-05
04/26/2024 03:02:21 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2100/  4000] |  330/1769 batches | ms/batch 109.4807 | train_loss 9.475495e-01 | lr 4.750000e-05
04/26/2024 03:02:21 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 2100 ****
04/26/2024 03:02:21 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:02:28 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2150/  4000] |  380/1769 batches | ms/batch 109.4148 | train_loss 1.014496e+00 | lr 4.625000e-05
04/26/2024 03:02:35 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2200/  4000] |  430/1769 batches | ms/batch 109.5131 | train_loss 9.434594e-01 | lr 4.500000e-05
04/26/2024 03:02:35 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 2200 ****
04/26/2024 03:02:36 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:02:42 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2250/  4000] |  480/1769 batches | ms/batch 109.4361 | train_loss 8.542034e-01 | lr 4.375000e-05
04/26/2024 03:02:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2300/  4000] |  530/1769 batches | ms/batch 109.4947 | train_loss 8.584079e-01 | lr 4.250000e-05
04/26/2024 03:02:49 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 2300 ****
04/26/2024 03:02:50 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:02:57 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2350/  4000] |  580/1769 batches | ms/batch 109.5153 | train_loss 9.125480e-01 | lr 4.125000e-05
04/26/2024 03:03:03 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2400/  4000] |  630/1769 batches | ms/batch 109.4372 | train_loss 8.799554e-01 | lr 4.000000e-05
04/26/2024 03:03:03 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 2400 ****
04/26/2024 03:03:04 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:03:11 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2450/  4000] |  680/1769 batches | ms/batch 109.5163 | train_loss 9.280402e-01 | lr 3.875000e-05
04/26/2024 03:03:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2500/  4000] |  730/1769 batches | ms/batch 109.4926 | train_loss 9.131311e-01 | lr 3.750000e-05
04/26/2024 03:03:17 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 2500 ****
04/26/2024 03:03:18 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:03:25 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2550/  4000] |  780/1769 batches | ms/batch 109.4821 | train_loss 8.450577e-01 | lr 3.625000e-05
04/26/2024 03:03:32 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2600/  4000] |  830/1769 batches | ms/batch 109.5560 | train_loss 9.253120e-01 | lr 3.500000e-05
04/26/2024 03:03:32 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 2600 ****
04/26/2024 03:03:32 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:03:39 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2650/  4000] |  880/1769 batches | ms/batch 109.5216 | train_loss 9.087605e-01 | lr 3.375000e-05
04/26/2024 03:03:46 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2700/  4000] |  930/1769 batches | ms/batch 109.4751 | train_loss 8.664038e-01 | lr 3.250000e-05
04/26/2024 03:03:46 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 2700 ****
04/26/2024 03:03:46 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:03:53 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2750/  4000] |  980/1769 batches | ms/batch 109.5415 | train_loss 8.953489e-01 | lr 3.125000e-05
04/26/2024 03:04:00 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2800/  4000] | 1030/1769 batches | ms/batch 109.4863 | train_loss 8.655113e-01 | lr 3.000000e-05
04/26/2024 03:04:00 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 2800 ****
04/26/2024 03:04:01 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:04:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2850/  4000] | 1080/1769 batches | ms/batch 109.5819 | train_loss 8.598719e-01 | lr 2.875000e-05
04/26/2024 03:04:14 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2900/  4000] | 1130/1769 batches | ms/batch 109.5205 | train_loss 8.667807e-01 | lr 2.750000e-05
04/26/2024 03:04:14 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 2900 ****
04/26/2024 03:04:15 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:04:21 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2950/  4000] | 1180/1769 batches | ms/batch 109.4690 | train_loss 7.967502e-01 | lr 2.625000e-05
04/26/2024 03:04:28 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3000/  4000] | 1230/1769 batches | ms/batch 109.4992 | train_loss 8.549523e-01 | lr 2.500000e-05
04/26/2024 03:04:28 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 3000 ****
04/26/2024 03:04:29 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:04:36 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3050/  4000] | 1280/1769 batches | ms/batch 109.4000 | train_loss 7.964075e-01 | lr 2.375000e-05
04/26/2024 03:04:42 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3100/  4000] | 1330/1769 batches | ms/batch 109.4867 | train_loss 8.311238e-01 | lr 2.250000e-05
04/26/2024 03:04:42 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 3100 ****
04/26/2024 03:04:43 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:04:50 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3150/  4000] | 1380/1769 batches | ms/batch 109.4197 | train_loss 8.867289e-01 | lr 2.125000e-05
04/26/2024 03:04:57 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3200/  4000] | 1430/1769 batches | ms/batch 109.5585 | train_loss 9.094970e-01 | lr 2.000000e-05
04/26/2024 03:04:57 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 3200 ****
04/26/2024 03:04:57 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:05:04 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3250/  4000] | 1480/1769 batches | ms/batch 109.4321 | train_loss 8.153249e-01 | lr 1.875000e-05
04/26/2024 03:05:11 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3300/  4000] | 1530/1769 batches | ms/batch 109.5473 | train_loss 7.973667e-01 | lr 1.750000e-05
04/26/2024 03:05:11 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 3300 ****
04/26/2024 03:05:11 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:05:18 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3350/  4000] | 1580/1769 batches | ms/batch 109.4847 | train_loss 7.998514e-01 | lr 1.625000e-05
04/26/2024 03:05:25 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3400/  4000] | 1630/1769 batches | ms/batch 109.5010 | train_loss 1.127258e+00 | lr 1.500000e-05
04/26/2024 03:05:25 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 3400 ****
04/26/2024 03:05:25 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:05:32 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3450/  4000] | 1680/1769 batches | ms/batch 109.3818 | train_loss 8.106898e-01 | lr 1.375000e-05
04/26/2024 03:05:39 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3500/  4000] | 1730/1769 batches | ms/batch 109.4902 | train_loss 8.026561e-01 | lr 1.250000e-05
04/26/2024 03:05:39 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 3500 ****
04/26/2024 03:05:39 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:05:48 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3550/  4000] |   11/1769 batches | ms/batch 108.2500 | train_loss 8.121636e-01 | lr 1.125000e-05
04/26/2024 03:05:55 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3600/  4000] |   61/1769 batches | ms/batch 109.3922 | train_loss 7.714892e-01 | lr 1.000000e-05
04/26/2024 03:05:55 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 3600 ****
04/26/2024 03:05:55 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:06:02 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3650/  4000] |  111/1769 batches | ms/batch 109.3933 | train_loss 7.635844e-01 | lr 8.750000e-06
04/26/2024 03:06:09 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3700/  4000] |  161/1769 batches | ms/batch 109.4225 | train_loss 8.180976e-01 | lr 7.500000e-06
04/26/2024 03:06:09 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 3700 ****
04/26/2024 03:06:10 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:06:16 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3750/  4000] |  211/1769 batches | ms/batch 109.4589 | train_loss 7.999861e-01 | lr 6.250000e-06
04/26/2024 03:06:23 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3800/  4000] |  261/1769 batches | ms/batch 109.5289 | train_loss 8.008691e-01 | lr 5.000000e-06
04/26/2024 03:06:23 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 3800 ****
04/26/2024 03:06:24 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:06:31 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3850/  4000] |  311/1769 batches | ms/batch 109.3895 | train_loss 7.739540e-01 | lr 3.750000e-06
04/26/2024 03:06:37 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3900/  4000] |  361/1769 batches | ms/batch 109.5104 | train_loss 7.567799e-01 | lr 2.500000e-06
04/26/2024 03:06:37 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 3900 ****
04/26/2024 03:06:38 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:06:45 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3950/  4000] |  411/1769 batches | ms/batch 109.4539 | train_loss 7.434545e-01 | lr 1.250000e-06
04/26/2024 03:06:51 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  4000/  4000] |  461/1769 batches | ms/batch 109.3698 | train_loss 7.441933e-01 | lr 0.000000e+00
04/26/2024 03:06:51 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l at global_step 4000 ****
04/26/2024 03:06:52 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:06:53 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23489227/tmpckzaxx1l
04/26/2024 03:06:53 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((14146, 32)) with avr_nnz=32.0
04/26/2024 03:06:53 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/26/2024 03:08:08 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn at level 2, nr_labels=512, avr_M_nnz=7.868372684857911
04/26/2024 03:08:08 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-cased model from s3.
04/26/2024 03:08:21 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23489227/tmpluzkfiug/X_trn.pt
04/26/2024 03:08:21 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
04/26/2024 03:09:05 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
04/26/2024 03:09:05 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 1
04/26/2024 03:09:05 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
04/26/2024 03:09:05 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/26/2024 03:09:05 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
04/26/2024 03:09:05 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 14146
04/26/2024 03:09:05 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 512
04/26/2024 03:09:05 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 304
04/26/2024 03:09:05 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 3
04/26/2024 03:09:05 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
04/26/2024 03:09:05 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 8
04/26/2024 03:09:05 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
04/26/2024 03:09:05 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
04/26/2024 03:09:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][    50/  4000] |   49/1769 batches | ms/batch 109.1350 | train_loss 7.254807e-01 | lr 9.875000e-05
04/26/2024 03:09:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   100/  4000] |   99/1769 batches | ms/batch 108.8142 | train_loss 7.159118e-01 | lr 9.750000e-05
04/26/2024 03:09:20 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 100 ****
04/26/2024 03:09:21 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:09:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   150/  4000] |  149/1769 batches | ms/batch 108.8212 | train_loss 7.102917e-01 | lr 9.625000e-05
04/26/2024 03:09:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   200/  4000] |  199/1769 batches | ms/batch 109.0125 | train_loss 7.031978e-01 | lr 9.500000e-05
04/26/2024 03:09:35 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 200 ****
04/26/2024 03:09:35 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:09:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   250/  4000] |  249/1769 batches | ms/batch 109.1087 | train_loss 7.119347e-01 | lr 9.375000e-05
04/26/2024 03:09:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   300/  4000] |  299/1769 batches | ms/batch 108.9811 | train_loss 7.089423e-01 | lr 9.250000e-05
04/26/2024 03:09:49 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 300 ****
04/26/2024 03:09:49 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:09:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   350/  4000] |  349/1769 batches | ms/batch 108.9757 | train_loss 7.090479e-01 | lr 9.125000e-05
04/26/2024 03:10:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   400/  4000] |  399/1769 batches | ms/batch 109.0414 | train_loss 7.025425e-01 | lr 9.000000e-05
04/26/2024 03:10:03 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 400 ****
04/26/2024 03:10:03 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:10:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   450/  4000] |  449/1769 batches | ms/batch 109.0528 | train_loss 6.969236e-01 | lr 8.875000e-05
04/26/2024 03:10:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   500/  4000] |  499/1769 batches | ms/batch 109.1616 | train_loss 6.955863e-01 | lr 8.750000e-05
04/26/2024 03:10:17 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 500 ****
04/26/2024 03:10:17 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:10:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   550/  4000] |  549/1769 batches | ms/batch 109.1931 | train_loss 6.984305e-01 | lr 8.625000e-05
04/26/2024 03:10:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   600/  4000] |  599/1769 batches | ms/batch 109.2583 | train_loss 7.008849e-01 | lr 8.500000e-05
04/26/2024 03:10:31 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 600 ****
04/26/2024 03:10:31 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:10:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   650/  4000] |  649/1769 batches | ms/batch 109.2589 | train_loss 7.008391e-01 | lr 8.375000e-05
04/26/2024 03:10:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   700/  4000] |  699/1769 batches | ms/batch 109.4134 | train_loss 7.005856e-01 | lr 8.250000e-05
04/26/2024 03:10:45 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 700 ****
04/26/2024 03:10:46 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:10:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   750/  4000] |  749/1769 batches | ms/batch 109.3257 | train_loss 7.033289e-01 | lr 8.125000e-05
04/26/2024 03:10:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   800/  4000] |  799/1769 batches | ms/batch 109.3980 | train_loss 7.073241e-01 | lr 8.000000e-05
04/26/2024 03:10:59 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 800 ****
04/26/2024 03:11:00 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:11:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   850/  4000] |  849/1769 batches | ms/batch 109.3921 | train_loss 6.961715e-01 | lr 7.875000e-05
04/26/2024 03:11:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   900/  4000] |  899/1769 batches | ms/batch 109.4051 | train_loss 7.002299e-01 | lr 7.750000e-05
04/26/2024 03:11:13 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 900 ****
04/26/2024 03:11:14 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:11:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   950/  4000] |  949/1769 batches | ms/batch 109.4482 | train_loss 7.042602e-01 | lr 7.625000e-05
04/26/2024 03:11:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1000/  4000] |  999/1769 batches | ms/batch 109.4914 | train_loss 7.036793e-01 | lr 7.500000e-05
04/26/2024 03:11:27 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 1000 ****
04/26/2024 03:11:28 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:11:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1050/  4000] | 1049/1769 batches | ms/batch 109.4411 | train_loss 6.929269e-01 | lr 7.375000e-05
04/26/2024 03:11:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1100/  4000] | 1099/1769 batches | ms/batch 109.5120 | train_loss 7.052447e-01 | lr 7.250000e-05
04/26/2024 03:11:41 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 1100 ****
04/26/2024 03:11:42 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:11:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1150/  4000] | 1149/1769 batches | ms/batch 109.4635 | train_loss 7.031813e-01 | lr 7.125000e-05
04/26/2024 03:11:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1200/  4000] | 1199/1769 batches | ms/batch 109.6183 | train_loss 7.001558e-01 | lr 7.000000e-05
04/26/2024 03:11:56 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 1200 ****
04/26/2024 03:11:56 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:12:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1250/  4000] | 1249/1769 batches | ms/batch 109.5319 | train_loss 7.044237e-01 | lr 6.875000e-05
04/26/2024 03:12:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1300/  4000] | 1299/1769 batches | ms/batch 109.5346 | train_loss 7.114156e-01 | lr 6.750000e-05
04/26/2024 03:12:10 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 1300 ****
04/26/2024 03:12:10 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:12:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1350/  4000] | 1349/1769 batches | ms/batch 109.5383 | train_loss 7.092291e-01 | lr 6.625000e-05
04/26/2024 03:12:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1400/  4000] | 1399/1769 batches | ms/batch 109.5305 | train_loss 6.999990e-01 | lr 6.500000e-05
04/26/2024 03:12:24 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 1400 ****
04/26/2024 03:12:25 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:12:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1450/  4000] | 1449/1769 batches | ms/batch 109.4013 | train_loss 6.987820e-01 | lr 6.375000e-05
04/26/2024 03:12:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1500/  4000] | 1499/1769 batches | ms/batch 109.5799 | train_loss 6.982457e-01 | lr 6.250000e-05
04/26/2024 03:12:38 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 1500 ****
04/26/2024 03:12:39 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:12:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1550/  4000] | 1549/1769 batches | ms/batch 109.5351 | train_loss 7.033907e-01 | lr 6.125000e-05
04/26/2024 03:12:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1600/  4000] | 1599/1769 batches | ms/batch 109.4251 | train_loss 6.987772e-01 | lr 6.000000e-05
04/26/2024 03:12:52 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 1600 ****
04/26/2024 03:12:53 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:13:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1650/  4000] | 1649/1769 batches | ms/batch 109.6443 | train_loss 6.948966e-01 | lr 5.875000e-05
04/26/2024 03:13:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1700/  4000] | 1699/1769 batches | ms/batch 109.6484 | train_loss 7.016681e-01 | lr 5.750000e-05
04/26/2024 03:13:07 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 1700 ****
04/26/2024 03:13:07 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:13:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1750/  4000] | 1749/1769 batches | ms/batch 109.6075 | train_loss 7.032298e-01 | lr 5.625000e-05
04/26/2024 03:13:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1800/  4000] |   30/1769 batches | ms/batch 108.0275 | train_loss 6.963219e-01 | lr 5.500000e-05
04/26/2024 03:13:22 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 1800 ****
04/26/2024 03:13:23 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:13:30 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1850/  4000] |   80/1769 batches | ms/batch 109.6076 | train_loss 6.966941e-01 | lr 5.375000e-05
04/26/2024 03:13:37 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1900/  4000] |  130/1769 batches | ms/batch 109.5742 | train_loss 7.100732e-01 | lr 5.250000e-05
04/26/2024 03:13:37 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 1900 ****
04/26/2024 03:13:37 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:13:44 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1950/  4000] |  180/1769 batches | ms/batch 109.4598 | train_loss 6.952273e-01 | lr 5.125000e-05
04/26/2024 03:13:51 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2000/  4000] |  230/1769 batches | ms/batch 109.5281 | train_loss 6.973165e-01 | lr 5.000000e-05
04/26/2024 03:13:51 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 2000 ****
04/26/2024 03:13:51 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:13:58 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2050/  4000] |  280/1769 batches | ms/batch 109.4722 | train_loss 6.944151e-01 | lr 4.875000e-05
04/26/2024 03:14:05 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2100/  4000] |  330/1769 batches | ms/batch 109.5031 | train_loss 7.098253e-01 | lr 4.750000e-05
04/26/2024 03:14:05 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 2100 ****
04/26/2024 03:14:06 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:14:12 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2150/  4000] |  380/1769 batches | ms/batch 109.4793 | train_loss 6.975418e-01 | lr 4.625000e-05
04/26/2024 03:14:19 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2200/  4000] |  430/1769 batches | ms/batch 109.4751 | train_loss 7.053044e-01 | lr 4.500000e-05
04/26/2024 03:14:19 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 2200 ****
04/26/2024 03:14:20 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:14:27 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2250/  4000] |  480/1769 batches | ms/batch 109.5168 | train_loss 7.028241e-01 | lr 4.375000e-05
04/26/2024 03:14:33 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2300/  4000] |  530/1769 batches | ms/batch 109.5847 | train_loss 6.979321e-01 | lr 4.250000e-05
04/26/2024 03:14:33 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 2300 ****
04/26/2024 03:14:34 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:14:41 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2350/  4000] |  580/1769 batches | ms/batch 109.5402 | train_loss 7.089822e-01 | lr 4.125000e-05
04/26/2024 03:14:48 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2400/  4000] |  630/1769 batches | ms/batch 109.5681 | train_loss 7.062915e-01 | lr 4.000000e-05
04/26/2024 03:14:48 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 2400 ****
04/26/2024 03:14:48 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:14:55 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2450/  4000] |  680/1769 batches | ms/batch 109.4743 | train_loss 7.084516e-01 | lr 3.875000e-05
04/26/2024 03:15:02 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2500/  4000] |  730/1769 batches | ms/batch 109.5203 | train_loss 7.043002e-01 | lr 3.750000e-05
04/26/2024 03:15:02 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 2500 ****
04/26/2024 03:15:02 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:15:09 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2550/  4000] |  780/1769 batches | ms/batch 109.5357 | train_loss 7.179420e-01 | lr 3.625000e-05
04/26/2024 03:15:16 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2600/  4000] |  830/1769 batches | ms/batch 109.6789 | train_loss 6.949469e-01 | lr 3.500000e-05
04/26/2024 03:15:16 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 2600 ****
04/26/2024 03:15:17 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:15:24 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2650/  4000] |  880/1769 batches | ms/batch 109.4681 | train_loss 7.071559e-01 | lr 3.375000e-05
04/26/2024 03:15:30 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2700/  4000] |  930/1769 batches | ms/batch 109.6071 | train_loss 6.967868e-01 | lr 3.250000e-05
04/26/2024 03:15:30 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 2700 ****
04/26/2024 03:15:31 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:15:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2750/  4000] |  980/1769 batches | ms/batch 109.5757 | train_loss 6.974841e-01 | lr 3.125000e-05
04/26/2024 03:15:45 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2800/  4000] | 1030/1769 batches | ms/batch 109.5377 | train_loss 7.013758e-01 | lr 3.000000e-05
04/26/2024 03:15:45 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 2800 ****
04/26/2024 03:15:45 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:15:52 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2850/  4000] | 1080/1769 batches | ms/batch 109.4830 | train_loss 6.917107e-01 | lr 2.875000e-05
04/26/2024 03:15:59 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2900/  4000] | 1130/1769 batches | ms/batch 109.5967 | train_loss 7.077086e-01 | lr 2.750000e-05
04/26/2024 03:15:59 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 2900 ****
04/26/2024 03:15:59 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:16:06 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2950/  4000] | 1180/1769 batches | ms/batch 109.6375 | train_loss 6.903803e-01 | lr 2.625000e-05
04/26/2024 03:16:13 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3000/  4000] | 1230/1769 batches | ms/batch 109.6067 | train_loss 7.003222e-01 | lr 2.500000e-05
04/26/2024 03:16:13 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 3000 ****
04/26/2024 03:16:13 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:16:20 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3050/  4000] | 1280/1769 batches | ms/batch 109.6424 | train_loss 7.026097e-01 | lr 2.375000e-05
04/26/2024 03:16:27 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3100/  4000] | 1330/1769 batches | ms/batch 109.6440 | train_loss 7.078016e-01 | lr 2.250000e-05
04/26/2024 03:16:27 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 3100 ****
04/26/2024 03:16:28 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:16:35 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3150/  4000] | 1380/1769 batches | ms/batch 109.5897 | train_loss 7.031884e-01 | lr 2.125000e-05
04/26/2024 03:16:41 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3200/  4000] | 1430/1769 batches | ms/batch 109.5302 | train_loss 7.078010e-01 | lr 2.000000e-05
04/26/2024 03:16:41 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 3200 ****
04/26/2024 03:16:42 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:16:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3250/  4000] | 1480/1769 batches | ms/batch 109.5246 | train_loss 7.046394e-01 | lr 1.875000e-05
04/26/2024 03:16:55 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3300/  4000] | 1530/1769 batches | ms/batch 109.4617 | train_loss 7.072732e-01 | lr 1.750000e-05
04/26/2024 03:16:55 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 3300 ****
04/26/2024 03:16:56 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:17:03 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3350/  4000] | 1580/1769 batches | ms/batch 109.5530 | train_loss 6.964365e-01 | lr 1.625000e-05
04/26/2024 03:17:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3400/  4000] | 1630/1769 batches | ms/batch 109.6592 | train_loss 6.988881e-01 | lr 1.500000e-05
04/26/2024 03:17:10 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 3400 ****
04/26/2024 03:17:10 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:17:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3450/  4000] | 1680/1769 batches | ms/batch 109.5331 | train_loss 6.917209e-01 | lr 1.375000e-05
04/26/2024 03:17:24 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3500/  4000] | 1730/1769 batches | ms/batch 109.6074 | train_loss 7.047573e-01 | lr 1.250000e-05
04/26/2024 03:17:24 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 3500 ****
04/26/2024 03:17:24 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:17:33 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3550/  4000] |   11/1769 batches | ms/batch 108.2456 | train_loss 6.968547e-01 | lr 1.125000e-05
04/26/2024 03:17:41 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3600/  4000] |   61/1769 batches | ms/batch 111.7275 | train_loss 7.049321e-01 | lr 1.000000e-05
04/26/2024 03:17:42 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 3600 ****
04/26/2024 03:17:42 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:17:49 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3650/  4000] |  111/1769 batches | ms/batch 109.4037 | train_loss 6.935299e-01 | lr 8.750000e-06
04/26/2024 03:17:56 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3700/  4000] |  161/1769 batches | ms/batch 109.5438 | train_loss 7.030391e-01 | lr 7.500000e-06
04/26/2024 03:17:56 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 3700 ****
04/26/2024 03:17:57 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:18:03 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3750/  4000] |  211/1769 batches | ms/batch 109.4949 | train_loss 6.936129e-01 | lr 6.250000e-06
04/26/2024 03:18:10 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3800/  4000] |  261/1769 batches | ms/batch 109.5563 | train_loss 7.016335e-01 | lr 5.000000e-06
04/26/2024 03:18:10 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 3800 ****
04/26/2024 03:18:11 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:18:18 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3850/  4000] |  311/1769 batches | ms/batch 109.4907 | train_loss 6.990028e-01 | lr 3.750000e-06
04/26/2024 03:18:24 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3900/  4000] |  361/1769 batches | ms/batch 109.4316 | train_loss 7.052687e-01 | lr 2.500000e-06
04/26/2024 03:18:24 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 3900 ****
04/26/2024 03:18:25 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:18:32 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3950/  4000] |  411/1769 batches | ms/batch 109.3548 | train_loss 7.006985e-01 | lr 1.250000e-06
04/26/2024 03:18:39 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  4000/  4000] |  461/1769 batches | ms/batch 109.7625 | train_loss 7.077459e-01 | lr 0.000000e+00
04/26/2024 03:18:39 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0 at global_step 4000 ****
04/26/2024 03:18:39 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:18:40 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23489227/tmpr85y1yt0
04/26/2024 03:18:40 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((14146, 512)) with avr_nnz=320.0
04/26/2024 03:18:40 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/26/2024 03:19:57 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn at level 3, nr_labels=30938, avr_M_nnz=12.53068005089778
04/26/2024 03:19:59 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-cased model from s3.
04/26/2024 03:20:12 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23489227/tmpluzkfiug/X_trn.pt
04/26/2024 03:20:12 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
04/26/2024 03:23:46 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
04/26/2024 03:23:46 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 1
04/26/2024 03:23:46 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
04/26/2024 03:23:46 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/26/2024 03:23:48 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
04/26/2024 03:23:48 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 14146
04/26/2024 03:23:48 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 30938
04/26/2024 03:23:48 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 1631
04/26/2024 03:23:48 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 3
04/26/2024 03:23:48 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
04/26/2024 03:23:48 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 8
04/26/2024 03:23:48 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
04/26/2024 03:23:48 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
04/26/2024 03:23:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][    50/  4000] |   49/1769 batches | ms/batch 109.1987 | train_loss 5.960173e-01 | lr 9.875000e-05
04/26/2024 03:24:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   100/  4000] |   99/1769 batches | ms/batch 108.9796 | train_loss 5.813400e-01 | lr 9.750000e-05
04/26/2024 03:24:03 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 100 ****
04/26/2024 03:24:04 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:24:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   150/  4000] |  149/1769 batches | ms/batch 109.1299 | train_loss 5.684962e-01 | lr 9.625000e-05
04/26/2024 03:24:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   200/  4000] |  199/1769 batches | ms/batch 109.1138 | train_loss 5.638793e-01 | lr 9.500000e-05
04/26/2024 03:24:17 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 200 ****
04/26/2024 03:24:18 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:24:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   250/  4000] |  249/1769 batches | ms/batch 109.2718 | train_loss 5.759795e-01 | lr 9.375000e-05
04/26/2024 03:24:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   300/  4000] |  299/1769 batches | ms/batch 109.3546 | train_loss 5.736758e-01 | lr 9.250000e-05
04/26/2024 03:24:32 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 300 ****
04/26/2024 03:24:33 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:24:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   350/  4000] |  349/1769 batches | ms/batch 109.3459 | train_loss 5.739052e-01 | lr 9.125000e-05
04/26/2024 03:24:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   400/  4000] |  399/1769 batches | ms/batch 109.3283 | train_loss 5.615318e-01 | lr 9.000000e-05
04/26/2024 03:24:46 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 400 ****
04/26/2024 03:24:47 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:24:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   450/  4000] |  449/1769 batches | ms/batch 109.4044 | train_loss 5.791908e-01 | lr 8.875000e-05
04/26/2024 03:25:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   500/  4000] |  499/1769 batches | ms/batch 109.3710 | train_loss 5.912473e-01 | lr 8.750000e-05
04/26/2024 03:25:01 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 500 ****
04/26/2024 03:25:02 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:25:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   550/  4000] |  549/1769 batches | ms/batch 109.3631 | train_loss 5.764662e-01 | lr 8.625000e-05
04/26/2024 03:25:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   600/  4000] |  599/1769 batches | ms/batch 109.5852 | train_loss 5.753617e-01 | lr 8.500000e-05
04/26/2024 03:25:16 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 600 ****
04/26/2024 03:25:16 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:25:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   650/  4000] |  649/1769 batches | ms/batch 109.5840 | train_loss 5.582244e-01 | lr 8.375000e-05
04/26/2024 03:25:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   700/  4000] |  699/1769 batches | ms/batch 109.6027 | train_loss 5.781556e-01 | lr 8.250000e-05
04/26/2024 03:25:30 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 700 ****
04/26/2024 03:25:31 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:25:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   750/  4000] |  749/1769 batches | ms/batch 109.5574 | train_loss 5.773289e-01 | lr 8.125000e-05
04/26/2024 03:25:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   800/  4000] |  799/1769 batches | ms/batch 109.6212 | train_loss 5.776330e-01 | lr 8.000000e-05
04/26/2024 03:25:45 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 800 ****
04/26/2024 03:25:45 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:25:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   850/  4000] |  849/1769 batches | ms/batch 109.5542 | train_loss 5.688894e-01 | lr 7.875000e-05
04/26/2024 03:25:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   900/  4000] |  899/1769 batches | ms/batch 109.6400 | train_loss 5.702952e-01 | lr 7.750000e-05
04/26/2024 03:25:59 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 900 ****
04/26/2024 03:26:00 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:26:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   950/  4000] |  949/1769 batches | ms/batch 109.6492 | train_loss 5.668399e-01 | lr 7.625000e-05
04/26/2024 03:26:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1000/  4000] |  999/1769 batches | ms/batch 109.7535 | train_loss 5.713154e-01 | lr 7.500000e-05
04/26/2024 03:26:14 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 1000 ****
04/26/2024 03:26:15 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:26:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1050/  4000] | 1049/1769 batches | ms/batch 109.7596 | train_loss 5.676723e-01 | lr 7.375000e-05
04/26/2024 03:26:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1100/  4000] | 1099/1769 batches | ms/batch 109.8184 | train_loss 5.911500e-01 | lr 7.250000e-05
04/26/2024 03:26:28 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 1100 ****
04/26/2024 03:26:29 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:26:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1150/  4000] | 1149/1769 batches | ms/batch 109.6794 | train_loss 5.734821e-01 | lr 7.125000e-05
04/26/2024 03:26:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1200/  4000] | 1199/1769 batches | ms/batch 109.7315 | train_loss 5.857128e-01 | lr 7.000000e-05
04/26/2024 03:26:43 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 1200 ****
04/26/2024 03:26:44 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:26:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1250/  4000] | 1249/1769 batches | ms/batch 109.6156 | train_loss 5.794080e-01 | lr 6.875000e-05
04/26/2024 03:26:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1300/  4000] | 1299/1769 batches | ms/batch 109.7640 | train_loss 5.623322e-01 | lr 6.750000e-05
04/26/2024 03:26:58 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 1300 ****
04/26/2024 03:26:58 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:27:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1350/  4000] | 1349/1769 batches | ms/batch 109.7159 | train_loss 5.709505e-01 | lr 6.625000e-05
04/26/2024 03:27:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1400/  4000] | 1399/1769 batches | ms/batch 109.6913 | train_loss 5.876704e-01 | lr 6.500000e-05
04/26/2024 03:27:12 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 1400 ****
04/26/2024 03:27:13 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:27:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1450/  4000] | 1449/1769 batches | ms/batch 109.6523 | train_loss 5.774641e-01 | lr 6.375000e-05
04/26/2024 03:27:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1500/  4000] | 1499/1769 batches | ms/batch 109.7409 | train_loss 5.730826e-01 | lr 6.250000e-05
04/26/2024 03:27:27 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 1500 ****
04/26/2024 03:27:27 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:27:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1550/  4000] | 1549/1769 batches | ms/batch 109.7325 | train_loss 5.653962e-01 | lr 6.125000e-05
04/26/2024 03:27:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1600/  4000] | 1599/1769 batches | ms/batch 109.6843 | train_loss 5.751553e-01 | lr 6.000000e-05
04/26/2024 03:27:41 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 1600 ****
04/26/2024 03:27:42 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:27:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1650/  4000] | 1649/1769 batches | ms/batch 109.7075 | train_loss 5.712275e-01 | lr 5.875000e-05
04/26/2024 03:27:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1700/  4000] | 1699/1769 batches | ms/batch 109.7496 | train_loss 5.654733e-01 | lr 5.750000e-05
04/26/2024 03:27:56 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 1700 ****
04/26/2024 03:27:56 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:28:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1750/  4000] | 1749/1769 batches | ms/batch 109.7112 | train_loss 5.648027e-01 | lr 5.625000e-05
04/26/2024 03:28:12 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1800/  4000] |   30/1769 batches | ms/batch 108.3339 | train_loss 5.664326e-01 | lr 5.500000e-05
04/26/2024 03:28:12 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 1800 ****
04/26/2024 03:28:13 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:28:20 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1850/  4000] |   80/1769 batches | ms/batch 109.7453 | train_loss 5.649393e-01 | lr 5.375000e-05
04/26/2024 03:28:27 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1900/  4000] |  130/1769 batches | ms/batch 109.7222 | train_loss 5.790019e-01 | lr 5.250000e-05
04/26/2024 03:28:27 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 1900 ****
04/26/2024 03:28:28 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:28:35 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1950/  4000] |  180/1769 batches | ms/batch 109.6927 | train_loss 5.581513e-01 | lr 5.125000e-05
04/26/2024 03:28:41 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2000/  4000] |  230/1769 batches | ms/batch 109.7428 | train_loss 5.717561e-01 | lr 5.000000e-05
04/26/2024 03:28:41 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 2000 ****
04/26/2024 03:28:42 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:28:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2050/  4000] |  280/1769 batches | ms/batch 109.6904 | train_loss 5.822099e-01 | lr 4.875000e-05
04/26/2024 03:28:56 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2100/  4000] |  330/1769 batches | ms/batch 109.6803 | train_loss 5.697744e-01 | lr 4.750000e-05
04/26/2024 03:28:56 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 2100 ****
04/26/2024 03:28:57 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:29:04 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2150/  4000] |  380/1769 batches | ms/batch 109.5531 | train_loss 5.810198e-01 | lr 4.625000e-05
04/26/2024 03:29:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2200/  4000] |  430/1769 batches | ms/batch 109.6349 | train_loss 5.510528e-01 | lr 4.500000e-05
04/26/2024 03:29:10 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 2200 ****
04/26/2024 03:29:11 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:29:18 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2250/  4000] |  480/1769 batches | ms/batch 109.7019 | train_loss 5.827095e-01 | lr 4.375000e-05
04/26/2024 03:29:25 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2300/  4000] |  530/1769 batches | ms/batch 109.8056 | train_loss 5.836237e-01 | lr 4.250000e-05
04/26/2024 03:29:25 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 2300 ****
04/26/2024 03:29:26 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:29:33 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2350/  4000] |  580/1769 batches | ms/batch 109.7525 | train_loss 5.748843e-01 | lr 4.125000e-05
04/26/2024 03:29:39 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2400/  4000] |  630/1769 batches | ms/batch 109.7949 | train_loss 5.871607e-01 | lr 4.000000e-05
04/26/2024 03:29:39 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 2400 ****
04/26/2024 03:29:40 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:29:47 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2450/  4000] |  680/1769 batches | ms/batch 109.8938 | train_loss 5.628355e-01 | lr 3.875000e-05
04/26/2024 03:29:54 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2500/  4000] |  730/1769 batches | ms/batch 109.7049 | train_loss 5.614446e-01 | lr 3.750000e-05
04/26/2024 03:29:54 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 2500 ****
04/26/2024 03:29:55 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:30:02 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2550/  4000] |  780/1769 batches | ms/batch 109.7700 | train_loss 5.665174e-01 | lr 3.625000e-05
04/26/2024 03:30:09 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2600/  4000] |  830/1769 batches | ms/batch 109.7926 | train_loss 5.535990e-01 | lr 3.500000e-05
04/26/2024 03:30:09 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 2600 ****
04/26/2024 03:30:09 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:30:16 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2650/  4000] |  880/1769 batches | ms/batch 109.7699 | train_loss 5.802221e-01 | lr 3.375000e-05
04/26/2024 03:30:23 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2700/  4000] |  930/1769 batches | ms/batch 109.8250 | train_loss 5.658956e-01 | lr 3.250000e-05
04/26/2024 03:30:23 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 2700 ****
04/26/2024 03:30:24 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:30:31 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2750/  4000] |  980/1769 batches | ms/batch 109.6493 | train_loss 5.720235e-01 | lr 3.125000e-05
04/26/2024 03:30:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2800/  4000] | 1030/1769 batches | ms/batch 109.7936 | train_loss 5.786037e-01 | lr 3.000000e-05
04/26/2024 03:30:38 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 2800 ****
04/26/2024 03:30:38 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:30:45 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2850/  4000] | 1080/1769 batches | ms/batch 109.7748 | train_loss 5.643023e-01 | lr 2.875000e-05
04/26/2024 03:30:52 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2900/  4000] | 1130/1769 batches | ms/batch 109.8969 | train_loss 5.714868e-01 | lr 2.750000e-05
04/26/2024 03:30:52 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 2900 ****
04/26/2024 03:30:53 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:31:00 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2950/  4000] | 1180/1769 batches | ms/batch 109.8673 | train_loss 5.888615e-01 | lr 2.625000e-05
04/26/2024 03:31:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3000/  4000] | 1230/1769 batches | ms/batch 109.7997 | train_loss 5.751023e-01 | lr 2.500000e-05
04/26/2024 03:31:07 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 3000 ****
04/26/2024 03:31:07 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:31:14 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3050/  4000] | 1280/1769 batches | ms/batch 109.7855 | train_loss 5.650277e-01 | lr 2.375000e-05
04/26/2024 03:31:21 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3100/  4000] | 1330/1769 batches | ms/batch 109.7889 | train_loss 5.771725e-01 | lr 2.250000e-05
04/26/2024 03:31:21 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 3100 ****
04/26/2024 03:31:22 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:31:29 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3150/  4000] | 1380/1769 batches | ms/batch 109.7029 | train_loss 5.736816e-01 | lr 2.125000e-05
04/26/2024 03:31:36 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3200/  4000] | 1430/1769 batches | ms/batch 109.8337 | train_loss 5.769310e-01 | lr 2.000000e-05
04/26/2024 03:31:36 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 3200 ****
04/26/2024 03:31:36 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:31:43 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3250/  4000] | 1480/1769 batches | ms/batch 109.6560 | train_loss 5.691652e-01 | lr 1.875000e-05
04/26/2024 03:31:50 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3300/  4000] | 1530/1769 batches | ms/batch 109.7529 | train_loss 5.605348e-01 | lr 1.750000e-05
04/26/2024 03:31:50 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 3300 ****
04/26/2024 03:31:51 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:31:58 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3350/  4000] | 1580/1769 batches | ms/batch 109.7931 | train_loss 5.743923e-01 | lr 1.625000e-05
04/26/2024 03:32:05 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3400/  4000] | 1630/1769 batches | ms/batch 110.0009 | train_loss 5.608376e-01 | lr 1.500000e-05
04/26/2024 03:32:05 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 3400 ****
04/26/2024 03:32:05 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:32:12 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3450/  4000] | 1680/1769 batches | ms/batch 109.7569 | train_loss 5.869301e-01 | lr 1.375000e-05
04/26/2024 03:32:19 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3500/  4000] | 1730/1769 batches | ms/batch 109.8028 | train_loss 5.644076e-01 | lr 1.250000e-05
04/26/2024 03:32:19 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 3500 ****
04/26/2024 03:32:20 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:32:29 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3550/  4000] |   11/1769 batches | ms/batch 108.3736 | train_loss 5.707440e-01 | lr 1.125000e-05
04/26/2024 03:32:35 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3600/  4000] |   61/1769 batches | ms/batch 109.8655 | train_loss 5.731999e-01 | lr 1.000000e-05
04/26/2024 03:32:35 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 3600 ****
04/26/2024 03:32:37 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:32:43 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3650/  4000] |  111/1769 batches | ms/batch 109.7754 | train_loss 5.558721e-01 | lr 8.750000e-06
04/26/2024 03:32:50 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3700/  4000] |  161/1769 batches | ms/batch 109.8051 | train_loss 5.656892e-01 | lr 7.500000e-06
04/26/2024 03:32:50 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 3700 ****
04/26/2024 03:32:51 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:32:58 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3750/  4000] |  211/1769 batches | ms/batch 109.8219 | train_loss 5.672773e-01 | lr 6.250000e-06
04/26/2024 03:33:05 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3800/  4000] |  261/1769 batches | ms/batch 109.8895 | train_loss 5.640968e-01 | lr 5.000000e-06
04/26/2024 03:33:05 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 3800 ****
04/26/2024 03:33:06 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:33:12 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3850/  4000] |  311/1769 batches | ms/batch 109.8260 | train_loss 5.712375e-01 | lr 3.750000e-06
04/26/2024 03:33:19 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3900/  4000] |  361/1769 batches | ms/batch 109.7914 | train_loss 5.681694e-01 | lr 2.500000e-06
04/26/2024 03:33:19 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 3900 ****
04/26/2024 03:33:20 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:33:27 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3950/  4000] |  411/1769 batches | ms/batch 109.7836 | train_loss 5.592541e-01 | lr 1.250000e-06
04/26/2024 03:33:34 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  4000/  4000] |  461/1769 batches | ms/batch 109.8165 | train_loss 5.762119e-01 | lr 0.000000e+00
04/26/2024 03:33:34 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w at global_step 4000 ****
04/26/2024 03:33:35 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:33:35 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23489227/tmplfl5my5w
04/26/2024 03:33:36 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((14146, 30938)) with avr_nnz=1206.0
04/26/2024 03:33:36 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/26/2024 03:34:52 - INFO - pecos.xmc.xtransformer.model - Constructed instance feature matrix with shape=(14146, 102706)
04/26/2024 03:35:00 - INFO - pecos.xmc.xtransformer.model - Hierarchical label tree for ranker: [2, 32, 512, 30938]
04/26/2024 03:35:00 - INFO - pecos.xmc.xtransformer.model - Start training ranker...
04/26/2024 03:35:01 - INFO - pecos.xmc.base - Training Layer 0 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
04/26/2024 03:35:01 - INFO - pecos.xmc.base - Training Layer 1 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
04/26/2024 03:35:08 - INFO - pecos.xmc.base - Training Layer 2 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
04/26/2024 03:35:26 - INFO - pecos.xmc.base - Training Layer 3 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
04/26/2024 03:36:43 - INFO - pecos.xmc.xtransformer.model - Parameters saved to ./trained-models/xr_model_wiki10-31k/param.json
04/26/2024 03:36:44 - INFO - pecos.xmc.xtransformer.model - Model saved to ./trained-models/xr_model_wiki10-31k

============================= JOB FEEDBACK =============================

NodeName=uc2n513
Job ID: 23489227
Cluster: uc2
User/Group: ul_ruw26/ul_student
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 01:46:28
CPU Efficiency: 19.88% of 08:55:30 core-walltime
Job Wall-clock time: 00:53:33
Memory Utilized: 19.20 GB
Memory Efficiency: 65.52% of 29.30 GB
