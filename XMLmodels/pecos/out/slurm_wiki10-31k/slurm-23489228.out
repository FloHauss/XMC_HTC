04/26/2024 03:41:32 - INFO - __main__ - Setting random seed 0
04/26/2024 03:41:33 - INFO - __main__ - Loaded training feature matrix with shape=(14146, 101938)
04/26/2024 03:41:33 - INFO - __main__ - Loaded training label matrix with shape=(14146, 30938)
04/26/2024 03:41:33 - INFO - __main__ - Loaded 14146 training sequences
04/26/2024 03:41:40 - INFO - pecos.xmc.xtransformer.model - Hierarchical label tree: [2, 32, 512, 30938]
04/26/2024 03:41:40 - INFO - pecos.xmc.xtransformer.model - Fine-tune Transformers with nr_labels=[2, 32, 512, 30938]
04/26/2024 03:41:40 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn at level 0, nr_labels=2, avr_M_nnz=2
04/26/2024 03:41:43 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-cased model from s3.
04/26/2024 03:41:43 - INFO - pecos.xmc.xtransformer.matcher - ***** Encoding data len=14146 truncation=256*****
04/26/2024 03:42:00 - INFO - pecos.xmc.xtransformer.matcher - ***** Finished with time cost=17.25635290145874 *****
04/26/2024 03:42:09 - INFO - pecos.xmc.xtransformer.matcher - trn tensors saved to /scratch/slurm_tmpdir/job_23489228/tmpgnkit8dh/X_trn.pt
04/26/2024 03:42:09 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 1
04/26/2024 03:42:11 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
04/26/2024 03:42:11 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
/home/ul/ul_student/ul_ruw26/.local/lib/python3.9/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
04/26/2024 03:42:11 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
04/26/2024 03:42:11 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 14146
04/26/2024 03:42:11 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 2
04/26/2024 03:42:11 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 3
04/26/2024 03:42:11 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
04/26/2024 03:42:11 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 8
04/26/2024 03:42:11 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
04/26/2024 03:42:11 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
04/26/2024 03:42:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][    50/  4000] |   49/1769 batches | ms/batch 207.6159 | train_loss 3.287692e-01 | lr 9.875000e-05
04/26/2024 03:42:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   100/  4000] |   99/1769 batches | ms/batch 107.6128 | train_loss 2.736668e-01 | lr 9.750000e-05
04/26/2024 03:42:30 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 100 ****
04/26/2024 03:42:31 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:42:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   150/  4000] |  149/1769 batches | ms/batch 107.6465 | train_loss 2.471865e-01 | lr 9.625000e-05
04/26/2024 03:42:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   200/  4000] |  199/1769 batches | ms/batch 107.7162 | train_loss 2.214904e-01 | lr 9.500000e-05
04/26/2024 03:42:44 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 200 ****
04/26/2024 03:42:45 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:42:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   250/  4000] |  249/1769 batches | ms/batch 107.9653 | train_loss 2.329297e-01 | lr 9.375000e-05
04/26/2024 03:42:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   300/  4000] |  299/1769 batches | ms/batch 108.0500 | train_loss 2.240005e-01 | lr 9.250000e-05
04/26/2024 03:42:57 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 300 ****
04/26/2024 03:42:58 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:43:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   350/  4000] |  349/1769 batches | ms/batch 107.6478 | train_loss 2.447918e-01 | lr 9.125000e-05
04/26/2024 03:43:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   400/  4000] |  399/1769 batches | ms/batch 108.2135 | train_loss 2.479854e-01 | lr 9.000000e-05
04/26/2024 03:43:11 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 400 ****
04/26/2024 03:43:11 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:43:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   450/  4000] |  449/1769 batches | ms/batch 108.0170 | train_loss 1.750621e-01 | lr 8.875000e-05
04/26/2024 03:43:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   500/  4000] |  499/1769 batches | ms/batch 108.1930 | train_loss 2.410800e-01 | lr 8.750000e-05
04/26/2024 03:43:24 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 500 ****
04/26/2024 03:43:25 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:43:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   550/  4000] |  549/1769 batches | ms/batch 108.2842 | train_loss 2.500334e-01 | lr 8.625000e-05
04/26/2024 03:43:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   600/  4000] |  599/1769 batches | ms/batch 108.5138 | train_loss 1.967428e-01 | lr 8.500000e-05
04/26/2024 03:43:38 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 600 ****
04/26/2024 03:43:38 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:43:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   650/  4000] |  649/1769 batches | ms/batch 107.6337 | train_loss 2.042740e-01 | lr 8.375000e-05
04/26/2024 03:43:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   700/  4000] |  699/1769 batches | ms/batch 107.9753 | train_loss 2.186699e-01 | lr 8.250000e-05
04/26/2024 03:43:51 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 700 ****
04/26/2024 03:43:51 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:43:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   750/  4000] |  749/1769 batches | ms/batch 108.4736 | train_loss 2.749361e-01 | lr 8.125000e-05
04/26/2024 03:44:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   800/  4000] |  799/1769 batches | ms/batch 108.5061 | train_loss 2.574511e-01 | lr 8.000000e-05
04/26/2024 03:44:05 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 800 ****
04/26/2024 03:44:05 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:44:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   850/  4000] |  849/1769 batches | ms/batch 108.3572 | train_loss 2.390957e-01 | lr 7.875000e-05
04/26/2024 03:44:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   900/  4000] |  899/1769 batches | ms/batch 108.9646 | train_loss 2.532062e-01 | lr 7.750000e-05
04/26/2024 03:44:18 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 900 ****
04/26/2024 03:44:19 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:44:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   950/  4000] |  949/1769 batches | ms/batch 109.0097 | train_loss 2.727655e-01 | lr 7.625000e-05
04/26/2024 03:44:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1000/  4000] |  999/1769 batches | ms/batch 108.3527 | train_loss 1.954234e-01 | lr 7.500000e-05
04/26/2024 03:44:31 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 1000 ****
04/26/2024 03:44:32 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:44:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1050/  4000] | 1049/1769 batches | ms/batch 108.3406 | train_loss 2.003824e-01 | lr 7.375000e-05
04/26/2024 03:44:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1100/  4000] | 1099/1769 batches | ms/batch 109.3237 | train_loss 3.098347e-01 | lr 7.250000e-05
04/26/2024 03:44:45 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 1100 ****
04/26/2024 03:44:46 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:44:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1150/  4000] | 1149/1769 batches | ms/batch 108.4693 | train_loss 2.049502e-01 | lr 7.125000e-05
04/26/2024 03:44:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1200/  4000] | 1199/1769 batches | ms/batch 108.4874 | train_loss 1.818969e-01 | lr 7.000000e-05
04/26/2024 03:44:58 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 1200 ****
04/26/2024 03:44:59 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:45:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1250/  4000] | 1249/1769 batches | ms/batch 108.6602 | train_loss 2.335273e-01 | lr 6.875000e-05
04/26/2024 03:45:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1300/  4000] | 1299/1769 batches | ms/batch 108.8674 | train_loss 2.741250e-01 | lr 6.750000e-05
04/26/2024 03:45:12 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 1300 ****
04/26/2024 03:45:13 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:45:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1350/  4000] | 1349/1769 batches | ms/batch 109.1618 | train_loss 2.292755e-01 | lr 6.625000e-05
04/26/2024 03:45:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1400/  4000] | 1399/1769 batches | ms/batch 109.1696 | train_loss 3.308355e-01 | lr 6.500000e-05
04/26/2024 03:45:25 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 1400 ****
04/26/2024 03:45:26 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:45:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1450/  4000] | 1449/1769 batches | ms/batch 108.9322 | train_loss 2.000582e-01 | lr 6.375000e-05
04/26/2024 03:45:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1500/  4000] | 1499/1769 batches | ms/batch 108.3652 | train_loss 1.808963e-01 | lr 6.250000e-05
04/26/2024 03:45:39 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 1500 ****
04/26/2024 03:45:39 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:45:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1550/  4000] | 1549/1769 batches | ms/batch 108.8733 | train_loss 2.366961e-01 | lr 6.125000e-05
04/26/2024 03:45:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1600/  4000] | 1599/1769 batches | ms/batch 108.5784 | train_loss 1.825001e-01 | lr 6.000000e-05
04/26/2024 03:45:53 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 1600 ****
04/26/2024 03:45:53 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:46:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1650/  4000] | 1649/1769 batches | ms/batch 108.5237 | train_loss 1.561529e-01 | lr 5.875000e-05
04/26/2024 03:46:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1700/  4000] | 1699/1769 batches | ms/batch 108.7902 | train_loss 2.620293e-01 | lr 5.750000e-05
04/26/2024 03:46:06 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 1700 ****
04/26/2024 03:46:07 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:46:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1750/  4000] | 1749/1769 batches | ms/batch 108.5098 | train_loss 2.074000e-01 | lr 5.625000e-05
04/26/2024 03:46:21 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1800/  4000] |   30/1769 batches | ms/batch 107.5595 | train_loss 2.392684e-01 | lr 5.500000e-05
04/26/2024 03:46:21 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 1800 ****
04/26/2024 03:46:22 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:46:28 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1850/  4000] |   80/1769 batches | ms/batch 108.7411 | train_loss 2.456084e-01 | lr 5.375000e-05
04/26/2024 03:46:35 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1900/  4000] |  130/1769 batches | ms/batch 108.5825 | train_loss 1.837301e-01 | lr 5.250000e-05
04/26/2024 03:46:35 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 1900 ****
04/26/2024 03:46:35 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:46:42 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1950/  4000] |  180/1769 batches | ms/batch 108.6268 | train_loss 2.460127e-01 | lr 5.125000e-05
04/26/2024 03:46:48 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2000/  4000] |  230/1769 batches | ms/batch 108.9492 | train_loss 2.503598e-01 | lr 5.000000e-05
04/26/2024 03:46:48 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 2000 ****
04/26/2024 03:46:49 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:46:55 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2050/  4000] |  280/1769 batches | ms/batch 108.6785 | train_loss 1.610543e-01 | lr 4.875000e-05
04/26/2024 03:47:02 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2100/  4000] |  330/1769 batches | ms/batch 108.5084 | train_loss 1.626863e-01 | lr 4.750000e-05
04/26/2024 03:47:02 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 2100 ****
04/26/2024 03:47:02 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:47:09 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2150/  4000] |  380/1769 batches | ms/batch 108.7070 | train_loss 2.116245e-01 | lr 4.625000e-05
04/26/2024 03:47:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2200/  4000] |  430/1769 batches | ms/batch 109.0324 | train_loss 2.249361e-01 | lr 4.500000e-05
04/26/2024 03:47:15 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 2200 ****
04/26/2024 03:47:16 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:47:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2250/  4000] |  480/1769 batches | ms/batch 109.2168 | train_loss 2.151489e-01 | lr 4.375000e-05
04/26/2024 03:47:29 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2300/  4000] |  530/1769 batches | ms/batch 108.6243 | train_loss 1.996027e-01 | lr 4.250000e-05
04/26/2024 03:47:29 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 2300 ****
04/26/2024 03:47:29 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:47:36 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2350/  4000] |  580/1769 batches | ms/batch 108.9991 | train_loss 2.025165e-01 | lr 4.125000e-05
04/26/2024 03:47:42 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2400/  4000] |  630/1769 batches | ms/batch 109.2280 | train_loss 2.397778e-01 | lr 4.000000e-05
04/26/2024 03:47:42 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 2400 ****
04/26/2024 03:47:43 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:47:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2450/  4000] |  680/1769 batches | ms/batch 109.0180 | train_loss 2.352967e-01 | lr 3.875000e-05
04/26/2024 03:47:56 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2500/  4000] |  730/1769 batches | ms/batch 109.3462 | train_loss 2.712094e-01 | lr 3.750000e-05
04/26/2024 03:47:56 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 2500 ****
04/26/2024 03:47:56 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:48:03 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2550/  4000] |  780/1769 batches | ms/batch 109.0064 | train_loss 2.161326e-01 | lr 3.625000e-05
04/26/2024 03:48:09 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2600/  4000] |  830/1769 batches | ms/batch 108.7035 | train_loss 2.354678e-01 | lr 3.500000e-05
04/26/2024 03:48:09 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 2600 ****
04/26/2024 03:48:10 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:48:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2650/  4000] |  880/1769 batches | ms/batch 109.0983 | train_loss 2.643880e-01 | lr 3.375000e-05
04/26/2024 03:48:23 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2700/  4000] |  930/1769 batches | ms/batch 109.2506 | train_loss 2.502709e-01 | lr 3.250000e-05
04/26/2024 03:48:23 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 2700 ****
04/26/2024 03:48:24 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:48:30 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2750/  4000] |  980/1769 batches | ms/batch 108.8257 | train_loss 1.721633e-01 | lr 3.125000e-05
04/26/2024 03:48:37 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2800/  4000] | 1030/1769 batches | ms/batch 108.9324 | train_loss 2.142879e-01 | lr 3.000000e-05
04/26/2024 03:48:37 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 2800 ****
04/26/2024 03:48:37 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:48:44 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2850/  4000] | 1080/1769 batches | ms/batch 108.8590 | train_loss 1.837000e-01 | lr 2.875000e-05
04/26/2024 03:48:50 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2900/  4000] | 1130/1769 batches | ms/batch 109.2624 | train_loss 2.543318e-01 | lr 2.750000e-05
04/26/2024 03:48:50 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 2900 ****
04/26/2024 03:48:51 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:48:57 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2950/  4000] | 1180/1769 batches | ms/batch 108.7316 | train_loss 1.825238e-01 | lr 2.625000e-05
04/26/2024 03:49:04 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3000/  4000] | 1230/1769 batches | ms/batch 108.8870 | train_loss 2.225529e-01 | lr 2.500000e-05
04/26/2024 03:49:04 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 3000 ****
04/26/2024 03:49:04 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:49:11 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3050/  4000] | 1280/1769 batches | ms/batch 109.3021 | train_loss 2.523900e-01 | lr 2.375000e-05
04/26/2024 03:49:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3100/  4000] | 1330/1769 batches | ms/batch 109.2141 | train_loss 1.944376e-01 | lr 2.250000e-05
04/26/2024 03:49:17 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 3100 ****
04/26/2024 03:49:18 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:49:24 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3150/  4000] | 1380/1769 batches | ms/batch 108.9002 | train_loss 2.257248e-01 | lr 2.125000e-05
04/26/2024 03:49:31 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3200/  4000] | 1430/1769 batches | ms/batch 109.1616 | train_loss 2.609444e-01 | lr 2.000000e-05
04/26/2024 03:49:31 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 3200 ****
04/26/2024 03:49:31 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:49:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3250/  4000] | 1480/1769 batches | ms/batch 109.2135 | train_loss 2.285397e-01 | lr 1.875000e-05
04/26/2024 03:49:44 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3300/  4000] | 1530/1769 batches | ms/batch 109.4973 | train_loss 2.593087e-01 | lr 1.750000e-05
04/26/2024 03:49:44 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 3300 ****
04/26/2024 03:49:45 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:49:51 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3350/  4000] | 1580/1769 batches | ms/batch 109.4610 | train_loss 2.618899e-01 | lr 1.625000e-05
04/26/2024 03:49:58 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3400/  4000] | 1630/1769 batches | ms/batch 109.2808 | train_loss 2.201487e-01 | lr 1.500000e-05
04/26/2024 03:49:58 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 3400 ****
04/26/2024 03:49:58 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:50:05 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3450/  4000] | 1680/1769 batches | ms/batch 109.2916 | train_loss 2.466426e-01 | lr 1.375000e-05
04/26/2024 03:50:11 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3500/  4000] | 1730/1769 batches | ms/batch 108.8067 | train_loss 1.858095e-01 | lr 1.250000e-05
04/26/2024 03:50:11 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 3500 ****
04/26/2024 03:50:12 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:50:19 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3550/  4000] |   11/1769 batches | ms/batch 107.5743 | train_loss 1.897224e-01 | lr 1.125000e-05
04/26/2024 03:50:26 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3600/  4000] |   61/1769 batches | ms/batch 109.2121 | train_loss 2.828891e-01 | lr 1.000000e-05
04/26/2024 03:50:26 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 3600 ****
04/26/2024 03:50:27 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:50:33 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3650/  4000] |  111/1769 batches | ms/batch 109.2406 | train_loss 2.060229e-01 | lr 8.750000e-06
04/26/2024 03:50:40 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3700/  4000] |  161/1769 batches | ms/batch 109.0025 | train_loss 2.306875e-01 | lr 7.500000e-06
04/26/2024 03:50:40 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 3700 ****
04/26/2024 03:50:40 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:50:47 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3750/  4000] |  211/1769 batches | ms/batch 109.1189 | train_loss 1.802271e-01 | lr 6.250000e-06
04/26/2024 03:50:53 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3800/  4000] |  261/1769 batches | ms/batch 109.1429 | train_loss 2.448175e-01 | lr 5.000000e-06
04/26/2024 03:50:53 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 3800 ****
04/26/2024 03:50:54 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:51:00 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3850/  4000] |  311/1769 batches | ms/batch 109.1706 | train_loss 2.220399e-01 | lr 3.750000e-06
04/26/2024 03:51:07 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3900/  4000] |  361/1769 batches | ms/batch 109.3019 | train_loss 2.389014e-01 | lr 2.500000e-06
04/26/2024 03:51:07 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 3900 ****
04/26/2024 03:51:07 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:51:14 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3950/  4000] |  411/1769 batches | ms/batch 109.1246 | train_loss 2.258494e-01 | lr 1.250000e-06
04/26/2024 03:51:21 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  4000/  4000] |  461/1769 batches | ms/batch 109.2373 | train_loss 1.786925e-01 | lr 0.000000e+00
04/26/2024 03:51:21 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g at global_step 4000 ****
04/26/2024 03:51:21 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:51:21 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23489228/tmpsqliwl9g
04/26/2024 03:51:22 - INFO - pecos.xmc.xtransformer.matcher - Predict on input text tensors(torch.Size([14146, 256])) in OVA mode
04/26/2024 03:51:22 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/26/2024 03:52:35 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn at level 1, nr_labels=32, avr_M_nnz=1.8872472783825816
04/26/2024 03:52:35 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-cased model from s3.
04/26/2024 03:52:48 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23489228/tmpgnkit8dh/X_trn.pt
04/26/2024 03:52:48 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
04/26/2024 03:52:58 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
04/26/2024 03:52:58 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 1
04/26/2024 03:52:59 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
04/26/2024 03:52:59 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/26/2024 03:52:59 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
04/26/2024 03:52:59 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 14146
04/26/2024 03:52:59 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 32
04/26/2024 03:52:59 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 32
04/26/2024 03:52:59 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 3
04/26/2024 03:52:59 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
04/26/2024 03:52:59 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 8
04/26/2024 03:52:59 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
04/26/2024 03:52:59 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
04/26/2024 03:53:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][    50/  4000] |   49/1769 batches | ms/batch 109.2344 | train_loss 6.306157e+00 | lr 9.875000e-05
04/26/2024 03:53:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   100/  4000] |   99/1769 batches | ms/batch 109.0704 | train_loss 2.128735e+00 | lr 9.750000e-05
04/26/2024 03:53:14 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 100 ****
04/26/2024 03:53:15 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:53:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   150/  4000] |  149/1769 batches | ms/batch 109.3751 | train_loss 2.094356e+00 | lr 9.625000e-05
04/26/2024 03:53:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   200/  4000] |  199/1769 batches | ms/batch 109.4871 | train_loss 2.380812e+00 | lr 9.500000e-05
04/26/2024 03:53:28 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 200 ****
04/26/2024 03:53:29 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:53:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   250/  4000] |  249/1769 batches | ms/batch 109.2670 | train_loss 2.111720e+00 | lr 9.375000e-05
04/26/2024 03:53:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   300/  4000] |  299/1769 batches | ms/batch 109.3907 | train_loss 1.885176e+00 | lr 9.250000e-05
04/26/2024 03:53:42 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 300 ****
04/26/2024 03:53:43 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:53:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   350/  4000] |  349/1769 batches | ms/batch 109.6821 | train_loss 1.750816e+00 | lr 9.125000e-05
04/26/2024 03:53:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   400/  4000] |  399/1769 batches | ms/batch 109.6498 | train_loss 1.532837e+00 | lr 9.000000e-05
04/26/2024 03:53:56 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 400 ****
04/26/2024 03:53:57 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:54:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   450/  4000] |  449/1769 batches | ms/batch 109.5342 | train_loss 1.685312e+00 | lr 8.875000e-05
04/26/2024 03:54:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   500/  4000] |  499/1769 batches | ms/batch 109.6742 | train_loss 2.086196e+00 | lr 8.750000e-05
04/26/2024 03:54:10 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 500 ****
04/26/2024 03:54:11 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:54:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   550/  4000] |  549/1769 batches | ms/batch 109.7617 | train_loss 1.419042e+00 | lr 8.625000e-05
04/26/2024 03:54:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   600/  4000] |  599/1769 batches | ms/batch 109.6119 | train_loss 1.694276e+00 | lr 8.500000e-05
04/26/2024 03:54:24 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 600 ****
04/26/2024 03:54:25 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:54:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   650/  4000] |  649/1769 batches | ms/batch 109.2966 | train_loss 1.374584e+00 | lr 8.375000e-05
04/26/2024 03:54:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   700/  4000] |  699/1769 batches | ms/batch 109.3724 | train_loss 1.501581e+00 | lr 8.250000e-05
04/26/2024 03:54:38 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 700 ****
04/26/2024 03:54:39 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:54:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   750/  4000] |  749/1769 batches | ms/batch 109.7733 | train_loss 1.323411e+00 | lr 8.125000e-05
04/26/2024 03:54:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   800/  4000] |  799/1769 batches | ms/batch 109.9853 | train_loss 1.590419e+00 | lr 8.000000e-05
04/26/2024 03:54:53 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 800 ****
04/26/2024 03:54:53 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:55:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   850/  4000] |  849/1769 batches | ms/batch 109.5454 | train_loss 1.266486e+00 | lr 7.875000e-05
04/26/2024 03:55:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   900/  4000] |  899/1769 batches | ms/batch 109.6637 | train_loss 1.312596e+00 | lr 7.750000e-05
04/26/2024 03:55:07 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 900 ****
04/26/2024 03:55:07 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:55:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   950/  4000] |  949/1769 batches | ms/batch 109.8698 | train_loss 1.440899e+00 | lr 7.625000e-05
04/26/2024 03:55:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1000/  4000] |  999/1769 batches | ms/batch 109.7811 | train_loss 1.184906e+00 | lr 7.500000e-05
04/26/2024 03:55:21 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 1000 ****
04/26/2024 03:55:21 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:55:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1050/  4000] | 1049/1769 batches | ms/batch 109.6110 | train_loss 1.470939e+00 | lr 7.375000e-05
04/26/2024 03:55:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1100/  4000] | 1099/1769 batches | ms/batch 109.6617 | train_loss 1.439396e+00 | lr 7.250000e-05
04/26/2024 03:55:35 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 1100 ****
04/26/2024 03:55:35 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:55:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1150/  4000] | 1149/1769 batches | ms/batch 109.6149 | train_loss 1.128162e+00 | lr 7.125000e-05
04/26/2024 03:55:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1200/  4000] | 1199/1769 batches | ms/batch 109.7191 | train_loss 1.150385e+00 | lr 7.000000e-05
04/26/2024 03:55:49 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 1200 ****
04/26/2024 03:55:49 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:55:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1250/  4000] | 1249/1769 batches | ms/batch 109.4940 | train_loss 1.083350e+00 | lr 6.875000e-05
04/26/2024 03:56:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1300/  4000] | 1299/1769 batches | ms/batch 109.6138 | train_loss 1.099967e+00 | lr 6.750000e-05
04/26/2024 03:56:03 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 1300 ****
04/26/2024 03:56:04 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:56:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1350/  4000] | 1349/1769 batches | ms/batch 109.6540 | train_loss 1.249143e+00 | lr 6.625000e-05
04/26/2024 03:56:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1400/  4000] | 1399/1769 batches | ms/batch 109.6138 | train_loss 1.186586e+00 | lr 6.500000e-05
04/26/2024 03:56:17 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 1400 ****
04/26/2024 03:56:18 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:56:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1450/  4000] | 1449/1769 batches | ms/batch 109.5114 | train_loss 1.089539e+00 | lr 6.375000e-05
04/26/2024 03:56:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1500/  4000] | 1499/1769 batches | ms/batch 109.8463 | train_loss 1.069489e+00 | lr 6.250000e-05
04/26/2024 03:56:31 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 1500 ****
04/26/2024 03:56:32 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:56:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1550/  4000] | 1549/1769 batches | ms/batch 109.8131 | train_loss 1.095430e+00 | lr 6.125000e-05
04/26/2024 03:56:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1600/  4000] | 1599/1769 batches | ms/batch 109.8441 | train_loss 1.082562e+00 | lr 6.000000e-05
04/26/2024 03:56:45 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 1600 ****
04/26/2024 03:56:46 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:56:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1650/  4000] | 1649/1769 batches | ms/batch 109.6397 | train_loss 1.014849e+00 | lr 5.875000e-05
04/26/2024 03:56:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1700/  4000] | 1699/1769 batches | ms/batch 109.6989 | train_loss 1.120682e+00 | lr 5.750000e-05
04/26/2024 03:56:59 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 1700 ****
04/26/2024 03:57:00 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:57:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1750/  4000] | 1749/1769 batches | ms/batch 109.7139 | train_loss 1.067872e+00 | lr 5.625000e-05
04/26/2024 03:57:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1800/  4000] |   30/1769 batches | ms/batch 108.1754 | train_loss 9.500650e-01 | lr 5.500000e-05
04/26/2024 03:57:15 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 1800 ****
04/26/2024 03:57:16 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:57:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1850/  4000] |   80/1769 batches | ms/batch 109.4705 | train_loss 9.262631e-01 | lr 5.375000e-05
04/26/2024 03:57:29 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1900/  4000] |  130/1769 batches | ms/batch 109.5236 | train_loss 9.944673e-01 | lr 5.250000e-05
04/26/2024 03:57:29 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 1900 ****
04/26/2024 03:57:30 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:57:36 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1950/  4000] |  180/1769 batches | ms/batch 109.4697 | train_loss 9.887760e-01 | lr 5.125000e-05
04/26/2024 03:57:43 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2000/  4000] |  230/1769 batches | ms/batch 109.3776 | train_loss 9.375870e-01 | lr 5.000000e-05
04/26/2024 03:57:43 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 2000 ****
04/26/2024 03:57:44 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:57:50 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2050/  4000] |  280/1769 batches | ms/batch 109.4392 | train_loss 9.544230e-01 | lr 4.875000e-05
04/26/2024 03:57:57 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2100/  4000] |  330/1769 batches | ms/batch 109.4302 | train_loss 9.475495e-01 | lr 4.750000e-05
04/26/2024 03:57:57 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 2100 ****
04/26/2024 03:57:58 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:58:04 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2150/  4000] |  380/1769 batches | ms/batch 109.5093 | train_loss 1.014496e+00 | lr 4.625000e-05
04/26/2024 03:58:11 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2200/  4000] |  430/1769 batches | ms/batch 109.4535 | train_loss 9.434594e-01 | lr 4.500000e-05
04/26/2024 03:58:11 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 2200 ****
04/26/2024 03:58:11 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:58:18 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2250/  4000] |  480/1769 batches | ms/batch 109.3962 | train_loss 8.542034e-01 | lr 4.375000e-05
04/26/2024 03:58:25 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2300/  4000] |  530/1769 batches | ms/batch 109.6200 | train_loss 8.584079e-01 | lr 4.250000e-05
04/26/2024 03:58:25 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 2300 ****
04/26/2024 03:58:26 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:58:32 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2350/  4000] |  580/1769 batches | ms/batch 109.5248 | train_loss 9.125480e-01 | lr 4.125000e-05
04/26/2024 03:58:39 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2400/  4000] |  630/1769 batches | ms/batch 109.5968 | train_loss 8.799554e-01 | lr 4.000000e-05
04/26/2024 03:58:39 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 2400 ****
04/26/2024 03:58:39 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:58:46 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2450/  4000] |  680/1769 batches | ms/batch 109.4437 | train_loss 9.280402e-01 | lr 3.875000e-05
04/26/2024 03:58:53 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2500/  4000] |  730/1769 batches | ms/batch 109.7135 | train_loss 9.131311e-01 | lr 3.750000e-05
04/26/2024 03:58:53 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 2500 ****
04/26/2024 03:58:53 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:59:00 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2550/  4000] |  780/1769 batches | ms/batch 109.6113 | train_loss 8.450577e-01 | lr 3.625000e-05
04/26/2024 03:59:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2600/  4000] |  830/1769 batches | ms/batch 109.4683 | train_loss 9.253120e-01 | lr 3.500000e-05
04/26/2024 03:59:07 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 2600 ****
04/26/2024 03:59:07 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:59:14 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2650/  4000] |  880/1769 batches | ms/batch 109.4997 | train_loss 9.087605e-01 | lr 3.375000e-05
04/26/2024 03:59:21 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2700/  4000] |  930/1769 batches | ms/batch 109.7397 | train_loss 8.664038e-01 | lr 3.250000e-05
04/26/2024 03:59:21 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 2700 ****
04/26/2024 03:59:21 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:59:28 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2750/  4000] |  980/1769 batches | ms/batch 109.5243 | train_loss 8.953489e-01 | lr 3.125000e-05
04/26/2024 03:59:35 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2800/  4000] | 1030/1769 batches | ms/batch 109.5933 | train_loss 8.655113e-01 | lr 3.000000e-05
04/26/2024 03:59:35 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 2800 ****
04/26/2024 03:59:36 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:59:42 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2850/  4000] | 1080/1769 batches | ms/batch 109.5703 | train_loss 8.598719e-01 | lr 2.875000e-05
04/26/2024 03:59:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2900/  4000] | 1130/1769 batches | ms/batch 109.7110 | train_loss 8.667807e-01 | lr 2.750000e-05
04/26/2024 03:59:49 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 2900 ****
04/26/2024 03:59:49 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 03:59:56 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2950/  4000] | 1180/1769 batches | ms/batch 109.6455 | train_loss 7.967502e-01 | lr 2.625000e-05
04/26/2024 04:00:03 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3000/  4000] | 1230/1769 batches | ms/batch 109.8365 | train_loss 8.549523e-01 | lr 2.500000e-05
04/26/2024 04:00:03 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 3000 ****
04/26/2024 04:00:04 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:00:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3050/  4000] | 1280/1769 batches | ms/batch 109.5943 | train_loss 7.964075e-01 | lr 2.375000e-05
04/26/2024 04:00:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3100/  4000] | 1330/1769 batches | ms/batch 109.7302 | train_loss 8.311238e-01 | lr 2.250000e-05
04/26/2024 04:00:17 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 3100 ****
04/26/2024 04:00:18 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:00:24 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3150/  4000] | 1380/1769 batches | ms/batch 109.7411 | train_loss 8.867289e-01 | lr 2.125000e-05
04/26/2024 04:00:31 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3200/  4000] | 1430/1769 batches | ms/batch 109.6729 | train_loss 9.094970e-01 | lr 2.000000e-05
04/26/2024 04:00:31 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 3200 ****
04/26/2024 04:00:32 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:00:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3250/  4000] | 1480/1769 batches | ms/batch 109.6434 | train_loss 8.153249e-01 | lr 1.875000e-05
04/26/2024 04:00:45 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3300/  4000] | 1530/1769 batches | ms/batch 109.8171 | train_loss 7.973667e-01 | lr 1.750000e-05
04/26/2024 04:00:45 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 3300 ****
04/26/2024 04:00:46 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:00:53 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3350/  4000] | 1580/1769 batches | ms/batch 109.6480 | train_loss 7.998514e-01 | lr 1.625000e-05
04/26/2024 04:00:59 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3400/  4000] | 1630/1769 batches | ms/batch 109.6117 | train_loss 1.127258e+00 | lr 1.500000e-05
04/26/2024 04:00:59 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 3400 ****
04/26/2024 04:01:00 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:01:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3450/  4000] | 1680/1769 batches | ms/batch 109.8051 | train_loss 8.106898e-01 | lr 1.375000e-05
04/26/2024 04:01:13 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3500/  4000] | 1730/1769 batches | ms/batch 109.8970 | train_loss 8.026561e-01 | lr 1.250000e-05
04/26/2024 04:01:13 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 3500 ****
04/26/2024 04:01:14 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:01:22 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3550/  4000] |   11/1769 batches | ms/batch 108.0579 | train_loss 8.121636e-01 | lr 1.125000e-05
04/26/2024 04:01:29 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3600/  4000] |   61/1769 batches | ms/batch 109.4855 | train_loss 7.714892e-01 | lr 1.000000e-05
04/26/2024 04:01:29 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 3600 ****
04/26/2024 04:01:29 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:01:36 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3650/  4000] |  111/1769 batches | ms/batch 109.6752 | train_loss 7.635844e-01 | lr 8.750000e-06
04/26/2024 04:01:43 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3700/  4000] |  161/1769 batches | ms/batch 109.7451 | train_loss 8.180976e-01 | lr 7.500000e-06
04/26/2024 04:01:43 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 3700 ****
04/26/2024 04:01:44 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:01:50 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3750/  4000] |  211/1769 batches | ms/batch 109.5986 | train_loss 7.999861e-01 | lr 6.250000e-06
04/26/2024 04:01:57 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3800/  4000] |  261/1769 batches | ms/batch 109.6717 | train_loss 8.008691e-01 | lr 5.000000e-06
04/26/2024 04:01:57 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 3800 ****
04/26/2024 04:01:57 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:02:04 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3850/  4000] |  311/1769 batches | ms/batch 109.5773 | train_loss 7.739540e-01 | lr 3.750000e-06
04/26/2024 04:02:11 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3900/  4000] |  361/1769 batches | ms/batch 109.5750 | train_loss 7.567799e-01 | lr 2.500000e-06
04/26/2024 04:02:11 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 3900 ****
04/26/2024 04:02:12 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:02:18 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3950/  4000] |  411/1769 batches | ms/batch 109.5747 | train_loss 7.434545e-01 | lr 1.250000e-06
04/26/2024 04:02:25 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  4000/  4000] |  461/1769 batches | ms/batch 109.5059 | train_loss 7.441933e-01 | lr 0.000000e+00
04/26/2024 04:02:25 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq at global_step 4000 ****
04/26/2024 04:02:26 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:02:26 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23489228/tmp69opmzdq
04/26/2024 04:02:26 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((14146, 32)) with avr_nnz=32.0
04/26/2024 04:02:26 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/26/2024 04:03:42 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn at level 2, nr_labels=512, avr_M_nnz=7.868372684857911
04/26/2024 04:03:43 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-cased model from s3.
04/26/2024 04:03:57 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23489228/tmpgnkit8dh/X_trn.pt
04/26/2024 04:03:57 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
04/26/2024 04:04:32 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
04/26/2024 04:04:32 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 1
04/26/2024 04:04:32 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
04/26/2024 04:04:32 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/26/2024 04:04:33 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
04/26/2024 04:04:33 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 14146
04/26/2024 04:04:33 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 512
04/26/2024 04:04:33 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 304
04/26/2024 04:04:33 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 3
04/26/2024 04:04:33 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
04/26/2024 04:04:33 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 8
04/26/2024 04:04:33 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
04/26/2024 04:04:33 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
04/26/2024 04:04:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][    50/  4000] |   49/1769 batches | ms/batch 109.0230 | train_loss 7.254807e-01 | lr 9.875000e-05
04/26/2024 04:04:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   100/  4000] |   99/1769 batches | ms/batch 108.7171 | train_loss 7.159118e-01 | lr 9.750000e-05
04/26/2024 04:04:48 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 100 ****
04/26/2024 04:04:48 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:04:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   150/  4000] |  149/1769 batches | ms/batch 108.7999 | train_loss 7.102917e-01 | lr 9.625000e-05
04/26/2024 04:05:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   200/  4000] |  199/1769 batches | ms/batch 109.1390 | train_loss 7.031978e-01 | lr 9.500000e-05
04/26/2024 04:05:02 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 200 ****
04/26/2024 04:05:02 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:05:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   250/  4000] |  249/1769 batches | ms/batch 109.2773 | train_loss 7.119347e-01 | lr 9.375000e-05
04/26/2024 04:05:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   300/  4000] |  299/1769 batches | ms/batch 109.1544 | train_loss 7.089423e-01 | lr 9.250000e-05
04/26/2024 04:05:15 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 300 ****
04/26/2024 04:05:16 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:05:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   350/  4000] |  349/1769 batches | ms/batch 109.3467 | train_loss 7.090479e-01 | lr 9.125000e-05
04/26/2024 04:05:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   400/  4000] |  399/1769 batches | ms/batch 109.3733 | train_loss 7.025425e-01 | lr 9.000000e-05
04/26/2024 04:05:29 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 400 ****
04/26/2024 04:05:30 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:05:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   450/  4000] |  449/1769 batches | ms/batch 109.5959 | train_loss 6.969236e-01 | lr 8.875000e-05
04/26/2024 04:05:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   500/  4000] |  499/1769 batches | ms/batch 109.5191 | train_loss 6.955863e-01 | lr 8.750000e-05
04/26/2024 04:05:43 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 500 ****
04/26/2024 04:05:44 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:05:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   550/  4000] |  549/1769 batches | ms/batch 109.3581 | train_loss 6.984305e-01 | lr 8.625000e-05
04/26/2024 04:05:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   600/  4000] |  599/1769 batches | ms/batch 109.5945 | train_loss 7.008849e-01 | lr 8.500000e-05
04/26/2024 04:05:57 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 600 ****
04/26/2024 04:05:58 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:06:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   650/  4000] |  649/1769 batches | ms/batch 109.6124 | train_loss 7.008391e-01 | lr 8.375000e-05
04/26/2024 04:06:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   700/  4000] |  699/1769 batches | ms/batch 109.5223 | train_loss 7.005856e-01 | lr 8.250000e-05
04/26/2024 04:06:11 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 700 ****
04/26/2024 04:06:12 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:06:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   750/  4000] |  749/1769 batches | ms/batch 109.3710 | train_loss 7.033289e-01 | lr 8.125000e-05
04/26/2024 04:06:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   800/  4000] |  799/1769 batches | ms/batch 109.5871 | train_loss 7.073241e-01 | lr 8.000000e-05
04/26/2024 04:06:25 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 800 ****
04/26/2024 04:06:26 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:06:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   850/  4000] |  849/1769 batches | ms/batch 109.4685 | train_loss 6.961715e-01 | lr 7.875000e-05
04/26/2024 04:06:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   900/  4000] |  899/1769 batches | ms/batch 109.5194 | train_loss 7.002299e-01 | lr 7.750000e-05
04/26/2024 04:06:39 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 900 ****
04/26/2024 04:06:40 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:06:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   950/  4000] |  949/1769 batches | ms/batch 109.6414 | train_loss 7.042602e-01 | lr 7.625000e-05
04/26/2024 04:06:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1000/  4000] |  999/1769 batches | ms/batch 109.7235 | train_loss 7.036793e-01 | lr 7.500000e-05
04/26/2024 04:06:53 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 1000 ****
04/26/2024 04:06:54 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:07:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1050/  4000] | 1049/1769 batches | ms/batch 109.5086 | train_loss 6.929269e-01 | lr 7.375000e-05
04/26/2024 04:07:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1100/  4000] | 1099/1769 batches | ms/batch 109.5322 | train_loss 7.052447e-01 | lr 7.250000e-05
04/26/2024 04:07:07 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 1100 ****
04/26/2024 04:07:08 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:07:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1150/  4000] | 1149/1769 batches | ms/batch 109.5700 | train_loss 7.031813e-01 | lr 7.125000e-05
04/26/2024 04:07:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1200/  4000] | 1199/1769 batches | ms/batch 109.6390 | train_loss 7.001558e-01 | lr 7.000000e-05
04/26/2024 04:07:21 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 1200 ****
04/26/2024 04:07:22 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:07:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1250/  4000] | 1249/1769 batches | ms/batch 109.7105 | train_loss 7.044237e-01 | lr 6.875000e-05
04/26/2024 04:07:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1300/  4000] | 1299/1769 batches | ms/batch 109.5288 | train_loss 7.114156e-01 | lr 6.750000e-05
04/26/2024 04:07:35 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 1300 ****
04/26/2024 04:07:36 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:07:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1350/  4000] | 1349/1769 batches | ms/batch 109.5324 | train_loss 7.092291e-01 | lr 6.625000e-05
04/26/2024 04:07:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1400/  4000] | 1399/1769 batches | ms/batch 109.8938 | train_loss 6.999990e-01 | lr 6.500000e-05
04/26/2024 04:07:49 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 1400 ****
04/26/2024 04:07:50 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:07:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1450/  4000] | 1449/1769 batches | ms/batch 109.8856 | train_loss 6.987820e-01 | lr 6.375000e-05
04/26/2024 04:08:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1500/  4000] | 1499/1769 batches | ms/batch 109.6728 | train_loss 6.982457e-01 | lr 6.250000e-05
04/26/2024 04:08:03 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 1500 ****
04/26/2024 04:08:04 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:08:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1550/  4000] | 1549/1769 batches | ms/batch 109.7770 | train_loss 7.033907e-01 | lr 6.125000e-05
04/26/2024 04:08:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1600/  4000] | 1599/1769 batches | ms/batch 109.8603 | train_loss 6.987772e-01 | lr 6.000000e-05
04/26/2024 04:08:17 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 1600 ****
04/26/2024 04:08:18 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:08:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1650/  4000] | 1649/1769 batches | ms/batch 109.6912 | train_loss 6.948966e-01 | lr 5.875000e-05
04/26/2024 04:08:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1700/  4000] | 1699/1769 batches | ms/batch 109.7111 | train_loss 7.016681e-01 | lr 5.750000e-05
04/26/2024 04:08:31 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 1700 ****
04/26/2024 04:08:32 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:08:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1750/  4000] | 1749/1769 batches | ms/batch 109.9480 | train_loss 7.032298e-01 | lr 5.625000e-05
04/26/2024 04:08:47 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1800/  4000] |   30/1769 batches | ms/batch 108.4255 | train_loss 6.963219e-01 | lr 5.500000e-05
04/26/2024 04:08:47 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 1800 ****
04/26/2024 04:08:48 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:08:55 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1850/  4000] |   80/1769 batches | ms/batch 109.5929 | train_loss 6.966941e-01 | lr 5.375000e-05
04/26/2024 04:09:01 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1900/  4000] |  130/1769 batches | ms/batch 109.6128 | train_loss 7.100732e-01 | lr 5.250000e-05
04/26/2024 04:09:01 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 1900 ****
04/26/2024 04:09:02 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:09:09 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1950/  4000] |  180/1769 batches | ms/batch 109.5803 | train_loss 6.952273e-01 | lr 5.125000e-05
04/26/2024 04:09:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2000/  4000] |  230/1769 batches | ms/batch 109.5734 | train_loss 6.973165e-01 | lr 5.000000e-05
04/26/2024 04:09:15 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 2000 ****
04/26/2024 04:09:16 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:09:23 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2050/  4000] |  280/1769 batches | ms/batch 109.5008 | train_loss 6.944151e-01 | lr 4.875000e-05
04/26/2024 04:09:29 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2100/  4000] |  330/1769 batches | ms/batch 109.4927 | train_loss 7.098253e-01 | lr 4.750000e-05
04/26/2024 04:09:29 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 2100 ****
04/26/2024 04:09:30 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:09:37 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2150/  4000] |  380/1769 batches | ms/batch 109.6481 | train_loss 6.975418e-01 | lr 4.625000e-05
04/26/2024 04:09:43 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2200/  4000] |  430/1769 batches | ms/batch 109.8147 | train_loss 7.053044e-01 | lr 4.500000e-05
04/26/2024 04:09:43 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 2200 ****
04/26/2024 04:09:44 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:09:51 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2250/  4000] |  480/1769 batches | ms/batch 109.3624 | train_loss 7.028241e-01 | lr 4.375000e-05
04/26/2024 04:09:57 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2300/  4000] |  530/1769 batches | ms/batch 109.5865 | train_loss 6.979321e-01 | lr 4.250000e-05
04/26/2024 04:09:57 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 2300 ****
04/26/2024 04:09:58 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:10:05 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2350/  4000] |  580/1769 batches | ms/batch 109.6544 | train_loss 7.089822e-01 | lr 4.125000e-05
04/26/2024 04:10:11 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2400/  4000] |  630/1769 batches | ms/batch 109.8183 | train_loss 7.062915e-01 | lr 4.000000e-05
04/26/2024 04:10:11 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 2400 ****
04/26/2024 04:10:12 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:10:19 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2450/  4000] |  680/1769 batches | ms/batch 109.7134 | train_loss 7.084516e-01 | lr 3.875000e-05
04/26/2024 04:10:25 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2500/  4000] |  730/1769 batches | ms/batch 109.6856 | train_loss 7.043002e-01 | lr 3.750000e-05
04/26/2024 04:10:25 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 2500 ****
04/26/2024 04:10:26 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:10:33 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2550/  4000] |  780/1769 batches | ms/batch 109.7896 | train_loss 7.179420e-01 | lr 3.625000e-05
04/26/2024 04:10:39 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2600/  4000] |  830/1769 batches | ms/batch 109.6305 | train_loss 6.949469e-01 | lr 3.500000e-05
04/26/2024 04:10:39 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 2600 ****
04/26/2024 04:10:40 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:10:47 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2650/  4000] |  880/1769 batches | ms/batch 109.6014 | train_loss 7.071559e-01 | lr 3.375000e-05
04/26/2024 04:10:53 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2700/  4000] |  930/1769 batches | ms/batch 109.7118 | train_loss 6.967868e-01 | lr 3.250000e-05
04/26/2024 04:10:53 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 2700 ****
04/26/2024 04:10:54 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:11:01 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2750/  4000] |  980/1769 batches | ms/batch 109.7188 | train_loss 6.974841e-01 | lr 3.125000e-05
04/26/2024 04:11:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2800/  4000] | 1030/1769 batches | ms/batch 109.8281 | train_loss 7.013758e-01 | lr 3.000000e-05
04/26/2024 04:11:07 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 2800 ****
04/26/2024 04:11:08 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:11:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2850/  4000] | 1080/1769 batches | ms/batch 109.8302 | train_loss 6.917107e-01 | lr 2.875000e-05
04/26/2024 04:11:21 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2900/  4000] | 1130/1769 batches | ms/batch 109.6910 | train_loss 7.077086e-01 | lr 2.750000e-05
04/26/2024 04:11:21 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 2900 ****
04/26/2024 04:11:22 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:11:29 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2950/  4000] | 1180/1769 batches | ms/batch 109.7991 | train_loss 6.903803e-01 | lr 2.625000e-05
04/26/2024 04:11:36 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3000/  4000] | 1230/1769 batches | ms/batch 109.8356 | train_loss 7.003222e-01 | lr 2.500000e-05
04/26/2024 04:11:36 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 3000 ****
04/26/2024 04:11:36 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:11:43 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3050/  4000] | 1280/1769 batches | ms/batch 109.7404 | train_loss 7.026097e-01 | lr 2.375000e-05
04/26/2024 04:11:50 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3100/  4000] | 1330/1769 batches | ms/batch 109.7877 | train_loss 7.078016e-01 | lr 2.250000e-05
04/26/2024 04:11:50 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 3100 ****
04/26/2024 04:11:50 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:11:57 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3150/  4000] | 1380/1769 batches | ms/batch 109.8873 | train_loss 7.031884e-01 | lr 2.125000e-05
04/26/2024 04:12:04 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3200/  4000] | 1430/1769 batches | ms/batch 109.8627 | train_loss 7.078010e-01 | lr 2.000000e-05
04/26/2024 04:12:04 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 3200 ****
04/26/2024 04:12:04 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:12:11 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3250/  4000] | 1480/1769 batches | ms/batch 109.6028 | train_loss 7.046394e-01 | lr 1.875000e-05
04/26/2024 04:12:18 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3300/  4000] | 1530/1769 batches | ms/batch 109.7541 | train_loss 7.072732e-01 | lr 1.750000e-05
04/26/2024 04:12:18 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 3300 ****
04/26/2024 04:12:18 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:12:25 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3350/  4000] | 1580/1769 batches | ms/batch 109.8398 | train_loss 6.964365e-01 | lr 1.625000e-05
04/26/2024 04:12:32 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3400/  4000] | 1630/1769 batches | ms/batch 109.8463 | train_loss 6.988881e-01 | lr 1.500000e-05
04/26/2024 04:12:32 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 3400 ****
04/26/2024 04:12:32 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:12:39 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3450/  4000] | 1680/1769 batches | ms/batch 109.8466 | train_loss 6.917209e-01 | lr 1.375000e-05
04/26/2024 04:12:46 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3500/  4000] | 1730/1769 batches | ms/batch 109.8910 | train_loss 7.047573e-01 | lr 1.250000e-05
04/26/2024 04:12:46 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 3500 ****
04/26/2024 04:12:46 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:12:55 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3550/  4000] |   11/1769 batches | ms/batch 108.2922 | train_loss 6.968547e-01 | lr 1.125000e-05
04/26/2024 04:13:02 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3600/  4000] |   61/1769 batches | ms/batch 109.6331 | train_loss 7.049321e-01 | lr 1.000000e-05
04/26/2024 04:13:02 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 3600 ****
04/26/2024 04:13:02 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:13:09 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3650/  4000] |  111/1769 batches | ms/batch 109.5459 | train_loss 6.935299e-01 | lr 8.750000e-06
04/26/2024 04:13:16 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3700/  4000] |  161/1769 batches | ms/batch 109.7886 | train_loss 7.030391e-01 | lr 7.500000e-06
04/26/2024 04:13:16 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 3700 ****
04/26/2024 04:13:16 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:13:23 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3750/  4000] |  211/1769 batches | ms/batch 109.8010 | train_loss 6.936129e-01 | lr 6.250000e-06
04/26/2024 04:13:30 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3800/  4000] |  261/1769 batches | ms/batch 109.7755 | train_loss 7.016335e-01 | lr 5.000000e-06
04/26/2024 04:13:30 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 3800 ****
04/26/2024 04:13:30 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:13:37 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3850/  4000] |  311/1769 batches | ms/batch 109.8434 | train_loss 6.990028e-01 | lr 3.750000e-06
04/26/2024 04:13:44 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3900/  4000] |  361/1769 batches | ms/batch 109.9036 | train_loss 7.052687e-01 | lr 2.500000e-06
04/26/2024 04:13:44 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 3900 ****
04/26/2024 04:13:45 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:13:51 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3950/  4000] |  411/1769 batches | ms/batch 109.7637 | train_loss 7.006985e-01 | lr 1.250000e-06
04/26/2024 04:13:58 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  4000/  4000] |  461/1769 batches | ms/batch 109.8482 | train_loss 7.077459e-01 | lr 0.000000e+00
04/26/2024 04:13:58 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx at global_step 4000 ****
04/26/2024 04:13:59 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:13:59 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23489228/tmpneiu59lx
04/26/2024 04:13:59 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((14146, 512)) with avr_nnz=320.0
04/26/2024 04:13:59 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/26/2024 04:15:14 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn at level 3, nr_labels=30938, avr_M_nnz=12.53068005089778
04/26/2024 04:15:16 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-cased model from s3.
04/26/2024 04:15:28 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23489228/tmpgnkit8dh/X_trn.pt
04/26/2024 04:15:28 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
04/26/2024 04:18:37 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
04/26/2024 04:18:37 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 1
04/26/2024 04:18:37 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
04/26/2024 04:18:37 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/26/2024 04:18:38 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
04/26/2024 04:18:38 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 14146
04/26/2024 04:18:38 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 30938
04/26/2024 04:18:38 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 1631
04/26/2024 04:18:38 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 3
04/26/2024 04:18:38 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
04/26/2024 04:18:38 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 8
04/26/2024 04:18:38 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
04/26/2024 04:18:38 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
04/26/2024 04:18:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][    50/  4000] |   49/1769 batches | ms/batch 109.2345 | train_loss 5.960173e-01 | lr 9.875000e-05
04/26/2024 04:18:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   100/  4000] |   99/1769 batches | ms/batch 108.8547 | train_loss 5.813400e-01 | lr 9.750000e-05
04/26/2024 04:18:53 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 100 ****
04/26/2024 04:18:54 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:19:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   150/  4000] |  149/1769 batches | ms/batch 108.9402 | train_loss 5.684962e-01 | lr 9.625000e-05
04/26/2024 04:19:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   200/  4000] |  199/1769 batches | ms/batch 109.3727 | train_loss 5.638793e-01 | lr 9.500000e-05
04/26/2024 04:19:07 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 200 ****
04/26/2024 04:19:08 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:19:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   250/  4000] |  249/1769 batches | ms/batch 109.2898 | train_loss 5.759795e-01 | lr 9.375000e-05
04/26/2024 04:19:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   300/  4000] |  299/1769 batches | ms/batch 109.1105 | train_loss 5.736758e-01 | lr 9.250000e-05
04/26/2024 04:19:22 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 300 ****
04/26/2024 04:19:22 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:19:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   350/  4000] |  349/1769 batches | ms/batch 109.3358 | train_loss 5.739052e-01 | lr 9.125000e-05
04/26/2024 04:19:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   400/  4000] |  399/1769 batches | ms/batch 109.5534 | train_loss 5.615318e-01 | lr 9.000000e-05
04/26/2024 04:19:36 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 400 ****
04/26/2024 04:19:37 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:19:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   450/  4000] |  449/1769 batches | ms/batch 109.6705 | train_loss 5.791908e-01 | lr 8.875000e-05
04/26/2024 04:19:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   500/  4000] |  499/1769 batches | ms/batch 109.4487 | train_loss 5.912473e-01 | lr 8.750000e-05
04/26/2024 04:19:50 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 500 ****
04/26/2024 04:19:51 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:19:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   550/  4000] |  549/1769 batches | ms/batch 109.6026 | train_loss 5.764662e-01 | lr 8.625000e-05
04/26/2024 04:20:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   600/  4000] |  599/1769 batches | ms/batch 109.7887 | train_loss 5.753617e-01 | lr 8.500000e-05
04/26/2024 04:20:05 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 600 ****
04/26/2024 04:20:05 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:20:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   650/  4000] |  649/1769 batches | ms/batch 109.8082 | train_loss 5.582244e-01 | lr 8.375000e-05
04/26/2024 04:20:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   700/  4000] |  699/1769 batches | ms/batch 109.6021 | train_loss 5.781556e-01 | lr 8.250000e-05
04/26/2024 04:20:19 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 700 ****
04/26/2024 04:20:20 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:20:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   750/  4000] |  749/1769 batches | ms/batch 109.6765 | train_loss 5.773289e-01 | lr 8.125000e-05
04/26/2024 04:20:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   800/  4000] |  799/1769 batches | ms/batch 109.9430 | train_loss 5.776330e-01 | lr 8.000000e-05
04/26/2024 04:20:33 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 800 ****
04/26/2024 04:20:34 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:20:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   850/  4000] |  849/1769 batches | ms/batch 109.6489 | train_loss 5.688894e-01 | lr 7.875000e-05
04/26/2024 04:20:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   900/  4000] |  899/1769 batches | ms/batch 109.7411 | train_loss 5.702952e-01 | lr 7.750000e-05
04/26/2024 04:20:47 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 900 ****
04/26/2024 04:20:48 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:20:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][   950/  4000] |  949/1769 batches | ms/batch 109.7166 | train_loss 5.668399e-01 | lr 7.625000e-05
04/26/2024 04:21:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1000/  4000] |  999/1769 batches | ms/batch 109.8666 | train_loss 5.713154e-01 | lr 7.500000e-05
04/26/2024 04:21:02 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 1000 ****
04/26/2024 04:21:02 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:21:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1050/  4000] | 1049/1769 batches | ms/batch 109.7990 | train_loss 5.676723e-01 | lr 7.375000e-05
04/26/2024 04:21:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1100/  4000] | 1099/1769 batches | ms/batch 109.9831 | train_loss 5.911500e-01 | lr 7.250000e-05
04/26/2024 04:21:16 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 1100 ****
04/26/2024 04:21:17 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:21:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1150/  4000] | 1149/1769 batches | ms/batch 110.0162 | train_loss 5.734821e-01 | lr 7.125000e-05
04/26/2024 04:21:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1200/  4000] | 1199/1769 batches | ms/batch 109.9229 | train_loss 5.857128e-01 | lr 7.000000e-05
04/26/2024 04:21:30 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 1200 ****
04/26/2024 04:21:31 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:21:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1250/  4000] | 1249/1769 batches | ms/batch 109.9402 | train_loss 5.794080e-01 | lr 6.875000e-05
04/26/2024 04:21:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1300/  4000] | 1299/1769 batches | ms/batch 110.0646 | train_loss 5.623322e-01 | lr 6.750000e-05
04/26/2024 04:21:45 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 1300 ****
04/26/2024 04:21:45 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:21:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1350/  4000] | 1349/1769 batches | ms/batch 109.8651 | train_loss 5.709505e-01 | lr 6.625000e-05
04/26/2024 04:21:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1400/  4000] | 1399/1769 batches | ms/batch 109.9291 | train_loss 5.876704e-01 | lr 6.500000e-05
04/26/2024 04:21:59 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 1400 ****
04/26/2024 04:22:00 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:22:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1450/  4000] | 1449/1769 batches | ms/batch 109.7223 | train_loss 5.774641e-01 | lr 6.375000e-05
04/26/2024 04:22:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1500/  4000] | 1499/1769 batches | ms/batch 109.8473 | train_loss 5.730826e-01 | lr 6.250000e-05
04/26/2024 04:22:13 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 1500 ****
04/26/2024 04:22:14 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:22:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1550/  4000] | 1549/1769 batches | ms/batch 110.0210 | train_loss 5.653962e-01 | lr 6.125000e-05
04/26/2024 04:22:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1600/  4000] | 1599/1769 batches | ms/batch 110.0114 | train_loss 5.751553e-01 | lr 6.000000e-05
04/26/2024 04:22:28 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 1600 ****
04/26/2024 04:22:28 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:22:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1650/  4000] | 1649/1769 batches | ms/batch 109.9535 | train_loss 5.712275e-01 | lr 5.875000e-05
04/26/2024 04:22:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1700/  4000] | 1699/1769 batches | ms/batch 109.8667 | train_loss 5.654733e-01 | lr 5.750000e-05
04/26/2024 04:22:42 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 1700 ****
04/26/2024 04:22:43 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:22:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   3][  1750/  4000] | 1749/1769 batches | ms/batch 109.9747 | train_loss 5.648027e-01 | lr 5.625000e-05
04/26/2024 04:22:58 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1800/  4000] |   30/1769 batches | ms/batch 108.4720 | train_loss 5.664326e-01 | lr 5.500000e-05
04/26/2024 04:22:58 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 1800 ****
04/26/2024 04:22:59 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:23:06 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1850/  4000] |   80/1769 batches | ms/batch 109.7966 | train_loss 5.649393e-01 | lr 5.375000e-05
04/26/2024 04:23:12 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1900/  4000] |  130/1769 batches | ms/batch 109.9387 | train_loss 5.790019e-01 | lr 5.250000e-05
04/26/2024 04:23:12 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 1900 ****
04/26/2024 04:23:13 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:23:20 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  1950/  4000] |  180/1769 batches | ms/batch 109.9942 | train_loss 5.581513e-01 | lr 5.125000e-05
04/26/2024 04:23:27 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2000/  4000] |  230/1769 batches | ms/batch 110.0166 | train_loss 5.717561e-01 | lr 5.000000e-05
04/26/2024 04:23:27 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 2000 ****
04/26/2024 04:23:27 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:23:34 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2050/  4000] |  280/1769 batches | ms/batch 109.9301 | train_loss 5.822099e-01 | lr 4.875000e-05
04/26/2024 04:23:41 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2100/  4000] |  330/1769 batches | ms/batch 110.1172 | train_loss 5.697744e-01 | lr 4.750000e-05
04/26/2024 04:23:41 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 2100 ****
04/26/2024 04:23:42 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:23:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2150/  4000] |  380/1769 batches | ms/batch 110.0601 | train_loss 5.810198e-01 | lr 4.625000e-05
04/26/2024 04:23:55 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2200/  4000] |  430/1769 batches | ms/batch 110.0351 | train_loss 5.510528e-01 | lr 4.500000e-05
04/26/2024 04:23:55 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 2200 ****
04/26/2024 04:23:56 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:24:03 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2250/  4000] |  480/1769 batches | ms/batch 110.0670 | train_loss 5.827095e-01 | lr 4.375000e-05
04/26/2024 04:24:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2300/  4000] |  530/1769 batches | ms/batch 110.1550 | train_loss 5.836237e-01 | lr 4.250000e-05
04/26/2024 04:24:10 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 2300 ****
04/26/2024 04:24:11 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:24:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2350/  4000] |  580/1769 batches | ms/batch 110.1160 | train_loss 5.748843e-01 | lr 4.125000e-05
04/26/2024 04:24:24 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2400/  4000] |  630/1769 batches | ms/batch 110.0395 | train_loss 5.871607e-01 | lr 4.000000e-05
04/26/2024 04:24:24 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 2400 ****
04/26/2024 04:24:25 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:24:32 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2450/  4000] |  680/1769 batches | ms/batch 110.0028 | train_loss 5.628355e-01 | lr 3.875000e-05
04/26/2024 04:24:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2500/  4000] |  730/1769 batches | ms/batch 110.1786 | train_loss 5.614446e-01 | lr 3.750000e-05
04/26/2024 04:24:38 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 2500 ****
04/26/2024 04:24:39 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:24:46 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2550/  4000] |  780/1769 batches | ms/batch 109.9463 | train_loss 5.665174e-01 | lr 3.625000e-05
04/26/2024 04:24:53 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2600/  4000] |  830/1769 batches | ms/batch 109.9831 | train_loss 5.535990e-01 | lr 3.500000e-05
04/26/2024 04:24:53 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 2600 ****
04/26/2024 04:24:54 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:25:00 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2650/  4000] |  880/1769 batches | ms/batch 110.1016 | train_loss 5.802221e-01 | lr 3.375000e-05
04/26/2024 04:25:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2700/  4000] |  930/1769 batches | ms/batch 110.2137 | train_loss 5.658956e-01 | lr 3.250000e-05
04/26/2024 04:25:07 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 2700 ****
04/26/2024 04:25:08 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:25:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2750/  4000] |  980/1769 batches | ms/batch 110.0626 | train_loss 5.720235e-01 | lr 3.125000e-05
04/26/2024 04:25:21 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2800/  4000] | 1030/1769 batches | ms/batch 110.0600 | train_loss 5.786037e-01 | lr 3.000000e-05
04/26/2024 04:25:21 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 2800 ****
04/26/2024 04:25:22 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:25:29 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2850/  4000] | 1080/1769 batches | ms/batch 110.0914 | train_loss 5.643023e-01 | lr 2.875000e-05
04/26/2024 04:25:36 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2900/  4000] | 1130/1769 batches | ms/batch 110.1797 | train_loss 5.714868e-01 | lr 2.750000e-05
04/26/2024 04:25:36 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 2900 ****
04/26/2024 04:25:36 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:25:43 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  2950/  4000] | 1180/1769 batches | ms/batch 110.2471 | train_loss 5.888615e-01 | lr 2.625000e-05
04/26/2024 04:25:50 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3000/  4000] | 1230/1769 batches | ms/batch 110.0839 | train_loss 5.751023e-01 | lr 2.500000e-05
04/26/2024 04:25:50 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 3000 ****
04/26/2024 04:25:51 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:25:58 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3050/  4000] | 1280/1769 batches | ms/batch 110.1651 | train_loss 5.650277e-01 | lr 2.375000e-05
04/26/2024 04:26:05 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3100/  4000] | 1330/1769 batches | ms/batch 110.2519 | train_loss 5.771725e-01 | lr 2.250000e-05
04/26/2024 04:26:05 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 3100 ****
04/26/2024 04:26:05 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:26:12 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3150/  4000] | 1380/1769 batches | ms/batch 110.0353 | train_loss 5.736816e-01 | lr 2.125000e-05
04/26/2024 04:26:19 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3200/  4000] | 1430/1769 batches | ms/batch 110.1471 | train_loss 5.769310e-01 | lr 2.000000e-05
04/26/2024 04:26:19 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 3200 ****
04/26/2024 04:26:20 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:26:26 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3250/  4000] | 1480/1769 batches | ms/batch 110.0350 | train_loss 5.691652e-01 | lr 1.875000e-05
04/26/2024 04:26:33 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3300/  4000] | 1530/1769 batches | ms/batch 110.0980 | train_loss 5.605348e-01 | lr 1.750000e-05
04/26/2024 04:26:33 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 3300 ****
04/26/2024 04:26:34 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:26:41 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3350/  4000] | 1580/1769 batches | ms/batch 110.4957 | train_loss 5.743923e-01 | lr 1.625000e-05
04/26/2024 04:26:48 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3400/  4000] | 1630/1769 batches | ms/batch 110.6500 | train_loss 5.608376e-01 | lr 1.500000e-05
04/26/2024 04:26:48 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 3400 ****
04/26/2024 04:26:49 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:26:56 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3450/  4000] | 1680/1769 batches | ms/batch 110.3900 | train_loss 5.869301e-01 | lr 1.375000e-05
04/26/2024 04:27:03 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   3][  3500/  4000] | 1730/1769 batches | ms/batch 110.2972 | train_loss 5.644076e-01 | lr 1.250000e-05
04/26/2024 04:27:03 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 3500 ****
04/26/2024 04:27:03 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:27:12 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3550/  4000] |   11/1769 batches | ms/batch 108.6415 | train_loss 5.707440e-01 | lr 1.125000e-05
04/26/2024 04:27:19 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3600/  4000] |   61/1769 batches | ms/batch 110.1005 | train_loss 5.731999e-01 | lr 1.000000e-05
04/26/2024 04:27:19 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 3600 ****
04/26/2024 04:27:20 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:27:27 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3650/  4000] |  111/1769 batches | ms/batch 110.0812 | train_loss 5.558721e-01 | lr 8.750000e-06
04/26/2024 04:27:33 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3700/  4000] |  161/1769 batches | ms/batch 110.1924 | train_loss 5.656892e-01 | lr 7.500000e-06
04/26/2024 04:27:33 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 3700 ****
04/26/2024 04:27:34 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:27:41 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3750/  4000] |  211/1769 batches | ms/batch 110.1200 | train_loss 5.672773e-01 | lr 6.250000e-06
04/26/2024 04:27:48 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3800/  4000] |  261/1769 batches | ms/batch 110.1475 | train_loss 5.640968e-01 | lr 5.000000e-06
04/26/2024 04:27:48 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 3800 ****
04/26/2024 04:27:49 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:27:55 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3850/  4000] |  311/1769 batches | ms/batch 110.2474 | train_loss 5.712375e-01 | lr 3.750000e-06
04/26/2024 04:28:02 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3900/  4000] |  361/1769 batches | ms/batch 110.2927 | train_loss 5.681694e-01 | lr 2.500000e-06
04/26/2024 04:28:02 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 3900 ****
04/26/2024 04:28:03 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:28:10 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  3950/  4000] |  411/1769 batches | ms/batch 110.3373 | train_loss 5.592541e-01 | lr 1.250000e-06
04/26/2024 04:28:16 - INFO - pecos.xmc.xtransformer.matcher - | [   3/   3][  4000/  4000] |  461/1769 batches | ms/batch 110.0845 | train_loss 5.762119e-01 | lr 0.000000e+00
04/26/2024 04:28:16 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0 at global_step 4000 ****
04/26/2024 04:28:17 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
04/26/2024 04:28:18 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23489228/tmpfp49n6h0
04/26/2024 04:28:19 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((14146, 30938)) with avr_nnz=1206.0
04/26/2024 04:28:19 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=14146
04/26/2024 04:29:32 - INFO - pecos.xmc.xtransformer.model - Constructed instance feature matrix with shape=(14146, 102706)
04/26/2024 04:29:39 - INFO - pecos.xmc.xtransformer.model - Hierarchical label tree for ranker: [2, 32, 512, 30938]
04/26/2024 04:29:39 - INFO - pecos.xmc.xtransformer.model - Start training ranker...
04/26/2024 04:29:39 - INFO - pecos.xmc.base - Training Layer 0 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
04/26/2024 04:29:39 - INFO - pecos.xmc.base - Training Layer 1 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
04/26/2024 04:29:45 - INFO - pecos.xmc.base - Training Layer 2 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
04/26/2024 04:30:01 - INFO - pecos.xmc.base - Training Layer 3 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
04/26/2024 04:31:07 - INFO - pecos.xmc.xtransformer.model - Parameters saved to ./trained-models/xr_model_wiki10-31k/param.json
04/26/2024 04:31:08 - INFO - pecos.xmc.xtransformer.model - Model saved to ./trained-models/xr_model_wiki10-31k

============================= JOB FEEDBACK =============================

NodeName=uc2n482
Job ID: 23489228
Cluster: uc2
User/Group: ul_ruw26/ul_student
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 01:43:48
CPU Efficiency: 20.15% of 08:35:10 core-walltime
Job Wall-clock time: 00:51:31
Memory Utilized: 19.11 GB
Memory Efficiency: 65.24% of 29.30 GB
