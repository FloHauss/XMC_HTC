------- Ensemble run at 2024-07-02 08:02:15 for amazon-670k ----------
07/02/2024 08:03:32 - INFO - __main__ - Setting random seed 0
07/02/2024 08:03:35 - INFO - __main__ - Loaded training feature matrix with shape=(490449, 135909)
07/02/2024 08:03:36 - INFO - __main__ - Loaded training label matrix with shape=(490449, 670091)
07/02/2024 08:03:37 - INFO - __main__ - Loaded 490449 training sequences
07/02/2024 08:03:51 - INFO - pecos.xmc.xtransformer.model - Hierarchical label tree: [128, 2048, 32768, 670091]
07/02/2024 08:03:51 - INFO - pecos.xmc.xtransformer.model - Fine-tune Transformers with nr_labels=[128, 2048, 32768]
07/02/2024 08:03:51 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn+man at level 0, nr_labels=128, avr_M_nnz=128
07/02/2024 08:03:58 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-uncased model from s3.
07/02/2024 08:03:58 - INFO - pecos.xmc.xtransformer.matcher - ***** Encoding data len=490449 truncation=128*****
07/02/2024 08:04:34 - INFO - pecos.xmc.xtransformer.matcher - ***** Finished with time cost=36.21149396896362 *****
07/02/2024 08:04:59 - INFO - pecos.xmc.xtransformer.matcher - trn tensors saved to /scratch/slurm_tmpdir/job_23821887/tmp5svzdcq1/X_trn.pt
07/02/2024 08:05:01 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 2
07/02/2024 08:05:26 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
07/02/2024 08:05:26 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
/home/ul/ul_student/ul_ruw26/.local/lib/python3.9/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
07/02/2024 08:05:26 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
07/02/2024 08:05:26 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 490449
07/02/2024 08:05:26 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 128
07/02/2024 08:05:26 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 1
07/02/2024 08:05:26 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
07/02/2024 08:05:26 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 64
07/02/2024 08:05:26 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
07/02/2024 08:05:26 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
07/02/2024 08:05:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][    50/  4000] |   49/7664 batches | ms/batch 408.5912 | train_loss 9.122429e-01 | lr 2.500000e-05
07/02/2024 08:06:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   100/  4000] |   99/7664 batches | ms/batch 191.6908 | train_loss 2.161370e-01 | lr 5.000000e-05
07/02/2024 08:06:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   150/  4000] |  149/7664 batches | ms/batch 191.7722 | train_loss 1.726158e-01 | lr 7.500000e-05
07/02/2024 08:06:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   200/  4000] |  199/7664 batches | ms/batch 192.2474 | train_loss 1.567484e-01 | lr 1.000000e-04
07/02/2024 08:06:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   250/  4000] |  249/7664 batches | ms/batch 192.2592 | train_loss 1.303860e-01 | lr 9.868421e-05
07/02/2024 08:06:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   300/  4000] |  299/7664 batches | ms/batch 192.5232 | train_loss 1.129764e-01 | lr 9.736842e-05
07/02/2024 08:06:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   350/  4000] |  349/7664 batches | ms/batch 192.7578 | train_loss 1.029267e-01 | lr 9.605263e-05
07/02/2024 08:07:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   400/  4000] |  399/7664 batches | ms/batch 192.8971 | train_loss 9.652118e-02 | lr 9.473684e-05
07/02/2024 08:07:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   450/  4000] |  449/7664 batches | ms/batch 193.0998 | train_loss 9.211296e-02 | lr 9.342105e-05
07/02/2024 08:07:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   500/  4000] |  499/7664 batches | ms/batch 193.2024 | train_loss 9.003738e-02 | lr 9.210526e-05
07/02/2024 08:07:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   550/  4000] |  549/7664 batches | ms/batch 193.5524 | train_loss 8.778069e-02 | lr 9.078947e-05
07/02/2024 08:07:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   600/  4000] |  599/7664 batches | ms/batch 193.4664 | train_loss 8.542408e-02 | lr 8.947368e-05
07/02/2024 08:08:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   650/  4000] |  649/7664 batches | ms/batch 193.7791 | train_loss 8.277694e-02 | lr 8.815789e-05
07/02/2024 08:08:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   700/  4000] |  699/7664 batches | ms/batch 193.7171 | train_loss 7.946539e-02 | lr 8.684211e-05
07/02/2024 08:08:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   750/  4000] |  749/7664 batches | ms/batch 193.6330 | train_loss 7.671358e-02 | lr 8.552632e-05
07/02/2024 08:08:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   800/  4000] |  799/7664 batches | ms/batch 193.8091 | train_loss 7.852250e-02 | lr 8.421053e-05
07/02/2024 08:08:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   850/  4000] |  849/7664 batches | ms/batch 193.7183 | train_loss 7.698307e-02 | lr 8.289474e-05
07/02/2024 08:08:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   900/  4000] |  899/7664 batches | ms/batch 194.0255 | train_loss 7.838911e-02 | lr 8.157895e-05
07/02/2024 08:09:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   950/  4000] |  949/7664 batches | ms/batch 196.7725 | train_loss 7.702652e-02 | lr 8.026316e-05
07/02/2024 08:09:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1000/  4000] |  999/7664 batches | ms/batch 194.4384 | train_loss 7.414844e-02 | lr 7.894737e-05
07/02/2024 08:09:16 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpd5jjyp_z at global_step 1000 ****
07/02/2024 08:09:16 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 08:09:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1050/  4000] | 1049/7664 batches | ms/batch 195.1699 | train_loss 7.590217e-02 | lr 7.763158e-05
07/02/2024 08:09:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1100/  4000] | 1099/7664 batches | ms/batch 195.4738 | train_loss 7.487237e-02 | lr 7.631579e-05
07/02/2024 08:09:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1150/  4000] | 1149/7664 batches | ms/batch 195.7744 | train_loss 7.454230e-02 | lr 7.500000e-05
07/02/2024 08:09:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1200/  4000] | 1199/7664 batches | ms/batch 195.0958 | train_loss 7.369639e-02 | lr 7.368421e-05
07/02/2024 08:10:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1250/  4000] | 1249/7664 batches | ms/batch 194.5350 | train_loss 7.358668e-02 | lr 7.236842e-05
07/02/2024 08:10:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1300/  4000] | 1299/7664 batches | ms/batch 194.5014 | train_loss 7.281755e-02 | lr 7.105263e-05
07/02/2024 08:10:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1350/  4000] | 1349/7664 batches | ms/batch 195.6285 | train_loss 7.221272e-02 | lr 6.973684e-05
07/02/2024 08:10:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1400/  4000] | 1399/7664 batches | ms/batch 195.4769 | train_loss 7.318719e-02 | lr 6.842105e-05
07/02/2024 08:10:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1450/  4000] | 1449/7664 batches | ms/batch 195.2318 | train_loss 7.044141e-02 | lr 6.710526e-05
07/02/2024 08:11:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1500/  4000] | 1499/7664 batches | ms/batch 195.3239 | train_loss 7.064714e-02 | lr 6.578947e-05
07/02/2024 08:11:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1550/  4000] | 1549/7664 batches | ms/batch 195.2904 | train_loss 7.250088e-02 | lr 6.447368e-05
07/02/2024 08:11:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1600/  4000] | 1599/7664 batches | ms/batch 195.4973 | train_loss 7.086743e-02 | lr 6.315789e-05
07/02/2024 08:11:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1650/  4000] | 1649/7664 batches | ms/batch 194.6732 | train_loss 7.066902e-02 | lr 6.184211e-05
07/02/2024 08:11:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1700/  4000] | 1699/7664 batches | ms/batch 194.7088 | train_loss 6.826295e-02 | lr 6.052632e-05
07/02/2024 08:11:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1750/  4000] | 1749/7664 batches | ms/batch 195.8740 | train_loss 7.017873e-02 | lr 5.921053e-05
07/02/2024 08:12:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1800/  4000] | 1799/7664 batches | ms/batch 195.7690 | train_loss 6.705536e-02 | lr 5.789474e-05
07/02/2024 08:12:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1850/  4000] | 1849/7664 batches | ms/batch 195.9879 | train_loss 6.875083e-02 | lr 5.657895e-05
07/02/2024 08:12:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1900/  4000] | 1899/7664 batches | ms/batch 196.0601 | train_loss 6.912274e-02 | lr 5.526316e-05
07/02/2024 08:12:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1950/  4000] | 1949/7664 batches | ms/batch 196.0640 | train_loss 6.872944e-02 | lr 5.394737e-05
07/02/2024 08:12:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2000/  4000] | 1999/7664 batches | ms/batch 195.8946 | train_loss 6.992805e-02 | lr 5.263158e-05
07/02/2024 08:12:51 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpd5jjyp_z at global_step 2000 ****
07/02/2024 08:12:51 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 08:13:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2050/  4000] | 2049/7664 batches | ms/batch 194.2899 | train_loss 6.681038e-02 | lr 5.131579e-05
07/02/2024 08:13:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2100/  4000] | 2099/7664 batches | ms/batch 197.3124 | train_loss 6.798421e-02 | lr 5.000000e-05
07/02/2024 08:13:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2150/  4000] | 2149/7664 batches | ms/batch 194.6990 | train_loss 6.617372e-02 | lr 4.868421e-05
07/02/2024 08:13:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2200/  4000] | 2199/7664 batches | ms/batch 195.6862 | train_loss 6.761038e-02 | lr 4.736842e-05
07/02/2024 08:13:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2250/  4000] | 2249/7664 batches | ms/batch 195.9901 | train_loss 6.657494e-02 | lr 4.605263e-05
07/02/2024 08:13:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2300/  4000] | 2299/7664 batches | ms/batch 195.6004 | train_loss 6.597545e-02 | lr 4.473684e-05
07/02/2024 08:14:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2350/  4000] | 2349/7664 batches | ms/batch 195.6569 | train_loss 6.691118e-02 | lr 4.342105e-05
07/02/2024 08:14:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2400/  4000] | 2399/7664 batches | ms/batch 195.6153 | train_loss 6.630503e-02 | lr 4.210526e-05
07/02/2024 08:14:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2450/  4000] | 2449/7664 batches | ms/batch 195.6063 | train_loss 6.713723e-02 | lr 4.078947e-05
07/02/2024 08:14:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2500/  4000] | 2499/7664 batches | ms/batch 195.2510 | train_loss 6.553579e-02 | lr 3.947368e-05
07/02/2024 08:14:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2550/  4000] | 2549/7664 batches | ms/batch 195.5917 | train_loss 6.656085e-02 | lr 3.815789e-05
07/02/2024 08:15:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2600/  4000] | 2599/7664 batches | ms/batch 195.4857 | train_loss 6.625040e-02 | lr 3.684211e-05
07/02/2024 08:15:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2650/  4000] | 2649/7664 batches | ms/batch 195.5038 | train_loss 6.647265e-02 | lr 3.552632e-05
07/02/2024 08:15:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2700/  4000] | 2699/7664 batches | ms/batch 195.4970 | train_loss 6.614817e-02 | lr 3.421053e-05
07/02/2024 08:15:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2750/  4000] | 2749/7664 batches | ms/batch 195.5809 | train_loss 6.535349e-02 | lr 3.289474e-05
07/02/2024 08:15:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2800/  4000] | 2799/7664 batches | ms/batch 195.7075 | train_loss 6.570956e-02 | lr 3.157895e-05
07/02/2024 08:15:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2850/  4000] | 2849/7664 batches | ms/batch 195.6334 | train_loss 6.453481e-02 | lr 3.026316e-05
07/02/2024 08:16:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2900/  4000] | 2899/7664 batches | ms/batch 195.4209 | train_loss 6.361119e-02 | lr 2.894737e-05
07/02/2024 08:16:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2950/  4000] | 2949/7664 batches | ms/batch 195.4880 | train_loss 6.498919e-02 | lr 2.763158e-05
07/02/2024 08:16:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3000/  4000] | 2999/7664 batches | ms/batch 195.6424 | train_loss 6.491654e-02 | lr 2.631579e-05
07/02/2024 08:16:26 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpd5jjyp_z at global_step 3000 ****
07/02/2024 08:16:27 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 08:16:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3050/  4000] | 3049/7664 batches | ms/batch 195.4534 | train_loss 6.527716e-02 | lr 2.500000e-05
07/02/2024 08:16:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3100/  4000] | 3099/7664 batches | ms/batch 194.7065 | train_loss 6.412521e-02 | lr 2.368421e-05
07/02/2024 08:16:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3150/  4000] | 3149/7664 batches | ms/batch 196.7829 | train_loss 6.265318e-02 | lr 2.236842e-05
07/02/2024 08:17:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3200/  4000] | 3199/7664 batches | ms/batch 194.7767 | train_loss 6.248573e-02 | lr 2.105263e-05
07/02/2024 08:17:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3250/  4000] | 3249/7664 batches | ms/batch 195.7214 | train_loss 6.497772e-02 | lr 1.973684e-05
07/02/2024 08:17:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3300/  4000] | 3299/7664 batches | ms/batch 194.8937 | train_loss 6.457669e-02 | lr 1.842105e-05
07/02/2024 08:17:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3350/  4000] | 3349/7664 batches | ms/batch 194.9036 | train_loss 6.441897e-02 | lr 1.710526e-05
07/02/2024 08:17:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3400/  4000] | 3399/7664 batches | ms/batch 195.7157 | train_loss 6.394403e-02 | lr 1.578947e-05
07/02/2024 08:18:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3450/  4000] | 3449/7664 batches | ms/batch 195.6238 | train_loss 6.250163e-02 | lr 1.447368e-05
07/02/2024 08:18:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3500/  4000] | 3499/7664 batches | ms/batch 195.5698 | train_loss 6.418297e-02 | lr 1.315789e-05
07/02/2024 08:18:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3550/  4000] | 3549/7664 batches | ms/batch 195.4780 | train_loss 6.247222e-02 | lr 1.184211e-05
07/02/2024 08:18:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3600/  4000] | 3599/7664 batches | ms/batch 195.8833 | train_loss 6.028274e-02 | lr 1.052632e-05
07/02/2024 08:18:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3650/  4000] | 3649/7664 batches | ms/batch 195.5009 | train_loss 6.274095e-02 | lr 9.210526e-06
07/02/2024 08:18:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3700/  4000] | 3699/7664 batches | ms/batch 195.7625 | train_loss 6.170031e-02 | lr 7.894737e-06
07/02/2024 08:19:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3750/  4000] | 3749/7664 batches | ms/batch 195.5867 | train_loss 6.293233e-02 | lr 6.578947e-06
07/02/2024 08:19:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3800/  4000] | 3799/7664 batches | ms/batch 195.1104 | train_loss 6.337991e-02 | lr 5.263158e-06
07/02/2024 08:19:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3850/  4000] | 3849/7664 batches | ms/batch 194.9639 | train_loss 6.132999e-02 | lr 3.947368e-06
07/02/2024 08:19:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3900/  4000] | 3899/7664 batches | ms/batch 194.9028 | train_loss 6.392441e-02 | lr 2.631579e-06
07/02/2024 08:19:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3950/  4000] | 3949/7664 batches | ms/batch 195.6740 | train_loss 6.234834e-02 | lr 1.315789e-06
07/02/2024 08:20:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  4000/  4000] | 3999/7664 batches | ms/batch 195.5468 | train_loss 6.139344e-02 | lr 0.000000e+00
07/02/2024 08:20:01 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpd5jjyp_z at global_step 4000 ****
07/02/2024 08:20:02 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 08:20:02 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23821887/tmpd5jjyp_z
07/02/2024 08:20:03 - INFO - pecos.xmc.xtransformer.matcher - Predict on input text tensors(torch.Size([490449, 128])) in OVA mode
07/02/2024 08:20:03 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
07/02/2024 08:29:52 - INFO - pecos.xmc.xtransformer.matcher - Concatenating instance embeddings with features...
07/02/2024 08:30:02 - INFO - pecos.xmc.xtransformer.matcher - Start training concat_model of transformer matcher...
07/02/2024 08:32:02 - INFO - pecos.xmc.xtransformer.matcher - Using concat-only for transformer/concat ensemble of pred_csr
07/02/2024 08:32:17 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn+man at level 1, nr_labels=2048, avr_M_nnz=5.100923847331731
07/02/2024 08:32:19 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-uncased model from s3.
07/02/2024 08:32:50 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23821887/tmp5svzdcq1/X_trn.pt
07/02/2024 08:32:50 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
07/02/2024 08:36:33 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
07/02/2024 08:36:33 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 2
07/02/2024 08:36:34 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
07/02/2024 08:36:34 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
/home/ul/ul_student/ul_ruw26/.local/lib/python3.9/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
07/02/2024 08:36:52 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
07/02/2024 08:36:52 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 490449
07/02/2024 08:36:52 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 2048
07/02/2024 08:36:52 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 176
07/02/2024 08:36:52 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 1
07/02/2024 08:36:52 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
07/02/2024 08:36:52 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 64
07/02/2024 08:36:52 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
07/02/2024 08:36:52 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
07/02/2024 08:37:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][    50/  4000] |   49/7664 batches | ms/batch 210.8163 | train_loss 8.604737e-01 | lr 2.500000e-05
07/02/2024 08:37:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   100/  4000] |   99/7664 batches | ms/batch 196.1704 | train_loss 7.300057e-01 | lr 5.000000e-05
07/02/2024 08:37:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   150/  4000] |  149/7664 batches | ms/batch 197.8158 | train_loss 6.876679e-01 | lr 7.500000e-05
07/02/2024 08:37:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   200/  4000] |  199/7664 batches | ms/batch 194.3997 | train_loss 6.791254e-01 | lr 1.000000e-04
07/02/2024 08:37:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   250/  4000] |  249/7664 batches | ms/batch 194.6001 | train_loss 6.686046e-01 | lr 9.868421e-05
07/02/2024 08:38:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   300/  4000] |  299/7664 batches | ms/batch 196.7263 | train_loss 6.613217e-01 | lr 9.736842e-05
07/02/2024 08:38:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   350/  4000] |  349/7664 batches | ms/batch 196.2052 | train_loss 6.587105e-01 | lr 9.605263e-05
07/02/2024 08:38:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   400/  4000] |  399/7664 batches | ms/batch 196.3936 | train_loss 6.549288e-01 | lr 9.473684e-05
07/02/2024 08:38:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   450/  4000] |  449/7664 batches | ms/batch 195.9700 | train_loss 6.540795e-01 | lr 9.342105e-05
07/02/2024 08:38:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   500/  4000] |  499/7664 batches | ms/batch 199.3487 | train_loss 6.509730e-01 | lr 9.210526e-05
07/02/2024 08:39:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   550/  4000] |  549/7664 batches | ms/batch 195.9318 | train_loss 6.484740e-01 | lr 9.078947e-05
07/02/2024 08:39:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   600/  4000] |  599/7664 batches | ms/batch 197.6901 | train_loss 6.453416e-01 | lr 8.947368e-05
07/02/2024 08:39:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   650/  4000] |  649/7664 batches | ms/batch 199.7388 | train_loss 6.426598e-01 | lr 8.815789e-05
07/02/2024 08:39:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   700/  4000] |  699/7664 batches | ms/batch 197.2754 | train_loss 6.435760e-01 | lr 8.684211e-05
07/02/2024 08:39:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   750/  4000] |  749/7664 batches | ms/batch 198.0155 | train_loss 6.409876e-01 | lr 8.552632e-05
07/02/2024 08:40:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   800/  4000] |  799/7664 batches | ms/batch 196.6109 | train_loss 6.402634e-01 | lr 8.421053e-05
07/02/2024 08:40:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   850/  4000] |  849/7664 batches | ms/batch 200.0205 | train_loss 6.397441e-01 | lr 8.289474e-05
07/02/2024 08:40:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   900/  4000] |  899/7664 batches | ms/batch 201.9268 | train_loss 6.392822e-01 | lr 8.157895e-05
07/02/2024 08:40:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   950/  4000] |  949/7664 batches | ms/batch 202.2862 | train_loss 6.382611e-01 | lr 8.026316e-05
07/02/2024 08:40:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1000/  4000] |  999/7664 batches | ms/batch 198.1639 | train_loss 6.368353e-01 | lr 7.894737e-05
07/02/2024 08:40:47 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmp8bqx4zhb at global_step 1000 ****
07/02/2024 08:40:48 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 08:40:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1050/  4000] | 1049/7664 batches | ms/batch 200.3056 | train_loss 6.337501e-01 | lr 7.763158e-05
07/02/2024 08:41:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1100/  4000] | 1099/7664 batches | ms/batch 199.0057 | train_loss 6.351638e-01 | lr 7.631579e-05
07/02/2024 08:41:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1150/  4000] | 1149/7664 batches | ms/batch 202.1892 | train_loss 6.338882e-01 | lr 7.500000e-05
07/02/2024 08:41:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1200/  4000] | 1199/7664 batches | ms/batch 200.1010 | train_loss 6.325975e-01 | lr 7.368421e-05
07/02/2024 08:41:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1250/  4000] | 1249/7664 batches | ms/batch 196.5431 | train_loss 6.338660e-01 | lr 7.236842e-05
07/02/2024 08:41:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1300/  4000] | 1299/7664 batches | ms/batch 196.4245 | train_loss 6.330323e-01 | lr 7.105263e-05
07/02/2024 08:42:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1350/  4000] | 1349/7664 batches | ms/batch 198.3396 | train_loss 6.342408e-01 | lr 6.973684e-05
07/02/2024 08:42:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1400/  4000] | 1399/7664 batches | ms/batch 197.6556 | train_loss 6.306971e-01 | lr 6.842105e-05
07/02/2024 08:42:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1450/  4000] | 1449/7664 batches | ms/batch 195.7407 | train_loss 6.314978e-01 | lr 6.710526e-05
07/02/2024 08:42:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1500/  4000] | 1499/7664 batches | ms/batch 195.8630 | train_loss 6.313772e-01 | lr 6.578947e-05
07/02/2024 08:42:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1550/  4000] | 1549/7664 batches | ms/batch 199.6119 | train_loss 6.287308e-01 | lr 6.447368e-05
07/02/2024 08:43:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1600/  4000] | 1599/7664 batches | ms/batch 200.5225 | train_loss 6.299593e-01 | lr 6.315789e-05
07/02/2024 08:43:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1650/  4000] | 1649/7664 batches | ms/batch 199.9142 | train_loss 6.289035e-01 | lr 6.184211e-05
07/02/2024 08:43:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1700/  4000] | 1699/7664 batches | ms/batch 196.8063 | train_loss 6.299120e-01 | lr 6.052632e-05
07/02/2024 08:43:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1750/  4000] | 1749/7664 batches | ms/batch 200.3652 | train_loss 6.275075e-01 | lr 5.921053e-05
07/02/2024 08:43:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1800/  4000] | 1799/7664 batches | ms/batch 196.8453 | train_loss 6.287586e-01 | lr 5.789474e-05
07/02/2024 08:43:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1850/  4000] | 1849/7664 batches | ms/batch 200.5320 | train_loss 6.274954e-01 | lr 5.657895e-05
07/02/2024 08:44:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1900/  4000] | 1899/7664 batches | ms/batch 196.7612 | train_loss 6.283986e-01 | lr 5.526316e-05
07/02/2024 08:44:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1950/  4000] | 1949/7664 batches | ms/batch 198.6153 | train_loss 6.287100e-01 | lr 5.394737e-05
07/02/2024 08:44:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2000/  4000] | 1999/7664 batches | ms/batch 196.0402 | train_loss 6.265953e-01 | lr 5.263158e-05
07/02/2024 08:44:32 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmp8bqx4zhb at global_step 2000 ****
07/02/2024 08:44:32 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 08:44:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2050/  4000] | 2049/7664 batches | ms/batch 196.5127 | train_loss 6.265385e-01 | lr 5.131579e-05
07/02/2024 08:44:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2100/  4000] | 2099/7664 batches | ms/batch 195.5215 | train_loss 6.260662e-01 | lr 5.000000e-05
07/02/2024 08:45:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2150/  4000] | 2149/7664 batches | ms/batch 196.0022 | train_loss 6.252295e-01 | lr 4.868421e-05
07/02/2024 08:45:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2200/  4000] | 2199/7664 batches | ms/batch 198.7306 | train_loss 6.253154e-01 | lr 4.736842e-05
07/02/2024 08:45:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2250/  4000] | 2249/7664 batches | ms/batch 205.6279 | train_loss 6.244136e-01 | lr 4.605263e-05
07/02/2024 08:45:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2300/  4000] | 2299/7664 batches | ms/batch 197.6992 | train_loss 6.249687e-01 | lr 4.473684e-05
07/02/2024 08:45:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2350/  4000] | 2349/7664 batches | ms/batch 213.8807 | train_loss 6.245496e-01 | lr 4.342105e-05
07/02/2024 08:46:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2400/  4000] | 2399/7664 batches | ms/batch 204.2386 | train_loss 6.245371e-01 | lr 4.210526e-05
07/02/2024 08:46:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2450/  4000] | 2449/7664 batches | ms/batch 207.9100 | train_loss 6.234055e-01 | lr 4.078947e-05
07/02/2024 08:46:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2500/  4000] | 2499/7664 batches | ms/batch 219.1372 | train_loss 6.242946e-01 | lr 3.947368e-05
07/02/2024 08:46:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2550/  4000] | 2549/7664 batches | ms/batch 217.0056 | train_loss 6.221789e-01 | lr 3.815789e-05
07/02/2024 08:46:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2600/  4000] | 2599/7664 batches | ms/batch 202.4588 | train_loss 6.223040e-01 | lr 3.684211e-05
07/02/2024 08:47:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2650/  4000] | 2649/7664 batches | ms/batch 199.7317 | train_loss 6.232263e-01 | lr 3.552632e-05
07/02/2024 08:47:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2700/  4000] | 2699/7664 batches | ms/batch 196.1143 | train_loss 6.204237e-01 | lr 3.421053e-05
07/02/2024 08:47:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2750/  4000] | 2749/7664 batches | ms/batch 196.6537 | train_loss 6.207744e-01 | lr 3.289474e-05
07/02/2024 08:47:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2800/  4000] | 2799/7664 batches | ms/batch 196.5590 | train_loss 6.223803e-01 | lr 3.157895e-05
07/02/2024 08:47:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2850/  4000] | 2849/7664 batches | ms/batch 196.6735 | train_loss 6.213320e-01 | lr 3.026316e-05
07/02/2024 08:47:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2900/  4000] | 2899/7664 batches | ms/batch 196.4544 | train_loss 6.215032e-01 | lr 2.894737e-05
07/02/2024 08:48:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2950/  4000] | 2949/7664 batches | ms/batch 195.3422 | train_loss 6.208246e-01 | lr 2.763158e-05
07/02/2024 08:48:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3000/  4000] | 2999/7664 batches | ms/batch 196.6309 | train_loss 6.211125e-01 | lr 2.631579e-05
07/02/2024 08:48:20 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmp8bqx4zhb at global_step 3000 ****
07/02/2024 08:48:20 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 08:48:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3050/  4000] | 3049/7664 batches | ms/batch 198.2659 | train_loss 6.196938e-01 | lr 2.500000e-05
07/02/2024 08:48:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3100/  4000] | 3099/7664 batches | ms/batch 195.7272 | train_loss 6.192637e-01 | lr 2.368421e-05
07/02/2024 08:48:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3150/  4000] | 3149/7664 batches | ms/batch 195.7217 | train_loss 6.203113e-01 | lr 2.236842e-05
07/02/2024 08:49:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3200/  4000] | 3199/7664 batches | ms/batch 196.4211 | train_loss 6.203070e-01 | lr 2.105263e-05
07/02/2024 08:49:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3250/  4000] | 3249/7664 batches | ms/batch 196.5294 | train_loss 6.197244e-01 | lr 1.973684e-05
07/02/2024 08:49:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3300/  4000] | 3299/7664 batches | ms/batch 196.0098 | train_loss 6.194789e-01 | lr 1.842105e-05
07/02/2024 08:49:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3350/  4000] | 3349/7664 batches | ms/batch 196.7817 | train_loss 6.199780e-01 | lr 1.710526e-05
07/02/2024 08:49:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3400/  4000] | 3399/7664 batches | ms/batch 195.8741 | train_loss 6.204087e-01 | lr 1.578947e-05
07/02/2024 08:50:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3450/  4000] | 3449/7664 batches | ms/batch 195.9060 | train_loss 6.200967e-01 | lr 1.447368e-05
07/02/2024 08:50:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3500/  4000] | 3499/7664 batches | ms/batch 195.3860 | train_loss 6.183889e-01 | lr 1.315789e-05
07/02/2024 08:50:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3550/  4000] | 3549/7664 batches | ms/batch 195.8098 | train_loss 6.186584e-01 | lr 1.184211e-05
07/02/2024 08:50:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3600/  4000] | 3599/7664 batches | ms/batch 198.2904 | train_loss 6.185037e-01 | lr 1.052632e-05
07/02/2024 08:50:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3650/  4000] | 3649/7664 batches | ms/batch 196.4892 | train_loss 6.196686e-01 | lr 9.210526e-06
07/02/2024 08:50:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3700/  4000] | 3699/7664 batches | ms/batch 195.8263 | train_loss 6.189014e-01 | lr 7.894737e-06
07/02/2024 08:51:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3750/  4000] | 3749/7664 batches | ms/batch 196.7389 | train_loss 6.168555e-01 | lr 6.578947e-06
07/02/2024 08:51:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3800/  4000] | 3799/7664 batches | ms/batch 196.6184 | train_loss 6.176743e-01 | lr 5.263158e-06
07/02/2024 08:51:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3850/  4000] | 3849/7664 batches | ms/batch 196.4585 | train_loss 6.172571e-01 | lr 3.947368e-06
07/02/2024 08:51:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3900/  4000] | 3899/7664 batches | ms/batch 196.5288 | train_loss 6.159611e-01 | lr 2.631579e-06
07/02/2024 08:51:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3950/  4000] | 3949/7664 batches | ms/batch 196.4330 | train_loss 6.170202e-01 | lr 1.315789e-06
07/02/2024 08:52:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  4000/  4000] | 3999/7664 batches | ms/batch 196.6028 | train_loss 6.191984e-01 | lr 0.000000e+00
07/02/2024 08:52:02 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmp8bqx4zhb at global_step 4000 ****
07/02/2024 08:52:03 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 08:52:04 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23821887/tmp8bqx4zhb
07/02/2024 08:52:05 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((490449, 2048)) with avr_nnz=80.0
07/02/2024 08:52:05 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
07/02/2024 09:02:16 - INFO - pecos.xmc.xtransformer.matcher - Concatenating instance embeddings with features...
07/02/2024 09:02:26 - INFO - pecos.xmc.xtransformer.matcher - Start training concat_model of transformer matcher...
07/02/2024 09:03:50 - INFO - pecos.xmc.xtransformer.matcher - Using concat-only for transformer/concat ensemble of pred_csr
07/02/2024 09:04:01 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn+man at level 2, nr_labels=32768, avr_M_nnz=5.208802546238243
07/02/2024 09:04:03 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-uncased model from s3.
07/02/2024 09:04:32 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23821887/tmp5svzdcq1/X_trn.pt
07/02/2024 09:04:32 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
07/02/2024 09:06:12 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
07/02/2024 09:06:12 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 2
07/02/2024 09:06:12 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
07/02/2024 09:06:12 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
/home/ul/ul_student/ul_ruw26/.local/lib/python3.9/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
07/02/2024 09:06:30 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
07/02/2024 09:06:30 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 490449
07/02/2024 09:06:30 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 32768
07/02/2024 09:06:30 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 192
07/02/2024 09:06:30 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 2
07/02/2024 09:06:30 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
07/02/2024 09:06:30 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 64
07/02/2024 09:06:30 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
07/02/2024 09:06:30 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 12000
07/02/2024 09:06:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][    50/ 12000] |   49/7664 batches | ms/batch 196.4665 | train_loss 6.640641e-01 | lr 2.500000e-05
07/02/2024 09:07:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   100/ 12000] |   99/7664 batches | ms/batch 193.9561 | train_loss 6.691291e-01 | lr 5.000000e-05
07/02/2024 09:07:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   150/ 12000] |  149/7664 batches | ms/batch 194.5037 | train_loss 6.702484e-01 | lr 7.500000e-05
07/02/2024 09:07:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   200/ 12000] |  199/7664 batches | ms/batch 194.2556 | train_loss 6.879822e-01 | lr 1.000000e-04
07/02/2024 09:07:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   250/ 12000] |  249/7664 batches | ms/batch 197.3089 | train_loss 6.883096e-01 | lr 9.957627e-05
07/02/2024 09:07:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   300/ 12000] |  299/7664 batches | ms/batch 202.7556 | train_loss 6.970413e-01 | lr 9.915254e-05
07/02/2024 09:07:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   350/ 12000] |  349/7664 batches | ms/batch 198.3920 | train_loss 6.899976e-01 | lr 9.872881e-05
07/02/2024 09:08:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   400/ 12000] |  399/7664 batches | ms/batch 194.5878 | train_loss 6.857477e-01 | lr 9.830508e-05
07/02/2024 09:08:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   450/ 12000] |  449/7664 batches | ms/batch 194.8121 | train_loss 6.885198e-01 | lr 9.788136e-05
07/02/2024 09:08:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   500/ 12000] |  499/7664 batches | ms/batch 202.1183 | train_loss 6.849320e-01 | lr 9.745763e-05
07/02/2024 09:08:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   550/ 12000] |  549/7664 batches | ms/batch 196.7718 | train_loss 6.811599e-01 | lr 9.703390e-05
07/02/2024 09:08:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   600/ 12000] |  599/7664 batches | ms/batch 196.5115 | train_loss 6.823351e-01 | lr 9.661017e-05
07/02/2024 09:09:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   650/ 12000] |  649/7664 batches | ms/batch 195.9214 | train_loss 6.791278e-01 | lr 9.618644e-05
07/02/2024 09:09:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   700/ 12000] |  699/7664 batches | ms/batch 195.9746 | train_loss 6.794486e-01 | lr 9.576271e-05
07/02/2024 09:09:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   750/ 12000] |  749/7664 batches | ms/batch 196.2488 | train_loss 6.847186e-01 | lr 9.533898e-05
07/02/2024 09:09:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   800/ 12000] |  799/7664 batches | ms/batch 196.0449 | train_loss 6.779511e-01 | lr 9.491525e-05
07/02/2024 09:09:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   850/ 12000] |  849/7664 batches | ms/batch 196.1191 | train_loss 6.744700e-01 | lr 9.449153e-05
07/02/2024 09:10:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   900/ 12000] |  899/7664 batches | ms/batch 196.1856 | train_loss 6.818783e-01 | lr 9.406780e-05
07/02/2024 09:10:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   950/ 12000] |  949/7664 batches | ms/batch 195.3484 | train_loss 6.734696e-01 | lr 9.364407e-05
07/02/2024 09:10:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1000/ 12000] |  999/7664 batches | ms/batch 195.7125 | train_loss 6.743775e-01 | lr 9.322034e-05
07/02/2024 09:10:23 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpbwhj1yxj at global_step 1000 ****
07/02/2024 09:10:24 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 09:10:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1050/ 12000] | 1049/7664 batches | ms/batch 196.1532 | train_loss 6.753859e-01 | lr 9.279661e-05
07/02/2024 09:10:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1100/ 12000] | 1099/7664 batches | ms/batch 202.2977 | train_loss 6.779252e-01 | lr 9.237288e-05
07/02/2024 09:10:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1150/ 12000] | 1149/7664 batches | ms/batch 196.4222 | train_loss 6.720959e-01 | lr 9.194915e-05
07/02/2024 09:11:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1200/ 12000] | 1199/7664 batches | ms/batch 196.5015 | train_loss 6.729488e-01 | lr 9.152542e-05
07/02/2024 09:11:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1250/ 12000] | 1249/7664 batches | ms/batch 196.3200 | train_loss 6.719323e-01 | lr 9.110169e-05
07/02/2024 09:11:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1300/ 12000] | 1299/7664 batches | ms/batch 196.2441 | train_loss 6.691981e-01 | lr 9.067797e-05
07/02/2024 09:11:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1350/ 12000] | 1349/7664 batches | ms/batch 196.4797 | train_loss 6.708844e-01 | lr 9.025424e-05
07/02/2024 09:11:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1400/ 12000] | 1399/7664 batches | ms/batch 198.4483 | train_loss 6.699195e-01 | lr 8.983051e-05
07/02/2024 09:12:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1450/ 12000] | 1449/7664 batches | ms/batch 196.2881 | train_loss 6.698203e-01 | lr 8.940678e-05
07/02/2024 09:12:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1500/ 12000] | 1499/7664 batches | ms/batch 196.3396 | train_loss 6.689413e-01 | lr 8.898305e-05
07/02/2024 09:12:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1550/ 12000] | 1549/7664 batches | ms/batch 195.9352 | train_loss 6.662586e-01 | lr 8.855932e-05
07/02/2024 09:12:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1600/ 12000] | 1599/7664 batches | ms/batch 196.3863 | train_loss 6.679342e-01 | lr 8.813559e-05
07/02/2024 09:12:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1650/ 12000] | 1649/7664 batches | ms/batch 196.6450 | train_loss 6.637100e-01 | lr 8.771186e-05
07/02/2024 09:13:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1700/ 12000] | 1699/7664 batches | ms/batch 196.3973 | train_loss 6.639749e-01 | lr 8.728814e-05
07/02/2024 09:13:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1750/ 12000] | 1749/7664 batches | ms/batch 196.2373 | train_loss 6.643158e-01 | lr 8.686441e-05
07/02/2024 09:13:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1800/ 12000] | 1799/7664 batches | ms/batch 197.9387 | train_loss 6.666468e-01 | lr 8.644068e-05
07/02/2024 09:13:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1850/ 12000] | 1849/7664 batches | ms/batch 198.3996 | train_loss 6.648001e-01 | lr 8.601695e-05
07/02/2024 09:13:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1900/ 12000] | 1899/7664 batches | ms/batch 195.8417 | train_loss 6.625775e-01 | lr 8.559322e-05
07/02/2024 09:13:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1950/ 12000] | 1949/7664 batches | ms/batch 195.6292 | train_loss 6.632552e-01 | lr 8.516949e-05
07/02/2024 09:14:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2000/ 12000] | 1999/7664 batches | ms/batch 198.7262 | train_loss 6.617877e-01 | lr 8.474576e-05
07/02/2024 09:14:07 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpbwhj1yxj at global_step 2000 ****
07/02/2024 09:14:07 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 09:14:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2050/ 12000] | 2049/7664 batches | ms/batch 196.4951 | train_loss 6.609606e-01 | lr 8.432203e-05
07/02/2024 09:14:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2100/ 12000] | 2099/7664 batches | ms/batch 196.6896 | train_loss 6.620201e-01 | lr 8.389831e-05
07/02/2024 09:14:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2150/ 12000] | 2149/7664 batches | ms/batch 196.5976 | train_loss 6.631499e-01 | lr 8.347458e-05
07/02/2024 09:14:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2200/ 12000] | 2199/7664 batches | ms/batch 196.6691 | train_loss 6.612938e-01 | lr 8.305085e-05
07/02/2024 09:15:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2250/ 12000] | 2249/7664 batches | ms/batch 197.8323 | train_loss 6.626789e-01 | lr 8.262712e-05
07/02/2024 09:15:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2300/ 12000] | 2299/7664 batches | ms/batch 196.5891 | train_loss 6.579614e-01 | lr 8.220339e-05
07/02/2024 09:15:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2350/ 12000] | 2349/7664 batches | ms/batch 196.0450 | train_loss 6.581646e-01 | lr 8.177966e-05
07/02/2024 09:15:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2400/ 12000] | 2399/7664 batches | ms/batch 196.7809 | train_loss 6.583704e-01 | lr 8.135593e-05
07/02/2024 09:15:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2450/ 12000] | 2449/7664 batches | ms/batch 196.6673 | train_loss 6.585619e-01 | lr 8.093220e-05
07/02/2024 09:15:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2500/ 12000] | 2499/7664 batches | ms/batch 196.6902 | train_loss 6.561803e-01 | lr 8.050847e-05
07/02/2024 09:16:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2550/ 12000] | 2549/7664 batches | ms/batch 196.6069 | train_loss 6.562256e-01 | lr 8.008475e-05
07/02/2024 09:16:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2600/ 12000] | 2599/7664 batches | ms/batch 196.8288 | train_loss 6.588562e-01 | lr 7.966102e-05
07/02/2024 09:16:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2650/ 12000] | 2649/7664 batches | ms/batch 196.6578 | train_loss 6.569381e-01 | lr 7.923729e-05
07/02/2024 09:16:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2700/ 12000] | 2699/7664 batches | ms/batch 195.9565 | train_loss 6.574981e-01 | lr 7.881356e-05
07/02/2024 09:16:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2750/ 12000] | 2749/7664 batches | ms/batch 196.9480 | train_loss 6.568339e-01 | lr 7.838983e-05
07/02/2024 09:17:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2800/ 12000] | 2799/7664 batches | ms/batch 196.5005 | train_loss 6.557856e-01 | lr 7.796610e-05
07/02/2024 09:17:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2850/ 12000] | 2849/7664 batches | ms/batch 196.4817 | train_loss 6.589642e-01 | lr 7.754237e-05
07/02/2024 09:17:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2900/ 12000] | 2899/7664 batches | ms/batch 198.4359 | train_loss 6.539023e-01 | lr 7.711864e-05
07/02/2024 09:17:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2950/ 12000] | 2949/7664 batches | ms/batch 195.4013 | train_loss 6.552874e-01 | lr 7.669492e-05
07/02/2024 09:17:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3000/ 12000] | 2999/7664 batches | ms/batch 196.8397 | train_loss 6.541507e-01 | lr 7.627119e-05
07/02/2024 09:17:49 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpbwhj1yxj at global_step 3000 ****
07/02/2024 09:17:50 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 09:18:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3050/ 12000] | 3049/7664 batches | ms/batch 196.7304 | train_loss 6.552190e-01 | lr 7.584746e-05
07/02/2024 09:18:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3100/ 12000] | 3099/7664 batches | ms/batch 196.5981 | train_loss 6.558049e-01 | lr 7.542373e-05
07/02/2024 09:18:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3150/ 12000] | 3149/7664 batches | ms/batch 196.4776 | train_loss 6.552358e-01 | lr 7.500000e-05
07/02/2024 09:18:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3200/ 12000] | 3199/7664 batches | ms/batch 196.6036 | train_loss 6.530563e-01 | lr 7.457627e-05
07/02/2024 09:18:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3250/ 12000] | 3249/7664 batches | ms/batch 196.9428 | train_loss 6.521708e-01 | lr 7.415254e-05
07/02/2024 09:18:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3300/ 12000] | 3299/7664 batches | ms/batch 196.9606 | train_loss 6.533076e-01 | lr 7.372881e-05
07/02/2024 09:19:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3350/ 12000] | 3349/7664 batches | ms/batch 196.9170 | train_loss 6.517227e-01 | lr 7.330508e-05
07/02/2024 09:19:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3400/ 12000] | 3399/7664 batches | ms/batch 196.7175 | train_loss 6.509742e-01 | lr 7.288136e-05
07/02/2024 09:19:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3450/ 12000] | 3449/7664 batches | ms/batch 196.6768 | train_loss 6.521843e-01 | lr 7.245763e-05
07/02/2024 09:19:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3500/ 12000] | 3499/7664 batches | ms/batch 196.5848 | train_loss 6.525055e-01 | lr 7.203390e-05
07/02/2024 09:19:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3550/ 12000] | 3549/7664 batches | ms/batch 196.4542 | train_loss 6.512613e-01 | lr 7.161017e-05
07/02/2024 09:20:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3600/ 12000] | 3599/7664 batches | ms/batch 197.8169 | train_loss 6.480469e-01 | lr 7.118644e-05
07/02/2024 09:20:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3650/ 12000] | 3649/7664 batches | ms/batch 196.6032 | train_loss 6.498136e-01 | lr 7.076271e-05
07/02/2024 09:20:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3700/ 12000] | 3699/7664 batches | ms/batch 196.7403 | train_loss 6.493236e-01 | lr 7.033898e-05
07/02/2024 09:20:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3750/ 12000] | 3749/7664 batches | ms/batch 196.8351 | train_loss 6.497229e-01 | lr 6.991525e-05
07/02/2024 09:20:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3800/ 12000] | 3799/7664 batches | ms/batch 195.6576 | train_loss 6.476246e-01 | lr 6.949153e-05
07/02/2024 09:20:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3850/ 12000] | 3849/7664 batches | ms/batch 196.7081 | train_loss 6.498215e-01 | lr 6.906780e-05
07/02/2024 09:21:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3900/ 12000] | 3899/7664 batches | ms/batch 196.6850 | train_loss 6.475916e-01 | lr 6.864407e-05
07/02/2024 09:21:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3950/ 12000] | 3949/7664 batches | ms/batch 196.7177 | train_loss 6.476844e-01 | lr 6.822034e-05
07/02/2024 09:21:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4000/ 12000] | 3999/7664 batches | ms/batch 196.5995 | train_loss 6.468807e-01 | lr 6.779661e-05
07/02/2024 09:21:32 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpbwhj1yxj at global_step 4000 ****
07/02/2024 09:21:33 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 09:21:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4050/ 12000] | 4049/7664 batches | ms/batch 195.6645 | train_loss 6.490657e-01 | lr 6.737288e-05
07/02/2024 09:21:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4100/ 12000] | 4099/7664 batches | ms/batch 196.4252 | train_loss 6.474718e-01 | lr 6.694915e-05
07/02/2024 09:22:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4150/ 12000] | 4149/7664 batches | ms/batch 196.6800 | train_loss 6.472366e-01 | lr 6.652542e-05
07/02/2024 09:22:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4200/ 12000] | 4199/7664 batches | ms/batch 195.8139 | train_loss 6.470546e-01 | lr 6.610169e-05
07/02/2024 09:22:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4250/ 12000] | 4249/7664 batches | ms/batch 198.5867 | train_loss 6.473549e-01 | lr 6.567797e-05
07/02/2024 09:22:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4300/ 12000] | 4299/7664 batches | ms/batch 195.9270 | train_loss 6.455462e-01 | lr 6.525424e-05
07/02/2024 09:22:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4350/ 12000] | 4349/7664 batches | ms/batch 196.7688 | train_loss 6.454528e-01 | lr 6.483051e-05
07/02/2024 09:23:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4400/ 12000] | 4399/7664 batches | ms/batch 195.9692 | train_loss 6.486985e-01 | lr 6.440678e-05
07/02/2024 09:23:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4450/ 12000] | 4449/7664 batches | ms/batch 195.4135 | train_loss 6.481033e-01 | lr 6.398305e-05
07/02/2024 09:23:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4500/ 12000] | 4499/7664 batches | ms/batch 196.6668 | train_loss 6.453573e-01 | lr 6.355932e-05
07/02/2024 09:23:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4550/ 12000] | 4549/7664 batches | ms/batch 197.5439 | train_loss 6.449755e-01 | lr 6.313559e-05
07/02/2024 09:23:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4600/ 12000] | 4599/7664 batches | ms/batch 196.5133 | train_loss 6.436872e-01 | lr 6.271186e-05
07/02/2024 09:23:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4650/ 12000] | 4649/7664 batches | ms/batch 196.9303 | train_loss 6.439164e-01 | lr 6.228814e-05
07/02/2024 09:24:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4700/ 12000] | 4699/7664 batches | ms/batch 196.5719 | train_loss 6.415983e-01 | lr 6.186441e-05
07/02/2024 09:24:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4750/ 12000] | 4749/7664 batches | ms/batch 196.7913 | train_loss 6.444741e-01 | lr 6.144068e-05
07/02/2024 09:24:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4800/ 12000] | 4799/7664 batches | ms/batch 195.9563 | train_loss 6.440372e-01 | lr 6.101695e-05
07/02/2024 09:24:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4850/ 12000] | 4849/7664 batches | ms/batch 196.9244 | train_loss 6.425737e-01 | lr 6.059322e-05
07/02/2024 09:24:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4900/ 12000] | 4899/7664 batches | ms/batch 196.4907 | train_loss 6.434143e-01 | lr 6.016949e-05
07/02/2024 09:25:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4950/ 12000] | 4949/7664 batches | ms/batch 195.7858 | train_loss 6.435952e-01 | lr 5.974576e-05
07/02/2024 09:25:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5000/ 12000] | 4999/7664 batches | ms/batch 196.5234 | train_loss 6.422220e-01 | lr 5.932203e-05
07/02/2024 09:25:15 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpbwhj1yxj at global_step 5000 ****
07/02/2024 09:25:16 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 09:25:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5050/ 12000] | 5049/7664 batches | ms/batch 196.6610 | train_loss 6.404162e-01 | lr 5.889831e-05
07/02/2024 09:25:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5100/ 12000] | 5099/7664 batches | ms/batch 196.8173 | train_loss 6.410155e-01 | lr 5.847458e-05
07/02/2024 09:25:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5150/ 12000] | 5149/7664 batches | ms/batch 196.5940 | train_loss 6.421029e-01 | lr 5.805085e-05
07/02/2024 09:26:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5200/ 12000] | 5199/7664 batches | ms/batch 195.9248 | train_loss 6.401218e-01 | lr 5.762712e-05
07/02/2024 09:26:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5250/ 12000] | 5249/7664 batches | ms/batch 196.5275 | train_loss 6.410774e-01 | lr 5.720339e-05
07/02/2024 09:26:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5300/ 12000] | 5299/7664 batches | ms/batch 196.8794 | train_loss 6.398863e-01 | lr 5.677966e-05
07/02/2024 09:26:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5350/ 12000] | 5349/7664 batches | ms/batch 197.4129 | train_loss 6.401879e-01 | lr 5.635593e-05
07/02/2024 09:26:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5400/ 12000] | 5399/7664 batches | ms/batch 196.9329 | train_loss 6.406548e-01 | lr 5.593220e-05
07/02/2024 09:26:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5450/ 12000] | 5449/7664 batches | ms/batch 195.8630 | train_loss 6.401624e-01 | lr 5.550847e-05
07/02/2024 09:27:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5500/ 12000] | 5499/7664 batches | ms/batch 196.6809 | train_loss 6.398126e-01 | lr 5.508475e-05
07/02/2024 09:27:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5550/ 12000] | 5549/7664 batches | ms/batch 196.9020 | train_loss 6.390293e-01 | lr 5.466102e-05
07/02/2024 09:27:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5600/ 12000] | 5599/7664 batches | ms/batch 196.6554 | train_loss 6.390523e-01 | lr 5.423729e-05
07/02/2024 09:27:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5650/ 12000] | 5649/7664 batches | ms/batch 196.6497 | train_loss 6.390068e-01 | lr 5.381356e-05
07/02/2024 09:27:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5700/ 12000] | 5699/7664 batches | ms/batch 196.7220 | train_loss 6.398234e-01 | lr 5.338983e-05
07/02/2024 09:28:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5750/ 12000] | 5749/7664 batches | ms/batch 196.5831 | train_loss 6.398787e-01 | lr 5.296610e-05
07/02/2024 09:28:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5800/ 12000] | 5799/7664 batches | ms/batch 196.5319 | train_loss 6.382322e-01 | lr 5.254237e-05
07/02/2024 09:28:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5850/ 12000] | 5849/7664 batches | ms/batch 196.5438 | train_loss 6.378688e-01 | lr 5.211864e-05
07/02/2024 09:28:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5900/ 12000] | 5899/7664 batches | ms/batch 196.3156 | train_loss 6.379956e-01 | lr 5.169492e-05
07/02/2024 09:28:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5950/ 12000] | 5949/7664 batches | ms/batch 196.9930 | train_loss 6.388756e-01 | lr 5.127119e-05
07/02/2024 09:28:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6000/ 12000] | 5999/7664 batches | ms/batch 195.7213 | train_loss 6.361410e-01 | lr 5.084746e-05
07/02/2024 09:28:58 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpbwhj1yxj at global_step 6000 ****
07/02/2024 09:28:59 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 09:29:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6050/ 12000] | 6049/7664 batches | ms/batch 195.7852 | train_loss 6.376541e-01 | lr 5.042373e-05
07/02/2024 09:29:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6100/ 12000] | 6099/7664 batches | ms/batch 196.4294 | train_loss 6.370833e-01 | lr 5.000000e-05
07/02/2024 09:29:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6150/ 12000] | 6149/7664 batches | ms/batch 196.1433 | train_loss 6.378909e-01 | lr 4.957627e-05
07/02/2024 09:29:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6200/ 12000] | 6199/7664 batches | ms/batch 198.6632 | train_loss 6.358786e-01 | lr 4.915254e-05
07/02/2024 09:29:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6250/ 12000] | 6249/7664 batches | ms/batch 198.4507 | train_loss 6.353714e-01 | lr 4.872881e-05
07/02/2024 09:30:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6300/ 12000] | 6299/7664 batches | ms/batch 195.7843 | train_loss 6.366416e-01 | lr 4.830508e-05
07/02/2024 09:30:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6350/ 12000] | 6349/7664 batches | ms/batch 197.9500 | train_loss 6.354405e-01 | lr 4.788136e-05
07/02/2024 09:30:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6400/ 12000] | 6399/7664 batches | ms/batch 196.9635 | train_loss 6.366301e-01 | lr 4.745763e-05
07/02/2024 09:30:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6450/ 12000] | 6449/7664 batches | ms/batch 196.4862 | train_loss 6.339819e-01 | lr 4.703390e-05
07/02/2024 09:30:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6500/ 12000] | 6499/7664 batches | ms/batch 196.6038 | train_loss 6.350943e-01 | lr 4.661017e-05
07/02/2024 09:31:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6550/ 12000] | 6549/7664 batches | ms/batch 195.4225 | train_loss 6.354282e-01 | lr 4.618644e-05
07/02/2024 09:31:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6600/ 12000] | 6599/7664 batches | ms/batch 196.6615 | train_loss 6.358479e-01 | lr 4.576271e-05
07/02/2024 09:31:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6650/ 12000] | 6649/7664 batches | ms/batch 197.8641 | train_loss 6.343772e-01 | lr 4.533898e-05
07/02/2024 09:31:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6700/ 12000] | 6699/7664 batches | ms/batch 195.3776 | train_loss 6.364372e-01 | lr 4.491525e-05
07/02/2024 09:31:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6750/ 12000] | 6749/7664 batches | ms/batch 196.5251 | train_loss 6.348901e-01 | lr 4.449153e-05
07/02/2024 09:31:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6800/ 12000] | 6799/7664 batches | ms/batch 196.6779 | train_loss 6.361116e-01 | lr 4.406780e-05
07/02/2024 09:32:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6850/ 12000] | 6849/7664 batches | ms/batch 196.7546 | train_loss 6.341191e-01 | lr 4.364407e-05
07/02/2024 09:32:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6900/ 12000] | 6899/7664 batches | ms/batch 196.6835 | train_loss 6.350491e-01 | lr 4.322034e-05
07/02/2024 09:32:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6950/ 12000] | 6949/7664 batches | ms/batch 196.5821 | train_loss 6.327171e-01 | lr 4.279661e-05
07/02/2024 09:32:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7000/ 12000] | 6999/7664 batches | ms/batch 196.6510 | train_loss 6.330661e-01 | lr 4.237288e-05
07/02/2024 09:32:41 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpbwhj1yxj at global_step 7000 ****
07/02/2024 09:32:42 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 09:32:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7050/ 12000] | 7049/7664 batches | ms/batch 196.6106 | train_loss 6.339898e-01 | lr 4.194915e-05
07/02/2024 09:33:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7100/ 12000] | 7099/7664 batches | ms/batch 196.5305 | train_loss 6.331616e-01 | lr 4.152542e-05
07/02/2024 09:33:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7150/ 12000] | 7149/7664 batches | ms/batch 196.8337 | train_loss 6.332672e-01 | lr 4.110169e-05
07/02/2024 09:33:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7200/ 12000] | 7199/7664 batches | ms/batch 196.6833 | train_loss 6.326532e-01 | lr 4.067797e-05
07/02/2024 09:33:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7250/ 12000] | 7249/7664 batches | ms/batch 196.7867 | train_loss 6.326615e-01 | lr 4.025424e-05
07/02/2024 09:33:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7300/ 12000] | 7299/7664 batches | ms/batch 198.6172 | train_loss 6.323551e-01 | lr 3.983051e-05
07/02/2024 09:34:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7350/ 12000] | 7349/7664 batches | ms/batch 195.8842 | train_loss 6.327841e-01 | lr 3.940678e-05
07/02/2024 09:34:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7400/ 12000] | 7399/7664 batches | ms/batch 195.9271 | train_loss 6.337362e-01 | lr 3.898305e-05
07/02/2024 09:34:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7450/ 12000] | 7449/7664 batches | ms/batch 196.4977 | train_loss 6.332572e-01 | lr 3.855932e-05
07/02/2024 09:34:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7500/ 12000] | 7499/7664 batches | ms/batch 198.8042 | train_loss 6.307216e-01 | lr 3.813559e-05
07/02/2024 09:34:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7550/ 12000] | 7549/7664 batches | ms/batch 196.7653 | train_loss 6.314870e-01 | lr 3.771186e-05
07/02/2024 09:34:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7600/ 12000] | 7599/7664 batches | ms/batch 196.6005 | train_loss 6.314997e-01 | lr 3.728814e-05
07/02/2024 09:35:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7650/ 12000] | 7649/7664 batches | ms/batch 196.6563 | train_loss 6.328245e-01 | lr 3.686441e-05
07/02/2024 09:35:28 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  7700/ 12000] |   35/7664 batches | ms/batch 196.0589 | train_loss 6.224142e-01 | lr 3.644068e-05
07/02/2024 09:35:40 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  7750/ 12000] |   85/7664 batches | ms/batch 195.2853 | train_loss 6.184813e-01 | lr 3.601695e-05
07/02/2024 09:35:51 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  7800/ 12000] |  135/7664 batches | ms/batch 196.0512 | train_loss 6.192509e-01 | lr 3.559322e-05
07/02/2024 09:36:02 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  7850/ 12000] |  185/7664 batches | ms/batch 198.1564 | train_loss 6.188594e-01 | lr 3.516949e-05
07/02/2024 09:36:13 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  7900/ 12000] |  235/7664 batches | ms/batch 196.3048 | train_loss 6.196601e-01 | lr 3.474576e-05
07/02/2024 09:36:24 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  7950/ 12000] |  285/7664 batches | ms/batch 196.2354 | train_loss 6.184767e-01 | lr 3.432203e-05
07/02/2024 09:36:35 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8000/ 12000] |  335/7664 batches | ms/batch 195.4930 | train_loss 6.192440e-01 | lr 3.389831e-05
07/02/2024 09:36:35 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpbwhj1yxj at global_step 8000 ****
07/02/2024 09:36:36 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 09:36:47 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8050/ 12000] |  385/7664 batches | ms/batch 196.1477 | train_loss 6.194138e-01 | lr 3.347458e-05
07/02/2024 09:36:58 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8100/ 12000] |  435/7664 batches | ms/batch 196.4025 | train_loss 6.189808e-01 | lr 3.305085e-05
07/02/2024 09:37:09 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8150/ 12000] |  485/7664 batches | ms/batch 196.2416 | train_loss 6.174737e-01 | lr 3.262712e-05
07/02/2024 09:37:20 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8200/ 12000] |  535/7664 batches | ms/batch 195.0712 | train_loss 6.185208e-01 | lr 3.220339e-05
07/02/2024 09:37:31 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8250/ 12000] |  585/7664 batches | ms/batch 196.2433 | train_loss 6.183407e-01 | lr 3.177966e-05
07/02/2024 09:37:42 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8300/ 12000] |  635/7664 batches | ms/batch 195.6618 | train_loss 6.207123e-01 | lr 3.135593e-05
07/02/2024 09:37:53 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8350/ 12000] |  685/7664 batches | ms/batch 196.6237 | train_loss 6.186574e-01 | lr 3.093220e-05
07/02/2024 09:38:05 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8400/ 12000] |  735/7664 batches | ms/batch 196.3738 | train_loss 6.192750e-01 | lr 3.050847e-05
07/02/2024 09:38:16 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8450/ 12000] |  785/7664 batches | ms/batch 196.2420 | train_loss 6.173744e-01 | lr 3.008475e-05
07/02/2024 09:38:27 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8500/ 12000] |  835/7664 batches | ms/batch 196.3229 | train_loss 6.168379e-01 | lr 2.966102e-05
07/02/2024 09:38:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8550/ 12000] |  885/7664 batches | ms/batch 195.7311 | train_loss 6.184111e-01 | lr 2.923729e-05
07/02/2024 09:38:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8600/ 12000] |  935/7664 batches | ms/batch 196.6172 | train_loss 6.185640e-01 | lr 2.881356e-05
07/02/2024 09:39:00 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8650/ 12000] |  985/7664 batches | ms/batch 196.4516 | train_loss 6.176782e-01 | lr 2.838983e-05
07/02/2024 09:39:11 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8700/ 12000] | 1035/7664 batches | ms/batch 196.5099 | train_loss 6.174177e-01 | lr 2.796610e-05
07/02/2024 09:39:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8750/ 12000] | 1085/7664 batches | ms/batch 196.6979 | train_loss 6.157332e-01 | lr 2.754237e-05
07/02/2024 09:39:33 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8800/ 12000] | 1135/7664 batches | ms/batch 196.4643 | train_loss 6.179163e-01 | lr 2.711864e-05
07/02/2024 09:39:45 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8850/ 12000] | 1185/7664 batches | ms/batch 198.3599 | train_loss 6.172548e-01 | lr 2.669492e-05
07/02/2024 09:39:56 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8900/ 12000] | 1235/7664 batches | ms/batch 195.7279 | train_loss 6.170281e-01 | lr 2.627119e-05
07/02/2024 09:40:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8950/ 12000] | 1285/7664 batches | ms/batch 195.9429 | train_loss 6.171275e-01 | lr 2.584746e-05
07/02/2024 09:40:18 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9000/ 12000] | 1335/7664 batches | ms/batch 196.5908 | train_loss 6.163149e-01 | lr 2.542373e-05
07/02/2024 09:40:18 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpbwhj1yxj at global_step 9000 ****
07/02/2024 09:40:19 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 09:40:30 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9050/ 12000] | 1385/7664 batches | ms/batch 196.3001 | train_loss 6.158751e-01 | lr 2.500000e-05
07/02/2024 09:40:41 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9100/ 12000] | 1435/7664 batches | ms/batch 196.8993 | train_loss 6.161437e-01 | lr 2.457627e-05
07/02/2024 09:40:52 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9150/ 12000] | 1485/7664 batches | ms/batch 195.9210 | train_loss 6.165602e-01 | lr 2.415254e-05
07/02/2024 09:41:03 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9200/ 12000] | 1535/7664 batches | ms/batch 196.5048 | train_loss 6.141385e-01 | lr 2.372881e-05
07/02/2024 09:41:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9250/ 12000] | 1585/7664 batches | ms/batch 196.4110 | train_loss 6.174208e-01 | lr 2.330508e-05
07/02/2024 09:41:26 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9300/ 12000] | 1635/7664 batches | ms/batch 195.5178 | train_loss 6.151102e-01 | lr 2.288136e-05
07/02/2024 09:41:37 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9350/ 12000] | 1685/7664 batches | ms/batch 196.6252 | train_loss 6.153352e-01 | lr 2.245763e-05
07/02/2024 09:41:48 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9400/ 12000] | 1735/7664 batches | ms/batch 196.3162 | train_loss 6.164140e-01 | lr 2.203390e-05
07/02/2024 09:41:59 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9450/ 12000] | 1785/7664 batches | ms/batch 195.2033 | train_loss 6.155407e-01 | lr 2.161017e-05
07/02/2024 09:42:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9500/ 12000] | 1835/7664 batches | ms/batch 196.4777 | train_loss 6.133931e-01 | lr 2.118644e-05
07/02/2024 09:42:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9550/ 12000] | 1885/7664 batches | ms/batch 197.9189 | train_loss 6.151473e-01 | lr 2.076271e-05
07/02/2024 09:42:33 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9600/ 12000] | 1935/7664 batches | ms/batch 196.7785 | train_loss 6.152966e-01 | lr 2.033898e-05
07/02/2024 09:42:44 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9650/ 12000] | 1985/7664 batches | ms/batch 196.4440 | train_loss 6.153603e-01 | lr 1.991525e-05
07/02/2024 09:42:55 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9700/ 12000] | 2035/7664 batches | ms/batch 196.2855 | train_loss 6.155698e-01 | lr 1.949153e-05
07/02/2024 09:43:06 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9750/ 12000] | 2085/7664 batches | ms/batch 196.4596 | train_loss 6.160819e-01 | lr 1.906780e-05
07/02/2024 09:43:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9800/ 12000] | 2135/7664 batches | ms/batch 196.0227 | train_loss 6.158376e-01 | lr 1.864407e-05
07/02/2024 09:43:28 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9850/ 12000] | 2185/7664 batches | ms/batch 196.6040 | train_loss 6.155688e-01 | lr 1.822034e-05
07/02/2024 09:43:39 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9900/ 12000] | 2235/7664 batches | ms/batch 195.4109 | train_loss 6.131994e-01 | lr 1.779661e-05
07/02/2024 09:43:50 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9950/ 12000] | 2285/7664 batches | ms/batch 195.9468 | train_loss 6.136576e-01 | lr 1.737288e-05
07/02/2024 09:44:01 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10000/ 12000] | 2335/7664 batches | ms/batch 195.8433 | train_loss 6.130846e-01 | lr 1.694915e-05
07/02/2024 09:44:01 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpbwhj1yxj at global_step 10000 ****
07/02/2024 09:44:03 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 09:44:14 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10050/ 12000] | 2385/7664 batches | ms/batch 196.2969 | train_loss 6.134954e-01 | lr 1.652542e-05
07/02/2024 09:44:25 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10100/ 12000] | 2435/7664 batches | ms/batch 196.4521 | train_loss 6.152259e-01 | lr 1.610169e-05
07/02/2024 09:44:37 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10150/ 12000] | 2485/7664 batches | ms/batch 196.4245 | train_loss 6.138269e-01 | lr 1.567797e-05
07/02/2024 09:44:48 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10200/ 12000] | 2535/7664 batches | ms/batch 196.5231 | train_loss 6.144936e-01 | lr 1.525424e-05
07/02/2024 09:44:59 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10250/ 12000] | 2585/7664 batches | ms/batch 195.6801 | train_loss 6.140794e-01 | lr 1.483051e-05
07/02/2024 09:45:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10300/ 12000] | 2635/7664 batches | ms/batch 196.2107 | train_loss 6.136935e-01 | lr 1.440678e-05
07/02/2024 09:45:21 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10350/ 12000] | 2685/7664 batches | ms/batch 196.3494 | train_loss 6.150395e-01 | lr 1.398305e-05
07/02/2024 09:45:32 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10400/ 12000] | 2735/7664 batches | ms/batch 196.3810 | train_loss 6.139939e-01 | lr 1.355932e-05
07/02/2024 09:45:43 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10450/ 12000] | 2785/7664 batches | ms/batch 196.6056 | train_loss 6.135630e-01 | lr 1.313559e-05
07/02/2024 09:45:54 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10500/ 12000] | 2835/7664 batches | ms/batch 198.2373 | train_loss 6.128631e-01 | lr 1.271186e-05
07/02/2024 09:46:05 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10550/ 12000] | 2885/7664 batches | ms/batch 196.5269 | train_loss 6.145691e-01 | lr 1.228814e-05
07/02/2024 09:46:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10600/ 12000] | 2935/7664 batches | ms/batch 196.3945 | train_loss 6.127456e-01 | lr 1.186441e-05
07/02/2024 09:46:28 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10650/ 12000] | 2985/7664 batches | ms/batch 195.3005 | train_loss 6.125405e-01 | lr 1.144068e-05
07/02/2024 09:46:39 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10700/ 12000] | 3035/7664 batches | ms/batch 196.7828 | train_loss 6.112729e-01 | lr 1.101695e-05
07/02/2024 09:46:50 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10750/ 12000] | 3085/7664 batches | ms/batch 196.5025 | train_loss 6.120339e-01 | lr 1.059322e-05
07/02/2024 09:47:01 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10800/ 12000] | 3135/7664 batches | ms/batch 196.6301 | train_loss 6.131863e-01 | lr 1.016949e-05
07/02/2024 09:47:12 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10850/ 12000] | 3185/7664 batches | ms/batch 196.4830 | train_loss 6.129719e-01 | lr 9.745763e-06
07/02/2024 09:47:23 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10900/ 12000] | 3235/7664 batches | ms/batch 198.5551 | train_loss 6.117699e-01 | lr 9.322034e-06
07/02/2024 09:47:34 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10950/ 12000] | 3285/7664 batches | ms/batch 196.4794 | train_loss 6.113594e-01 | lr 8.898305e-06
07/02/2024 09:47:45 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11000/ 12000] | 3335/7664 batches | ms/batch 196.5121 | train_loss 6.136916e-01 | lr 8.474576e-06
07/02/2024 09:47:45 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpbwhj1yxj at global_step 11000 ****
07/02/2024 09:47:46 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 09:47:57 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11050/ 12000] | 3385/7664 batches | ms/batch 195.6418 | train_loss 6.120022e-01 | lr 8.050847e-06
07/02/2024 09:48:08 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11100/ 12000] | 3435/7664 batches | ms/batch 196.6096 | train_loss 6.115933e-01 | lr 7.627119e-06
07/02/2024 09:48:19 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11150/ 12000] | 3485/7664 batches | ms/batch 196.0147 | train_loss 6.115994e-01 | lr 7.203390e-06
07/02/2024 09:48:30 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11200/ 12000] | 3535/7664 batches | ms/batch 196.5995 | train_loss 6.126469e-01 | lr 6.779661e-06
07/02/2024 09:48:41 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11250/ 12000] | 3585/7664 batches | ms/batch 196.4257 | train_loss 6.117756e-01 | lr 6.355932e-06
07/02/2024 09:48:52 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11300/ 12000] | 3635/7664 batches | ms/batch 196.5570 | train_loss 6.109066e-01 | lr 5.932203e-06
07/02/2024 09:49:03 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11350/ 12000] | 3685/7664 batches | ms/batch 196.5822 | train_loss 6.131798e-01 | lr 5.508475e-06
07/02/2024 09:49:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11400/ 12000] | 3735/7664 batches | ms/batch 196.6285 | train_loss 6.123062e-01 | lr 5.084746e-06
07/02/2024 09:49:26 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11450/ 12000] | 3785/7664 batches | ms/batch 196.5094 | train_loss 6.119338e-01 | lr 4.661017e-06
07/02/2024 09:49:37 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11500/ 12000] | 3835/7664 batches | ms/batch 195.7147 | train_loss 6.125557e-01 | lr 4.237288e-06
07/02/2024 09:49:48 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11550/ 12000] | 3885/7664 batches | ms/batch 196.0878 | train_loss 6.104179e-01 | lr 3.813559e-06
07/02/2024 09:49:59 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11600/ 12000] | 3935/7664 batches | ms/batch 196.6487 | train_loss 6.101841e-01 | lr 3.389831e-06
07/02/2024 09:50:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11650/ 12000] | 3985/7664 batches | ms/batch 196.5305 | train_loss 6.122910e-01 | lr 2.966102e-06
07/02/2024 09:50:21 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11700/ 12000] | 4035/7664 batches | ms/batch 196.4932 | train_loss 6.095600e-01 | lr 2.542373e-06
07/02/2024 09:50:32 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11750/ 12000] | 4085/7664 batches | ms/batch 196.9617 | train_loss 6.095380e-01 | lr 2.118644e-06
07/02/2024 09:50:43 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11800/ 12000] | 4135/7664 batches | ms/batch 195.7832 | train_loss 6.124040e-01 | lr 1.694915e-06
07/02/2024 09:50:55 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11850/ 12000] | 4185/7664 batches | ms/batch 196.3958 | train_loss 6.098437e-01 | lr 1.271186e-06
07/02/2024 09:51:06 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11900/ 12000] | 4235/7664 batches | ms/batch 196.4203 | train_loss 6.107532e-01 | lr 8.474576e-07
07/02/2024 09:51:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11950/ 12000] | 4285/7664 batches | ms/batch 198.5473 | train_loss 6.119990e-01 | lr 4.237288e-07
07/02/2024 09:51:28 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 12000/ 12000] | 4335/7664 batches | ms/batch 196.7339 | train_loss 6.104128e-01 | lr 0.000000e+00
07/02/2024 09:51:28 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpbwhj1yxj at global_step 12000 ****
07/02/2024 09:51:29 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 09:51:30 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23821887/tmpbwhj1yxj
07/02/2024 09:51:32 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((490449, 32768)) with avr_nnz=80.0
07/02/2024 09:51:32 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
07/02/2024 10:01:56 - INFO - pecos.xmc.xtransformer.model - Constructed instance feature matrix with shape=(490449, 136677)
07/02/2024 10:02:38 - INFO - pecos.xmc.xtransformer.model - Hierarchical label tree for ranker: [8, 256, 8192, 670091]
07/02/2024 10:02:38 - INFO - pecos.xmc.xtransformer.model - Start training ranker...
07/02/2024 10:02:38 - INFO - pecos.xmc.base - Training Layer 0 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
07/02/2024 10:03:00 - INFO - pecos.xmc.base - Training Layer 1 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
07/02/2024 10:03:39 - INFO - pecos.xmc.base - Training Layer 2 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
07/02/2024 10:04:59 - INFO - pecos.xmc.base - Training Layer 3 of 4 Layers in HierarchicalMLModel, neg_mining=tfn+man..
07/02/2024 10:48:19 - INFO - pecos.xmc.xtransformer.model - Parameters saved to models/amazon-670k/bert1/param.json
07/02/2024 10:48:36 - INFO - pecos.xmc.xtransformer.model - Model saved to models/amazon-670k/bert1
07/02/2024 10:58:48 - INFO - __main__ - Setting random seed 0
07/02/2024 10:58:50 - INFO - __main__ - Loaded training feature matrix with shape=(490449, 135909)
07/02/2024 10:58:50 - INFO - __main__ - Loaded training label matrix with shape=(490449, 670091)
07/02/2024 10:58:52 - INFO - __main__ - Loaded 490449 training sequences
07/02/2024 10:59:06 - INFO - pecos.xmc.xtransformer.model - Hierarchical label tree: [128, 2048, 32768, 670091]
07/02/2024 10:59:06 - INFO - pecos.xmc.xtransformer.model - Fine-tune Transformers with nr_labels=[128, 2048, 32768]
07/02/2024 10:59:06 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn+man at level 0, nr_labels=128, avr_M_nnz=128
07/02/2024 10:59:09 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-uncased model from s3.
07/02/2024 10:59:09 - INFO - pecos.xmc.xtransformer.matcher - ***** Encoding data len=490449 truncation=128*****
07/02/2024 10:59:46 - INFO - pecos.xmc.xtransformer.matcher - ***** Finished with time cost=36.52008533477783 *****
07/02/2024 11:00:10 - INFO - pecos.xmc.xtransformer.matcher - trn tensors saved to /scratch/slurm_tmpdir/job_23821887/tmpfr3d9otf/X_trn.pt
07/02/2024 11:00:11 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 2
07/02/2024 11:00:12 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
07/02/2024 11:00:12 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
/home/ul/ul_student/ul_ruw26/.local/lib/python3.9/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
07/02/2024 11:00:12 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
07/02/2024 11:00:12 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 490449
07/02/2024 11:00:12 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 128
07/02/2024 11:00:12 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 1
07/02/2024 11:00:12 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
07/02/2024 11:00:12 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 64
07/02/2024 11:00:12 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
07/02/2024 11:00:12 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
07/02/2024 11:00:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][    50/  4000] |   49/7664 batches | ms/batch 265.4617 | train_loss 9.112195e-01 | lr 2.500000e-05
07/02/2024 11:00:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   100/  4000] |   99/7664 batches | ms/batch 191.9361 | train_loss 2.168999e-01 | lr 5.000000e-05
07/02/2024 11:00:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   150/  4000] |  149/7664 batches | ms/batch 192.1485 | train_loss 1.723793e-01 | lr 7.500000e-05
07/02/2024 11:01:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   200/  4000] |  199/7664 batches | ms/batch 192.6041 | train_loss 1.572844e-01 | lr 1.000000e-04
07/02/2024 11:01:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   250/  4000] |  249/7664 batches | ms/batch 192.6694 | train_loss 1.330690e-01 | lr 9.868421e-05
07/02/2024 11:01:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   300/  4000] |  299/7664 batches | ms/batch 193.0478 | train_loss 1.148108e-01 | lr 9.736842e-05
07/02/2024 11:01:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   350/  4000] |  349/7664 batches | ms/batch 193.3169 | train_loss 1.037288e-01 | lr 9.605263e-05
07/02/2024 11:01:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   400/  4000] |  399/7664 batches | ms/batch 193.2166 | train_loss 9.769368e-02 | lr 9.473684e-05
07/02/2024 11:01:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   450/  4000] |  449/7664 batches | ms/batch 193.9860 | train_loss 9.234211e-02 | lr 9.342105e-05
07/02/2024 11:02:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   500/  4000] |  499/7664 batches | ms/batch 193.5673 | train_loss 9.077804e-02 | lr 9.210526e-05
07/02/2024 11:02:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   550/  4000] |  549/7664 batches | ms/batch 193.6389 | train_loss 8.732636e-02 | lr 9.078947e-05
07/02/2024 11:02:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   600/  4000] |  599/7664 batches | ms/batch 194.1274 | train_loss 8.578190e-02 | lr 8.947368e-05
07/02/2024 11:02:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   650/  4000] |  649/7664 batches | ms/batch 194.1005 | train_loss 8.349961e-02 | lr 8.815789e-05
07/02/2024 11:02:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   700/  4000] |  699/7664 batches | ms/batch 194.0759 | train_loss 8.040685e-02 | lr 8.684211e-05
07/02/2024 11:03:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   750/  4000] |  749/7664 batches | ms/batch 194.2349 | train_loss 7.787901e-02 | lr 8.552632e-05
07/02/2024 11:03:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   800/  4000] |  799/7664 batches | ms/batch 194.3592 | train_loss 7.913539e-02 | lr 8.421053e-05
07/02/2024 11:03:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   850/  4000] |  849/7664 batches | ms/batch 194.3971 | train_loss 7.685640e-02 | lr 8.289474e-05
07/02/2024 11:03:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   900/  4000] |  899/7664 batches | ms/batch 194.2768 | train_loss 7.846150e-02 | lr 8.157895e-05
07/02/2024 11:03:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   950/  4000] |  949/7664 batches | ms/batch 197.5794 | train_loss 7.755184e-02 | lr 8.026316e-05
07/02/2024 11:03:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1000/  4000] |  999/7664 batches | ms/batch 196.2548 | train_loss 7.536433e-02 | lr 7.894737e-05
07/02/2024 11:03:55 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmppft76ipe at global_step 1000 ****
07/02/2024 11:03:55 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 11:04:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1050/  4000] | 1049/7664 batches | ms/batch 196.1429 | train_loss 7.651323e-02 | lr 7.763158e-05
07/02/2024 11:04:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1100/  4000] | 1099/7664 batches | ms/batch 196.9265 | train_loss 7.488606e-02 | lr 7.631579e-05
07/02/2024 11:04:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1150/  4000] | 1149/7664 batches | ms/batch 195.6286 | train_loss 7.486954e-02 | lr 7.500000e-05
07/02/2024 11:04:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1200/  4000] | 1199/7664 batches | ms/batch 195.7412 | train_loss 7.460447e-02 | lr 7.368421e-05
07/02/2024 11:04:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1250/  4000] | 1249/7664 batches | ms/batch 195.9727 | train_loss 7.349805e-02 | lr 7.236842e-05
07/02/2024 11:05:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1300/  4000] | 1299/7664 batches | ms/batch 196.1114 | train_loss 7.436371e-02 | lr 7.105263e-05
07/02/2024 11:05:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1350/  4000] | 1349/7664 batches | ms/batch 195.6125 | train_loss 7.308740e-02 | lr 6.973684e-05
07/02/2024 11:05:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1400/  4000] | 1399/7664 batches | ms/batch 196.2070 | train_loss 7.342940e-02 | lr 6.842105e-05
07/02/2024 11:05:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1450/  4000] | 1449/7664 batches | ms/batch 195.5242 | train_loss 7.143411e-02 | lr 6.710526e-05
07/02/2024 11:05:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1500/  4000] | 1499/7664 batches | ms/batch 195.9638 | train_loss 7.133377e-02 | lr 6.578947e-05
07/02/2024 11:05:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1550/  4000] | 1549/7664 batches | ms/batch 195.8338 | train_loss 7.130557e-02 | lr 6.447368e-05
07/02/2024 11:06:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1600/  4000] | 1599/7664 batches | ms/batch 195.7589 | train_loss 7.076473e-02 | lr 6.315789e-05
07/02/2024 11:06:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1650/  4000] | 1649/7664 batches | ms/batch 195.5516 | train_loss 7.077573e-02 | lr 6.184211e-05
07/02/2024 11:06:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1700/  4000] | 1699/7664 batches | ms/batch 196.8278 | train_loss 6.858421e-02 | lr 6.052632e-05
07/02/2024 11:06:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1750/  4000] | 1749/7664 batches | ms/batch 196.3386 | train_loss 7.101188e-02 | lr 5.921053e-05
07/02/2024 11:06:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1800/  4000] | 1799/7664 batches | ms/batch 196.4549 | train_loss 6.824340e-02 | lr 5.789474e-05
07/02/2024 11:07:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1850/  4000] | 1849/7664 batches | ms/batch 196.8367 | train_loss 6.832051e-02 | lr 5.657895e-05
07/02/2024 11:07:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1900/  4000] | 1899/7664 batches | ms/batch 195.5314 | train_loss 6.892496e-02 | lr 5.526316e-05
07/02/2024 11:07:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1950/  4000] | 1949/7664 batches | ms/batch 195.4208 | train_loss 6.820148e-02 | lr 5.394737e-05
07/02/2024 11:07:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2000/  4000] | 1999/7664 batches | ms/batch 196.6781 | train_loss 7.048903e-02 | lr 5.263158e-05
07/02/2024 11:07:33 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmppft76ipe at global_step 2000 ****
07/02/2024 11:07:33 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 11:07:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2050/  4000] | 2049/7664 batches | ms/batch 195.4914 | train_loss 6.791171e-02 | lr 5.131579e-05
07/02/2024 11:07:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2100/  4000] | 2099/7664 batches | ms/batch 195.2834 | train_loss 6.765332e-02 | lr 5.000000e-05
07/02/2024 11:08:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2150/  4000] | 2149/7664 batches | ms/batch 195.0056 | train_loss 6.702959e-02 | lr 4.868421e-05
07/02/2024 11:08:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2200/  4000] | 2199/7664 batches | ms/batch 195.8494 | train_loss 6.812465e-02 | lr 4.736842e-05
07/02/2024 11:08:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2250/  4000] | 2249/7664 batches | ms/batch 195.7761 | train_loss 6.698460e-02 | lr 4.605263e-05
07/02/2024 11:08:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2300/  4000] | 2299/7664 batches | ms/batch 196.2021 | train_loss 6.704282e-02 | lr 4.473684e-05
07/02/2024 11:08:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2350/  4000] | 2349/7664 batches | ms/batch 196.4152 | train_loss 6.692453e-02 | lr 4.342105e-05
07/02/2024 11:09:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2400/  4000] | 2399/7664 batches | ms/batch 195.8781 | train_loss 6.755794e-02 | lr 4.210526e-05
07/02/2024 11:09:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2450/  4000] | 2449/7664 batches | ms/batch 196.3918 | train_loss 6.768350e-02 | lr 4.078947e-05
07/02/2024 11:09:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2500/  4000] | 2499/7664 batches | ms/batch 195.8430 | train_loss 6.598670e-02 | lr 3.947368e-05
07/02/2024 11:09:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2550/  4000] | 2549/7664 batches | ms/batch 196.1992 | train_loss 6.669397e-02 | lr 3.815789e-05
07/02/2024 11:09:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2600/  4000] | 2599/7664 batches | ms/batch 196.6107 | train_loss 6.691421e-02 | lr 3.684211e-05
07/02/2024 11:09:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2650/  4000] | 2649/7664 batches | ms/batch 196.5147 | train_loss 6.643928e-02 | lr 3.552632e-05
07/02/2024 11:10:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2700/  4000] | 2699/7664 batches | ms/batch 196.3423 | train_loss 6.664775e-02 | lr 3.421053e-05
07/02/2024 11:10:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2750/  4000] | 2749/7664 batches | ms/batch 196.3476 | train_loss 6.517000e-02 | lr 3.289474e-05
07/02/2024 11:10:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2800/  4000] | 2799/7664 batches | ms/batch 196.5758 | train_loss 6.582295e-02 | lr 3.157895e-05
07/02/2024 11:10:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2850/  4000] | 2849/7664 batches | ms/batch 195.9890 | train_loss 6.534498e-02 | lr 3.026316e-05
07/02/2024 11:10:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2900/  4000] | 2899/7664 batches | ms/batch 196.2807 | train_loss 6.382493e-02 | lr 2.894737e-05
07/02/2024 11:11:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2950/  4000] | 2949/7664 batches | ms/batch 196.4946 | train_loss 6.584738e-02 | lr 2.763158e-05
07/02/2024 11:11:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3000/  4000] | 2999/7664 batches | ms/batch 228.1085 | train_loss 6.399984e-02 | lr 2.631579e-05
07/02/2024 11:11:12 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmppft76ipe at global_step 3000 ****
07/02/2024 11:11:13 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 11:11:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3050/  4000] | 3049/7664 batches | ms/batch 206.6263 | train_loss 6.562360e-02 | lr 2.500000e-05
07/02/2024 11:11:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3100/  4000] | 3099/7664 batches | ms/batch 196.4424 | train_loss 6.376357e-02 | lr 2.368421e-05
07/02/2024 11:11:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3150/  4000] | 3149/7664 batches | ms/batch 196.8596 | train_loss 6.357975e-02 | lr 2.236842e-05
07/02/2024 11:11:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3200/  4000] | 3199/7664 batches | ms/batch 195.9016 | train_loss 6.202931e-02 | lr 2.105263e-05
07/02/2024 11:12:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3250/  4000] | 3249/7664 batches | ms/batch 196.9275 | train_loss 6.435083e-02 | lr 1.973684e-05
07/02/2024 11:12:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3300/  4000] | 3299/7664 batches | ms/batch 197.1317 | train_loss 6.417456e-02 | lr 1.842105e-05
07/02/2024 11:12:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3350/  4000] | 3349/7664 batches | ms/batch 196.5688 | train_loss 6.578396e-02 | lr 1.710526e-05
07/02/2024 11:12:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3400/  4000] | 3399/7664 batches | ms/batch 196.6041 | train_loss 6.424290e-02 | lr 1.578947e-05
07/02/2024 11:12:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3450/  4000] | 3449/7664 batches | ms/batch 196.6458 | train_loss 6.305526e-02 | lr 1.447368e-05
07/02/2024 11:13:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3500/  4000] | 3499/7664 batches | ms/batch 196.6035 | train_loss 6.399351e-02 | lr 1.315789e-05
07/02/2024 11:13:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3550/  4000] | 3549/7664 batches | ms/batch 196.9271 | train_loss 6.298156e-02 | lr 1.184211e-05
07/02/2024 11:13:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3600/  4000] | 3599/7664 batches | ms/batch 195.6910 | train_loss 6.078172e-02 | lr 1.052632e-05
07/02/2024 11:13:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3650/  4000] | 3649/7664 batches | ms/batch 196.4040 | train_loss 6.269341e-02 | lr 9.210526e-06
07/02/2024 11:13:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3700/  4000] | 3699/7664 batches | ms/batch 196.0565 | train_loss 6.239035e-02 | lr 7.894737e-06
07/02/2024 11:13:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3750/  4000] | 3749/7664 batches | ms/batch 195.7529 | train_loss 6.291519e-02 | lr 6.578947e-06
07/02/2024 11:14:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3800/  4000] | 3799/7664 batches | ms/batch 195.6514 | train_loss 6.298401e-02 | lr 5.263158e-06
07/02/2024 11:14:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3850/  4000] | 3849/7664 batches | ms/batch 196.9512 | train_loss 6.250089e-02 | lr 3.947368e-06
07/02/2024 11:14:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3900/  4000] | 3899/7664 batches | ms/batch 195.8826 | train_loss 6.293120e-02 | lr 2.631579e-06
07/02/2024 11:14:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3950/  4000] | 3949/7664 batches | ms/batch 195.5750 | train_loss 6.251452e-02 | lr 1.315789e-06
07/02/2024 11:14:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  4000/  4000] | 3999/7664 batches | ms/batch 195.4877 | train_loss 6.182133e-02 | lr 0.000000e+00
07/02/2024 11:14:51 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmppft76ipe at global_step 4000 ****
07/02/2024 11:14:51 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 11:14:52 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23821887/tmppft76ipe
07/02/2024 11:14:53 - INFO - pecos.xmc.xtransformer.matcher - Predict on input text tensors(torch.Size([490449, 128])) in OVA mode
07/02/2024 11:14:53 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
07/02/2024 11:24:46 - INFO - pecos.xmc.xtransformer.matcher - Concatenating instance embeddings with features...
07/02/2024 11:24:56 - INFO - pecos.xmc.xtransformer.matcher - Start training concat_model of transformer matcher...
07/02/2024 11:26:56 - INFO - pecos.xmc.xtransformer.matcher - Using concat-only for transformer/concat ensemble of pred_csr
07/02/2024 11:27:11 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn+man at level 1, nr_labels=2048, avr_M_nnz=5.105221949682842
07/02/2024 11:27:12 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-uncased model from s3.
07/02/2024 11:27:43 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23821887/tmpfr3d9otf/X_trn.pt
07/02/2024 11:27:43 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
07/02/2024 11:31:37 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
07/02/2024 11:31:37 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 2
07/02/2024 11:31:37 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
07/02/2024 11:31:37 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
/home/ul/ul_student/ul_ruw26/.local/lib/python3.9/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
07/02/2024 11:31:56 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
07/02/2024 11:31:56 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 490449
07/02/2024 11:31:56 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 2048
07/02/2024 11:31:56 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 192
07/02/2024 11:31:56 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 1
07/02/2024 11:31:56 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
07/02/2024 11:31:56 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 64
07/02/2024 11:31:56 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
07/02/2024 11:31:56 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
07/02/2024 11:32:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][    50/  4000] |   49/7664 batches | ms/batch 213.5834 | train_loss 8.715567e-01 | lr 2.500000e-05
07/02/2024 11:32:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   100/  4000] |   99/7664 batches | ms/batch 192.9082 | train_loss 7.467486e-01 | lr 5.000000e-05
07/02/2024 11:32:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   150/  4000] |  149/7664 batches | ms/batch 194.4054 | train_loss 7.137236e-01 | lr 7.500000e-05
07/02/2024 11:32:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   200/  4000] |  199/7664 batches | ms/batch 194.6095 | train_loss 7.030249e-01 | lr 1.000000e-04
07/02/2024 11:33:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   250/  4000] |  249/7664 batches | ms/batch 194.9712 | train_loss 6.948527e-01 | lr 9.868421e-05
07/02/2024 11:33:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   300/  4000] |  299/7664 batches | ms/batch 197.2450 | train_loss 6.907485e-01 | lr 9.736842e-05
07/02/2024 11:33:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   350/  4000] |  349/7664 batches | ms/batch 196.6649 | train_loss 6.866986e-01 | lr 9.605263e-05
07/02/2024 11:33:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   400/  4000] |  399/7664 batches | ms/batch 197.3014 | train_loss 6.858008e-01 | lr 9.473684e-05
07/02/2024 11:33:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   450/  4000] |  449/7664 batches | ms/batch 194.6514 | train_loss 6.816804e-01 | lr 9.342105e-05
07/02/2024 11:33:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   500/  4000] |  499/7664 batches | ms/batch 196.1021 | train_loss 6.780087e-01 | lr 9.210526e-05
07/02/2024 11:34:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   550/  4000] |  549/7664 batches | ms/batch 197.9411 | train_loss 6.768495e-01 | lr 9.078947e-05
07/02/2024 11:34:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   600/  4000] |  599/7664 batches | ms/batch 196.1473 | train_loss 6.734879e-01 | lr 8.947368e-05
07/02/2024 11:34:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   650/  4000] |  649/7664 batches | ms/batch 196.2080 | train_loss 6.730279e-01 | lr 8.815789e-05
07/02/2024 11:34:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   700/  4000] |  699/7664 batches | ms/batch 196.4606 | train_loss 6.744373e-01 | lr 8.684211e-05
07/02/2024 11:34:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   750/  4000] |  749/7664 batches | ms/batch 195.5537 | train_loss 6.718750e-01 | lr 8.552632e-05
07/02/2024 11:35:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   800/  4000] |  799/7664 batches | ms/batch 196.3643 | train_loss 6.720842e-01 | lr 8.421053e-05
07/02/2024 11:35:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   850/  4000] |  849/7664 batches | ms/batch 196.3751 | train_loss 6.706906e-01 | lr 8.289474e-05
07/02/2024 11:35:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   900/  4000] |  899/7664 batches | ms/batch 196.7049 | train_loss 6.701460e-01 | lr 8.157895e-05
07/02/2024 11:35:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   950/  4000] |  949/7664 batches | ms/batch 196.0093 | train_loss 6.673619e-01 | lr 8.026316e-05
07/02/2024 11:35:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1000/  4000] |  999/7664 batches | ms/batch 196.8556 | train_loss 6.684158e-01 | lr 7.894737e-05
07/02/2024 11:35:48 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpuvkanl40 at global_step 1000 ****
07/02/2024 11:35:49 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 11:36:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1050/  4000] | 1049/7664 batches | ms/batch 196.6610 | train_loss 6.655390e-01 | lr 7.763158e-05
07/02/2024 11:36:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1100/  4000] | 1099/7664 batches | ms/batch 196.5378 | train_loss 6.656356e-01 | lr 7.631579e-05
07/02/2024 11:36:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1150/  4000] | 1149/7664 batches | ms/batch 196.2734 | train_loss 6.652005e-01 | lr 7.500000e-05
07/02/2024 11:36:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1200/  4000] | 1199/7664 batches | ms/batch 197.0399 | train_loss 6.645320e-01 | lr 7.368421e-05
07/02/2024 11:36:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1250/  4000] | 1249/7664 batches | ms/batch 197.0357 | train_loss 6.637672e-01 | lr 7.236842e-05
07/02/2024 11:36:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1300/  4000] | 1299/7664 batches | ms/batch 196.8509 | train_loss 6.649852e-01 | lr 7.105263e-05
07/02/2024 11:37:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1350/  4000] | 1349/7664 batches | ms/batch 196.8240 | train_loss 6.648005e-01 | lr 6.973684e-05
07/02/2024 11:37:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1400/  4000] | 1399/7664 batches | ms/batch 196.8595 | train_loss 6.636539e-01 | lr 6.842105e-05
07/02/2024 11:37:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1450/  4000] | 1449/7664 batches | ms/batch 196.9154 | train_loss 6.629879e-01 | lr 6.710526e-05
07/02/2024 11:37:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1500/  4000] | 1499/7664 batches | ms/batch 196.8921 | train_loss 6.621182e-01 | lr 6.578947e-05
07/02/2024 11:37:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1550/  4000] | 1549/7664 batches | ms/batch 196.8184 | train_loss 6.605653e-01 | lr 6.447368e-05
07/02/2024 11:38:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1600/  4000] | 1599/7664 batches | ms/batch 196.0842 | train_loss 6.611889e-01 | lr 6.315789e-05
07/02/2024 11:38:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1650/  4000] | 1649/7664 batches | ms/batch 196.3599 | train_loss 6.600162e-01 | lr 6.184211e-05
07/02/2024 11:38:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1700/  4000] | 1699/7664 batches | ms/batch 195.9079 | train_loss 6.608861e-01 | lr 6.052632e-05
07/02/2024 11:38:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1750/  4000] | 1749/7664 batches | ms/batch 195.6633 | train_loss 6.595693e-01 | lr 5.921053e-05
07/02/2024 11:38:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1800/  4000] | 1799/7664 batches | ms/batch 196.2457 | train_loss 6.602757e-01 | lr 5.789474e-05
07/02/2024 11:38:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1850/  4000] | 1849/7664 batches | ms/batch 196.8939 | train_loss 6.581732e-01 | lr 5.657895e-05
07/02/2024 11:39:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1900/  4000] | 1899/7664 batches | ms/batch 197.1327 | train_loss 6.600292e-01 | lr 5.526316e-05
07/02/2024 11:39:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1950/  4000] | 1949/7664 batches | ms/batch 196.8674 | train_loss 6.593791e-01 | lr 5.394737e-05
07/02/2024 11:39:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2000/  4000] | 1999/7664 batches | ms/batch 196.7796 | train_loss 6.573699e-01 | lr 5.263158e-05
07/02/2024 11:39:31 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpuvkanl40 at global_step 2000 ****
07/02/2024 11:39:31 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 11:39:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2050/  4000] | 2049/7664 batches | ms/batch 196.8346 | train_loss 6.585893e-01 | lr 5.131579e-05
07/02/2024 11:39:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2100/  4000] | 2099/7664 batches | ms/batch 198.8629 | train_loss 6.574755e-01 | lr 5.000000e-05
07/02/2024 11:40:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2150/  4000] | 2149/7664 batches | ms/batch 198.3585 | train_loss 6.562577e-01 | lr 4.868421e-05
07/02/2024 11:40:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2200/  4000] | 2199/7664 batches | ms/batch 197.6223 | train_loss 6.572425e-01 | lr 4.736842e-05
07/02/2024 11:40:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2250/  4000] | 2249/7664 batches | ms/batch 197.1115 | train_loss 6.553036e-01 | lr 4.605263e-05
07/02/2024 11:40:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2300/  4000] | 2299/7664 batches | ms/batch 198.9530 | train_loss 6.570066e-01 | lr 4.473684e-05
07/02/2024 11:40:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2350/  4000] | 2349/7664 batches | ms/batch 196.9260 | train_loss 6.565806e-01 | lr 4.342105e-05
07/02/2024 11:41:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2400/  4000] | 2399/7664 batches | ms/batch 196.9969 | train_loss 6.559919e-01 | lr 4.210526e-05
07/02/2024 11:41:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2450/  4000] | 2449/7664 batches | ms/batch 197.0635 | train_loss 6.537863e-01 | lr 4.078947e-05
07/02/2024 11:41:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2500/  4000] | 2499/7664 batches | ms/batch 196.3066 | train_loss 6.556940e-01 | lr 3.947368e-05
07/02/2024 11:41:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2550/  4000] | 2549/7664 batches | ms/batch 196.7537 | train_loss 6.541731e-01 | lr 3.815789e-05
07/02/2024 11:41:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2600/  4000] | 2599/7664 batches | ms/batch 197.1836 | train_loss 6.526831e-01 | lr 3.684211e-05
07/02/2024 11:41:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2650/  4000] | 2649/7664 batches | ms/batch 197.1419 | train_loss 6.563998e-01 | lr 3.552632e-05
07/02/2024 11:42:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2700/  4000] | 2699/7664 batches | ms/batch 197.0422 | train_loss 6.530549e-01 | lr 3.421053e-05
07/02/2024 11:42:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2750/  4000] | 2749/7664 batches | ms/batch 196.8674 | train_loss 6.536422e-01 | lr 3.289474e-05
07/02/2024 11:42:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2800/  4000] | 2799/7664 batches | ms/batch 197.0615 | train_loss 6.542900e-01 | lr 3.157895e-05
07/02/2024 11:42:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2850/  4000] | 2849/7664 batches | ms/batch 196.9672 | train_loss 6.527344e-01 | lr 3.026316e-05
07/02/2024 11:42:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2900/  4000] | 2899/7664 batches | ms/batch 196.2023 | train_loss 6.530346e-01 | lr 2.894737e-05
07/02/2024 11:43:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2950/  4000] | 2949/7664 batches | ms/batch 196.9445 | train_loss 6.528818e-01 | lr 2.763158e-05
07/02/2024 11:43:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3000/  4000] | 2999/7664 batches | ms/batch 195.8749 | train_loss 6.529864e-01 | lr 2.631579e-05
07/02/2024 11:43:14 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpuvkanl40 at global_step 3000 ****
07/02/2024 11:43:15 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 11:43:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3050/  4000] | 3049/7664 batches | ms/batch 196.2759 | train_loss 6.520430e-01 | lr 2.500000e-05
07/02/2024 11:43:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3100/  4000] | 3099/7664 batches | ms/batch 196.9923 | train_loss 6.517501e-01 | lr 2.368421e-05
07/02/2024 11:43:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3150/  4000] | 3149/7664 batches | ms/batch 195.9730 | train_loss 6.514367e-01 | lr 2.236842e-05
07/02/2024 11:43:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3200/  4000] | 3199/7664 batches | ms/batch 196.8358 | train_loss 6.518652e-01 | lr 2.105263e-05
07/02/2024 11:44:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3250/  4000] | 3249/7664 batches | ms/batch 196.1278 | train_loss 6.523764e-01 | lr 1.973684e-05
07/02/2024 11:44:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3300/  4000] | 3299/7664 batches | ms/batch 197.2690 | train_loss 6.517902e-01 | lr 1.842105e-05
07/02/2024 11:44:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3350/  4000] | 3349/7664 batches | ms/batch 196.8900 | train_loss 6.512377e-01 | lr 1.710526e-05
07/02/2024 11:44:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3400/  4000] | 3399/7664 batches | ms/batch 198.6700 | train_loss 6.517063e-01 | lr 1.578947e-05
07/02/2024 11:44:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3450/  4000] | 3449/7664 batches | ms/batch 197.3073 | train_loss 6.508346e-01 | lr 1.447368e-05
07/02/2024 11:45:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3500/  4000] | 3499/7664 batches | ms/batch 197.0671 | train_loss 6.500827e-01 | lr 1.315789e-05
07/02/2024 11:45:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3550/  4000] | 3549/7664 batches | ms/batch 197.0296 | train_loss 6.510752e-01 | lr 1.184211e-05
07/02/2024 11:45:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3600/  4000] | 3599/7664 batches | ms/batch 196.1950 | train_loss 6.501228e-01 | lr 1.052632e-05
07/02/2024 11:45:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3650/  4000] | 3649/7664 batches | ms/batch 197.1004 | train_loss 6.513247e-01 | lr 9.210526e-06
07/02/2024 11:45:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3700/  4000] | 3699/7664 batches | ms/batch 196.1163 | train_loss 6.506529e-01 | lr 7.894737e-06
07/02/2024 11:46:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3750/  4000] | 3749/7664 batches | ms/batch 196.8506 | train_loss 6.494800e-01 | lr 6.578947e-06
07/02/2024 11:46:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3800/  4000] | 3799/7664 batches | ms/batch 196.9708 | train_loss 6.498449e-01 | lr 5.263158e-06
07/02/2024 11:46:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3850/  4000] | 3849/7664 batches | ms/batch 196.8650 | train_loss 6.493685e-01 | lr 3.947368e-06
07/02/2024 11:46:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3900/  4000] | 3899/7664 batches | ms/batch 196.1639 | train_loss 6.478139e-01 | lr 2.631579e-06
07/02/2024 11:46:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3950/  4000] | 3949/7664 batches | ms/batch 196.8136 | train_loss 6.497231e-01 | lr 1.315789e-06
07/02/2024 11:46:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  4000/  4000] | 3999/7664 batches | ms/batch 196.8223 | train_loss 6.508666e-01 | lr 0.000000e+00
07/02/2024 11:46:57 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpuvkanl40 at global_step 4000 ****
07/02/2024 11:46:57 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 11:46:59 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23821887/tmpuvkanl40
07/02/2024 11:46:59 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((490449, 2048)) with avr_nnz=80.0
07/02/2024 11:46:59 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
07/02/2024 11:57:06 - INFO - pecos.xmc.xtransformer.matcher - Concatenating instance embeddings with features...
07/02/2024 11:57:16 - INFO - pecos.xmc.xtransformer.matcher - Start training concat_model of transformer matcher...
07/02/2024 11:58:41 - INFO - pecos.xmc.xtransformer.matcher - Using concat-only for transformer/concat ensemble of pred_csr
07/02/2024 11:58:51 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn+man at level 2, nr_labels=32768, avr_M_nnz=5.210582547828622
07/02/2024 11:58:53 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-uncased model from s3.
07/02/2024 11:59:21 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23821887/tmpfr3d9otf/X_trn.pt
07/02/2024 11:59:21 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
07/02/2024 12:01:02 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
07/02/2024 12:01:02 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 2
07/02/2024 12:01:02 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
07/02/2024 12:01:02 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
/home/ul/ul_student/ul_ruw26/.local/lib/python3.9/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
07/02/2024 12:01:20 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
07/02/2024 12:01:20 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 490449
07/02/2024 12:01:20 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 32768
07/02/2024 12:01:20 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 192
07/02/2024 12:01:20 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 2
07/02/2024 12:01:20 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
07/02/2024 12:01:20 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 64
07/02/2024 12:01:20 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
07/02/2024 12:01:20 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 12000
07/02/2024 12:01:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][    50/ 12000] |   49/7664 batches | ms/batch 201.9812 | train_loss 6.646328e-01 | lr 2.500000e-05
07/02/2024 12:01:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   100/ 12000] |   99/7664 batches | ms/batch 194.1334 | train_loss 6.662165e-01 | lr 5.000000e-05
07/02/2024 12:02:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   150/ 12000] |  149/7664 batches | ms/batch 196.6958 | train_loss 6.747275e-01 | lr 7.500000e-05
07/02/2024 12:02:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   200/ 12000] |  199/7664 batches | ms/batch 195.6502 | train_loss 6.829073e-01 | lr 1.000000e-04
07/02/2024 12:02:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   250/ 12000] |  249/7664 batches | ms/batch 195.3662 | train_loss 6.940559e-01 | lr 9.957627e-05
07/02/2024 12:02:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   300/ 12000] |  299/7664 batches | ms/batch 195.8826 | train_loss 6.883148e-01 | lr 9.915254e-05
07/02/2024 12:02:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   350/ 12000] |  349/7664 batches | ms/batch 195.6787 | train_loss 6.857929e-01 | lr 9.872881e-05
07/02/2024 12:02:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   400/ 12000] |  399/7664 batches | ms/batch 195.7793 | train_loss 6.896251e-01 | lr 9.830508e-05
07/02/2024 12:03:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   450/ 12000] |  449/7664 batches | ms/batch 195.3274 | train_loss 6.898492e-01 | lr 9.788136e-05
07/02/2024 12:03:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   500/ 12000] |  499/7664 batches | ms/batch 197.2323 | train_loss 6.853930e-01 | lr 9.745763e-05
07/02/2024 12:03:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   550/ 12000] |  549/7664 batches | ms/batch 196.7713 | train_loss 6.816243e-01 | lr 9.703390e-05
07/02/2024 12:03:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   600/ 12000] |  599/7664 batches | ms/batch 196.4542 | train_loss 6.773570e-01 | lr 9.661017e-05
07/02/2024 12:03:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   650/ 12000] |  649/7664 batches | ms/batch 195.6459 | train_loss 6.826619e-01 | lr 9.618644e-05
07/02/2024 12:04:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   700/ 12000] |  699/7664 batches | ms/batch 204.4770 | train_loss 6.813061e-01 | lr 9.576271e-05
07/02/2024 12:04:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   750/ 12000] |  749/7664 batches | ms/batch 196.7474 | train_loss 6.817433e-01 | lr 9.533898e-05
07/02/2024 12:04:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   800/ 12000] |  799/7664 batches | ms/batch 196.5389 | train_loss 6.783148e-01 | lr 9.491525e-05
07/02/2024 12:04:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   850/ 12000] |  849/7664 batches | ms/batch 199.0744 | train_loss 6.767910e-01 | lr 9.449153e-05
07/02/2024 12:04:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   900/ 12000] |  899/7664 batches | ms/batch 195.9636 | train_loss 6.771225e-01 | lr 9.406780e-05
07/02/2024 12:05:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   950/ 12000] |  949/7664 batches | ms/batch 196.1024 | train_loss 6.751155e-01 | lr 9.364407e-05
07/02/2024 12:05:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1000/ 12000] |  999/7664 batches | ms/batch 197.0288 | train_loss 6.739117e-01 | lr 9.322034e-05
07/02/2024 12:05:13 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmp0w_vczr0 at global_step 1000 ****
07/02/2024 12:05:13 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 12:05:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1050/ 12000] | 1049/7664 batches | ms/batch 196.9611 | train_loss 6.765690e-01 | lr 9.279661e-05
07/02/2024 12:05:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1100/ 12000] | 1099/7664 batches | ms/batch 197.1124 | train_loss 6.787964e-01 | lr 9.237288e-05
07/02/2024 12:05:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1150/ 12000] | 1149/7664 batches | ms/batch 197.0697 | train_loss 6.682464e-01 | lr 9.194915e-05
07/02/2024 12:05:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1200/ 12000] | 1199/7664 batches | ms/batch 196.8605 | train_loss 6.719305e-01 | lr 9.152542e-05
07/02/2024 12:06:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1250/ 12000] | 1249/7664 batches | ms/batch 198.8320 | train_loss 6.702384e-01 | lr 9.110169e-05
07/02/2024 12:06:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1300/ 12000] | 1299/7664 batches | ms/batch 202.4417 | train_loss 6.711763e-01 | lr 9.067797e-05
07/02/2024 12:06:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1350/ 12000] | 1349/7664 batches | ms/batch 197.0187 | train_loss 6.716899e-01 | lr 9.025424e-05
07/02/2024 12:06:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1400/ 12000] | 1399/7664 batches | ms/batch 197.1805 | train_loss 6.666188e-01 | lr 8.983051e-05
07/02/2024 12:06:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1450/ 12000] | 1449/7664 batches | ms/batch 197.0312 | train_loss 6.700424e-01 | lr 8.940678e-05
07/02/2024 12:07:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1500/ 12000] | 1499/7664 batches | ms/batch 197.0472 | train_loss 6.685384e-01 | lr 8.898305e-05
07/02/2024 12:07:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1550/ 12000] | 1549/7664 batches | ms/batch 195.6854 | train_loss 6.680606e-01 | lr 8.855932e-05
07/02/2024 12:07:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1600/ 12000] | 1599/7664 batches | ms/batch 197.0257 | train_loss 6.703982e-01 | lr 8.813559e-05
07/02/2024 12:07:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1650/ 12000] | 1649/7664 batches | ms/batch 197.1404 | train_loss 6.659981e-01 | lr 8.771186e-05
07/02/2024 12:07:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1700/ 12000] | 1699/7664 batches | ms/batch 196.3202 | train_loss 6.621050e-01 | lr 8.728814e-05
07/02/2024 12:08:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1750/ 12000] | 1749/7664 batches | ms/batch 197.2720 | train_loss 6.661249e-01 | lr 8.686441e-05
07/02/2024 12:08:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1800/ 12000] | 1799/7664 batches | ms/batch 197.0976 | train_loss 6.664898e-01 | lr 8.644068e-05
07/02/2024 12:08:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1850/ 12000] | 1849/7664 batches | ms/batch 196.1670 | train_loss 6.639316e-01 | lr 8.601695e-05
07/02/2024 12:08:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1900/ 12000] | 1899/7664 batches | ms/batch 197.0123 | train_loss 6.619779e-01 | lr 8.559322e-05
07/02/2024 12:08:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1950/ 12000] | 1949/7664 batches | ms/batch 197.1883 | train_loss 6.614073e-01 | lr 8.516949e-05
07/02/2024 12:08:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2000/ 12000] | 1999/7664 batches | ms/batch 197.1013 | train_loss 6.622353e-01 | lr 8.474576e-05
07/02/2024 12:08:56 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmp0w_vczr0 at global_step 2000 ****
07/02/2024 12:08:57 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 12:09:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2050/ 12000] | 2049/7664 batches | ms/batch 199.0253 | train_loss 6.638004e-01 | lr 8.432203e-05
07/02/2024 12:09:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2100/ 12000] | 2099/7664 batches | ms/batch 196.9024 | train_loss 6.602176e-01 | lr 8.389831e-05
07/02/2024 12:09:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2150/ 12000] | 2149/7664 batches | ms/batch 197.1949 | train_loss 6.640267e-01 | lr 8.347458e-05
07/02/2024 12:09:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2200/ 12000] | 2199/7664 batches | ms/batch 195.8239 | train_loss 6.619295e-01 | lr 8.305085e-05
07/02/2024 12:09:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2250/ 12000] | 2249/7664 batches | ms/batch 197.1639 | train_loss 6.597227e-01 | lr 8.262712e-05
07/02/2024 12:10:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2300/ 12000] | 2299/7664 batches | ms/batch 197.1219 | train_loss 6.591970e-01 | lr 8.220339e-05
07/02/2024 12:10:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2350/ 12000] | 2349/7664 batches | ms/batch 197.1279 | train_loss 6.576375e-01 | lr 8.177966e-05
07/02/2024 12:10:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2400/ 12000] | 2399/7664 batches | ms/batch 197.0617 | train_loss 6.599791e-01 | lr 8.135593e-05
07/02/2024 12:10:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2450/ 12000] | 2449/7664 batches | ms/batch 197.1772 | train_loss 6.591600e-01 | lr 8.093220e-05
07/02/2024 12:10:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2500/ 12000] | 2499/7664 batches | ms/batch 197.0709 | train_loss 6.577600e-01 | lr 8.050847e-05
07/02/2024 12:10:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2550/ 12000] | 2549/7664 batches | ms/batch 197.1480 | train_loss 6.579568e-01 | lr 8.008475e-05
07/02/2024 12:11:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2600/ 12000] | 2599/7664 batches | ms/batch 196.4625 | train_loss 6.565606e-01 | lr 7.966102e-05
07/02/2024 12:11:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2650/ 12000] | 2649/7664 batches | ms/batch 197.4310 | train_loss 6.552514e-01 | lr 7.923729e-05
07/02/2024 12:11:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2700/ 12000] | 2699/7664 batches | ms/batch 196.9000 | train_loss 6.553234e-01 | lr 7.881356e-05
07/02/2024 12:11:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2750/ 12000] | 2749/7664 batches | ms/batch 198.9607 | train_loss 6.589159e-01 | lr 7.838983e-05
07/02/2024 12:11:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2800/ 12000] | 2799/7664 batches | ms/batch 197.1350 | train_loss 6.550130e-01 | lr 7.796610e-05
07/02/2024 12:12:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2850/ 12000] | 2849/7664 batches | ms/batch 197.2689 | train_loss 6.566900e-01 | lr 7.754237e-05
07/02/2024 12:12:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2900/ 12000] | 2899/7664 batches | ms/batch 197.2075 | train_loss 6.559825e-01 | lr 7.711864e-05
07/02/2024 12:12:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2950/ 12000] | 2949/7664 batches | ms/batch 199.1117 | train_loss 6.540796e-01 | lr 7.669492e-05
07/02/2024 12:12:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3000/ 12000] | 2999/7664 batches | ms/batch 196.9325 | train_loss 6.547354e-01 | lr 7.627119e-05
07/02/2024 12:12:40 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmp0w_vczr0 at global_step 3000 ****
07/02/2024 12:12:40 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 12:12:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3050/ 12000] | 3049/7664 batches | ms/batch 196.0604 | train_loss 6.537425e-01 | lr 7.584746e-05
07/02/2024 12:13:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3100/ 12000] | 3099/7664 batches | ms/batch 196.2087 | train_loss 6.570295e-01 | lr 7.542373e-05
07/02/2024 12:13:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3150/ 12000] | 3149/7664 batches | ms/batch 196.2979 | train_loss 6.527365e-01 | lr 7.500000e-05
07/02/2024 12:13:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3200/ 12000] | 3199/7664 batches | ms/batch 197.1527 | train_loss 6.535827e-01 | lr 7.457627e-05
07/02/2024 12:13:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3250/ 12000] | 3249/7664 batches | ms/batch 196.9483 | train_loss 6.514604e-01 | lr 7.415254e-05
07/02/2024 12:13:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3300/ 12000] | 3299/7664 batches | ms/batch 197.1140 | train_loss 6.514652e-01 | lr 7.372881e-05
07/02/2024 12:13:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3350/ 12000] | 3349/7664 batches | ms/batch 197.1812 | train_loss 6.518673e-01 | lr 7.330508e-05
07/02/2024 12:14:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3400/ 12000] | 3399/7664 batches | ms/batch 197.0212 | train_loss 6.524603e-01 | lr 7.288136e-05
07/02/2024 12:14:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3450/ 12000] | 3449/7664 batches | ms/batch 196.2385 | train_loss 6.515507e-01 | lr 7.245763e-05
07/02/2024 12:14:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3500/ 12000] | 3499/7664 batches | ms/batch 196.4204 | train_loss 6.494853e-01 | lr 7.203390e-05
07/02/2024 12:14:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3550/ 12000] | 3549/7664 batches | ms/batch 197.1517 | train_loss 6.504080e-01 | lr 7.161017e-05
07/02/2024 12:14:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3600/ 12000] | 3599/7664 batches | ms/batch 195.7664 | train_loss 6.506407e-01 | lr 7.118644e-05
07/02/2024 12:15:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3650/ 12000] | 3649/7664 batches | ms/batch 197.1421 | train_loss 6.514799e-01 | lr 7.076271e-05
07/02/2024 12:15:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3700/ 12000] | 3699/7664 batches | ms/batch 196.2254 | train_loss 6.500634e-01 | lr 7.033898e-05
07/02/2024 12:15:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3750/ 12000] | 3749/7664 batches | ms/batch 197.2909 | train_loss 6.504162e-01 | lr 6.991525e-05
07/02/2024 12:15:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3800/ 12000] | 3799/7664 batches | ms/batch 199.1050 | train_loss 6.491187e-01 | lr 6.949153e-05
07/02/2024 12:15:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3850/ 12000] | 3849/7664 batches | ms/batch 197.1241 | train_loss 6.479307e-01 | lr 6.906780e-05
07/02/2024 12:16:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3900/ 12000] | 3899/7664 batches | ms/batch 199.7908 | train_loss 6.473442e-01 | lr 6.864407e-05
07/02/2024 12:16:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3950/ 12000] | 3949/7664 batches | ms/batch 201.3982 | train_loss 6.479245e-01 | lr 6.822034e-05
07/02/2024 12:16:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4000/ 12000] | 3999/7664 batches | ms/batch 196.9600 | train_loss 6.463083e-01 | lr 6.779661e-05
07/02/2024 12:16:23 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmp0w_vczr0 at global_step 4000 ****
07/02/2024 12:16:24 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 12:16:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4050/ 12000] | 4049/7664 batches | ms/batch 200.5270 | train_loss 6.479531e-01 | lr 6.737288e-05
07/02/2024 12:16:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4100/ 12000] | 4099/7664 batches | ms/batch 197.1370 | train_loss 6.473965e-01 | lr 6.694915e-05
07/02/2024 12:16:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4150/ 12000] | 4149/7664 batches | ms/batch 197.3019 | train_loss 6.483526e-01 | lr 6.652542e-05
07/02/2024 12:17:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4200/ 12000] | 4199/7664 batches | ms/batch 198.2029 | train_loss 6.464586e-01 | lr 6.610169e-05
07/02/2024 12:17:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4250/ 12000] | 4249/7664 batches | ms/batch 196.1010 | train_loss 6.458095e-01 | lr 6.567797e-05
07/02/2024 12:17:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4300/ 12000] | 4299/7664 batches | ms/batch 196.9891 | train_loss 6.441078e-01 | lr 6.525424e-05
07/02/2024 12:17:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4350/ 12000] | 4349/7664 batches | ms/batch 196.4537 | train_loss 6.439681e-01 | lr 6.483051e-05
07/02/2024 12:17:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4400/ 12000] | 4399/7664 batches | ms/batch 197.2803 | train_loss 6.483585e-01 | lr 6.440678e-05
07/02/2024 12:18:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4450/ 12000] | 4449/7664 batches | ms/batch 197.2348 | train_loss 6.459811e-01 | lr 6.398305e-05
07/02/2024 12:18:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4500/ 12000] | 4499/7664 batches | ms/batch 196.9196 | train_loss 6.459767e-01 | lr 6.355932e-05
07/02/2024 12:18:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4550/ 12000] | 4549/7664 batches | ms/batch 197.1917 | train_loss 6.456139e-01 | lr 6.313559e-05
07/02/2024 12:18:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4600/ 12000] | 4599/7664 batches | ms/batch 197.1399 | train_loss 6.454261e-01 | lr 6.271186e-05
07/02/2024 12:18:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4650/ 12000] | 4649/7664 batches | ms/batch 197.0670 | train_loss 6.430827e-01 | lr 6.228814e-05
07/02/2024 12:19:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4700/ 12000] | 4699/7664 batches | ms/batch 196.9465 | train_loss 6.437028e-01 | lr 6.186441e-05
07/02/2024 12:19:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4750/ 12000] | 4749/7664 batches | ms/batch 197.1248 | train_loss 6.443731e-01 | lr 6.144068e-05
07/02/2024 12:19:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4800/ 12000] | 4799/7664 batches | ms/batch 197.3301 | train_loss 6.433932e-01 | lr 6.101695e-05
07/02/2024 12:19:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4850/ 12000] | 4849/7664 batches | ms/batch 196.9456 | train_loss 6.418725e-01 | lr 6.059322e-05
07/02/2024 12:19:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4900/ 12000] | 4899/7664 batches | ms/batch 197.0138 | train_loss 6.428632e-01 | lr 6.016949e-05
07/02/2024 12:19:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4950/ 12000] | 4949/7664 batches | ms/batch 199.9121 | train_loss 6.421765e-01 | lr 5.974576e-05
07/02/2024 12:20:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5000/ 12000] | 4999/7664 batches | ms/batch 197.1542 | train_loss 6.443611e-01 | lr 5.932203e-05
07/02/2024 12:20:07 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmp0w_vczr0 at global_step 5000 ****
07/02/2024 12:20:07 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 12:20:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5050/ 12000] | 5049/7664 batches | ms/batch 196.0570 | train_loss 6.406535e-01 | lr 5.889831e-05
07/02/2024 12:20:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5100/ 12000] | 5099/7664 batches | ms/batch 196.1729 | train_loss 6.420874e-01 | lr 5.847458e-05
07/02/2024 12:20:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5150/ 12000] | 5149/7664 batches | ms/batch 196.9220 | train_loss 6.395635e-01 | lr 5.805085e-05
07/02/2024 12:20:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5200/ 12000] | 5199/7664 batches | ms/batch 195.8453 | train_loss 6.402096e-01 | lr 5.762712e-05
07/02/2024 12:21:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5250/ 12000] | 5249/7664 batches | ms/batch 198.7805 | train_loss 6.412112e-01 | lr 5.720339e-05
07/02/2024 12:21:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5300/ 12000] | 5299/7664 batches | ms/batch 195.8077 | train_loss 6.391926e-01 | lr 5.677966e-05
07/02/2024 12:21:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5350/ 12000] | 5349/7664 batches | ms/batch 197.4893 | train_loss 6.392293e-01 | lr 5.635593e-05
07/02/2024 12:21:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5400/ 12000] | 5399/7664 batches | ms/batch 195.5530 | train_loss 6.402325e-01 | lr 5.593220e-05
07/02/2024 12:21:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5450/ 12000] | 5449/7664 batches | ms/batch 196.9490 | train_loss 6.424757e-01 | lr 5.550847e-05
07/02/2024 12:21:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5500/ 12000] | 5499/7664 batches | ms/batch 196.6851 | train_loss 6.399716e-01 | lr 5.508475e-05
07/02/2024 12:22:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5550/ 12000] | 5549/7664 batches | ms/batch 196.2333 | train_loss 6.382927e-01 | lr 5.466102e-05
07/02/2024 12:22:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5600/ 12000] | 5599/7664 batches | ms/batch 196.9527 | train_loss 6.394075e-01 | lr 5.423729e-05
07/02/2024 12:22:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5650/ 12000] | 5649/7664 batches | ms/batch 196.7113 | train_loss 6.382258e-01 | lr 5.381356e-05
07/02/2024 12:22:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5700/ 12000] | 5699/7664 batches | ms/batch 196.4738 | train_loss 6.404628e-01 | lr 5.338983e-05
07/02/2024 12:22:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5750/ 12000] | 5749/7664 batches | ms/batch 196.0795 | train_loss 6.398001e-01 | lr 5.296610e-05
07/02/2024 12:23:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5800/ 12000] | 5799/7664 batches | ms/batch 196.9722 | train_loss 6.389843e-01 | lr 5.254237e-05
07/02/2024 12:23:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5850/ 12000] | 5849/7664 batches | ms/batch 196.3862 | train_loss 6.371356e-01 | lr 5.211864e-05
07/02/2024 12:23:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5900/ 12000] | 5899/7664 batches | ms/batch 197.3371 | train_loss 6.391187e-01 | lr 5.169492e-05
07/02/2024 12:23:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5950/ 12000] | 5949/7664 batches | ms/batch 197.5292 | train_loss 6.381645e-01 | lr 5.127119e-05
07/02/2024 12:23:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6000/ 12000] | 5999/7664 batches | ms/batch 197.3855 | train_loss 6.348203e-01 | lr 5.084746e-05
07/02/2024 12:23:50 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmp0w_vczr0 at global_step 6000 ****
07/02/2024 12:23:50 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 12:24:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6050/ 12000] | 6049/7664 batches | ms/batch 198.0789 | train_loss 6.373114e-01 | lr 5.042373e-05
07/02/2024 12:24:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6100/ 12000] | 6099/7664 batches | ms/batch 197.8736 | train_loss 6.374626e-01 | lr 5.000000e-05
07/02/2024 12:24:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6150/ 12000] | 6149/7664 batches | ms/batch 196.7592 | train_loss 6.363843e-01 | lr 4.957627e-05
07/02/2024 12:24:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6200/ 12000] | 6199/7664 batches | ms/batch 199.2283 | train_loss 6.359121e-01 | lr 4.915254e-05
07/02/2024 12:24:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6250/ 12000] | 6249/7664 batches | ms/batch 197.1962 | train_loss 6.369813e-01 | lr 4.872881e-05
07/02/2024 12:24:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6300/ 12000] | 6299/7664 batches | ms/batch 197.4479 | train_loss 6.355885e-01 | lr 4.830508e-05
07/02/2024 12:25:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6350/ 12000] | 6349/7664 batches | ms/batch 197.2061 | train_loss 6.347294e-01 | lr 4.788136e-05
07/02/2024 12:25:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6400/ 12000] | 6399/7664 batches | ms/batch 196.1669 | train_loss 6.362198e-01 | lr 4.745763e-05
07/02/2024 12:25:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6450/ 12000] | 6449/7664 batches | ms/batch 197.0260 | train_loss 6.359331e-01 | lr 4.703390e-05
07/02/2024 12:25:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6500/ 12000] | 6499/7664 batches | ms/batch 195.9813 | train_loss 6.352113e-01 | lr 4.661017e-05
07/02/2024 12:25:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6550/ 12000] | 6549/7664 batches | ms/batch 197.7529 | train_loss 6.329113e-01 | lr 4.618644e-05
07/02/2024 12:26:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6600/ 12000] | 6599/7664 batches | ms/batch 195.8968 | train_loss 6.353163e-01 | lr 4.576271e-05
07/02/2024 12:26:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6650/ 12000] | 6649/7664 batches | ms/batch 196.2156 | train_loss 6.365090e-01 | lr 4.533898e-05
07/02/2024 12:26:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6700/ 12000] | 6699/7664 batches | ms/batch 196.1832 | train_loss 6.347028e-01 | lr 4.491525e-05
07/02/2024 12:26:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6750/ 12000] | 6749/7664 batches | ms/batch 196.9374 | train_loss 6.359789e-01 | lr 4.449153e-05
07/02/2024 12:26:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6800/ 12000] | 6799/7664 batches | ms/batch 197.2872 | train_loss 6.344908e-01 | lr 4.406780e-05
07/02/2024 12:27:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6850/ 12000] | 6849/7664 batches | ms/batch 197.1063 | train_loss 6.334607e-01 | lr 4.364407e-05
07/02/2024 12:27:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6900/ 12000] | 6899/7664 batches | ms/batch 198.8142 | train_loss 6.329397e-01 | lr 4.322034e-05
07/02/2024 12:27:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6950/ 12000] | 6949/7664 batches | ms/batch 196.0644 | train_loss 6.322843e-01 | lr 4.279661e-05
07/02/2024 12:27:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7000/ 12000] | 6999/7664 batches | ms/batch 196.9281 | train_loss 6.338114e-01 | lr 4.237288e-05
07/02/2024 12:27:33 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmp0w_vczr0 at global_step 7000 ****
07/02/2024 12:27:34 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 12:27:45 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7050/ 12000] | 7049/7664 batches | ms/batch 197.0472 | train_loss 6.328799e-01 | lr 4.194915e-05
07/02/2024 12:27:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7100/ 12000] | 7099/7664 batches | ms/batch 196.2698 | train_loss 6.322617e-01 | lr 4.152542e-05
07/02/2024 12:28:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7150/ 12000] | 7149/7664 batches | ms/batch 197.2334 | train_loss 6.331498e-01 | lr 4.110169e-05
07/02/2024 12:28:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7200/ 12000] | 7199/7664 batches | ms/batch 196.1615 | train_loss 6.322749e-01 | lr 4.067797e-05
07/02/2024 12:28:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7250/ 12000] | 7249/7664 batches | ms/batch 196.9842 | train_loss 6.316441e-01 | lr 4.025424e-05
07/02/2024 12:28:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7300/ 12000] | 7299/7664 batches | ms/batch 196.9228 | train_loss 6.319252e-01 | lr 3.983051e-05
07/02/2024 12:28:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7350/ 12000] | 7349/7664 batches | ms/batch 196.2975 | train_loss 6.316611e-01 | lr 3.940678e-05
07/02/2024 12:29:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7400/ 12000] | 7399/7664 batches | ms/batch 195.8830 | train_loss 6.333471e-01 | lr 3.898305e-05
07/02/2024 12:29:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7450/ 12000] | 7449/7664 batches | ms/batch 196.3594 | train_loss 6.318766e-01 | lr 3.855932e-05
07/02/2024 12:29:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7500/ 12000] | 7499/7664 batches | ms/batch 198.0881 | train_loss 6.299877e-01 | lr 3.813559e-05
07/02/2024 12:29:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7550/ 12000] | 7549/7664 batches | ms/batch 196.8386 | train_loss 6.330528e-01 | lr 3.771186e-05
07/02/2024 12:29:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7600/ 12000] | 7599/7664 batches | ms/batch 195.7182 | train_loss 6.303313e-01 | lr 3.728814e-05
07/02/2024 12:29:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7650/ 12000] | 7649/7664 batches | ms/batch 197.0369 | train_loss 6.316516e-01 | lr 3.686441e-05
07/02/2024 12:30:20 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  7700/ 12000] |   35/7664 batches | ms/batch 195.1550 | train_loss 6.220485e-01 | lr 3.644068e-05
07/02/2024 12:30:31 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  7750/ 12000] |   85/7664 batches | ms/batch 199.0816 | train_loss 6.185492e-01 | lr 3.601695e-05
07/02/2024 12:30:42 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  7800/ 12000] |  135/7664 batches | ms/batch 196.4520 | train_loss 6.187136e-01 | lr 3.559322e-05
07/02/2024 12:30:53 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  7850/ 12000] |  185/7664 batches | ms/batch 196.8549 | train_loss 6.192989e-01 | lr 3.516949e-05
07/02/2024 12:31:04 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  7900/ 12000] |  235/7664 batches | ms/batch 196.8217 | train_loss 6.207145e-01 | lr 3.474576e-05
07/02/2024 12:31:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  7950/ 12000] |  285/7664 batches | ms/batch 196.9526 | train_loss 6.177441e-01 | lr 3.432203e-05
07/02/2024 12:31:26 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8000/ 12000] |  335/7664 batches | ms/batch 196.9381 | train_loss 6.188804e-01 | lr 3.389831e-05
07/02/2024 12:31:26 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmp0w_vczr0 at global_step 8000 ****
07/02/2024 12:31:27 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 12:31:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8050/ 12000] |  385/7664 batches | ms/batch 196.0402 | train_loss 6.178861e-01 | lr 3.347458e-05
07/02/2024 12:31:50 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8100/ 12000] |  435/7664 batches | ms/batch 196.5878 | train_loss 6.197559e-01 | lr 3.305085e-05
07/02/2024 12:32:01 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8150/ 12000] |  485/7664 batches | ms/batch 196.1377 | train_loss 6.176364e-01 | lr 3.262712e-05
07/02/2024 12:32:12 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8200/ 12000] |  535/7664 batches | ms/batch 196.2260 | train_loss 6.190926e-01 | lr 3.220339e-05
07/02/2024 12:32:23 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8250/ 12000] |  585/7664 batches | ms/batch 196.9822 | train_loss 6.166263e-01 | lr 3.177966e-05
07/02/2024 12:32:34 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8300/ 12000] |  635/7664 batches | ms/batch 196.3965 | train_loss 6.195188e-01 | lr 3.135593e-05
07/02/2024 12:32:45 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8350/ 12000] |  685/7664 batches | ms/batch 197.1221 | train_loss 6.162611e-01 | lr 3.093220e-05
07/02/2024 12:32:56 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8400/ 12000] |  735/7664 batches | ms/batch 196.9370 | train_loss 6.164221e-01 | lr 3.050847e-05
07/02/2024 12:33:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8450/ 12000] |  785/7664 batches | ms/batch 196.9138 | train_loss 6.160066e-01 | lr 3.008475e-05
07/02/2024 12:33:18 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8500/ 12000] |  835/7664 batches | ms/batch 196.9556 | train_loss 6.168184e-01 | lr 2.966102e-05
07/02/2024 12:33:30 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8550/ 12000] |  885/7664 batches | ms/batch 198.5082 | train_loss 6.167989e-01 | lr 2.923729e-05
07/02/2024 12:33:41 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8600/ 12000] |  935/7664 batches | ms/batch 195.7226 | train_loss 6.178485e-01 | lr 2.881356e-05
07/02/2024 12:33:52 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8650/ 12000] |  985/7664 batches | ms/batch 197.2076 | train_loss 6.182897e-01 | lr 2.838983e-05
07/02/2024 12:34:03 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8700/ 12000] | 1035/7664 batches | ms/batch 196.9537 | train_loss 6.177531e-01 | lr 2.796610e-05
07/02/2024 12:34:14 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8750/ 12000] | 1085/7664 batches | ms/batch 197.0884 | train_loss 6.164209e-01 | lr 2.754237e-05
07/02/2024 12:34:25 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8800/ 12000] | 1135/7664 batches | ms/batch 197.0415 | train_loss 6.171077e-01 | lr 2.711864e-05
07/02/2024 12:34:36 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8850/ 12000] | 1185/7664 batches | ms/batch 199.0233 | train_loss 6.159032e-01 | lr 2.669492e-05
07/02/2024 12:34:47 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8900/ 12000] | 1235/7664 batches | ms/batch 196.9228 | train_loss 6.167385e-01 | lr 2.627119e-05
07/02/2024 12:34:58 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8950/ 12000] | 1285/7664 batches | ms/batch 196.8633 | train_loss 6.166997e-01 | lr 2.584746e-05
07/02/2024 12:35:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9000/ 12000] | 1335/7664 batches | ms/batch 196.1270 | train_loss 6.152340e-01 | lr 2.542373e-05
07/02/2024 12:35:10 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmp0w_vczr0 at global_step 9000 ****
07/02/2024 12:35:10 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 12:35:21 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9050/ 12000] | 1385/7664 batches | ms/batch 196.9142 | train_loss 6.162890e-01 | lr 2.500000e-05
07/02/2024 12:35:33 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9100/ 12000] | 1435/7664 batches | ms/batch 196.4212 | train_loss 6.165622e-01 | lr 2.457627e-05
07/02/2024 12:35:44 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9150/ 12000] | 1485/7664 batches | ms/batch 197.1004 | train_loss 6.143192e-01 | lr 2.415254e-05
07/02/2024 12:35:55 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9200/ 12000] | 1535/7664 batches | ms/batch 196.5193 | train_loss 6.139678e-01 | lr 2.372881e-05
07/02/2024 12:36:06 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9250/ 12000] | 1585/7664 batches | ms/batch 196.9707 | train_loss 6.147042e-01 | lr 2.330508e-05
07/02/2024 12:36:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9300/ 12000] | 1635/7664 batches | ms/batch 201.0418 | train_loss 6.133231e-01 | lr 2.288136e-05
07/02/2024 12:36:28 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9350/ 12000] | 1685/7664 batches | ms/batch 196.2799 | train_loss 6.140207e-01 | lr 2.245763e-05
07/02/2024 12:36:40 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9400/ 12000] | 1735/7664 batches | ms/batch 196.9148 | train_loss 6.160641e-01 | lr 2.203390e-05
07/02/2024 12:36:51 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9450/ 12000] | 1785/7664 batches | ms/batch 197.2312 | train_loss 6.142111e-01 | lr 2.161017e-05
07/02/2024 12:37:02 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9500/ 12000] | 1835/7664 batches | ms/batch 195.8287 | train_loss 6.144446e-01 | lr 2.118644e-05
07/02/2024 12:37:13 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9550/ 12000] | 1885/7664 batches | ms/batch 197.4149 | train_loss 6.160346e-01 | lr 2.076271e-05
07/02/2024 12:37:24 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9600/ 12000] | 1935/7664 batches | ms/batch 196.7505 | train_loss 6.146536e-01 | lr 2.033898e-05
07/02/2024 12:37:35 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9650/ 12000] | 1985/7664 batches | ms/batch 196.8180 | train_loss 6.142065e-01 | lr 1.991525e-05
07/02/2024 12:37:46 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9700/ 12000] | 2035/7664 batches | ms/batch 196.9522 | train_loss 6.143268e-01 | lr 1.949153e-05
07/02/2024 12:37:57 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9750/ 12000] | 2085/7664 batches | ms/batch 197.1527 | train_loss 6.166133e-01 | lr 1.906780e-05
07/02/2024 12:38:08 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9800/ 12000] | 2135/7664 batches | ms/batch 196.9499 | train_loss 6.153014e-01 | lr 1.864407e-05
07/02/2024 12:38:20 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9850/ 12000] | 2185/7664 batches | ms/batch 196.3975 | train_loss 6.131266e-01 | lr 1.822034e-05
07/02/2024 12:38:31 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9900/ 12000] | 2235/7664 batches | ms/batch 197.0402 | train_loss 6.131076e-01 | lr 1.779661e-05
07/02/2024 12:38:42 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9950/ 12000] | 2285/7664 batches | ms/batch 196.2672 | train_loss 6.146467e-01 | lr 1.737288e-05
07/02/2024 12:38:53 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10000/ 12000] | 2335/7664 batches | ms/batch 196.1949 | train_loss 6.130051e-01 | lr 1.694915e-05
07/02/2024 12:38:53 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmp0w_vczr0 at global_step 10000 ****
07/02/2024 12:38:54 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 12:39:05 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10050/ 12000] | 2385/7664 batches | ms/batch 196.9265 | train_loss 6.139910e-01 | lr 1.652542e-05
07/02/2024 12:39:16 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10100/ 12000] | 2435/7664 batches | ms/batch 197.0578 | train_loss 6.155126e-01 | lr 1.610169e-05
07/02/2024 12:39:27 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10150/ 12000] | 2485/7664 batches | ms/batch 197.2043 | train_loss 6.127323e-01 | lr 1.567797e-05
07/02/2024 12:39:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10200/ 12000] | 2535/7664 batches | ms/batch 197.2288 | train_loss 6.141015e-01 | lr 1.525424e-05
07/02/2024 12:39:50 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10250/ 12000] | 2585/7664 batches | ms/batch 195.7057 | train_loss 6.116049e-01 | lr 1.483051e-05
07/02/2024 12:40:01 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10300/ 12000] | 2635/7664 batches | ms/batch 196.2125 | train_loss 6.128896e-01 | lr 1.440678e-05
07/02/2024 12:40:12 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10350/ 12000] | 2685/7664 batches | ms/batch 196.1763 | train_loss 6.135897e-01 | lr 1.398305e-05
07/02/2024 12:40:23 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10400/ 12000] | 2735/7664 batches | ms/batch 197.1774 | train_loss 6.137353e-01 | lr 1.355932e-05
07/02/2024 12:40:34 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10450/ 12000] | 2785/7664 batches | ms/batch 197.3560 | train_loss 6.145989e-01 | lr 1.313559e-05
07/02/2024 12:40:45 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10500/ 12000] | 2835/7664 batches | ms/batch 197.0625 | train_loss 6.130604e-01 | lr 1.271186e-05
07/02/2024 12:40:56 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10550/ 12000] | 2885/7664 batches | ms/batch 197.0884 | train_loss 6.133019e-01 | lr 1.228814e-05
07/02/2024 12:41:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10600/ 12000] | 2935/7664 batches | ms/batch 197.3026 | train_loss 6.122920e-01 | lr 1.186441e-05
07/02/2024 12:41:18 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10650/ 12000] | 2985/7664 batches | ms/batch 196.4140 | train_loss 6.130254e-01 | lr 1.144068e-05
07/02/2024 12:41:30 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10700/ 12000] | 3035/7664 batches | ms/batch 197.2039 | train_loss 6.109387e-01 | lr 1.101695e-05
07/02/2024 12:41:41 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10750/ 12000] | 3085/7664 batches | ms/batch 198.8253 | train_loss 6.117280e-01 | lr 1.059322e-05
07/02/2024 12:41:52 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10800/ 12000] | 3135/7664 batches | ms/batch 196.1010 | train_loss 6.110458e-01 | lr 1.016949e-05
07/02/2024 12:42:03 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10850/ 12000] | 3185/7664 batches | ms/batch 196.9958 | train_loss 6.119847e-01 | lr 9.745763e-06
07/02/2024 12:42:14 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10900/ 12000] | 3235/7664 batches | ms/batch 197.0054 | train_loss 6.124149e-01 | lr 9.322034e-06
07/02/2024 12:42:25 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10950/ 12000] | 3285/7664 batches | ms/batch 196.3565 | train_loss 6.114174e-01 | lr 8.898305e-06
07/02/2024 12:42:36 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11000/ 12000] | 3335/7664 batches | ms/batch 196.2148 | train_loss 6.117965e-01 | lr 8.474576e-06
07/02/2024 12:42:36 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmp0w_vczr0 at global_step 11000 ****
07/02/2024 12:42:37 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 12:42:48 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11050/ 12000] | 3385/7664 batches | ms/batch 196.8016 | train_loss 6.116366e-01 | lr 8.050847e-06
07/02/2024 12:42:59 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11100/ 12000] | 3435/7664 batches | ms/batch 196.8039 | train_loss 6.110963e-01 | lr 7.627119e-06
07/02/2024 12:43:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11150/ 12000] | 3485/7664 batches | ms/batch 197.1607 | train_loss 6.113952e-01 | lr 7.203390e-06
07/02/2024 12:43:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11200/ 12000] | 3535/7664 batches | ms/batch 197.2325 | train_loss 6.126090e-01 | lr 6.779661e-06
07/02/2024 12:43:33 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11250/ 12000] | 3585/7664 batches | ms/batch 196.8865 | train_loss 6.115083e-01 | lr 6.355932e-06
07/02/2024 12:43:44 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11300/ 12000] | 3635/7664 batches | ms/batch 195.8079 | train_loss 6.106584e-01 | lr 5.932203e-06
07/02/2024 12:43:55 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11350/ 12000] | 3685/7664 batches | ms/batch 197.0600 | train_loss 6.110304e-01 | lr 5.508475e-06
07/02/2024 12:44:06 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11400/ 12000] | 3735/7664 batches | ms/batch 196.9809 | train_loss 6.093553e-01 | lr 5.084746e-06
07/02/2024 12:44:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11450/ 12000] | 3785/7664 batches | ms/batch 196.2636 | train_loss 6.114804e-01 | lr 4.661017e-06
07/02/2024 12:44:28 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11500/ 12000] | 3835/7664 batches | ms/batch 197.3638 | train_loss 6.112407e-01 | lr 4.237288e-06
07/02/2024 12:44:39 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11550/ 12000] | 3885/7664 batches | ms/batch 197.0951 | train_loss 6.104125e-01 | lr 3.813559e-06
07/02/2024 12:44:50 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11600/ 12000] | 3935/7664 batches | ms/batch 197.0903 | train_loss 6.107123e-01 | lr 3.389831e-06
07/02/2024 12:45:01 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11650/ 12000] | 3985/7664 batches | ms/batch 196.3886 | train_loss 6.118995e-01 | lr 2.966102e-06
07/02/2024 12:45:13 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11700/ 12000] | 4035/7664 batches | ms/batch 196.3349 | train_loss 6.091086e-01 | lr 2.542373e-06
07/02/2024 12:45:24 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11750/ 12000] | 4085/7664 batches | ms/batch 197.0558 | train_loss 6.098705e-01 | lr 2.118644e-06
07/02/2024 12:45:35 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11800/ 12000] | 4135/7664 batches | ms/batch 197.1074 | train_loss 6.107322e-01 | lr 1.694915e-06
07/02/2024 12:45:46 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11850/ 12000] | 4185/7664 batches | ms/batch 196.9769 | train_loss 6.109390e-01 | lr 1.271186e-06
07/02/2024 12:45:57 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11900/ 12000] | 4235/7664 batches | ms/batch 197.6303 | train_loss 6.117231e-01 | lr 8.474576e-07
07/02/2024 12:46:08 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11950/ 12000] | 4285/7664 batches | ms/batch 196.1843 | train_loss 6.111725e-01 | lr 4.237288e-07
07/02/2024 12:46:19 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 12000/ 12000] | 4335/7664 batches | ms/batch 196.8310 | train_loss 6.108235e-01 | lr 0.000000e+00
07/02/2024 12:46:19 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmp0w_vczr0 at global_step 12000 ****
07/02/2024 12:46:20 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 12:46:21 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23821887/tmp0w_vczr0
07/02/2024 12:46:23 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((490449, 32768)) with avr_nnz=80.0
07/02/2024 12:46:23 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
07/02/2024 12:56:43 - INFO - pecos.xmc.xtransformer.model - Constructed instance feature matrix with shape=(490449, 136677)
07/02/2024 12:57:26 - INFO - pecos.xmc.xtransformer.model - Hierarchical label tree for ranker: [8, 256, 8192, 670091]
07/02/2024 12:57:26 - INFO - pecos.xmc.xtransformer.model - Start training ranker...
07/02/2024 12:57:26 - INFO - pecos.xmc.base - Training Layer 0 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
07/02/2024 12:57:50 - INFO - pecos.xmc.base - Training Layer 1 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
07/02/2024 12:58:28 - INFO - pecos.xmc.base - Training Layer 2 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
07/02/2024 12:59:49 - INFO - pecos.xmc.base - Training Layer 3 of 4 Layers in HierarchicalMLModel, neg_mining=tfn+man..
07/02/2024 13:42:58 - INFO - pecos.xmc.xtransformer.model - Parameters saved to models/amazon-670k/bert2/param.json
07/02/2024 13:43:16 - INFO - pecos.xmc.xtransformer.model - Model saved to models/amazon-670k/bert2
07/02/2024 13:55:08 - INFO - __main__ - Setting random seed 0
07/02/2024 13:55:10 - INFO - __main__ - Loaded training feature matrix with shape=(490449, 135909)
07/02/2024 13:55:10 - INFO - __main__ - Loaded training label matrix with shape=(490449, 670091)
07/02/2024 13:55:12 - INFO - __main__ - Loaded 490449 training sequences
07/02/2024 13:55:27 - INFO - pecos.xmc.xtransformer.model - Hierarchical label tree: [128, 2048, 32768, 670091]
07/02/2024 13:55:27 - INFO - pecos.xmc.xtransformer.model - Fine-tune Transformers with nr_labels=[128, 2048, 32768]
07/02/2024 13:55:27 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn+man at level 0, nr_labels=128, avr_M_nnz=128
07/02/2024 13:55:31 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-uncased model from s3.
07/02/2024 13:55:31 - INFO - pecos.xmc.xtransformer.matcher - ***** Encoding data len=490449 truncation=128*****
07/02/2024 13:56:04 - INFO - pecos.xmc.xtransformer.matcher - ***** Finished with time cost=33.52716064453125 *****
07/02/2024 13:56:27 - INFO - pecos.xmc.xtransformer.matcher - trn tensors saved to /scratch/slurm_tmpdir/job_23821887/tmphfu_qnho/X_trn.pt
07/02/2024 13:56:28 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 2
07/02/2024 13:56:29 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
07/02/2024 13:56:29 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
/home/ul/ul_student/ul_ruw26/.local/lib/python3.9/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
07/02/2024 13:56:29 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
07/02/2024 13:56:29 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 490449
07/02/2024 13:56:29 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 128
07/02/2024 13:56:29 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 1
07/02/2024 13:56:29 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
07/02/2024 13:56:29 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 64
07/02/2024 13:56:29 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
07/02/2024 13:56:29 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
07/02/2024 13:56:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][    50/  4000] |   49/7664 batches | ms/batch 261.6628 | train_loss 9.160959e-01 | lr 2.500000e-05
07/02/2024 13:57:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   100/  4000] |   99/7664 batches | ms/batch 191.7085 | train_loss 2.184370e-01 | lr 5.000000e-05
07/02/2024 13:57:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   150/  4000] |  149/7664 batches | ms/batch 192.1388 | train_loss 1.730870e-01 | lr 7.500000e-05
07/02/2024 13:57:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   200/  4000] |  199/7664 batches | ms/batch 192.3149 | train_loss 1.585346e-01 | lr 1.000000e-04
07/02/2024 13:57:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   250/  4000] |  249/7664 batches | ms/batch 192.9889 | train_loss 1.341695e-01 | lr 9.868421e-05
07/02/2024 13:57:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   300/  4000] |  299/7664 batches | ms/batch 192.8149 | train_loss 1.164767e-01 | lr 9.736842e-05
07/02/2024 13:57:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   350/  4000] |  349/7664 batches | ms/batch 192.9247 | train_loss 1.042957e-01 | lr 9.605263e-05
07/02/2024 13:58:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   400/  4000] |  399/7664 batches | ms/batch 193.2841 | train_loss 9.745681e-02 | lr 9.473684e-05
07/02/2024 13:58:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   450/  4000] |  449/7664 batches | ms/batch 193.2542 | train_loss 9.401780e-02 | lr 9.342105e-05
07/02/2024 13:58:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   500/  4000] |  499/7664 batches | ms/batch 193.4068 | train_loss 9.074056e-02 | lr 9.210526e-05
07/02/2024 13:58:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   550/  4000] |  549/7664 batches | ms/batch 193.6241 | train_loss 8.914437e-02 | lr 9.078947e-05
07/02/2024 13:58:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   600/  4000] |  599/7664 batches | ms/batch 193.9140 | train_loss 8.622040e-02 | lr 8.947368e-05
07/02/2024 13:58:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   650/  4000] |  649/7664 batches | ms/batch 194.4117 | train_loss 8.439644e-02 | lr 8.815789e-05
07/02/2024 13:59:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   700/  4000] |  699/7664 batches | ms/batch 193.8130 | train_loss 8.113959e-02 | lr 8.684211e-05
07/02/2024 13:59:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   750/  4000] |  749/7664 batches | ms/batch 194.0583 | train_loss 7.862297e-02 | lr 8.552632e-05
07/02/2024 13:59:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   800/  4000] |  799/7664 batches | ms/batch 194.3513 | train_loss 7.855342e-02 | lr 8.421053e-05
07/02/2024 13:59:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   850/  4000] |  849/7664 batches | ms/batch 194.0992 | train_loss 7.842402e-02 | lr 8.289474e-05
07/02/2024 13:59:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   900/  4000] |  899/7664 batches | ms/batch 194.4722 | train_loss 7.931843e-02 | lr 8.157895e-05
07/02/2024 14:00:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   950/  4000] |  949/7664 batches | ms/batch 196.0423 | train_loss 7.706326e-02 | lr 8.026316e-05
07/02/2024 14:00:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1000/  4000] |  999/7664 batches | ms/batch 195.4729 | train_loss 7.501395e-02 | lr 7.894737e-05
07/02/2024 14:00:11 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpe_hoj15d at global_step 1000 ****
07/02/2024 14:00:12 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 14:00:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1050/  4000] | 1049/7664 batches | ms/batch 195.3003 | train_loss 7.800656e-02 | lr 7.763158e-05
07/02/2024 14:00:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1100/  4000] | 1099/7664 batches | ms/batch 195.4991 | train_loss 7.546911e-02 | lr 7.631579e-05
07/02/2024 14:00:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1150/  4000] | 1149/7664 batches | ms/batch 195.5348 | train_loss 7.523460e-02 | lr 7.500000e-05
07/02/2024 14:00:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1200/  4000] | 1199/7664 batches | ms/batch 195.3861 | train_loss 7.472803e-02 | lr 7.368421e-05
07/02/2024 14:01:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1250/  4000] | 1249/7664 batches | ms/batch 195.6724 | train_loss 7.389664e-02 | lr 7.236842e-05
07/02/2024 14:01:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1300/  4000] | 1299/7664 batches | ms/batch 195.7824 | train_loss 7.273798e-02 | lr 7.105263e-05
07/02/2024 14:01:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1350/  4000] | 1349/7664 batches | ms/batch 194.6766 | train_loss 7.261559e-02 | lr 6.973684e-05
07/02/2024 14:01:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1400/  4000] | 1399/7664 batches | ms/batch 195.9440 | train_loss 7.310560e-02 | lr 6.842105e-05
07/02/2024 14:01:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1450/  4000] | 1449/7664 batches | ms/batch 195.7315 | train_loss 7.195749e-02 | lr 6.710526e-05
07/02/2024 14:01:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1500/  4000] | 1499/7664 batches | ms/batch 195.5121 | train_loss 7.122340e-02 | lr 6.578947e-05
07/02/2024 14:02:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1550/  4000] | 1549/7664 batches | ms/batch 195.9434 | train_loss 7.170883e-02 | lr 6.447368e-05
07/02/2024 14:02:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1600/  4000] | 1599/7664 batches | ms/batch 194.6114 | train_loss 7.100763e-02 | lr 6.315789e-05
07/02/2024 14:02:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1650/  4000] | 1649/7664 batches | ms/batch 195.8745 | train_loss 7.066971e-02 | lr 6.184211e-05
07/02/2024 14:02:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1700/  4000] | 1699/7664 batches | ms/batch 195.7827 | train_loss 6.932045e-02 | lr 6.052632e-05
07/02/2024 14:02:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1750/  4000] | 1749/7664 batches | ms/batch 195.5842 | train_loss 7.153540e-02 | lr 5.921053e-05
07/02/2024 14:03:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1800/  4000] | 1799/7664 batches | ms/batch 195.8909 | train_loss 6.749023e-02 | lr 5.789474e-05
07/02/2024 14:03:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1850/  4000] | 1849/7664 batches | ms/batch 195.9018 | train_loss 6.897159e-02 | lr 5.657895e-05
07/02/2024 14:03:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1900/  4000] | 1899/7664 batches | ms/batch 195.5760 | train_loss 6.952224e-02 | lr 5.526316e-05
07/02/2024 14:03:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1950/  4000] | 1949/7664 batches | ms/batch 194.9134 | train_loss 6.828903e-02 | lr 5.394737e-05
07/02/2024 14:03:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2000/  4000] | 1999/7664 batches | ms/batch 195.7463 | train_loss 7.021889e-02 | lr 5.263158e-05
07/02/2024 14:03:44 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpe_hoj15d at global_step 2000 ****
07/02/2024 14:03:45 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 14:03:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2050/  4000] | 2049/7664 batches | ms/batch 195.6154 | train_loss 6.884540e-02 | lr 5.131579e-05
07/02/2024 14:04:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2100/  4000] | 2099/7664 batches | ms/batch 195.7894 | train_loss 6.878246e-02 | lr 5.000000e-05
07/02/2024 14:04:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2150/  4000] | 2149/7664 batches | ms/batch 195.9663 | train_loss 6.649102e-02 | lr 4.868421e-05
07/02/2024 14:04:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2200/  4000] | 2199/7664 batches | ms/batch 195.2083 | train_loss 6.683508e-02 | lr 4.736842e-05
07/02/2024 14:04:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2250/  4000] | 2249/7664 batches | ms/batch 194.8957 | train_loss 6.741747e-02 | lr 4.605263e-05
07/02/2024 14:04:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2300/  4000] | 2299/7664 batches | ms/batch 195.7944 | train_loss 6.730431e-02 | lr 4.473684e-05
07/02/2024 14:04:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2350/  4000] | 2349/7664 batches | ms/batch 195.2685 | train_loss 6.638318e-02 | lr 4.342105e-05
07/02/2024 14:05:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2400/  4000] | 2399/7664 batches | ms/batch 194.8948 | train_loss 6.618212e-02 | lr 4.210526e-05
07/02/2024 14:05:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2450/  4000] | 2449/7664 batches | ms/batch 195.7998 | train_loss 6.757436e-02 | lr 4.078947e-05
07/02/2024 14:05:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2500/  4000] | 2499/7664 batches | ms/batch 195.9499 | train_loss 6.542310e-02 | lr 3.947368e-05
07/02/2024 14:05:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2550/  4000] | 2549/7664 batches | ms/batch 195.6317 | train_loss 6.654041e-02 | lr 3.815789e-05
07/02/2024 14:05:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2600/  4000] | 2599/7664 batches | ms/batch 195.9106 | train_loss 6.657951e-02 | lr 3.684211e-05
07/02/2024 14:06:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2650/  4000] | 2649/7664 batches | ms/batch 195.6369 | train_loss 6.638433e-02 | lr 3.552632e-05
07/02/2024 14:06:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2700/  4000] | 2699/7664 batches | ms/batch 195.9473 | train_loss 6.605783e-02 | lr 3.421053e-05
07/02/2024 14:06:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2750/  4000] | 2749/7664 batches | ms/batch 195.9187 | train_loss 6.429785e-02 | lr 3.289474e-05
07/02/2024 14:06:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2800/  4000] | 2799/7664 batches | ms/batch 195.9972 | train_loss 6.486256e-02 | lr 3.157895e-05
07/02/2024 14:06:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2850/  4000] | 2849/7664 batches | ms/batch 195.7925 | train_loss 6.527131e-02 | lr 3.026316e-05
07/02/2024 14:06:56 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2900/  4000] | 2899/7664 batches | ms/batch 195.9091 | train_loss 6.510430e-02 | lr 2.894737e-05
07/02/2024 14:07:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2950/  4000] | 2949/7664 batches | ms/batch 194.9579 | train_loss 6.508280e-02 | lr 2.763158e-05
07/02/2024 14:07:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3000/  4000] | 2999/7664 batches | ms/batch 195.7077 | train_loss 6.430992e-02 | lr 2.631579e-05
07/02/2024 14:07:18 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpe_hoj15d at global_step 3000 ****
07/02/2024 14:07:18 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 14:07:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3050/  4000] | 3049/7664 batches | ms/batch 195.8707 | train_loss 6.491026e-02 | lr 2.500000e-05
07/02/2024 14:07:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3100/  4000] | 3099/7664 batches | ms/batch 195.7245 | train_loss 6.467580e-02 | lr 2.368421e-05
07/02/2024 14:07:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3150/  4000] | 3149/7664 batches | ms/batch 195.8161 | train_loss 6.271218e-02 | lr 2.236842e-05
07/02/2024 14:08:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3200/  4000] | 3199/7664 batches | ms/batch 195.7741 | train_loss 6.204101e-02 | lr 2.105263e-05
07/02/2024 14:08:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3250/  4000] | 3249/7664 batches | ms/batch 195.2092 | train_loss 6.493154e-02 | lr 1.973684e-05
07/02/2024 14:08:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3300/  4000] | 3299/7664 batches | ms/batch 196.0455 | train_loss 6.341577e-02 | lr 1.842105e-05
07/02/2024 14:08:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3350/  4000] | 3349/7664 batches | ms/batch 195.0073 | train_loss 6.564181e-02 | lr 1.710526e-05
07/02/2024 14:08:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3400/  4000] | 3399/7664 batches | ms/batch 195.8118 | train_loss 6.420001e-02 | lr 1.578947e-05
07/02/2024 14:08:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3450/  4000] | 3449/7664 batches | ms/batch 195.2750 | train_loss 6.315850e-02 | lr 1.447368e-05
07/02/2024 14:09:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3500/  4000] | 3499/7664 batches | ms/batch 195.8128 | train_loss 6.409316e-02 | lr 1.315789e-05
07/02/2024 14:09:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3550/  4000] | 3549/7664 batches | ms/batch 194.9548 | train_loss 6.292812e-02 | lr 1.184211e-05
07/02/2024 14:09:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3600/  4000] | 3599/7664 batches | ms/batch 196.3901 | train_loss 6.041875e-02 | lr 1.052632e-05
07/02/2024 14:09:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3650/  4000] | 3649/7664 batches | ms/batch 195.8450 | train_loss 6.268453e-02 | lr 9.210526e-06
07/02/2024 14:09:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3700/  4000] | 3699/7664 batches | ms/batch 195.8457 | train_loss 6.234207e-02 | lr 7.894737e-06
07/02/2024 14:09:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3750/  4000] | 3749/7664 batches | ms/batch 195.8020 | train_loss 6.254620e-02 | lr 6.578947e-06
07/02/2024 14:10:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3800/  4000] | 3799/7664 batches | ms/batch 196.0196 | train_loss 6.292174e-02 | lr 5.263158e-06
07/02/2024 14:10:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3850/  4000] | 3849/7664 batches | ms/batch 195.7885 | train_loss 6.203614e-02 | lr 3.947368e-06
07/02/2024 14:10:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3900/  4000] | 3899/7664 batches | ms/batch 195.0282 | train_loss 6.379492e-02 | lr 2.631579e-06
07/02/2024 14:10:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3950/  4000] | 3949/7664 batches | ms/batch 195.9471 | train_loss 6.230799e-02 | lr 1.315789e-06
07/02/2024 14:10:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  4000/  4000] | 3999/7664 batches | ms/batch 195.3950 | train_loss 6.157941e-02 | lr 0.000000e+00
07/02/2024 14:10:52 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpe_hoj15d at global_step 4000 ****
07/02/2024 14:10:52 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 14:10:53 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23821887/tmpe_hoj15d
07/02/2024 14:10:53 - INFO - pecos.xmc.xtransformer.matcher - Predict on input text tensors(torch.Size([490449, 128])) in OVA mode
07/02/2024 14:10:53 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
07/02/2024 14:20:44 - INFO - pecos.xmc.xtransformer.matcher - Concatenating instance embeddings with features...
07/02/2024 14:20:54 - INFO - pecos.xmc.xtransformer.matcher - Start training concat_model of transformer matcher...
07/02/2024 14:22:47 - INFO - pecos.xmc.xtransformer.matcher - Using concat-only for transformer/concat ensemble of pred_csr
07/02/2024 14:23:01 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn+man at level 1, nr_labels=2048, avr_M_nnz=5.101443779067752
07/02/2024 14:23:02 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-uncased model from s3.
07/02/2024 14:23:31 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23821887/tmphfu_qnho/X_trn.pt
07/02/2024 14:23:31 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
07/02/2024 14:27:20 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
07/02/2024 14:27:20 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 2
07/02/2024 14:27:20 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
07/02/2024 14:27:21 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
/home/ul/ul_student/ul_ruw26/.local/lib/python3.9/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
07/02/2024 14:27:39 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
07/02/2024 14:27:39 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 490449
07/02/2024 14:27:39 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 2048
07/02/2024 14:27:39 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 176
07/02/2024 14:27:39 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 1
07/02/2024 14:27:39 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
07/02/2024 14:27:39 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 64
07/02/2024 14:27:39 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
07/02/2024 14:27:39 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 4000
07/02/2024 14:27:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][    50/  4000] |   49/7664 batches | ms/batch 202.8838 | train_loss 8.627643e-01 | lr 2.500000e-05
07/02/2024 14:28:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   100/  4000] |   99/7664 batches | ms/batch 194.1735 | train_loss 7.265282e-01 | lr 5.000000e-05
07/02/2024 14:28:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   150/  4000] |  149/7664 batches | ms/batch 194.4263 | train_loss 6.871192e-01 | lr 7.500000e-05
07/02/2024 14:28:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   200/  4000] |  199/7664 batches | ms/batch 194.0312 | train_loss 6.781879e-01 | lr 1.000000e-04
07/02/2024 14:28:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   250/  4000] |  249/7664 batches | ms/batch 197.0140 | train_loss 6.695494e-01 | lr 9.868421e-05
07/02/2024 14:28:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   300/  4000] |  299/7664 batches | ms/batch 195.4840 | train_loss 6.670365e-01 | lr 9.736842e-05
07/02/2024 14:29:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   350/  4000] |  349/7664 batches | ms/batch 195.1669 | train_loss 6.594439e-01 | lr 9.605263e-05
07/02/2024 14:29:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   400/  4000] |  399/7664 batches | ms/batch 194.1847 | train_loss 6.571020e-01 | lr 9.473684e-05
07/02/2024 14:29:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   450/  4000] |  449/7664 batches | ms/batch 196.7697 | train_loss 6.549652e-01 | lr 9.342105e-05
07/02/2024 14:29:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   500/  4000] |  499/7664 batches | ms/batch 195.7639 | train_loss 6.518833e-01 | lr 9.210526e-05
07/02/2024 14:29:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   550/  4000] |  549/7664 batches | ms/batch 195.9193 | train_loss 6.501289e-01 | lr 9.078947e-05
07/02/2024 14:29:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   600/  4000] |  599/7664 batches | ms/batch 195.8164 | train_loss 6.458606e-01 | lr 8.947368e-05
07/02/2024 14:30:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   650/  4000] |  649/7664 batches | ms/batch 196.2503 | train_loss 6.458819e-01 | lr 8.815789e-05
07/02/2024 14:30:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   700/  4000] |  699/7664 batches | ms/batch 197.5754 | train_loss 6.440895e-01 | lr 8.684211e-05
07/02/2024 14:30:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   750/  4000] |  749/7664 batches | ms/batch 196.4642 | train_loss 6.425123e-01 | lr 8.552632e-05
07/02/2024 14:30:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   800/  4000] |  799/7664 batches | ms/batch 196.4195 | train_loss 6.413961e-01 | lr 8.421053e-05
07/02/2024 14:30:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   850/  4000] |  849/7664 batches | ms/batch 196.2463 | train_loss 6.406998e-01 | lr 8.289474e-05
07/02/2024 14:31:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   900/  4000] |  899/7664 batches | ms/batch 198.4430 | train_loss 6.402973e-01 | lr 8.157895e-05
07/02/2024 14:31:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][   950/  4000] |  949/7664 batches | ms/batch 196.4290 | train_loss 6.392180e-01 | lr 8.026316e-05
07/02/2024 14:31:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1000/  4000] |  999/7664 batches | ms/batch 195.8065 | train_loss 6.375925e-01 | lr 7.894737e-05
07/02/2024 14:31:24 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpc36wr9wv at global_step 1000 ****
07/02/2024 14:31:25 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 14:31:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1050/  4000] | 1049/7664 batches | ms/batch 195.7247 | train_loss 6.362962e-01 | lr 7.763158e-05
07/02/2024 14:31:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1100/  4000] | 1099/7664 batches | ms/batch 195.9808 | train_loss 6.350203e-01 | lr 7.631579e-05
07/02/2024 14:31:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1150/  4000] | 1149/7664 batches | ms/batch 195.9386 | train_loss 6.340314e-01 | lr 7.500000e-05
07/02/2024 14:32:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1200/  4000] | 1199/7664 batches | ms/batch 196.6803 | train_loss 6.342599e-01 | lr 7.368421e-05
07/02/2024 14:32:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1250/  4000] | 1249/7664 batches | ms/batch 196.8345 | train_loss 6.347890e-01 | lr 7.236842e-05
07/02/2024 14:32:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1300/  4000] | 1299/7664 batches | ms/batch 196.9548 | train_loss 6.325621e-01 | lr 7.105263e-05
07/02/2024 14:32:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1350/  4000] | 1349/7664 batches | ms/batch 196.0100 | train_loss 6.332736e-01 | lr 6.973684e-05
07/02/2024 14:32:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1400/  4000] | 1399/7664 batches | ms/batch 197.2324 | train_loss 6.324324e-01 | lr 6.842105e-05
07/02/2024 14:33:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1450/  4000] | 1449/7664 batches | ms/batch 196.5177 | train_loss 6.328435e-01 | lr 6.710526e-05
07/02/2024 14:33:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1500/  4000] | 1499/7664 batches | ms/batch 197.0389 | train_loss 6.318908e-01 | lr 6.578947e-05
07/02/2024 14:33:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1550/  4000] | 1549/7664 batches | ms/batch 196.9429 | train_loss 6.309374e-01 | lr 6.447368e-05
07/02/2024 14:33:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1600/  4000] | 1599/7664 batches | ms/batch 196.9350 | train_loss 6.313620e-01 | lr 6.315789e-05
07/02/2024 14:33:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1650/  4000] | 1649/7664 batches | ms/batch 196.9245 | train_loss 6.307121e-01 | lr 6.184211e-05
07/02/2024 14:33:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1700/  4000] | 1699/7664 batches | ms/batch 197.5284 | train_loss 6.307140e-01 | lr 6.052632e-05
07/02/2024 14:34:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1750/  4000] | 1749/7664 batches | ms/batch 197.3233 | train_loss 6.281472e-01 | lr 5.921053e-05
07/02/2024 14:34:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1800/  4000] | 1799/7664 batches | ms/batch 199.8161 | train_loss 6.288338e-01 | lr 5.789474e-05
07/02/2024 14:34:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1850/  4000] | 1849/7664 batches | ms/batch 197.2798 | train_loss 6.268011e-01 | lr 5.657895e-05
07/02/2024 14:34:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1900/  4000] | 1899/7664 batches | ms/batch 197.0792 | train_loss 6.294916e-01 | lr 5.526316e-05
07/02/2024 14:34:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  1950/  4000] | 1949/7664 batches | ms/batch 196.9027 | train_loss 6.277767e-01 | lr 5.394737e-05
07/02/2024 14:35:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2000/  4000] | 1999/7664 batches | ms/batch 195.7766 | train_loss 6.261526e-01 | lr 5.263158e-05
07/02/2024 14:35:03 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpc36wr9wv at global_step 2000 ****
07/02/2024 14:35:04 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 14:35:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2050/  4000] | 2049/7664 batches | ms/batch 198.2447 | train_loss 6.272512e-01 | lr 5.131579e-05
07/02/2024 14:35:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2100/  4000] | 2099/7664 batches | ms/batch 199.2354 | train_loss 6.273808e-01 | lr 5.000000e-05
07/02/2024 14:35:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2150/  4000] | 2149/7664 batches | ms/batch 200.6358 | train_loss 6.255808e-01 | lr 4.868421e-05
07/02/2024 14:35:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2200/  4000] | 2199/7664 batches | ms/batch 197.0235 | train_loss 6.262169e-01 | lr 4.736842e-05
07/02/2024 14:35:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2250/  4000] | 2249/7664 batches | ms/batch 196.3417 | train_loss 6.252984e-01 | lr 4.605263e-05
07/02/2024 14:36:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2300/  4000] | 2299/7664 batches | ms/batch 196.1621 | train_loss 6.256594e-01 | lr 4.473684e-05
07/02/2024 14:36:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2350/  4000] | 2349/7664 batches | ms/batch 196.3395 | train_loss 6.257239e-01 | lr 4.342105e-05
07/02/2024 14:36:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2400/  4000] | 2399/7664 batches | ms/batch 196.2088 | train_loss 6.252457e-01 | lr 4.210526e-05
07/02/2024 14:36:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2450/  4000] | 2449/7664 batches | ms/batch 197.0597 | train_loss 6.228279e-01 | lr 4.078947e-05
07/02/2024 14:36:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2500/  4000] | 2499/7664 batches | ms/batch 197.1686 | train_loss 6.250348e-01 | lr 3.947368e-05
07/02/2024 14:37:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2550/  4000] | 2549/7664 batches | ms/batch 198.7915 | train_loss 6.228636e-01 | lr 3.815789e-05
07/02/2024 14:37:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2600/  4000] | 2599/7664 batches | ms/batch 197.0655 | train_loss 6.232899e-01 | lr 3.684211e-05
07/02/2024 14:37:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2650/  4000] | 2649/7664 batches | ms/batch 197.0411 | train_loss 6.238675e-01 | lr 3.552632e-05
07/02/2024 14:37:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2700/  4000] | 2699/7664 batches | ms/batch 197.2491 | train_loss 6.224641e-01 | lr 3.421053e-05
07/02/2024 14:37:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2750/  4000] | 2749/7664 batches | ms/batch 197.0039 | train_loss 6.213598e-01 | lr 3.289474e-05
07/02/2024 14:37:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2800/  4000] | 2799/7664 batches | ms/batch 196.9674 | train_loss 6.225478e-01 | lr 3.157895e-05
07/02/2024 14:38:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2850/  4000] | 2849/7664 batches | ms/batch 197.0385 | train_loss 6.213138e-01 | lr 3.026316e-05
07/02/2024 14:38:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2900/  4000] | 2899/7664 batches | ms/batch 196.6668 | train_loss 6.217044e-01 | lr 2.894737e-05
07/02/2024 14:38:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  2950/  4000] | 2949/7664 batches | ms/batch 197.2536 | train_loss 6.224242e-01 | lr 2.763158e-05
07/02/2024 14:38:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3000/  4000] | 2999/7664 batches | ms/batch 197.1092 | train_loss 6.207962e-01 | lr 2.631579e-05
07/02/2024 14:38:42 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpc36wr9wv at global_step 3000 ****
07/02/2024 14:38:42 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 14:38:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3050/  4000] | 3049/7664 batches | ms/batch 196.2910 | train_loss 6.210123e-01 | lr 2.500000e-05
07/02/2024 14:39:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3100/  4000] | 3099/7664 batches | ms/batch 196.2097 | train_loss 6.210308e-01 | lr 2.368421e-05
07/02/2024 14:39:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3150/  4000] | 3149/7664 batches | ms/batch 197.1028 | train_loss 6.203222e-01 | lr 2.236842e-05
07/02/2024 14:39:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3200/  4000] | 3199/7664 batches | ms/batch 196.3434 | train_loss 6.198750e-01 | lr 2.105263e-05
07/02/2024 14:39:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3250/  4000] | 3249/7664 batches | ms/batch 196.9812 | train_loss 6.217912e-01 | lr 1.973684e-05
07/02/2024 14:39:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3300/  4000] | 3299/7664 batches | ms/batch 197.0603 | train_loss 6.207067e-01 | lr 1.842105e-05
07/02/2024 14:39:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3350/  4000] | 3349/7664 batches | ms/batch 197.1716 | train_loss 6.200448e-01 | lr 1.710526e-05
07/02/2024 14:40:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3400/  4000] | 3399/7664 batches | ms/batch 197.4187 | train_loss 6.203833e-01 | lr 1.578947e-05
07/02/2024 14:40:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3450/  4000] | 3449/7664 batches | ms/batch 197.2205 | train_loss 6.207608e-01 | lr 1.447368e-05
07/02/2024 14:40:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3500/  4000] | 3499/7664 batches | ms/batch 198.3630 | train_loss 6.193306e-01 | lr 1.315789e-05
07/02/2024 14:40:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3550/  4000] | 3549/7664 batches | ms/batch 195.8609 | train_loss 6.201424e-01 | lr 1.184211e-05
07/02/2024 14:40:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3600/  4000] | 3599/7664 batches | ms/batch 197.0399 | train_loss 6.189743e-01 | lr 1.052632e-05
07/02/2024 14:41:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3650/  4000] | 3649/7664 batches | ms/batch 197.1370 | train_loss 6.201260e-01 | lr 9.210526e-06
07/02/2024 14:41:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3700/  4000] | 3699/7664 batches | ms/batch 199.0960 | train_loss 6.183266e-01 | lr 7.894737e-06
07/02/2024 14:41:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3750/  4000] | 3749/7664 batches | ms/batch 197.1289 | train_loss 6.168917e-01 | lr 6.578947e-06
07/02/2024 14:41:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3800/  4000] | 3799/7664 batches | ms/batch 197.0375 | train_loss 6.177467e-01 | lr 5.263158e-06
07/02/2024 14:41:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3850/  4000] | 3849/7664 batches | ms/batch 196.9852 | train_loss 6.184178e-01 | lr 3.947368e-06
07/02/2024 14:41:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3900/  4000] | 3899/7664 batches | ms/batch 197.2091 | train_loss 6.158265e-01 | lr 2.631579e-06
07/02/2024 14:42:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  3950/  4000] | 3949/7664 batches | ms/batch 197.0812 | train_loss 6.190807e-01 | lr 1.315789e-06
07/02/2024 14:42:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   1][  4000/  4000] | 3999/7664 batches | ms/batch 196.4713 | train_loss 6.199444e-01 | lr 0.000000e+00
07/02/2024 14:42:20 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpc36wr9wv at global_step 4000 ****
07/02/2024 14:42:21 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 14:42:22 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23821887/tmpc36wr9wv
07/02/2024 14:42:22 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((490449, 2048)) with avr_nnz=80.0
07/02/2024 14:42:22 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
07/02/2024 14:52:24 - INFO - pecos.xmc.xtransformer.matcher - Concatenating instance embeddings with features...
07/02/2024 14:52:34 - INFO - pecos.xmc.xtransformer.matcher - Start training concat_model of transformer matcher...
07/02/2024 14:54:00 - INFO - pecos.xmc.xtransformer.matcher - Using concat-only for transformer/concat ensemble of pred_csr
07/02/2024 14:54:10 - INFO - pecos.xmc.xtransformer.model - Fine-tuning XR-Transformer with tfn+man at level 2, nr_labels=32768, avr_M_nnz=5.211218699599755
07/02/2024 14:54:12 - INFO - pecos.xmc.xtransformer.matcher - Downloaded bert-base-uncased model from s3.
07/02/2024 14:54:40 - INFO - pecos.xmc.xtransformer.matcher - trn tensors loaded_from /scratch/slurm_tmpdir/job_23821887/tmphfu_qnho/X_trn.pt
07/02/2024 14:54:40 - INFO - pecos.xmc.xtransformer.matcher - Continue training form given text_encoder!
07/02/2024 14:56:22 - INFO - pecos.xmc.xtransformer.matcher - Initialized transformer text_model with xlinear!
07/02/2024 14:56:22 - INFO - pecos.utils.torch_util - Setting device to cuda, number of active GPUs: 2
07/02/2024 14:56:22 - INFO - pecos.xmc.xtransformer.matcher - Start fine-tuning transformer matcher...
07/02/2024 14:56:22 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
/home/ul/ul_student/ul_ruw26/.local/lib/python3.9/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
07/02/2024 14:56:40 - INFO - pecos.xmc.xtransformer.matcher - ***** Running training *****
07/02/2024 14:56:40 - INFO - pecos.xmc.xtransformer.matcher -   Num examples = 490449
07/02/2024 14:56:40 - INFO - pecos.xmc.xtransformer.matcher -   Num labels = 32768
07/02/2024 14:56:40 - INFO - pecos.xmc.xtransformer.matcher -   Num active labels per instance = 192
07/02/2024 14:56:40 - INFO - pecos.xmc.xtransformer.matcher -   Num Epochs = 2
07/02/2024 14:56:40 - INFO - pecos.xmc.xtransformer.matcher -   Learning Rate Schedule = linear
07/02/2024 14:56:40 - INFO - pecos.xmc.xtransformer.matcher -   Batch size = 64
07/02/2024 14:56:40 - INFO - pecos.xmc.xtransformer.matcher -   Gradient Accumulation steps = 1
07/02/2024 14:56:40 - INFO - pecos.xmc.xtransformer.matcher -   Total optimization steps = 12000
07/02/2024 14:57:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][    50/ 12000] |   49/7664 batches | ms/batch 204.4825 | train_loss 6.655874e-01 | lr 2.500000e-05
07/02/2024 14:57:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   100/ 12000] |   99/7664 batches | ms/batch 194.2893 | train_loss 6.656478e-01 | lr 5.000000e-05
07/02/2024 14:57:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   150/ 12000] |  149/7664 batches | ms/batch 193.7854 | train_loss 6.732438e-01 | lr 7.500000e-05
07/02/2024 14:57:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   200/ 12000] |  199/7664 batches | ms/batch 194.8680 | train_loss 6.818035e-01 | lr 1.000000e-04
07/02/2024 14:57:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   250/ 12000] |  249/7664 batches | ms/batch 195.0801 | train_loss 6.915807e-01 | lr 9.957627e-05
07/02/2024 14:57:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   300/ 12000] |  299/7664 batches | ms/batch 194.4843 | train_loss 6.963572e-01 | lr 9.915254e-05
07/02/2024 14:58:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   350/ 12000] |  349/7664 batches | ms/batch 195.5147 | train_loss 6.965232e-01 | lr 9.872881e-05
07/02/2024 14:58:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   400/ 12000] |  399/7664 batches | ms/batch 197.8595 | train_loss 6.892861e-01 | lr 9.830508e-05
07/02/2024 14:58:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   450/ 12000] |  449/7664 batches | ms/batch 195.2459 | train_loss 6.843639e-01 | lr 9.788136e-05
07/02/2024 14:58:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   500/ 12000] |  499/7664 batches | ms/batch 195.4141 | train_loss 6.859020e-01 | lr 9.745763e-05
07/02/2024 14:58:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   550/ 12000] |  549/7664 batches | ms/batch 196.4884 | train_loss 6.832206e-01 | lr 9.703390e-05
07/02/2024 14:59:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   600/ 12000] |  599/7664 batches | ms/batch 196.2829 | train_loss 6.805189e-01 | lr 9.661017e-05
07/02/2024 14:59:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   650/ 12000] |  649/7664 batches | ms/batch 195.6548 | train_loss 6.857257e-01 | lr 9.618644e-05
07/02/2024 14:59:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   700/ 12000] |  699/7664 batches | ms/batch 198.3967 | train_loss 6.822559e-01 | lr 9.576271e-05
07/02/2024 14:59:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   750/ 12000] |  749/7664 batches | ms/batch 196.0099 | train_loss 6.807454e-01 | lr 9.533898e-05
07/02/2024 14:59:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   800/ 12000] |  799/7664 batches | ms/batch 196.6519 | train_loss 6.804398e-01 | lr 9.491525e-05
07/02/2024 14:59:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   850/ 12000] |  849/7664 batches | ms/batch 196.4649 | train_loss 6.780217e-01 | lr 9.449153e-05
07/02/2024 15:00:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   900/ 12000] |  899/7664 batches | ms/batch 195.8275 | train_loss 6.800433e-01 | lr 9.406780e-05
07/02/2024 15:00:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][   950/ 12000] |  949/7664 batches | ms/batch 205.4512 | train_loss 6.747186e-01 | lr 9.364407e-05
07/02/2024 15:00:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1000/ 12000] |  999/7664 batches | ms/batch 202.7691 | train_loss 6.783164e-01 | lr 9.322034e-05
07/02/2024 15:00:29 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpb310n078 at global_step 1000 ****
07/02/2024 15:00:30 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 15:00:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1050/ 12000] | 1049/7664 batches | ms/batch 198.7043 | train_loss 6.759575e-01 | lr 9.279661e-05
07/02/2024 15:00:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1100/ 12000] | 1099/7664 batches | ms/batch 196.6212 | train_loss 6.759482e-01 | lr 9.237288e-05
07/02/2024 15:01:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1150/ 12000] | 1149/7664 batches | ms/batch 197.0579 | train_loss 6.714140e-01 | lr 9.194915e-05
07/02/2024 15:01:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1200/ 12000] | 1199/7664 batches | ms/batch 198.1201 | train_loss 6.734611e-01 | lr 9.152542e-05
07/02/2024 15:01:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1250/ 12000] | 1249/7664 batches | ms/batch 197.6482 | train_loss 6.727858e-01 | lr 9.110169e-05
07/02/2024 15:01:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1300/ 12000] | 1299/7664 batches | ms/batch 197.6692 | train_loss 6.693375e-01 | lr 9.067797e-05
07/02/2024 15:01:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1350/ 12000] | 1349/7664 batches | ms/batch 199.4998 | train_loss 6.703409e-01 | lr 9.025424e-05
07/02/2024 15:01:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1400/ 12000] | 1399/7664 batches | ms/batch 200.6499 | train_loss 6.691914e-01 | lr 8.983051e-05
07/02/2024 15:02:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1450/ 12000] | 1449/7664 batches | ms/batch 196.3042 | train_loss 6.696647e-01 | lr 8.940678e-05
07/02/2024 15:02:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1500/ 12000] | 1499/7664 batches | ms/batch 199.2446 | train_loss 6.709893e-01 | lr 8.898305e-05
07/02/2024 15:02:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1550/ 12000] | 1549/7664 batches | ms/batch 196.6198 | train_loss 6.652693e-01 | lr 8.855932e-05
07/02/2024 15:02:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1600/ 12000] | 1599/7664 batches | ms/batch 201.2052 | train_loss 6.687304e-01 | lr 8.813559e-05
07/02/2024 15:02:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1650/ 12000] | 1649/7664 batches | ms/batch 198.2781 | train_loss 6.652733e-01 | lr 8.771186e-05
07/02/2024 15:03:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1700/ 12000] | 1699/7664 batches | ms/batch 199.0282 | train_loss 6.636932e-01 | lr 8.728814e-05
07/02/2024 15:03:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1750/ 12000] | 1749/7664 batches | ms/batch 195.9726 | train_loss 6.670427e-01 | lr 8.686441e-05
07/02/2024 15:03:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1800/ 12000] | 1799/7664 batches | ms/batch 197.9067 | train_loss 6.669052e-01 | lr 8.644068e-05
07/02/2024 15:03:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1850/ 12000] | 1849/7664 batches | ms/batch 196.6039 | train_loss 6.652911e-01 | lr 8.601695e-05
07/02/2024 15:03:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1900/ 12000] | 1899/7664 batches | ms/batch 197.2106 | train_loss 6.644202e-01 | lr 8.559322e-05
07/02/2024 15:04:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  1950/ 12000] | 1949/7664 batches | ms/batch 196.9533 | train_loss 6.615972e-01 | lr 8.516949e-05
07/02/2024 15:04:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2000/ 12000] | 1999/7664 batches | ms/batch 197.4572 | train_loss 6.614840e-01 | lr 8.474576e-05
07/02/2024 15:04:12 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpb310n078 at global_step 2000 ****
07/02/2024 15:04:13 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 15:04:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2050/ 12000] | 2049/7664 batches | ms/batch 199.1358 | train_loss 6.647663e-01 | lr 8.432203e-05
07/02/2024 15:04:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2100/ 12000] | 2099/7664 batches | ms/batch 197.0834 | train_loss 6.626878e-01 | lr 8.389831e-05
07/02/2024 15:04:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2150/ 12000] | 2149/7664 batches | ms/batch 197.2707 | train_loss 6.641008e-01 | lr 8.347458e-05
07/02/2024 15:04:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2200/ 12000] | 2199/7664 batches | ms/batch 198.3283 | train_loss 6.606658e-01 | lr 8.305085e-05
07/02/2024 15:05:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2250/ 12000] | 2249/7664 batches | ms/batch 196.2864 | train_loss 6.619743e-01 | lr 8.262712e-05
07/02/2024 15:05:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2300/ 12000] | 2299/7664 batches | ms/batch 197.1475 | train_loss 6.594698e-01 | lr 8.220339e-05
07/02/2024 15:05:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2350/ 12000] | 2349/7664 batches | ms/batch 197.3610 | train_loss 6.577513e-01 | lr 8.177966e-05
07/02/2024 15:05:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2400/ 12000] | 2399/7664 batches | ms/batch 197.2967 | train_loss 6.609821e-01 | lr 8.135593e-05
07/02/2024 15:05:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2450/ 12000] | 2449/7664 batches | ms/batch 196.7125 | train_loss 6.605651e-01 | lr 8.093220e-05
07/02/2024 15:06:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2500/ 12000] | 2499/7664 batches | ms/batch 196.2806 | train_loss 6.543600e-01 | lr 8.050847e-05
07/02/2024 15:06:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2550/ 12000] | 2549/7664 batches | ms/batch 196.9781 | train_loss 6.560169e-01 | lr 8.008475e-05
07/02/2024 15:06:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2600/ 12000] | 2599/7664 batches | ms/batch 196.4276 | train_loss 6.571703e-01 | lr 7.966102e-05
07/02/2024 15:06:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2650/ 12000] | 2649/7664 batches | ms/batch 197.3005 | train_loss 6.568075e-01 | lr 7.923729e-05
07/02/2024 15:06:47 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2700/ 12000] | 2699/7664 batches | ms/batch 196.6542 | train_loss 6.586123e-01 | lr 7.881356e-05
07/02/2024 15:06:58 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2750/ 12000] | 2749/7664 batches | ms/batch 197.2747 | train_loss 6.564819e-01 | lr 7.838983e-05
07/02/2024 15:07:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2800/ 12000] | 2799/7664 batches | ms/batch 196.4361 | train_loss 6.538881e-01 | lr 7.796610e-05
07/02/2024 15:07:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2850/ 12000] | 2849/7664 batches | ms/batch 197.2678 | train_loss 6.573577e-01 | lr 7.754237e-05
07/02/2024 15:07:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2900/ 12000] | 2899/7664 batches | ms/batch 197.2301 | train_loss 6.546011e-01 | lr 7.711864e-05
07/02/2024 15:07:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  2950/ 12000] | 2949/7664 batches | ms/batch 197.3639 | train_loss 6.543884e-01 | lr 7.669492e-05
07/02/2024 15:07:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3000/ 12000] | 2999/7664 batches | ms/batch 197.2708 | train_loss 6.541506e-01 | lr 7.627119e-05
07/02/2024 15:07:53 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpb310n078 at global_step 3000 ****
07/02/2024 15:07:53 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 15:08:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3050/ 12000] | 3049/7664 batches | ms/batch 197.2090 | train_loss 6.520342e-01 | lr 7.584746e-05
07/02/2024 15:08:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3100/ 12000] | 3099/7664 batches | ms/batch 197.3579 | train_loss 6.531567e-01 | lr 7.542373e-05
07/02/2024 15:08:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3150/ 12000] | 3149/7664 batches | ms/batch 197.2747 | train_loss 6.546468e-01 | lr 7.500000e-05
07/02/2024 15:08:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3200/ 12000] | 3199/7664 batches | ms/batch 196.4509 | train_loss 6.536889e-01 | lr 7.457627e-05
07/02/2024 15:08:49 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3250/ 12000] | 3249/7664 batches | ms/batch 197.3735 | train_loss 6.523471e-01 | lr 7.415254e-05
07/02/2024 15:09:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3300/ 12000] | 3299/7664 batches | ms/batch 198.8959 | train_loss 6.541507e-01 | lr 7.372881e-05
07/02/2024 15:09:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3350/ 12000] | 3349/7664 batches | ms/batch 197.9099 | train_loss 6.491397e-01 | lr 7.330508e-05
07/02/2024 15:09:22 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3400/ 12000] | 3399/7664 batches | ms/batch 197.3916 | train_loss 6.516097e-01 | lr 7.288136e-05
07/02/2024 15:09:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3450/ 12000] | 3449/7664 batches | ms/batch 197.1312 | train_loss 6.538465e-01 | lr 7.245763e-05
07/02/2024 15:09:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3500/ 12000] | 3499/7664 batches | ms/batch 197.3175 | train_loss 6.501789e-01 | lr 7.203390e-05
07/02/2024 15:09:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3550/ 12000] | 3549/7664 batches | ms/batch 196.7778 | train_loss 6.495363e-01 | lr 7.161017e-05
07/02/2024 15:10:06 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3600/ 12000] | 3599/7664 batches | ms/batch 197.4923 | train_loss 6.488672e-01 | lr 7.118644e-05
07/02/2024 15:10:17 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3650/ 12000] | 3649/7664 batches | ms/batch 196.6633 | train_loss 6.515615e-01 | lr 7.076271e-05
07/02/2024 15:10:28 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3700/ 12000] | 3699/7664 batches | ms/batch 196.1701 | train_loss 6.489015e-01 | lr 7.033898e-05
07/02/2024 15:10:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3750/ 12000] | 3749/7664 batches | ms/batch 197.3266 | train_loss 6.490321e-01 | lr 6.991525e-05
07/02/2024 15:10:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3800/ 12000] | 3799/7664 batches | ms/batch 197.2681 | train_loss 6.507493e-01 | lr 6.949153e-05
07/02/2024 15:11:01 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3850/ 12000] | 3849/7664 batches | ms/batch 196.7916 | train_loss 6.484301e-01 | lr 6.906780e-05
07/02/2024 15:11:12 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3900/ 12000] | 3899/7664 batches | ms/batch 197.4879 | train_loss 6.470637e-01 | lr 6.864407e-05
07/02/2024 15:11:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  3950/ 12000] | 3949/7664 batches | ms/batch 197.0798 | train_loss 6.459439e-01 | lr 6.822034e-05
07/02/2024 15:11:34 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4000/ 12000] | 3999/7664 batches | ms/batch 196.5942 | train_loss 6.492340e-01 | lr 6.779661e-05
07/02/2024 15:11:34 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpb310n078 at global_step 4000 ****
07/02/2024 15:11:35 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 15:11:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4050/ 12000] | 4049/7664 batches | ms/batch 197.6221 | train_loss 6.474250e-01 | lr 6.737288e-05
07/02/2024 15:11:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4100/ 12000] | 4099/7664 batches | ms/batch 197.3007 | train_loss 6.493506e-01 | lr 6.694915e-05
07/02/2024 15:12:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4150/ 12000] | 4149/7664 batches | ms/batch 197.1999 | train_loss 6.456533e-01 | lr 6.652542e-05
07/02/2024 15:12:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4200/ 12000] | 4199/7664 batches | ms/batch 196.5085 | train_loss 6.465063e-01 | lr 6.610169e-05
07/02/2024 15:12:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4250/ 12000] | 4249/7664 batches | ms/batch 197.2549 | train_loss 6.478140e-01 | lr 6.567797e-05
07/02/2024 15:12:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4300/ 12000] | 4299/7664 batches | ms/batch 197.1221 | train_loss 6.452771e-01 | lr 6.525424e-05
07/02/2024 15:12:52 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4350/ 12000] | 4349/7664 batches | ms/batch 197.0290 | train_loss 6.463646e-01 | lr 6.483051e-05
07/02/2024 15:13:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4400/ 12000] | 4399/7664 batches | ms/batch 197.1812 | train_loss 6.472270e-01 | lr 6.440678e-05
07/02/2024 15:13:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4450/ 12000] | 4449/7664 batches | ms/batch 196.6297 | train_loss 6.445027e-01 | lr 6.398305e-05
07/02/2024 15:13:24 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4500/ 12000] | 4499/7664 batches | ms/batch 196.6935 | train_loss 6.454377e-01 | lr 6.355932e-05
07/02/2024 15:13:35 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4550/ 12000] | 4549/7664 batches | ms/batch 197.2765 | train_loss 6.446789e-01 | lr 6.313559e-05
07/02/2024 15:13:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4600/ 12000] | 4599/7664 batches | ms/batch 196.3600 | train_loss 6.431197e-01 | lr 6.271186e-05
07/02/2024 15:13:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4650/ 12000] | 4649/7664 batches | ms/batch 196.0228 | train_loss 6.424507e-01 | lr 6.228814e-05
07/02/2024 15:14:08 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4700/ 12000] | 4699/7664 batches | ms/batch 197.4717 | train_loss 6.431647e-01 | lr 6.186441e-05
07/02/2024 15:14:19 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4750/ 12000] | 4749/7664 batches | ms/batch 198.9506 | train_loss 6.434045e-01 | lr 6.144068e-05
07/02/2024 15:14:30 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4800/ 12000] | 4799/7664 batches | ms/batch 198.1765 | train_loss 6.440829e-01 | lr 6.101695e-05
07/02/2024 15:14:41 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4850/ 12000] | 4849/7664 batches | ms/batch 197.1172 | train_loss 6.430634e-01 | lr 6.059322e-05
07/02/2024 15:14:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4900/ 12000] | 4899/7664 batches | ms/batch 197.3134 | train_loss 6.420923e-01 | lr 6.016949e-05
07/02/2024 15:15:03 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  4950/ 12000] | 4949/7664 batches | ms/batch 197.3349 | train_loss 6.405058e-01 | lr 5.974576e-05
07/02/2024 15:15:14 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5000/ 12000] | 4999/7664 batches | ms/batch 196.3872 | train_loss 6.413070e-01 | lr 5.932203e-05
07/02/2024 15:15:14 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpb310n078 at global_step 5000 ****
07/02/2024 15:15:15 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 15:15:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5050/ 12000] | 5049/7664 batches | ms/batch 198.8876 | train_loss 6.408629e-01 | lr 5.889831e-05
07/02/2024 15:15:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5100/ 12000] | 5099/7664 batches | ms/batch 197.0711 | train_loss 6.410865e-01 | lr 5.847458e-05
07/02/2024 15:15:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5150/ 12000] | 5149/7664 batches | ms/batch 197.3654 | train_loss 6.407579e-01 | lr 5.805085e-05
07/02/2024 15:15:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5200/ 12000] | 5199/7664 batches | ms/batch 197.3855 | train_loss 6.405548e-01 | lr 5.762712e-05
07/02/2024 15:16:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5250/ 12000] | 5249/7664 batches | ms/batch 196.4630 | train_loss 6.417200e-01 | lr 5.720339e-05
07/02/2024 15:16:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5300/ 12000] | 5299/7664 batches | ms/batch 196.0245 | train_loss 6.417336e-01 | lr 5.677966e-05
07/02/2024 15:16:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5350/ 12000] | 5349/7664 batches | ms/batch 197.3141 | train_loss 6.397272e-01 | lr 5.635593e-05
07/02/2024 15:16:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5400/ 12000] | 5399/7664 batches | ms/batch 197.5402 | train_loss 6.389866e-01 | lr 5.593220e-05
07/02/2024 15:16:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5450/ 12000] | 5449/7664 batches | ms/batch 199.1075 | train_loss 6.404665e-01 | lr 5.550847e-05
07/02/2024 15:17:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5500/ 12000] | 5499/7664 batches | ms/batch 197.3032 | train_loss 6.388476e-01 | lr 5.508475e-05
07/02/2024 15:17:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5550/ 12000] | 5549/7664 batches | ms/batch 197.4079 | train_loss 6.379197e-01 | lr 5.466102e-05
07/02/2024 15:17:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5600/ 12000] | 5599/7664 batches | ms/batch 197.3196 | train_loss 6.414657e-01 | lr 5.423729e-05
07/02/2024 15:17:39 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5650/ 12000] | 5649/7664 batches | ms/batch 197.3568 | train_loss 6.388156e-01 | lr 5.381356e-05
07/02/2024 15:17:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5700/ 12000] | 5699/7664 batches | ms/batch 196.5449 | train_loss 6.390372e-01 | lr 5.338983e-05
07/02/2024 15:18:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5750/ 12000] | 5749/7664 batches | ms/batch 196.5082 | train_loss 6.398562e-01 | lr 5.296610e-05
07/02/2024 15:18:11 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5800/ 12000] | 5799/7664 batches | ms/batch 197.1650 | train_loss 6.381186e-01 | lr 5.254237e-05
07/02/2024 15:18:23 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5850/ 12000] | 5849/7664 batches | ms/batch 197.2908 | train_loss 6.378047e-01 | lr 5.211864e-05
07/02/2024 15:18:33 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5900/ 12000] | 5899/7664 batches | ms/batch 196.2715 | train_loss 6.377060e-01 | lr 5.169492e-05
07/02/2024 15:18:44 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  5950/ 12000] | 5949/7664 batches | ms/batch 196.2972 | train_loss 6.381112e-01 | lr 5.127119e-05
07/02/2024 15:18:55 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6000/ 12000] | 5999/7664 batches | ms/batch 197.0128 | train_loss 6.363590e-01 | lr 5.084746e-05
07/02/2024 15:18:55 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpb310n078 at global_step 6000 ****
07/02/2024 15:18:56 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 15:19:07 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6050/ 12000] | 6049/7664 batches | ms/batch 197.3445 | train_loss 6.379221e-01 | lr 5.042373e-05
07/02/2024 15:19:18 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6100/ 12000] | 6099/7664 batches | ms/batch 197.2532 | train_loss 6.375160e-01 | lr 5.000000e-05
07/02/2024 15:19:29 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6150/ 12000] | 6149/7664 batches | ms/batch 197.1926 | train_loss 6.377671e-01 | lr 4.957627e-05
07/02/2024 15:19:40 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6200/ 12000] | 6199/7664 batches | ms/batch 197.0134 | train_loss 6.372359e-01 | lr 4.915254e-05
07/02/2024 15:19:51 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6250/ 12000] | 6249/7664 batches | ms/batch 196.9705 | train_loss 6.367039e-01 | lr 4.872881e-05
07/02/2024 15:20:02 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6300/ 12000] | 6299/7664 batches | ms/batch 197.4701 | train_loss 6.368976e-01 | lr 4.830508e-05
07/02/2024 15:20:13 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6350/ 12000] | 6349/7664 batches | ms/batch 197.3548 | train_loss 6.345189e-01 | lr 4.788136e-05
07/02/2024 15:20:25 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6400/ 12000] | 6399/7664 batches | ms/batch 197.2535 | train_loss 6.346795e-01 | lr 4.745763e-05
07/02/2024 15:20:36 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6450/ 12000] | 6449/7664 batches | ms/batch 196.4106 | train_loss 6.359655e-01 | lr 4.703390e-05
07/02/2024 15:20:46 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6500/ 12000] | 6499/7664 batches | ms/batch 196.8955 | train_loss 6.321016e-01 | lr 4.661017e-05
07/02/2024 15:20:57 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6550/ 12000] | 6549/7664 batches | ms/batch 198.1234 | train_loss 6.345137e-01 | lr 4.618644e-05
07/02/2024 15:21:09 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6600/ 12000] | 6599/7664 batches | ms/batch 197.3514 | train_loss 6.352224e-01 | lr 4.576271e-05
07/02/2024 15:21:20 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6650/ 12000] | 6649/7664 batches | ms/batch 199.2406 | train_loss 6.336612e-01 | lr 4.533898e-05
07/02/2024 15:21:31 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6700/ 12000] | 6699/7664 batches | ms/batch 197.1827 | train_loss 6.349531e-01 | lr 4.491525e-05
07/02/2024 15:21:42 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6750/ 12000] | 6749/7664 batches | ms/batch 197.1498 | train_loss 6.359227e-01 | lr 4.449153e-05
07/02/2024 15:21:53 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6800/ 12000] | 6799/7664 batches | ms/batch 199.2828 | train_loss 6.361860e-01 | lr 4.406780e-05
07/02/2024 15:22:04 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6850/ 12000] | 6849/7664 batches | ms/batch 197.8952 | train_loss 6.343536e-01 | lr 4.364407e-05
07/02/2024 15:22:15 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6900/ 12000] | 6899/7664 batches | ms/batch 197.1792 | train_loss 6.318405e-01 | lr 4.322034e-05
07/02/2024 15:22:26 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  6950/ 12000] | 6949/7664 batches | ms/batch 196.4712 | train_loss 6.323448e-01 | lr 4.279661e-05
07/02/2024 15:22:37 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7000/ 12000] | 6999/7664 batches | ms/batch 196.9920 | train_loss 6.352960e-01 | lr 4.237288e-05
07/02/2024 15:22:37 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpb310n078 at global_step 7000 ****
07/02/2024 15:22:37 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 15:22:48 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7050/ 12000] | 7049/7664 batches | ms/batch 196.3662 | train_loss 6.329804e-01 | lr 4.194915e-05
07/02/2024 15:22:59 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7100/ 12000] | 7099/7664 batches | ms/batch 197.0383 | train_loss 6.334428e-01 | lr 4.152542e-05
07/02/2024 15:23:10 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7150/ 12000] | 7149/7664 batches | ms/batch 196.9492 | train_loss 6.329866e-01 | lr 4.110169e-05
07/02/2024 15:23:21 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7200/ 12000] | 7199/7664 batches | ms/batch 196.4595 | train_loss 6.326321e-01 | lr 4.067797e-05
07/02/2024 15:23:32 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7250/ 12000] | 7249/7664 batches | ms/batch 197.3607 | train_loss 6.325000e-01 | lr 4.025424e-05
07/02/2024 15:23:43 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7300/ 12000] | 7299/7664 batches | ms/batch 197.7146 | train_loss 6.316713e-01 | lr 3.983051e-05
07/02/2024 15:23:54 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7350/ 12000] | 7349/7664 batches | ms/batch 197.4788 | train_loss 6.318775e-01 | lr 3.940678e-05
07/02/2024 15:24:05 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7400/ 12000] | 7399/7664 batches | ms/batch 197.2514 | train_loss 6.341314e-01 | lr 3.898305e-05
07/02/2024 15:24:16 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7450/ 12000] | 7449/7664 batches | ms/batch 197.1965 | train_loss 6.334860e-01 | lr 3.855932e-05
07/02/2024 15:24:27 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7500/ 12000] | 7499/7664 batches | ms/batch 197.2683 | train_loss 6.310334e-01 | lr 3.813559e-05
07/02/2024 15:24:38 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7550/ 12000] | 7549/7664 batches | ms/batch 197.2626 | train_loss 6.332139e-01 | lr 3.771186e-05
07/02/2024 15:24:50 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7600/ 12000] | 7599/7664 batches | ms/batch 197.3850 | train_loss 6.320415e-01 | lr 3.728814e-05
07/02/2024 15:25:00 - INFO - pecos.xmc.xtransformer.matcher - | [   1/   2][  7650/ 12000] | 7649/7664 batches | ms/batch 197.1514 | train_loss 6.309600e-01 | lr 3.686441e-05
07/02/2024 15:25:20 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  7700/ 12000] |   35/7664 batches | ms/batch 198.0500 | train_loss 6.231353e-01 | lr 3.644068e-05
07/02/2024 15:25:31 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  7750/ 12000] |   85/7664 batches | ms/batch 195.5814 | train_loss 6.192073e-01 | lr 3.601695e-05
07/02/2024 15:25:42 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  7800/ 12000] |  135/7664 batches | ms/batch 197.2206 | train_loss 6.179526e-01 | lr 3.559322e-05
07/02/2024 15:25:53 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  7850/ 12000] |  185/7664 batches | ms/batch 198.7604 | train_loss 6.179294e-01 | lr 3.516949e-05
07/02/2024 15:26:04 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  7900/ 12000] |  235/7664 batches | ms/batch 197.1588 | train_loss 6.199092e-01 | lr 3.474576e-05
07/02/2024 15:26:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  7950/ 12000] |  285/7664 batches | ms/batch 197.0050 | train_loss 6.188284e-01 | lr 3.432203e-05
07/02/2024 15:26:26 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8000/ 12000] |  335/7664 batches | ms/batch 198.2279 | train_loss 6.185874e-01 | lr 3.389831e-05
07/02/2024 15:26:26 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpb310n078 at global_step 8000 ****
07/02/2024 15:26:27 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 15:26:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8050/ 12000] |  385/7664 batches | ms/batch 196.9781 | train_loss 6.181500e-01 | lr 3.347458e-05
07/02/2024 15:26:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8100/ 12000] |  435/7664 batches | ms/batch 197.0076 | train_loss 6.198210e-01 | lr 3.305085e-05
07/02/2024 15:27:00 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8150/ 12000] |  485/7664 batches | ms/batch 196.3392 | train_loss 6.179958e-01 | lr 3.262712e-05
07/02/2024 15:27:11 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8200/ 12000] |  535/7664 batches | ms/batch 197.0114 | train_loss 6.183949e-01 | lr 3.220339e-05
07/02/2024 15:27:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8250/ 12000] |  585/7664 batches | ms/batch 197.0591 | train_loss 6.186011e-01 | lr 3.177966e-05
07/02/2024 15:27:33 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8300/ 12000] |  635/7664 batches | ms/batch 197.0037 | train_loss 6.194827e-01 | lr 3.135593e-05
07/02/2024 15:27:44 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8350/ 12000] |  685/7664 batches | ms/batch 197.3584 | train_loss 6.162859e-01 | lr 3.093220e-05
07/02/2024 15:27:55 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8400/ 12000] |  735/7664 batches | ms/batch 197.2434 | train_loss 6.189366e-01 | lr 3.050847e-05
07/02/2024 15:28:06 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8450/ 12000] |  785/7664 batches | ms/batch 197.1045 | train_loss 6.181481e-01 | lr 3.008475e-05
07/02/2024 15:28:17 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8500/ 12000] |  835/7664 batches | ms/batch 197.0602 | train_loss 6.180684e-01 | lr 2.966102e-05
07/02/2024 15:28:28 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8550/ 12000] |  885/7664 batches | ms/batch 196.2258 | train_loss 6.192647e-01 | lr 2.923729e-05
07/02/2024 15:28:39 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8600/ 12000] |  935/7664 batches | ms/batch 197.0506 | train_loss 6.171611e-01 | lr 2.881356e-05
07/02/2024 15:28:50 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8650/ 12000] |  985/7664 batches | ms/batch 196.3555 | train_loss 6.182813e-01 | lr 2.838983e-05
07/02/2024 15:29:01 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8700/ 12000] | 1035/7664 batches | ms/batch 197.1260 | train_loss 6.166082e-01 | lr 2.796610e-05
07/02/2024 15:29:12 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8750/ 12000] | 1085/7664 batches | ms/batch 197.2281 | train_loss 6.174382e-01 | lr 2.754237e-05
07/02/2024 15:29:23 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8800/ 12000] | 1135/7664 batches | ms/batch 197.2379 | train_loss 6.179178e-01 | lr 2.711864e-05
07/02/2024 15:29:34 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8850/ 12000] | 1185/7664 batches | ms/batch 197.1853 | train_loss 6.167394e-01 | lr 2.669492e-05
07/02/2024 15:29:45 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8900/ 12000] | 1235/7664 batches | ms/batch 196.7640 | train_loss 6.167790e-01 | lr 2.627119e-05
07/02/2024 15:29:56 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  8950/ 12000] | 1285/7664 batches | ms/batch 196.0636 | train_loss 6.183545e-01 | lr 2.584746e-05
07/02/2024 15:30:07 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9000/ 12000] | 1335/7664 batches | ms/batch 198.8265 | train_loss 6.155269e-01 | lr 2.542373e-05
07/02/2024 15:30:07 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpb310n078 at global_step 9000 ****
07/02/2024 15:30:07 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 15:30:19 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9050/ 12000] | 1385/7664 batches | ms/batch 199.2371 | train_loss 6.171758e-01 | lr 2.500000e-05
07/02/2024 15:30:30 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9100/ 12000] | 1435/7664 batches | ms/batch 197.1324 | train_loss 6.165530e-01 | lr 2.457627e-05
07/02/2024 15:30:41 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9150/ 12000] | 1485/7664 batches | ms/batch 198.8980 | train_loss 6.146018e-01 | lr 2.415254e-05
07/02/2024 15:30:51 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9200/ 12000] | 1535/7664 batches | ms/batch 195.9807 | train_loss 6.153880e-01 | lr 2.372881e-05
07/02/2024 15:31:02 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9250/ 12000] | 1585/7664 batches | ms/batch 196.2947 | train_loss 6.149158e-01 | lr 2.330508e-05
07/02/2024 15:31:13 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9300/ 12000] | 1635/7664 batches | ms/batch 197.0784 | train_loss 6.141986e-01 | lr 2.288136e-05
07/02/2024 15:31:26 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9350/ 12000] | 1685/7664 batches | ms/batch 221.7902 | train_loss 6.149913e-01 | lr 2.245763e-05
07/02/2024 15:31:37 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9400/ 12000] | 1735/7664 batches | ms/batch 196.9037 | train_loss 6.161305e-01 | lr 2.203390e-05
07/02/2024 15:31:48 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9450/ 12000] | 1785/7664 batches | ms/batch 196.9949 | train_loss 6.146769e-01 | lr 2.161017e-05
07/02/2024 15:31:59 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9500/ 12000] | 1835/7664 batches | ms/batch 196.9192 | train_loss 6.150002e-01 | lr 2.118644e-05
07/02/2024 15:32:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9550/ 12000] | 1885/7664 batches | ms/batch 197.2769 | train_loss 6.153499e-01 | lr 2.076271e-05
07/02/2024 15:32:21 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9600/ 12000] | 1935/7664 batches | ms/batch 197.1413 | train_loss 6.163460e-01 | lr 2.033898e-05
07/02/2024 15:32:31 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9650/ 12000] | 1985/7664 batches | ms/batch 197.0950 | train_loss 6.145418e-01 | lr 1.991525e-05
07/02/2024 15:32:42 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9700/ 12000] | 2035/7664 batches | ms/batch 196.9447 | train_loss 6.157004e-01 | lr 1.949153e-05
07/02/2024 15:32:53 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9750/ 12000] | 2085/7664 batches | ms/batch 196.3232 | train_loss 6.169572e-01 | lr 1.906780e-05
07/02/2024 15:33:04 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9800/ 12000] | 2135/7664 batches | ms/batch 196.9222 | train_loss 6.154633e-01 | lr 1.864407e-05
07/02/2024 15:33:15 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9850/ 12000] | 2185/7664 batches | ms/batch 197.0100 | train_loss 6.157611e-01 | lr 1.822034e-05
07/02/2024 15:33:26 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9900/ 12000] | 2235/7664 batches | ms/batch 196.1964 | train_loss 6.139261e-01 | lr 1.779661e-05
07/02/2024 15:33:37 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][  9950/ 12000] | 2285/7664 batches | ms/batch 197.3215 | train_loss 6.137338e-01 | lr 1.737288e-05
07/02/2024 15:33:48 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10000/ 12000] | 2335/7664 batches | ms/batch 196.1521 | train_loss 6.130377e-01 | lr 1.694915e-05
07/02/2024 15:33:48 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpb310n078 at global_step 10000 ****
07/02/2024 15:33:48 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 15:33:59 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10050/ 12000] | 2385/7664 batches | ms/batch 197.2959 | train_loss 6.134249e-01 | lr 1.652542e-05
07/02/2024 15:34:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10100/ 12000] | 2435/7664 batches | ms/batch 197.3064 | train_loss 6.137618e-01 | lr 1.610169e-05
07/02/2024 15:34:21 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10150/ 12000] | 2485/7664 batches | ms/batch 196.4218 | train_loss 6.123460e-01 | lr 1.567797e-05
07/02/2024 15:34:32 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10200/ 12000] | 2535/7664 batches | ms/batch 197.1016 | train_loss 6.138555e-01 | lr 1.525424e-05
07/02/2024 15:34:43 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10250/ 12000] | 2585/7664 batches | ms/batch 196.1201 | train_loss 6.120974e-01 | lr 1.483051e-05
07/02/2024 15:34:54 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10300/ 12000] | 2635/7664 batches | ms/batch 197.1269 | train_loss 6.134067e-01 | lr 1.440678e-05
07/02/2024 15:35:05 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10350/ 12000] | 2685/7664 batches | ms/batch 197.1361 | train_loss 6.133270e-01 | lr 1.398305e-05
07/02/2024 15:35:16 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10400/ 12000] | 2735/7664 batches | ms/batch 196.8965 | train_loss 6.124209e-01 | lr 1.355932e-05
07/02/2024 15:35:26 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10450/ 12000] | 2785/7664 batches | ms/batch 196.9136 | train_loss 6.128103e-01 | lr 1.313559e-05
07/02/2024 15:35:37 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10500/ 12000] | 2835/7664 batches | ms/batch 196.3211 | train_loss 6.130970e-01 | lr 1.271186e-05
07/02/2024 15:35:48 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10550/ 12000] | 2885/7664 batches | ms/batch 197.1682 | train_loss 6.127095e-01 | lr 1.228814e-05
07/02/2024 15:35:59 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10600/ 12000] | 2935/7664 batches | ms/batch 199.7698 | train_loss 6.128618e-01 | lr 1.186441e-05
07/02/2024 15:36:10 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10650/ 12000] | 2985/7664 batches | ms/batch 197.1859 | train_loss 6.126946e-01 | lr 1.144068e-05
07/02/2024 15:36:21 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10700/ 12000] | 3035/7664 batches | ms/batch 197.0161 | train_loss 6.118268e-01 | lr 1.101695e-05
07/02/2024 15:36:32 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10750/ 12000] | 3085/7664 batches | ms/batch 195.8208 | train_loss 6.120361e-01 | lr 1.059322e-05
07/02/2024 15:36:43 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10800/ 12000] | 3135/7664 batches | ms/batch 197.1513 | train_loss 6.112920e-01 | lr 1.016949e-05
07/02/2024 15:36:54 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10850/ 12000] | 3185/7664 batches | ms/batch 196.1919 | train_loss 6.124180e-01 | lr 9.745763e-06
07/02/2024 15:37:05 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10900/ 12000] | 3235/7664 batches | ms/batch 196.8625 | train_loss 6.122548e-01 | lr 9.322034e-06
07/02/2024 15:37:16 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 10950/ 12000] | 3285/7664 batches | ms/batch 197.1661 | train_loss 6.128548e-01 | lr 8.898305e-06
07/02/2024 15:37:26 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11000/ 12000] | 3335/7664 batches | ms/batch 197.3045 | train_loss 6.119167e-01 | lr 8.474576e-06
07/02/2024 15:37:26 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpb310n078 at global_step 11000 ****
07/02/2024 15:37:27 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 15:37:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11050/ 12000] | 3385/7664 batches | ms/batch 196.2736 | train_loss 6.114708e-01 | lr 8.050847e-06
07/02/2024 15:37:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11100/ 12000] | 3435/7664 batches | ms/batch 197.1514 | train_loss 6.120455e-01 | lr 7.627119e-06
07/02/2024 15:38:00 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11150/ 12000] | 3485/7664 batches | ms/batch 196.9593 | train_loss 6.114648e-01 | lr 7.203390e-06
07/02/2024 15:38:11 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11200/ 12000] | 3535/7664 batches | ms/batch 198.3984 | train_loss 6.132330e-01 | lr 6.779661e-06
07/02/2024 15:38:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11250/ 12000] | 3585/7664 batches | ms/batch 196.3060 | train_loss 6.112259e-01 | lr 6.355932e-06
07/02/2024 15:38:33 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11300/ 12000] | 3635/7664 batches | ms/batch 196.2386 | train_loss 6.084972e-01 | lr 5.932203e-06
07/02/2024 15:38:44 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11350/ 12000] | 3685/7664 batches | ms/batch 197.0234 | train_loss 6.127630e-01 | lr 5.508475e-06
07/02/2024 15:38:54 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11400/ 12000] | 3735/7664 batches | ms/batch 196.4129 | train_loss 6.110817e-01 | lr 5.084746e-06
07/02/2024 15:39:05 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11450/ 12000] | 3785/7664 batches | ms/batch 199.0733 | train_loss 6.122553e-01 | lr 4.661017e-06
07/02/2024 15:39:16 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11500/ 12000] | 3835/7664 batches | ms/batch 197.0555 | train_loss 6.106037e-01 | lr 4.237288e-06
07/02/2024 15:39:27 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11550/ 12000] | 3885/7664 batches | ms/batch 196.1731 | train_loss 6.098327e-01 | lr 3.813559e-06
07/02/2024 15:39:38 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11600/ 12000] | 3935/7664 batches | ms/batch 197.1728 | train_loss 6.105663e-01 | lr 3.389831e-06
07/02/2024 15:39:49 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11650/ 12000] | 3985/7664 batches | ms/batch 196.9421 | train_loss 6.113274e-01 | lr 2.966102e-06
07/02/2024 15:40:00 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11700/ 12000] | 4035/7664 batches | ms/batch 196.8491 | train_loss 6.089236e-01 | lr 2.542373e-06
07/02/2024 15:40:11 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11750/ 12000] | 4085/7664 batches | ms/batch 197.0959 | train_loss 6.102804e-01 | lr 2.118644e-06
07/02/2024 15:40:22 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11800/ 12000] | 4135/7664 batches | ms/batch 197.1461 | train_loss 6.123926e-01 | lr 1.694915e-06
07/02/2024 15:40:33 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11850/ 12000] | 4185/7664 batches | ms/batch 197.2557 | train_loss 6.106671e-01 | lr 1.271186e-06
07/02/2024 15:40:44 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11900/ 12000] | 4235/7664 batches | ms/batch 196.9287 | train_loss 6.111778e-01 | lr 8.474576e-07
07/02/2024 15:40:55 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 11950/ 12000] | 4285/7664 batches | ms/batch 196.8960 | train_loss 6.102767e-01 | lr 4.237288e-07
07/02/2024 15:41:06 - INFO - pecos.xmc.xtransformer.matcher - | [   2/   2][ 12000/ 12000] | 4335/7664 batches | ms/batch 195.8115 | train_loss 6.092390e-01 | lr 0.000000e+00
07/02/2024 15:41:06 - INFO - pecos.xmc.xtransformer.matcher - | **** saving model (avg_prec=0) to /scratch/slurm_tmpdir/job_23821887/tmpb310n078 at global_step 12000 ****
07/02/2024 15:41:06 - INFO - pecos.xmc.xtransformer.matcher - -----------------------------------------------------------------------------------------
07/02/2024 15:41:08 - INFO - pecos.xmc.xtransformer.matcher - Reload the best checkpoint from /scratch/slurm_tmpdir/job_23821887/tmpb310n078
07/02/2024 15:41:09 - INFO - pecos.xmc.xtransformer.matcher - Predict with csr_codes_next((490449, 32768)) with avr_nnz=80.0
07/02/2024 15:41:09 - INFO - pecos.xmc.xtransformer.module - Constructed XMCTextTensorizer, tokenized=True, len=490449
07/02/2024 15:51:29 - INFO - pecos.xmc.xtransformer.model - Constructed instance feature matrix with shape=(490449, 136677)
07/02/2024 15:52:12 - INFO - pecos.xmc.xtransformer.model - Hierarchical label tree for ranker: [8, 256, 8192, 670091]
07/02/2024 15:52:12 - INFO - pecos.xmc.xtransformer.model - Start training ranker...
07/02/2024 15:52:13 - INFO - pecos.xmc.base - Training Layer 0 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
07/02/2024 15:52:36 - INFO - pecos.xmc.base - Training Layer 1 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
07/02/2024 15:53:12 - INFO - pecos.xmc.base - Training Layer 2 of 4 Layers in HierarchicalMLModel, neg_mining=tfn..
07/02/2024 15:54:33 - INFO - pecos.xmc.base - Training Layer 3 of 4 Layers in HierarchicalMLModel, neg_mining=tfn+man..
07/02/2024 16:38:00 - INFO - pecos.xmc.xtransformer.model - Parameters saved to models/amazon-670k/bert3/param.json
07/02/2024 16:38:20 - INFO - pecos.xmc.xtransformer.model - Model saved to models/amazon-670k/bert3
==== evaluation results ====
param: bert1
[382338 397323 586059]
3
prec   = 48.20 45.28 42.97 41.02 39.25 37.51 34.11 31.06 28.51 26.35 24.49 22.86 21.43 20.18 19.06 18.07 17.17 16.37 15.63 14.97
recall = 10.14 18.14 25.10 31.34 36.98 41.98 44.48 46.25 47.73 48.99 50.07 50.99 51.79 52.51 53.16 53.74 54.28 54.78 55.24 55.67
psp    = 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
r_prec = 39.83
param: bert2
[382338 397323 586059]
3
prec   = 48.26 45.29 42.99 40.98 39.22 37.49 34.08 31.06 28.50 26.33 24.46 22.84 21.42 20.15 19.04 18.04 17.15 16.34 15.61 14.94
recall = 10.16 18.15 25.11 31.31 36.96 41.98 44.44 46.25 47.72 48.96 50.02 50.96 51.76 52.46 53.10 53.68 54.21 54.71 55.15 55.57
psp    = 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
r_prec = 39.83
param: bert3
[382338 397323 586059]
3
prec   = 48.25 45.32 43.03 41.07 39.29 37.56 34.14 31.08 28.52 26.35 24.49 22.87 21.44 20.18 19.06 18.07 17.17 16.36 15.63 14.96
recall = 10.16 18.15 25.14 31.38 37.01 42.05 44.51 46.27 47.73 48.98 50.06 51.01 51.80 52.51 53.16 53.74 54.27 54.76 55.21 55.65
psp    = 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
r_prec = 39.91
==== softmax_average ensemble results ====
[382338 397323 586059]
3
prec   = 49.17 46.12 43.75 41.72 39.91 38.14 34.69 31.61 29.02 26.83 24.94 23.30 21.86 20.58 19.45 18.45 17.54 16.72 15.98 15.30
recall = 10.34 18.47 25.55 31.87 37.61 42.72 45.25 47.09 48.61 49.91 51.02 52.00 52.84 53.60 54.28 54.91 55.48 56.02 56.53 56.98
psp    = 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
r_prec = 40.52

============================= JOB FEEDBACK =============================

NodeName=uc2n911
Job ID: 23821887
Cluster: uc2
User/Group: ul_ruw26/ul_student
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 32
CPU Utilized: 4-04:04:08
CPU Efficiency: 35.40% of 11-18:41:36 core-walltime
Job Wall-clock time: 08:50:03
Memory Utilized: 121.37 GB
Memory Efficiency: 82.85% of 146.48 GB
